{"version":3,"sources":["turno-filtro.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"turno-filtro.js","sourcesContent":["\t{ \r\n        /** Pesquisar Centro de Custo */\r\n\t\t\r\n\t\tvar filtro;\r\n\t\tvar campo_turno;\r\n\t\tvar btn_filtro_turno;\r\n\t\tvar input_group;\r\n\t\tvar itens_turno;\r\n\t\tvar _turno_id;\r\n\t\tvar tempo_focus;\r\n\t\tvar turno_selecionado = false;\r\n\r\n\r\n\r\n\t\t/**\r\n\t\t * Filtrar objeto.\r\n\t\t */\r\n\t\tfunction filtrarTurno() {\r\n\r\n\t\t\tcampo_turno\t\t= $('#turno-descricao');\t//campo\r\n\t\t\tbtn_filtro_turno\t= $('.btn-filtro-turno');\r\n\r\n\t\t\tinput_group\t\t\t= $(campo_turno).parent('.input-group');\t//input-group\r\n\t\t\t_turno_id\t\t\t= $('input[name=\"_turno_id\"]');\r\n\r\n\t\t\tfiltro = campo_turno.val();\r\n\r\n\t\t\t//esvazia campo hidden caso algum item já tenha sido escolhido antes\r\n\t\t\tif(turno_selecionado) \r\n\t\t\t\t$(_turno_id).val('');\r\n\r\n\t\t\tif( !filtro ) {\r\n\t\t\t\tfechaListaTurno( input_group );\r\n\t\t\t\t$(_turno_id).val('');\r\n\t\t\t\t//return false;\r\n\t\t\t}\r\n            \r\n            var url_action = \"/turno/filtrar\";\r\n            var dados = {'filtro': filtro};\r\n            var type = \"POST\";\r\n            \r\n            function success(data){\r\n              abreListaTurno( input_group );\r\n\t\t\t\t\t\r\n\t\t\t\t\t$('.lista-turno')\r\n\t\t\t\t\t\t.html(data);\r\n\r\n\t\t\t\t\t//existem dados cadastrados\r\n\t\t\t\t\tif( data.indexOf('nao-cadastrado') === -1 ) {\r\n\r\n\t\t\t\t\t\titens_turno = $('ul.turno li a');\r\n                        \r\n\t\t\t\t\t\tselecItemListaTurno( $(itens_turno), campo_turno );\r\n\r\n\t\t\t\t\t\t$(itens_turno)\r\n\t\t\t\t\t\t\t.focusout(function() {\r\n\r\n\t\t\t\t\t\t\t\tif(tempo_focus) \r\n\t\t\t\t\t\t\t\t\tclearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\t\t\t\tif( !$(itens_turno).is(':focus') && \r\n\t\t\t\t\t\t\t\t\t\t!$(campo_turno).is(':focus') && \r\n\t\t\t\t\t\t\t\t\t\t!$(btn_filtro_turno).is(':focus') \r\n\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t$(campo_turno).val('');\r\n\t\t\t\t\t\t\t\t\t\tfechaListaTurno( input_group );\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}, 200);\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$(campo_turno)\r\n\t\t\t\t\t\t\t.focusout(function() {\r\n\r\n\t\t\t\t\t\t\t\tif(tempo_focus) \r\n\t\t\t\t\t\t\t\t\tclearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\t\t\t\tif( !$(itens_turno).is(':focus') &&\r\n\t\t\t\t\t\t\t\t\t\t!$(_turno_id).val() && \r\n\t\t\t\t\t\t\t\t\t\t!$(btn_filtro_turno).is(':focus') \r\n\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t$(campo_turno).val('');\r\n\t\t\t\t\t\t\t\t\t\tfechaListaTurno( input_group );\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}, 200);\r\n\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t$(_turno_id).val('');\r\n\r\n\t\t\t\t\t\t$(campo_turno)\r\n\t\t\t\t\t\t\t.focusout(function() {\r\n\t\t\t\t\t\t\t\tif( $('.lista-turno').children().children().hasClass('nao-cadastrado') ) {\r\n\t\t\t\t\t\t\t\t\t$(campo_turno).val('');\r\n\t\t\t\t\t\t\t\t\tfechaListaTurno( input_group );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}  \r\n            }\r\n            \r\n\r\n            execAjax2(type,url_action,dados,success,false,btn_filtro_turno,false);\r\n\t\t}\r\n\r\n\t\t//Abre resultado da filtragem\r\n\t\tfunction abreListaTurno(turno) {\r\n\t\t\t\r\n\t\t\t$(turno)\r\n\t\t\t\t.next('.lista-turno-container')\r\n\t\t\t\t.addClass('ativo');\r\n\t\t\r\n\t\t\t$(btn_filtro_turno)\r\n\t\t\t\t.attr('tabindex', '-1');\r\n\t\t}\r\n\r\n\t\t//Fecha resultado da filtragem\r\n\t\tfunction fechaListaTurno(turno) {\r\n\t\t\t\r\n\t\t\t$(turno)\r\n\t\t\t\t.next('.lista-turno-container')\r\n\t\t\t\t.removeClass('ativo')\r\n\t\t\t\t.children('.lista-turno')\r\n\t\t\t\t.empty();\r\n\t\t\r\n\t\t\t$(btn_filtro_turno)\r\n\t\t\t\t.removeAttr('tabindex');\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Preencher campos de acordo com o item selecionado.\r\n\t\t * \r\n\t\t * @param {object} itens\r\n\t\t * @param {object} campo\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tfunction selecItemListaTurno(itens, campo) {\r\n\r\n\t\t\t$(itens).click(function(e) {\r\n\t\t\t\t\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\t\r\n\t\t\t\t$(campo)\r\n\t\t\t\t\t.val( $(this).text() )\r\n\t\t\t\t\t.focus();\r\n\t\t\t\r\n\t\t\t\tselecionadoTurno();\r\n\t\t\t\r\n\t\t\t\t$(_turno_id)\r\n\t\t\t\t\t.val( $(this).nextAll('.turno-id').val() )\r\n\t\t\t\t\t.trigger('change');\r\n            \r\n                $( \".turno-descricao\" ).trigger( \"change\" );\r\n                \r\n\t\t\t\tfechaListaTurno( input_group );\r\n\t\t\t\tturno_selecionado = true;\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * Ações que devem acontecer após o item ser selecionado.\r\n\t\t */\r\n\t\tfunction selecionadoTurno() {\r\n\t\t\t\r\n\t\t\t$('#turno-descricao')\r\n\t\t\t\t.attr('readonly', true);\r\n\r\n\t\t\t$('.btn-filtro-turno')\r\n\t\t\t\t.hide();\r\n\r\n\t\t\t$('.btn-apagar-filtro-turno')\r\n\t\t\t\t.show()\r\n\t\t\t\t.click(function() {\r\n\r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.siblings('input')\r\n\t\t\t\t\t\t.removeAttr('readonly');\r\n\r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.hide()\r\n\t\t\t\t\t\t.prev('button')\r\n\t\t\t\t\t\t.show();\r\n\r\n\t\t\t\t\t$('#turno-descricao')\r\n\t\t\t\t\t\t.val('')\r\n\t\t\t\t\t\t.focus();\r\n\r\n\t\t\t\t\t$('input[name=\"_turno_id\"]')\r\n\t\t\t\t\t\t.val('');\r\n\r\n\t\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t/**\r\n\t\t * Eventos para o filtro de Turno.\r\n\t\t */\r\n\t\tfunction iniciarFiltroTurno() {\r\n\t\t\t\r\n\t\t\t//Se o item j? estiver selecionado (tela de update), efetua as devidas a??es.\r\n\t\t\tif ( $('input[name=\"_turno_id\"]').val() !== '' )\r\n\t\t\t\tselecionadoTurno();\r\n\r\n\t\t\t//Bot?o de filtrar\r\n\t\t\t$('.btn-filtro-turno').on({\r\n\r\n\t\t\t\tclick: function() {\r\n\r\n\t\t\t\t\tif ( !$(_turno_id).val() )\r\n\t\t\t\t\t\tfiltrarTurno();\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfocusout: function() {\r\n\r\n\t\t\t\t\tif(tempo_focus) clearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif ( !$('input[name=\"_turno_id\"]').val() && \r\n\t\t\t\t\t\t\t $('.lista-turno').is(':empty') \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t   $('#turno-descricao').val('');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( !$('input[name=\"_turno_id\"]').val() && \r\n\t\t\t\t\t\t\t !$('.lista-turno ul li a').is(':focus') && \r\n\t\t\t\t\t\t\t  $('#turno-descricao').val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t$('#turno-descricao').val('');\r\n\t\t\t\t\t\t\tfechaListaTurno(input_group);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif ( !$('input[name=\"_turno_id\"]').val() && \r\n\t\t\t\t\t\t\t !$('.lista-turno ul li a').is(':focus') && \r\n\t\t\t\t\t\t\t !$('#turno-descricao').val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tfechaListaTurno(input_group);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t\t//Campo de filtro\r\n\t\t\t$('#turno-descricao').on({\r\n\r\n\t\t\t\tkeydown: function(e) {\r\n\r\n\t\t\t\t\t//Eventos ap?s a escolha de um item\r\n\t\t\t\t\tif ( $(this).is('[readonly]') ) {\r\n\r\n\t\t\t\t\t\t//Deletar teclando 'Backspace' ou 'Delete'\r\n\t\t\t\t\t\tif ( (e.keyCode === 8) || (e.keyCode === 46) ) {\r\n\t\t\t\t\t\t\t$('.btn-apagar-filtro-turno').click();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t//Pesquisar com 'Enter'\r\n\t\t\t\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\t\t\t\tfiltrarTurno();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfocusout: function() {\r\n\r\n\t\t\t\t\t//verificar quando o campo deve ser zerado\r\n\t\t\t\t\tif(tempo_focus)\r\n\t\t\t\t\t\tclearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif ( !$('input[name=\"_turno_id\"]').val() && \r\n\t\t\t\t\t\t\t $('.lista-turno').is(':empty') &&\r\n\t\t\t\t\t\t\t !$('.btn-filtro-turno').is(':focus') \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t$('#turno-descricao').val('');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\tiniciarFiltroTurno();\r\n\t}"]}