{"version":3,"sources":["_25200-filtro.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_25200-filtro.js","sourcesContent":["\t{ \r\n        /** Pesquisar Centro de Custo */\r\n\t\t\r\n\t\tvar filtro;\r\n\t\tvar campo_indicadores;\r\n\t\tvar btn_filtro_indicadores;\r\n\t\tvar input_group;\r\n\t\tvar itens_indicadores;\r\n\t\tvar _indicadores_id;\r\n\t\tvar tempo_focus;\r\n\t\tvar indicadores_selecionado = false;\r\n\r\n\t\t/**\r\n\t\t * Filtrar objeto.\r\n\t\t */\r\n\t\tfunction filtrarIndicadores() {\r\n\r\n\t\t\tcampo_indicadores\t\t= $('#indicadores-descricao');\t//campo\r\n\t\t\tbtn_filtro_indicadores\t= $('.btn-filtro-indicadores');\r\n\r\n\t\t\tinput_group\t\t\t= $(campo_indicadores).parent('.input-group');\t//input-group\r\n\t\t\t_indicadores_id\t\t\t= $('input[name=\"_indicadores_id\"]');\r\n\r\n\t\t\tfiltro = campo_indicadores.val();\r\n\r\n\t\t\t//esvazia campo hidden caso algum item já tenha sido escolhido antes\r\n\t\t\tif(indicadores_selecionado) \r\n\t\t\t\t$(_indicadores_id).val('');\r\n\r\n\t\t\tif( !filtro ) {\r\n\t\t\t\tfechaListaIndicadores( input_group );\r\n\t\t\t\t$(_indicadores_id).val('');\r\n\t\t\t\t//return false;\r\n\t\t\t}\r\n            \r\n            var url_action = \"/_25200/filtrar\";\r\n            var dados = {'filtro': filtro};\r\n            var type = \"POST\";\r\n            \r\n            function success(data){\r\n              abreListaIndicadores( input_group );\r\n\t\t\t\t\t\r\n\t\t\t\t\t$('.lista-indicadores')\r\n\t\t\t\t\t\t.html(data);\r\n\r\n\t\t\t\t\t//existem dados cadastrados\r\n\t\t\t\t\tif( data.indexOf('nao-cadastrado') === -1 ) {\r\n\r\n\t\t\t\t\t\titens_indicadores = $('ul.indicadores li a');\r\n                        \r\n\t\t\t\t\t\tselecItemListaIndicadores( $(itens_indicadores), campo_indicadores );\r\n\r\n\t\t\t\t\t\t$(itens_indicadores)\r\n\t\t\t\t\t\t\t.focusout(function() {\r\n\r\n\t\t\t\t\t\t\t\tif(tempo_focus) \r\n\t\t\t\t\t\t\t\t\tclearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\t\t\t\tif( !$(itens_indicadores).is(':focus') && \r\n\t\t\t\t\t\t\t\t\t\t!$(campo_indicadores).is(':focus') && \r\n\t\t\t\t\t\t\t\t\t\t!$(btn_filtro_indicadores).is(':focus') \r\n\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t$(campo_indicadores).val('');\r\n\t\t\t\t\t\t\t\t\t\tfechaListaIndicadores( input_group );\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}, 200);\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$(campo_indicadores)\r\n\t\t\t\t\t\t\t.focusout(function() {\r\n\r\n\t\t\t\t\t\t\t\tif(tempo_focus) \r\n\t\t\t\t\t\t\t\t\tclearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\t\t\t\tif( !$(itens_indicadores).is(':focus') &&\r\n\t\t\t\t\t\t\t\t\t\t!$(_indicadores_id).val() && \r\n\t\t\t\t\t\t\t\t\t\t!$(btn_filtro_indicadores).is(':focus') \r\n\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t$(campo_indicadores).val('');\r\n\t\t\t\t\t\t\t\t\t\tfechaListaIndicadores( input_group );\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}, 200);\r\n\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t$(_indicadores_id).val('');\r\n\r\n\t\t\t\t\t\t$(campo_indicadores)\r\n\t\t\t\t\t\t\t.focusout(function() {\r\n\t\t\t\t\t\t\t\tif( $('.lista-indicadores').children().children().hasClass('nao-cadastrado') ) {\r\n\t\t\t\t\t\t\t\t\t$(campo_indicadores).val('');\r\n\t\t\t\t\t\t\t\t\tfechaListaIndicadores( input_group );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}  \r\n            }\r\n            \r\n\r\n            execAjax2(type,url_action,dados,success,false,btn_filtro_indicadores,false);\r\n\t\t}\r\n\r\n\t\t//Abre resultado da filtragem\r\n\t\tfunction abreListaIndicadores(indicadores) {\r\n\t\t\t\r\n\t\t\t$(indicadores)\r\n\t\t\t\t.next('.lista-indicadores-container')\r\n\t\t\t\t.addClass('ativo');\r\n\t\t\r\n\t\t\t$(btn_filtro_indicadores)\r\n\t\t\t\t.attr('tabindex', '-1');\r\n\t\t}\r\n\r\n\t\t//Fecha resultado da filtragem\r\n\t\tfunction fechaListaIndicadores(indicadores) {\r\n\t\t\t\r\n\t\t\t$(indicadores)\r\n\t\t\t\t.next('.lista-indicadores-container')\r\n\t\t\t\t.removeClass('ativo')\r\n\t\t\t\t.children('.lista-indicadores')\r\n\t\t\t\t.empty();\r\n\t\t\r\n\t\t\t$(btn_filtro_indicadores)\r\n\t\t\t\t.removeAttr('tabindex');\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Preencher campos de acordo com o item selecionado.\r\n\t\t * \r\n\t\t * @param {object} itens\r\n\t\t * @param {object} campo\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tfunction selecItemListaIndicadores(itens, campo) {\r\n\r\n\t\t\t$(itens).click(function(e) {\r\n\t\t\t\t\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\t\r\n\t\t\t\t$(campo)\r\n\t\t\t\t\t.val( $(this).text() )\r\n\t\t\t\t\t.focus();\r\n\t\t\t\r\n\t\t\t\tselecionadoIndicadores();\r\n\t\t\t\r\n\t\t\t\t$(_indicadores_id)\r\n\t\t\t\t\t.val( $(this).nextAll('.indicadores-id').val() )\r\n\t\t\t\t\t.trigger('change');\r\n            \r\n                $( \".indicadores-descricao\" ).trigger( \"change\" );\r\n                \r\n\t\t\t\tfechaListaIndicadores( input_group );\r\n\t\t\t\tindicadores_selecionado = true;\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * Ações que devem acontecer após o item ser selecionado.\r\n\t\t */\r\n\t\tfunction selecionadoIndicadores() {\r\n\t\t\t\r\n\t\t\t$('#indicadores-descricao')\r\n\t\t\t\t.attr('readonly', true);\r\n\r\n\t\t\t$('.btn-filtro-indicadores')\r\n\t\t\t\t.hide();\r\n\r\n\t\t\t$('.btn-apagar-filtro-indicadores')\r\n\t\t\t\t.show()\r\n\t\t\t\t.click(function() {\r\n\r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.siblings('input')\r\n\t\t\t\t\t\t.removeAttr('readonly');\r\n\r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.hide()\r\n\t\t\t\t\t\t.prev('button')\r\n\t\t\t\t\t\t.show();\r\n\r\n\t\t\t\t\t$('#indicadores-descricao')\r\n\t\t\t\t\t\t.val('')\r\n\t\t\t\t\t\t.focus();\r\n\r\n\t\t\t\t\t$('input[name=\"_indicadores_id\"]')\r\n\t\t\t\t\t\t.val('');\r\n\r\n\t\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t/**\r\n\t\t * Eventos para o filtro de Indicadores.\r\n\t\t */\r\n\t\tfunction iniciarFiltroIndicadores() {\r\n\t\t\t\r\n\t\t\t//Se o item j? estiver selecionado (tela de update), efetua as devidas a??es.\r\n\t\t\tif ( $('input[name=\"_indicadores_id\"]').val() !== '' )\r\n\t\t\t\tselecionadoIndicadores();\r\n\r\n\t\t\t//Bot?o de filtrar\r\n\t\t\t$('.btn-filtro-indicadores').on({\r\n\r\n\t\t\t\tclick: function() {\r\n\r\n\t\t\t\t\tif ( !$(_indicadores_id).val() )\r\n\t\t\t\t\t\tfiltrarIndicadores();\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfocusout: function() {\r\n\r\n\t\t\t\t\tif(tempo_focus) clearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif ( !$('input[name=\"_indicadores_id\"]').val() && \r\n\t\t\t\t\t\t\t $('.lista-indicadores').is(':empty') \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t   $('#indicadores-descricao').val('');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( !$('input[name=\"_indicadores_id\"]').val() && \r\n\t\t\t\t\t\t\t !$('.lista-indicadores ul li a').is(':focus') && \r\n\t\t\t\t\t\t\t  $('#indicadores-descricao').val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t$('#indicadores-descricao').val('');\r\n\t\t\t\t\t\t\tfechaListaIndicadores(input_group);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif ( !$('input[name=\"_indicadores_id\"]').val() && \r\n\t\t\t\t\t\t\t !$('.lista-indicadores ul li a').is(':focus') && \r\n\t\t\t\t\t\t\t !$('#indicadores-descricao').val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tfechaListaIndicadores(input_group);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t\t//Campo de filtro\r\n\t\t\t$('#indicadores-descricao').on({\r\n\r\n\t\t\t\tkeydown: function(e) {\r\n\r\n\t\t\t\t\t//Eventos ap?s a escolha de um item\r\n\t\t\t\t\tif ( $(this).is('[readonly]') ) {\r\n\r\n\t\t\t\t\t\t//Deletar teclando 'Backspace' ou 'Delete'\r\n\t\t\t\t\t\tif ( (e.keyCode === 8) || (e.keyCode === 46) ) {\r\n\t\t\t\t\t\t\t$('.btn-apagar-filtro-indicadores').click();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t//Pesquisar com 'Enter'\r\n\t\t\t\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\t\t\t\tfiltrarIndicadores();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfocusout: function() {\r\n\r\n\t\t\t\t\t//verificar quando o campo deve ser zerado\r\n\t\t\t\t\tif(tempo_focus)\r\n\t\t\t\t\t\tclearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif ( !$('input[name=\"_indicadores_id\"]').val() && \r\n\t\t\t\t\t\t\t $('.lista-indicadores').is(':empty') &&\r\n\t\t\t\t\t\t\t !$('.btn-filtro-indicadores').is(':focus') \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t$('#indicadores-descricao').val('');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\tiniciarFiltroIndicadores();\r\n\t}"]}