{"version":3,"sources":["_25010.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_25010.js","sourcesContent":["/**\n * _25010 - Cadastro de Formulários\n */\n;(function(angular) {\n\n\t/**\n\t * Controller.\n\t */\n\tvar ctrl = function($ajax, $filter, $timeout) {\n\n\t\tvar vm = this;\n\n\t\tvm.tipoTela\t\t\t\t\t\t= \"incluir\";\n\t\tvm.permissao \t\t\t\t\t= {};\n\t\tvm.listaFormulario\t\t\t\t= [];\t// Lista de formulários cadastrados.\n\t\tvm.listaFormularioSelec\t\t\t= [];\t// Formulário selecionado.\n\t\tvm.listaFormularioShow\t\t\t= [];\t// Formulário a ser exibido.\n\t\tvm.tipoFormulario \t\t\t\t= [];\t// Tipos de formulários.\n\t\tvm.tipoResposta\t\t\t\t\t= [];\t// Tipos de respostas.\n\t\tvm.nivelSatisfacao\t\t\t\t= [];\t// Níveis de satisfação das alternativas.\n\t\tvm.listaUsuario \t\t\t\t= [];\t// Lista de usuários cadastrados.\n\t\tvm.listaUsuarioSelec \t\t\t= [];\t// Usuários selecionados.\n\t\tvm.listaUsuarioSelecEscolhido \t= [];\t// Usuários selecionados marcados.\n\t\tvm.listaCCusto\t \t\t\t\t= [];\t// Lista de centro de custos cadastrados.\n\t\tvm.listaCCustoSelec \t\t\t= [];\t// Centro de custos selecionados.\n\t\tvm.listaCCustoSelecEscolhido \t= [];\t// Centro de custos selecionados marcados.\n\t\tvm.todosCCustoSelecionado\t\t= false;\n\t\tvm.listaDestinatarioExcluir\t\t= [];\t// Destinatários que serão excluídos ao alterar.\n\n\t\tvm.perguntaPadrao\t\t\t\t= {\n\t\t\t\t\t\t\t\t\t\t\tID \t\t\t\t\t\t\t: 0,\n\t\t\t\t\t\t\t\t\t\t\tORDEM \t\t\t\t\t\t: 1,\n\t\t\t\t\t\t\t\t\t\t\tDESCRICAO \t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t\t\t\tTIPO_RESPOSTA \t\t\t\t: 1,\n\t\t\t\t\t\t\t\t\t\t\tINDICADOR \t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t\t\t\tTAG \t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t\t\t\tALTERNATIVA \t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t\t\t{ ID: 0, DESCRICAO: 'Sim', NOTA: '1', NIVEL_SATISFACAO: '1', JUSTIFICATIVA_OBRIGATORIA : 0 }, \n\t\t\t\t\t\t\t\t\t\t\t\t{ ID: 0, DESCRICAO: 'Não', NOTA: '0', NIVEL_SATISFACAO: '2', JUSTIFICATIVA_OBRIGATORIA : 0 }\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t\tALTERNATIVA_EXCLUIR\t\t\t: [{}]\n\t\t\t\t\t\t\t\t\t\t  };\n\n\t\tvm.pergunta\t\t\t\t\t\t= [];\n\t\tvm.perguntaExcluir\t\t\t\t= [];\n\n\t\tvm.alternativaPadrao\t\t\t= { ID: 0, DESCRICAO: 'Alternativa', NOTA: '1', NIVEL_SATISFACAO: '1', JUSTIFICATIVA_OBRIGATORIA : 0 };\n\n\t\tvm.formularioPadrao\t\t\t\t= {\n\t\t\t\t\t\t\t\t\t\t\tID \t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t\t\t\tTIPO \t\t\t\t: 1,\n\t\t\t\t\t\t\t\t\t\t\tTITULO \t\t\t\t: '',\n\t\t\t\t\t\t\t\t\t\t\tDESCRICAO \t\t\t: '',\n\t\t\t\t\t\t\t\t\t\t\tPERIODO_INI\t\t\t: moment().toDate(),\n\t\t\t\t\t\t\t\t\t\t\tPERIODO_FIM \t\t: moment().add(1, \"month\").toDate(),\n\t\t\t\t\t\t\t\t\t\t\tDESTINATARIO_TIPO\t: 'usuario'\n\t\t\t\t\t\t\t\t\t\t  };\n\n\t\tvm.formulario\t\t\t\t\t= {};\n\n\t\tvm.painel \t\t\t\t\t\t= [];\n\t\tvm.painelAlternativa \t\t\t= [];\n\t\tvm.painelTop \t\t\t\t\t= {};\n\t\tvm.painelFiltro \t\t\t\t= {\n\t\t\tDATA_INI_INPUT\t: moment().subtract(3, 'months').toDate(),\n\t\t\tDATA_FIM_INPUT\t: moment().toDate(),\n\t\t\tREPRESENTANTE \t: {CODIGO: null},\n\t\t\tUF\t\t\t\t: {UF: null}\n\t\t};\n\t\tvm.listaRepresentante \t\t\t= [];\n\n\t\tvm.peso_soma \t\t\t\t\t= 0;\n\t\tvm.satisf_soma\t\t\t\t\t= 0;\n\t\tvm.satisf_geral\t\t\t\t\t= 0;\n\t\tvm.insatisf_geral\t\t\t\t= 0;\n\t\tvm.satisf_usuario\t\t\t\t= 0;\n\t\tvm.insatisf_usuario\t\t\t\t= 0;\n\t\tvm.satisf_pergunta\t\t\t\t= 0;\n\t\tvm.insatisf_pergunta\t\t\t= 0;\n\n\t\tvm.destinatarioResposta\t\t\t= [];\n\t\tvm.filtroStatusDestinatario\t\t= false;\n\t\tvm.urlTipoForm \t\t\t\t\t= 0;\n\t\tvm.filtro \t\t\t\t\t\t= {};\n\n\t\tvm.totalNota \t\t\t\t\t= 0;\n\n\n\t\tthis.$onInit = function() {\n\n\t\t\tvm.urlTipoForm \t\t= parseInt(getURLParameter('tipoForm'));\n\n\t\t\tvm.filtro.STATUS\t= '';\n\t\t\tvm.filtro.TIPO \t\t= vm.urlTipoForm ? vm.urlTipoForm : 1;\n\t\t\tvm.filtro.DATA_INI \t= moment().subtract(3, 'month').toDate();\n\t\t\tvm.filtro.DATA_FIM \t= moment().toDate();\n\n\t\t\tvm.formulario.TIPO \t= vm.urlTipoForm ? vm.urlTipoForm : 1;\n\n\t\t\t// Carregar dados padrões do gráfico.\n\t\t\tgoogle.charts.load('current', {packages: ['corechart'], 'language': 'pt-br'}); // basta chamar 1 vez\n\t\t};\n\n\n        /**\n\t\t * Fix para vs-repeat: exibir a tabela completa.\n\t\t */\n\t\tvm.fixVsRepeat = function() {\n\n\t\t\t$timeout(function(){\n                $('.modal .scroll-table').scrollTop(0);\n            }, 200);\n\n\t\t};\n\n\n\n\n\t\t/**\n\t\t * INDEX\n\t\t */\n\n\t\t/**\n\t\t * Listar formulários.\n\t\t */\n\t\tvm.listarFormulario = function() {\n\n\t\t\tvar param = {\n\t\t\t\tSTATUS  : vm.filtro.STATUS,\n\t\t\t\tTIPO \t: vm.filtro.TIPO,\n\t\t\t\tDATA_INI: vm.filtro.DATA_INI ? moment(vm.filtro.DATA_INI).format('DD.MM.YYYY') : null,\n\t\t\t\tDATA_FIM: vm.filtro.DATA_FIM ? moment(vm.filtro.DATA_FIM).format('DD.MM.YYYY') : null\n\t\t\t};\n            \n\t\t\t$ajax\n\t\t\t\t.post('/_25010/listar',\n\t\t\t\t\tJSON.stringify(param), \n\t\t\t\t\t{contentType: 'application/json'})\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tvm.listaFormulario  = response;\n\t\t\t\t\tvm.permissao \t\t= response.PERMISSAO;\n\t\t\t\t\tformataCampoFormulario();\n\t\t\t\t})\n\t\t\t;\n\n\t\t\tfunction formataCampoFormulario() {\n\n\t            var frm = {};\n\n\t            for (var i in vm.listaFormulario.FORMULARIO) {\n\n\t                frm = vm.listaFormulario.FORMULARIO[i];\n\n\t                frm.DATAHORA_INSERT_HUMANIZE = moment(frm.DATAHORA_INSERT).format('DD/MM/YYYY');\n\t            }\n\t        }\n\n\t\t};\n    \n\t\tvm.csv = function(tipo) {\n            \n\t\t\t$ajax\n\t\t\t\t.post('/_25010/csv', {\n\t\t\t\t\tformulario_id \t: vm.painelTop.FORMULARIO_ID,\n\t\t\t\t\tdata_ini \t\t: (vm.formulario.TIPO == 3) \t? moment(vm.painelFiltro.DATA_INI_INPUT).format('YYYY-MM-DD')+' 00:00:00' : null,\n\t\t\t\t\tdata_fim \t\t: (vm.formulario.TIPO == 3) \t? moment(vm.painelFiltro.DATA_FIM_INPUT).format('YYYY-MM-DD')+' 23:59:59' : null,\n\t\t\t\t\trepresentante   : vm.painelFiltro.REPRESENTANTE ? vm.painelFiltro.REPRESENTANTE : null,\n\t\t\t\t\tuf \t\t\t\t: vm.painelFiltro.UF\t\t  \t? vm.painelFiltro.UF \t\t    : null\n\t\t\t\t})\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tif(tipo == 1){\n\t\t\t\t\t\texportToXls('export.xls', response);\n\t\t\t\t\t}else{\n\t\t\t\t\t\texportToCsv('export.csv', response);\n\t\t\t\t\t}\t\t\t\n\n\t\t\t\t})\n\t\t\t;\n\n\t\t};\n\n\n\n\t\t/**\n\t\t * Atalhos para as linhas da lista de formulários.\n\t\t */\n\t\tvm.atalhoFormulario = function($event, formulario) {\n\n\t\t\t// Exibir formulário ao pressionar 'enter'.\n\t\t\tif ( $event.keyCode == 13 )\n\t\t\t\tvm.exibirFormulario($event, formulario);\n\n\t\t\t// Selecionar formulário ao pressionar 'space'.\n\t\t\telse if ( $event.keyCode == 32 )\n\t\t\t\tvm.selecionarFormulario(formulario);\n\n\t\t};\n\n\t\t/**\n\t\t * Selecionar formulários.\n\t\t */\n\t\tvm.selecionarFormulario = function(formulario) {\n\n\t\t\t// Indica se deve selecionar a linha da tabela.\n\t\t\tif (formulario.selected == undefined || formulario.selected == false)\n\t\t\t\tformulario.selected = true;\n\t\t\telse\n\t\t\t\tformulario.selected = false;\n\n\t\t\t// Preencher model com a lista de formulários selecionados.\n\t\t\tvar indexFormulario = vm.listaFormularioSelec.indexOf(formulario);\n\n\t\t\tif (indexFormulario > -1) {\n\t\t\t\tvm.listaFormularioSelec.splice(indexFormulario, 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvm.listaFormularioSelec.push(formulario);\n\t\t\t}\n\n\t\t};\n\n\t\t/**\n\t\t * Excluir formulários selecionados.\n\t\t */\n\t\tvm.excluirFormularioSelec = function(formulario) {\n\n\t\t\taddConfirme(\n\t\t\t\t'<h4>Confirmação</h4>',\n            \t'Confirma a exclusão dos formulários selecionados?',\n            \t[obtn_sim, obtn_nao],\n            \t[\n                \t{\n                \t\tret: 1,\n                \t\tfunc: function() { \n\n                \t\t\tvar indexFormulario = -1,\n\t\t\t\t\t\t\t\tform \t\t\t= '',\n\t\t\t\t\t\t\t\tid \t\t\t\t= []\t//ID's a serem enviados para o SQL.\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\t\t//Excluir no JSON.\n\t\t\t\t\t\t\tfor(var i in formulario) {\n\n\t\t\t\t\t\t\t\tform \t\t \t= formulario[i];\n\t\t\t\t\t\t\t\tindexFormulario = vm.listaFormulario.FORMULARIO.indexOf(form);\n\n\t\t\t\t\t\t\t\tif (indexFormulario > -1) {\n\t\t\t\t\t\t\t\t\tvm.listaFormulario.FORMULARIO.splice(indexFormulario, 1);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tid.push(form.ID);\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//Excluir na base de dados.\n\t\t\t\t\t\t\tvar dados = {\n\t\t\t\t\t\t\t\tid: id\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t$ajax\n\t\t\t\t\t\t\t\t.post('/_25010/excluirFormulario', dados)\n\t\t\t\t\t\t\t\t.then(function(response) {\n\n\t\t\t\t\t\t\t\t\tshowSuccess('Excluído com sucesso.');\n\t\t\t\t\t\t\t\t\tvm.listaFormularioSelec = [];\n\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t;\n\n                \t\t}\n                \t},\n                \t{\n                \t\tret: 2,\n                \t\tfunc: function() {}\n                \t}\n            \t]\n            );\n\n\t\t};\n\n\n\t\t/**\n\t\t * Exibir formulário.\n\t\t */\n\t\tvm.exibirFormulario = function($event, formulario) {\n\n\t\t\t// Não exibir caso o checkbox seja clicado.\n\t\t\tif ( $event.target.className == 'chk-selec-form' || $event.target.className == 'chk' ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tvar destinatario \t= [],\n\t\t\t\tpergunta \t\t= []\n\t\t\t;\n\n\t\t\tvm.tipoTela \t\t\t\t\t\t= 'exibir';\n\t\t\tvm.formulario.ID \t\t\t\t\t= formulario.ID;\n\t\t\tvm.formulario.TIPO \t\t\t\t\t= parseInt(formulario.TIPO);\n\t\t\tvm.formulario.TITULO \t\t\t\t= formulario.TITULO;\n\t\t\tvm.formulario.DESCRICAO \t\t\t= formulario.DESCRICAO;\n\t\t\tvm.formulario.DATAHORA_INSERT\t\t= moment(formulario.DATAHORA_INSERT).toDate();\n\t\t\tvm.formulario.PERIODO_INI\t\t\t= moment(formulario.PERIODO_INI).toDate();\n\t\t\tvm.formulario.PERIODO_FIM\t\t\t= moment(formulario.PERIODO_FIM).toDate();\n\t\t\tvm.formulario.DESTINATARIO_TIPO\t\t= formulario.DESTINATARIO_TIPO.trim();\n\n\t\t\t// Destinatários.\n\t\t\tfor (var i in vm.listaFormulario.DESTINATARIO) {\n\n\t\t\t\tdestinatario = vm.listaFormulario.DESTINATARIO[i];\n\n\t\t\t\tif ( parseInt(destinatario.FORMULARIO_ID) == parseInt(formulario.ID) ) {\n\n\t\t\t\t\tif(vm.formulario.DESTINATARIO_TIPO == 'usuario') \n\t\t\t\t\t\tvm.listaUsuarioSelec.push(destinatario);\n\t\t\t\t\telse\n\t\t\t\t\t\tvm.listaCCustoSelec.push(destinatario);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvm.pergunta = [];\n\n\t\t\t// Perguntas.\n\t\t\tfor (var j in vm.listaFormulario.PERGUNTA) {\n\n\t\t\t\tpergunta = vm.listaFormulario.PERGUNTA[j];\n\t\t\t\tpergunta.ALTERNATIVA = [];\n\t\t\t\tpergunta.ALTERNATIVA_EXCLUIR = [];\n\n\t\t\t\tif ( parseInt(pergunta.FORMULARIO_ID) == parseInt(formulario.ID) ) {\n\n\t\t\t\t\t// Alternativas.\n\t\t\t\t\tfor (var k in vm.listaFormulario.ALTERNATIVA) {\n\n\t\t\t\t\t\talternativa = vm.listaFormulario.ALTERNATIVA[k];\n\n\t\t\t\t\t\tif ( ( parseInt(alternativa.FORMULARIO_ID) == parseInt(formulario.ID) ) \n\t\t\t\t\t\t  && ( parseInt(alternativa.FORMULARIO_PERGUNTA_ID) == parseInt(pergunta.ID) ) \n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tpergunta.ALTERNATIVA.push(alternativa);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvm.pergunta.push(pergunta);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvm.somarNota();\n\n\t\t\t$('#modal-create .modal-body').scrollTop(0);\n\t\t\t$('#modal-create').modal('show');\n\n\t\t};\n\n\t\t/**\n\t\t * Redefinir formulário.\n\t\t */\n\t\tvm.redefinirFormulario = function() {\n\n\t\t\tangular.copy(vm.formularioPadrao, vm.formulario);\n\t\t\tvm.formulario.TIPO = vm.urlTipoForm ? vm.urlTipoForm : 1;\n\n\t\t};\n\n\t\t/**\n\t\t * Limpar tela.\n\t\t */\n\t\tvm.limparTela = function() {\n\n\t\t\tvm.formulario \t\t \t\t= {};\n\t\t\tvm.listaUsuarioSelec \t\t= [];\n\t\t\tvm.listaCCustoSelec  \t\t= [];\n\t\t\tvm.pergunta \t\t \t\t= [];\n\t\t\tvm.todosCCustoSelecionado \t= false;\n\t\t\tvm.redefinirFormulario();\n\t\t\tvm.addPergunta();\n\n\t\t};\n\n\t\t/**\n\t\t * Limpar painel.\n\t\t */\n\t\tvm.limparPainel = function() {\n\n\t\t\tvm.painel = {};\n\t\t\tvm.destinatarioResposta = {};\n\n\t\t\t// Limpando gráficos.\n\t\t\t$('#grafico-qtd-respondida, #grafico-satisf-geral, #grafico-satisf-delfa, #grafico-satisf-usuario, #grafico-satisf-pergunta-*')\n\t\t\t\t.empty();\n\n\t\t};\n\n\t\t/**\n\t\t * Ver painel.\n\t\t */\n\t\tvm.verPainel = function(formulario) {\n\n\t\t\tvm.painel.DESTINATARIO \t\t\t= [];\n\t\t\tvm.painel.RESPOSTA\t\t\t\t= [];\n\t\t\tvm.painel.PERGUNTA  \t\t\t= [];\n\t\t\tvm.painel.PERGUNTA_DETALHADA\t= [];\n\t\t\tvm.painel.ALTERNATIVA  \t\t\t= [];\n\n\t\t\tvm.painelTop.FORMULARIO_ID \t\t= formulario[0].ID;\n\t\t\tvm.painelTop.FORMULARIO_TITULO\t= formulario[0].TITULO;\n\n\t\t\tif (vm.formulario.TIPO != 3)\n\t\t\t\tvm.painelClimaESatisfacao();\n\t\t};\n\n\t\tvm.painelClimaESatisfacao = function() {\n\n\t\t\t//Consulta dados para o painel na base de dados.\n\t\t\tvar dados = {\n\t\t\t\tformulario_id: vm.painelTop.FORMULARIO_ID\n\t\t\t};\n\n\t\t\t$ajax\n\t\t\t\t.post('/_25010/listarPainel', dados)\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tvar qtd \t\t\t\t= response.QTD,\n\t\t\t\t\t\tdestinatario \t\t= response.DESTINATARIO,\n\t\t\t\t\t\tsatisfacao_geral\t= response.SATISFACAO_GERAL,\n\t\t\t\t\t\tsatisfacao_pergunta\t= response.SATISFACAO_PERGUNTA,\n\t\t\t\t\t\tpergunta \t\t\t= response.PERGUNTA,\n\t\t\t\t\t\talternativa \t\t= response.ALTERNATIVA\n\t\t\t\t\t;\n\n\t\t\t\t\t// Quantidades.\n\t\t\t\t\tvm.painel.QTD_RESPOSTA_ESPERADA\t= (qtd[0].QTD_RESPOSTA_ESPERADA_USUARIO > 0) ? qtd[0].QTD_RESPOSTA_ESPERADA_USUARIO : qtd[0].QTD_RESPOSTA_ESPERADA_COLAB;\n\t\t\t\t\tvm.painel.QTD_RESPONDIDA \t\t= (qtd[0].QTD_RESPOSTA_ESPERADA_USUARIO > 0) ? qtd[0].QTD_RESPONDIDA_USUARIO \t\t: qtd[0].QTD_RESPONDIDA_COLAB;\n\n\n\t\t\t\t \t// Perguntas.\n\t\t\t\t \tfor (var i in pergunta) {\n\n\t\t\t\t \t\tvm.painel.PERGUNTA.push({ \n\n\t\t\t\t\t \t\tFORMULARIO_PERGUNTA_ID\t: pergunta[i].FORMULARIO_PERGUNTA_ID,\n\t\t\t\t\t \t\tPERGUNTA_ORDEM\t\t\t: pergunta[i].PERGUNTA_ORDEM,\n\t\t\t\t\t \t\tPERGUNTA_DESCRICAO\t\t: pergunta[i].PERGUNTA_DESCRICAO\n\n\t\t\t\t\t \t});\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Alternativas.\n\t\t\t\t \tfor (var i in alternativa) {\n\n\t\t\t\t\t \tvm.painel.ALTERNATIVA.push({ \n\n\t\t\t\t\t \t\tFORMULARIO_PERGUNTA_ID\t\t: alternativa[i].FORMULARIO_PERGUNTA_ID,\n\t\t\t\t\t \t\tALTERNATIVA_ID \t\t\t\t: alternativa[i].ALTERNATIVA_ID,\n\t\t\t\t\t \t\tALTERNATIVA_DESCRICAO\t\t: alternativa[i].ALTERNATIVA_DESCRICAO,\n\t\t\t\t\t \t\tALTERNATIVA_QTD_ESCOLHIDA\t: alternativa[i].ALTERNATIVA_QTD_ESCOLHIDA\n\n\t\t\t\t\t \t});\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Usuários que responderam.\n\t\t\t\t\tfor (var i in destinatario) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tvm.painel.DESTINATARIO.push({ \n\n\t\t\t\t\t \t\tFORMULARIO_ID\t: destinatario[i].FORMULARIO_ID,\n\t\t\t\t\t \t\tID \t\t\t\t: destinatario[i].DESTINATARIO_ID,\n\t\t\t\t\t \t\tDESCRICAO \t\t: destinatario[i].DESTINATARIO_DESCRICAO,\n\t\t\t\t\t \t\tPESO \t\t\t: destinatario[i].DESTINATARIO_PESO, \n\t\t\t\t\t \t\tSTATUS_RESPOSTA : destinatario[i].DESTINATARIO_STATUS_RESPOSTA, \n\t\t\t\t\t \t\tCCUSTO \t\t\t: destinatario[i].DESTINATARIO_CCUSTO\n\n\t\t\t\t\t \t});\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvm.graficoQtdRespondida().carregar();\n\t\t\t\t\tvm.calcularSatisfacaoGeral(satisfacao_geral);\n\n\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\tvm.calcularSatisfacaoPorPergunta(satisfacao_pergunta);\n\t\t\t\t\t}, 2000);\n\n\t\t\t\t})\n\t\t\t;\n\t\t};\n\n\t\tvm.painelCliente = function() {\n\n\t\t\tvm.limparPainel();\n\n\t\t\tvm.painel.DESTINATARIO \t\t\t= [];\n\t\t\tvm.painel.RESPOSTA\t\t\t\t= [];\n\t\t\tvm.painel.PERGUNTA  \t\t\t= [];\n\t\t\tvm.painel.PERGUNTA_DETALHADA\t= [];\n\t\t\tvm.painel.ALTERNATIVA  \t\t\t= [];\n\n\t\t\t//Consulta dados para o painel na base de dados.\n\t\t\tvar dados = {\n\t\t\t\tformulario_id \t: vm.painelTop.FORMULARIO_ID,\n\t\t\t\tdata_ini \t\t: moment(vm.painelFiltro.DATA_INI_INPUT).format('YYYY-MM-DD')+' 00:00:00',\n\t\t\t\tdata_fim \t\t: moment(vm.painelFiltro.DATA_FIM_INPUT).format('YYYY-MM-DD')+' 23:59:59',\n\t\t\t\trepresentante   : vm.painelFiltro.REPRESENTANTE ? vm.painelFiltro.REPRESENTANTE : null,\n\t\t\t\tuf \t\t\t\t: vm.painelFiltro.UF \t\t\t? vm.painelFiltro.UF \t\t\t: null\n\t\t\t};\n\n\t\t\t$ajax\n\t\t\t\t.post('/_25010/listarPainelCliente', dados)\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tcarregarResumo(response.RESUMO[0]);\n\t\t\t\t\tcarregarDestinatario(response.DESTINATARIO);\n\t\t\t\t\tcarregarPergunta(response.PERGUNTA);\n\t\t\t\t\tcarregarAlternativa(response.ALTERNATIVA);\n\n\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\tvm.calcularSatisfacaoPorPergunta(response.SATISFACAO_PERGUNTA);\n\t\t\t\t\t}, 2000);\n\t\t\t\t});\n\n\n\t\t\tfunction carregarResumo(resumo) {\n\n\t\t\t\tvar metaSatisf  = 10,\n\t\t\t\t\tpercSatisf \t= 0;\n\n\t\t\t\tvm.painel.QTD_PESQUISA \t\t= parseFloat(resumo.QTD_PESQUISA);\n\t\t\t\tvm.painel.MEDIA_SATISFACAO  = parseFloat(resumo.MEDIA_SATISFACAO);\n\t\t\t\tvm.painel.MEDIA_DELFA \t\t= parseFloat(resumo.MEDIA_DELFA);\n\n\t\t\t\t// Calcular satisfação com a Delfa.\n\t\t\t\tpercSatisf \t\t\t= (vm.painel.MEDIA_DELFA * 100) / metaSatisf;\n\t\t\t\tvm.satisf_delfa\t \t= percSatisf;\n\t\t\t\tvm.insatisf_delfa \t= 100 - percSatisf;\n\n\t\t\t\tvm.graficoSatisfacaoDelfa().carregar();\n\n\t\t\t\t// Calcular satisfação geral.\n\t\t\t\tpercSatisf \t\t\t= 0;\n\t\t\t\tpercSatisf \t\t\t= (vm.painel.MEDIA_SATISFACAO * 100) / metaSatisf;\n\t\t\t\tvm.satisf_geral\t \t= percSatisf;\n\t\t\t\tvm.insatisf_geral \t= 100 - percSatisf;\n\n\t\t\t\tvm.graficoSatisfacaoGeral().carregar();\n\t\t\t}\n\n\t\t\tfunction carregarDestinatario(destinatario) {\n\n\t\t\t\t// Usuários que responderam.\n\t\t\t\tfor (var i in destinatario) {\n\t\t\t\t\t\n\t\t\t\t\tvm.painel.DESTINATARIO.push({ \n\n\t\t\t\t \t\tFORMULARIO_ID\t: destinatario[i].FORMULARIO_ID,\n\t\t\t\t \t\tID \t\t\t\t: destinatario[i].CLIENTE_ID,\n\t\t\t\t \t\tDESCRICAO \t\t: destinatario[i].CLIENTE_RAZAOSOCIAL,\n\t\t\t\t \t\tUF \t\t\t\t: destinatario[i].CLIENTE_UF,\n\t\t\t\t \t\tSATISFACAO  \t: destinatario[i].SATISFACAO,\n\t\t\t\t \t\tNOTA_DELFA  \t: destinatario[i].NOTA_DELFA,\n\t\t\t\t \t\tOBSERVACAO_DELFA: destinatario[i].OBSERVACAO_DELFA\n\n\t\t\t\t \t});\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction carregarPergunta(pergunta) {\n\n\t\t\t \tfor (var i in pergunta) {\n\n\t\t\t \t\tvm.painel.PERGUNTA.push({ \n\n\t\t\t\t \t\tFORMULARIO_PERGUNTA_ID\t: pergunta[i].FORMULARIO_PERGUNTA_ID,\n\t\t\t\t \t\tPERGUNTA_ORDEM\t\t\t: pergunta[i].PERGUNTA_ORDEM,\n\t\t\t\t \t\tPERGUNTA_DESCRICAO\t\t: pergunta[i].PERGUNTA_DESCRICAO\n\n\t\t\t\t \t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction carregarAlternativa(alternativa) {\n\n\t\t\t\tfor (var i in alternativa) {\n\n\t\t\t\t \tvm.painel.ALTERNATIVA.push({ \n\n\t\t\t\t \t\tFORMULARIO_PERGUNTA_ID\t\t: alternativa[i].FORMULARIO_PERGUNTA_ID,\n\t\t\t\t \t\tALTERNATIVA_ID \t\t\t\t: alternativa[i].ALTERNATIVA_ID,\n\t\t\t\t \t\tALTERNATIVA_DESCRICAO\t\t: alternativa[i].ALTERNATIVA_DESCRICAO,\n\t\t\t\t \t\tALTERNATIVA_QTD_ESCOLHIDA\t: alternativa[i].ALTERNATIVA_QTD_ESCOLHIDA\n\n\t\t\t\t \t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//// Início filtro representante.\n\n\t\tvm.eventoAlterarRepresentante = function($event) {\n\n\t    \t// enter\n\t    \tif ($event.keyCode == 13)\n\t    \t\tvm.alterarRepresentante();\n\n\t    \t// backspace ou delete\n\t    \telse if ($event.keyCode == 8 || $event.keyCode == 46)\n\t    \t\tvm.limparRepresentanteSelecionado();\n\t    };\n\n\t\tvm.alterarRepresentante = function() {\n\n\t        vm.consultarRepresentante();\n\t        $('#modal-consultar-representante').modal('show');\n\t    };\n\n\t    vm.consultarRepresentante = function() {\n\n\t        $ajax\n\t            .post('/_12060/consultarRepresentante')\n\t            .then(function(response){\n\n\t                vm.listaRepresentante = response;\n\n\t                // Fix para vs-repeat.\n\t                $('.table-representante')\n\t                    .trigger('resize')\n\t                    .scrollTop(0);\n\n\t                // Foco no input de filtrar.\n\t                $('.input-filtrar-representante').select();\n\n\t            });\n\t    };\n\n\t    vm.selecionarRepresentante = function(representante) {\n\n            vm.painelFiltro.REPRESENTANTE = representante;\n            $('.js-input-filtrar-representante').focus();\n\n\t        vm.fecharModalConsultarRepresentante();\n\t    };\n\n\t    vm.limparRepresentanteSelecionado = function() {\n\n\t        vm.painelFiltro.REPRESENTANTE = {CODIGO: null};\n\t    };\n\n\t    /**\n\t     * Fix para vs-repeat: exibir a tabela completa.\n\t     */\n\t    vm.fixVsRepeatConsultarRepresentante = function() {\n\n\t        $timeout(function(){\n\t            $('#modal-consultar-representante .table-representante').scrollTop(0);\n\t        }, 200);\n\t    };\n\n\t    vm.fecharModalConsultarRepresentante = function() {\n\t        \n\t        $('#modal-consultar-representante')\n\t            .modal('hide')\n\t            .find('.modal-body')\n\t            .animate({ scrollTop: 0 }, 'fast');\n\n\t        vm.filtrarRepresentante = '';\n\t    };\n\n\t    //// Fim filtro representante\n\n\t    //// Início filtro UF\n\n\t    vm.eventoAlterarUF = function($event) {\n\n\t    \t// enter\n\t    \tif ($event.keyCode == 13)\n\t    \t\tvm.alterarUF();\n\n\t    \t// backspace ou delete\n\t    \telse if ($event.keyCode == 8 || $event.keyCode == 46)\n\t    \t\tvm.limparUFSelecionado();\n\t    };\n\n\t\tvm.alterarUF = function() {\n\n\t        vm.consultarUF();\n\t        $('#modal-consultar-uf').modal('show');\n\t    };\n\n\t    vm.consultarUF = function() {\n\n\t        $ajax\n\t            .post('/_25010/consultarUF')\n\t            .then(function(response){\n\n\t                vm.listaUF = response;\n\n\t                // Fix para vs-repeat.\n\t                $('.table-uf')\n\t                    .trigger('resize')\n\t                    .scrollTop(0);\n\n\t                // Foco no input de filtrar.\n\t                $('.input-filtrar-uf').select();\n\n\t            });\n\t    };\n\n\t    vm.selecionarUF = function(uf) {\n\n            vm.painelFiltro.UF = uf;\n            $('.js-input-filtrar-uf').focus();\n\n\t        vm.fecharModalConsultarUF();\n\t    };\n\n\t    vm.limparUFSelecionado = function() {\n\n\t        vm.painelFiltro.UF = {UF: null};\n\t    };\n\n\t    /**\n\t     * Fix para vs-repeat: exibir a tabela completa.\n\t     */\n\t    vm.fixVsRepeatConsultarUF = function() {\n\n\t        $timeout(function(){\n\t            $('#modal-consultar-uf .table-uf').scrollTop(0);\n\t        }, 200);\n\t    };\n\n\t    vm.fecharModalConsultarUF = function() {\n\t        \n\t        $('#modal-consultar-uf')\n\t            .modal('hide')\n\t            .find('.modal-body')\n\t            .animate({ scrollTop: 0 }, 'fast');\n\n\t        vm.filtrarUF = '';\n\t    };\n\n\t    //// Fim filtro UF\n\n\t\t/**\n\t\t * Gráfico de quantidades respondidas no painel.\n\t\t */\n\t\tvm.graficoQtdRespondida = function() {\n\t\t\t\n\t\t\tfunction dados() {\n\t\t\t\t\n\t\t\t\tvar data = new google.visualization.arrayToDataTable([\n\t\t\t\t\t['Item', 'Qtd'],\n\t\t\t\t\t['Respondido', parseInt(vm.painel.QTD_RESPONDIDA)],\n\t\t\t\t\t['Não respondido', parseInt(vm.painel.QTD_RESPOSTA_ESPERADA) - parseInt(vm.painel.QTD_RESPONDIDA)]\n\t\t\t\t]);\n\n\t\t\t\tvar options = {\n\t\t        \ttitle: 'Respondido',\n\t\t        \theight: 300\n\t\t        };\n\n\t\t        var chart = new google.visualization.PieChart(document.getElementById('grafico-qtd-respondida'));\n\n        \t\tchart.draw(data, options);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfunction carregar() {\n\n\t\t\t\t//google.charts.load('current', {packages: ['corechart', 'bar'], 'language': 'pt-br'});\t// basta chamar 1 vez\n\t\t\t\tgoogle.charts.setOnLoadCallback(dados);\n\n\t\t\t}\n\t\t\t\n\t\t\treturn {\n\t\t\t\tcarregar: carregar\n\t\t\t};\n\t\t\t\n\t\t};\n\n\t\t/**\n\t\t * Gráfico de satisfação geral no painel.\n\t\t */\n\t\tvm.graficoSatisfacaoGeral = function() {\n\t\t\t\n\t\t\tfunction dados() {\n\t\t\t\t\n\t\t\t\tvar data = new google.visualization.arrayToDataTable([\n\t\t\t\t\t['Item', 'Qtd'],\n\t\t\t\t\t['Satisfação', parseFloat(vm.satisf_geral)],\n\t\t\t\t\t['Insatisfação', parseFloat(vm.insatisf_geral)]\n\t\t\t\t]);\n\n\t\t\t\tvar options = {\n\t\t        \ttitle: 'Satisfação',\n\t\t        \theight: 300\n\t\t        };\n\n\t\t        var chart = new google.visualization.PieChart(document.getElementById('grafico-satisf-geral'));\n\n        \t\tchart.draw(data, options);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfunction carregar() {\n\n\t\t\t\t//google.charts.load('current', {packages: ['corechart'], 'language': 'pt-br'}); // basta chamar 1 vez\n\t\t\t\tgoogle.charts.setOnLoadCallback(dados);\n\n\t\t\t}\n\t\t\t\n\t\t\treturn {\n\t\t\t\tcarregar: carregar\n\t\t\t};\n\t\t\t\n\t\t};\n\n\t\t/**\n\t\t * Gráfico de satisfação com a Delfa no painel.\n\t\t */\n\t\tvm.graficoSatisfacaoDelfa = function() {\n\t\t\t\n\t\t\tfunction dados() {\n\t\t\t\t\n\t\t\t\tvar data = new google.visualization.arrayToDataTable([\n\t\t\t\t\t['Item', 'Qtd'],\n\t\t\t\t\t['Satisfação', parseFloat(vm.satisf_delfa)],\n\t\t\t\t\t['Insatisfação', parseFloat(vm.insatisf_delfa)]\n\t\t\t\t]);\n\n\t\t\t\tvar options = {\n\t\t        \ttitle: 'Satisfação com a Delfa',\n\t\t        \theight: 300\n\t\t        };\n\n\t\t        var chart = new google.visualization.PieChart(document.getElementById('grafico-satisf-delfa'));\n\n        \t\tchart.draw(data, options);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfunction carregar() {\n\n\t\t\t\t//google.charts.load('current', {packages: ['corechart'], 'language': 'pt-br'}); // basta chamar 1 vez\n\t\t\t\tgoogle.charts.setOnLoadCallback(dados);\n\n\t\t\t}\n\t\t\t\n\t\t\treturn {\n\t\t\t\tcarregar: carregar\n\t\t\t};\n\t\t\t\n\t\t};\n\n\t\t/**\n\t\t * Gráfico de satisfação por usuário no painel.\n\t\t */\n\t\tvm.graficoSatisfacaoPorUsuario = function() {\n\t\t\t\n\t\t\tfunction dados(elemento) {\n\t\t\t\t\n\t\t\t\tvar data = new google.visualization.arrayToDataTable([\n\t\t\t\t\t['Item', 'Qtd'],\n\t\t\t\t\t['Satisfação', parseFloat(vm.satisf_usuario)],\n\t\t\t\t\t['Insatisfação', parseFloat(vm.insatisf_usuario)]\n\t\t\t\t]);\n\n\t\t\t\tvar options = {\n\t\t        \tlegend: { position: 'bottom' },\n\t\t        \tchartArea: { top: 10, width: '100%', height: '75%' }\n\t\t        };\n\n\t\t        var chart = new google.visualization.PieChart(elemento);\n\n        \t\tchart.draw(data, options);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfunction carregar(elemento) {\n\n\t\t\t\t//google.charts.load('current', {packages: ['corechart'], 'language': 'pt-br'}); // basta chamar 1 vez\n\t\t\t\tgoogle.charts.setOnLoadCallback(function() { dados(elemento); });\n\n\t\t\t}\n\t\t\t\n\t\t\treturn {\n\t\t\t\tcarregar: carregar\n\t\t\t};\n\t\t\t\n\t\t};\n\n\t\t/**\n\t\t * Gráfico de satisfação por pergunta no painel.\n\t\t */\n\t\tvm.graficoSatisfacaoPorPergunta = function() {\n\t\t\t\n\t\t\tfunction dados(elemento) {\n\t\t\t\t\n\t\t\t\tvar data = new google.visualization.arrayToDataTable([\n\t\t\t\t\t['Item', 'Qtd'],\n\t\t\t\t\t['Satisfação', parseFloat(vm.satisf_pergunta)],\n\t\t\t\t\t['Insatisfação', parseFloat(vm.insatisf_pergunta)]\n\t\t\t\t]);\n\n\t\t\t\tvar options = {\n\t\t        \ttitle: 'Satisfação por pergunta',\n\t\t        \theight: 220\n\t\t        };\n\n\t\t        var chart = new google.visualization.PieChart(elemento);\n\n        \t\tchart.draw(data, options);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfunction carregar(elemento) {\n\n\t\t\t\t//google.charts.load('current', {packages: ['corechart'], 'language': 'pt-br'}); // basta chamar 1 vez\n\t\t\t\tgoogle.charts.setOnLoadCallback(function() { dados(elemento); });\n\n\t\t\t}\n\t\t\t\n\t\t\treturn {\n\t\t\t\tcarregar: carregar\n\t\t\t};\n\t\t\t\n\t\t};\n\n\t\t/**\n\t\t * Gráfico de satisfação por alternativa no painel.\n\t\t */\n\t\tvm.graficoSatisfacaoPorAlternativa = function() {\n\t\t\t\n\t\t\tfunction dados(elemento) {\n\t\t\t\t\n\t\t\t\tvar tam \t= vm.painelAlternativa.length,\n\t\t\t\t\tdados \t= ['Alternativa', 'Qtd']\n\t\t\t\t;\n\n\t\t\t\tvar dataTable = new google.visualization.DataTable();\n\n\t\t\t\tdataTable.addColumn('string', 'Alternativa');\n\t\t\t\tdataTable.addColumn('number', 'Qtd.');\n\n\t\t\t\tfor (var i in vm.painelAlternativa) {\n\t\t\t\t\tdataTable.addRow([vm.painelAlternativa[i].DESCRICAO, parseFloat(vm.painelAlternativa[i].QTD_ESCOLHIDA)]);\n\t\t\t\t}\t\t\t\t\n\n\t\t\t\tvar options = {\n\t\t        \ttitle: 'Qtd. respostas por alternativa',\n\t\t        \tchartArea: {left: 200}\n\t\t        };\n\n\t\t        var chart = new google.visualization.BarChart(elemento);\n\n        \t\tchart.draw(dataTable, options);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfunction carregar(elemento) {\n\n\t\t\t\t//google.charts.load('current', {packages: ['corechart', 'bar'], 'language': 'pt-br'});\t// basta chamar 1 vez\n\t\t\t\tgoogle.charts.setOnLoadCallback(function() { dados(elemento); });\n\n\t\t\t}\n\t\t\t\n\t\t\treturn {\n\t\t\t\tcarregar: carregar\n\t\t\t};\n\n\t\t};\n\n\t\t/**\n\t\t * Calcular satisfação por alternativa.\n\t\t */\n\t\tvm.calcularSatisfacaoPorAlternativa = function(pergunta) {\n\n\t\t\tvar alternativa = {};\n\t\t\tvm.painelAlternativa = [];\n\n\t\t\tfor (var i in vm.painel.ALTERNATIVA) {\n\n\t\t\t\talternativa = vm.painel.ALTERNATIVA[i];\n\n\t\t\t\tif (alternativa.FORMULARIO_PERGUNTA_ID == pergunta.FORMULARIO_PERGUNTA_ID) {\n\n\t\t\t\t\tvm.painelAlternativa.push({\n\n\t\t\t\t\t\tID \t\t\t\t: alternativa.ALTERNATIVA_ID,\n\t\t\t\t\t\tDESCRICAO\t\t: alternativa.ALTERNATIVA_DESCRICAO,\n\t\t\t\t\t\tQTD_ESCOLHIDA\t: alternativa.ALTERNATIVA_QTD_ESCOLHIDA\n\n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvm.graficoSatisfacaoPorAlternativa().carregar(document.getElementById('grafico-satisf-alternativa-'+pergunta.FORMULARIO_PERGUNTA_ID));\n\n\t\t};\n\n\t\t/**\n\t\t * Calcular satisfação por usuário.\n\t\t */\n\t\tvm.calcularSatisfacaoPorUsuario = function(resposta) {\n\t\t\t\n\t\t\tvar rspt  \t\t\t\t= {},\n\t\t\t\tsoma_nota\t\t\t= 0,\n\t\t\t\t// possui_nivel_satisf = false,\n\t\t\t\tnao_se_aplica\t\t= false,\n\t\t\t\tconta_nao_se_aplica = 0,\n\t\t\t\tconta_satisf\t\t= 0,\n\t\t\t\tconta_insatisf\t\t= 0,\n\t\t\t\tsatisf_usuario\t\t= 0,\n\t\t\t\ttotal_resp \t\t\t= 0,\n\t\t\t\tqtd_perg\t\t\t= 0,\n\t\t\t\tmeta_satisf\t\t\t= 0,\n\t\t\t\tnota_maior\t\t\t= 0\n\t\t\t;\n\n\t\t\tvm.satisf_usuario\t= 0;\n\t\t\tvm.insatisf_usuario\t= 0;\n\n\t\t\t// Respostas.\n\t\t\tfor (var i in resposta) {\n\n\t\t\t\trspt = resposta[i];\n\n\t\t\t\t// Quantidade respostas.\n\t\t\t\ttotal_resp++;\n\n\t\t\t\t// Se a alternativa possui nível de satisfação.\n\t\t\t\tif (rspt.NIVEL_SATISFACAO > 0) {\n\n\t\t\t\t\t//possui_nivel_satisf = true;\n\t\t\t\t\tnao_se_aplica = false;\n\n\t\t\t\t\tif (rspt.NIVEL_SATISFACAO == '1')\n\t\t\t\t\t\tconta_satisf++;\n\t\t\t\t\telse if (rspt.NIVEL_SATISFACAO == '2')\n\t\t\t\t\t\tconta_insatisf++;\n\t\t\t\t\telse if (rspt.NIVEL_SATISFACAO == '3') {\n\t\t\t\t\t\tconta_nao_se_aplica++;\n\t\t\t\t\t\t//possui_nivel_satisf = false;\n\t\t\t\t\t\tnao_se_aplica = true;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Se a alternativa possui nota.\n\t\t\t\tif (rspt.ALTERNATIVA_NOTA != null && !nao_se_aplica) {\n\n\t\t\t\t\tqtd_perg++;\t\t// Quantidade de perguntas com nota.\n\t\t\t\t\tnota_maior = rspt.ALTERNATIVA_NOTA_MAIOR;\n\n\t\t\t\t\t// Soma satisfação.\n\t\t\t\t\t// Obs.: a verificação da nota serve para as perguntas subjetivas.\n\t\t\t\t\tsoma_nota += parseFloat(rspt.ALTERNATIVA_NOTA);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif (total_resp > 0) {\n\n\t\t\t\t// Cálculo por nível de satisfação.\n\t\t\t\t//if ( possui_nivel_satisf ) {\t// Se a pergunta (alternativas) possui nível de satisfação.\n\n\t\t\t\t\t// Percentual satisfação.\n\t\t\t\t\tmeta_satisf\t\t\t= qtd_perg * 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Meta de satisfação. Definida pela qtd de pergunta multiplicado pelo valor satisfatório.\n\t\t\t\t\tsatisf_usuario\t\t= (meta_satisf > 0) ? ((conta_satisf * 100) / meta_satisf) : 0;\t\t// % de satisfação do usuário.\n\n\t\t\t\t//}\n\t\t\t\t// Cálculo por nota.\n\t\t\t\t/*else {\n\n\t\t\t\t\t// Percentual satisfação.\n\t\t\t\t\tmeta_satisf\t\t\t= qtd_perg * nota_maior;\t\t\t\t\t\t\t\t\t\t// Meta de satisfação. Ex.: 5 perguntas com respostas de 1 à 5 a meta é 25.\n\t\t\t\t\tsatisf_usuario\t\t= (meta_satisf > 0) ? ((soma_nota * 100) / meta_satisf) : 0;\t// % de satisfação do usuário.\n\n\t\t\t\t}*/\n\n\t\t\t\t// Satisfação do usuário.\n\t\t\t\tvm.satisf_usuario\t= satisf_usuario;\n\t\t\t\tvm.insatisf_usuario\t= 100 - satisf_usuario;\n\n\t\t\t}\n\n\t\t\t// Se todas as respostas forem 'Não se aplica', o gráfico some.\n\t\t\tif (total_resp === conta_nao_se_aplica)\n\t\t\t\tdocument.getElementById('grafico-satisf-usuario').innerHTML = '';\n\t\t\telse\n\t\t\t\tvm.graficoSatisfacaoPorUsuario().carregar(document.getElementById('grafico-satisf-usuario'));\n\n\t\t};\n\n\t\tvm.calcularSatisfacaoPorCliente = function(cliente) {\n\n\t\t\tvar metaSatisf  = 10,\n\t\t\t\tpercSatisf \t= 0;\n\n\t\t\tvm.painel.CLIENTE_SELECIONADO = cliente;\n\n\t\t\t// Calcular percentual de satisfação do cliente.\n\t\t\tpercSatisf \t\t\t= (cliente.SATISFACAO * 100) / metaSatisf;\n\t\t\tvm.satisf_usuario\t= percSatisf;\n\t\t\tvm.insatisf_usuario\t= 100 - percSatisf;\n\t\t\t\n\t\t\tvm.graficoSatisfacaoPorUsuario().carregar(document.getElementById('grafico-satisf-usuario'));\n\t\t};\n\n\t\t/**\n\t\t * Selecionar destinatário.\n\t\t */\n\t\tvm.selecionarDestinatarioPainel = function(destinatario) {\n\n\t\t\tfor(var i in vm.painel.DESTINATARIO)\n\t\t\t\tvm.painel.DESTINATARIO[i].selected = false;\n\n\t\t\t// Indica se deve selecionar a linha da tabela.\n\t\t\tif (destinatario.selected == undefined || destinatario.selected == false)\n\t\t\t\tdestinatario.selected = true;\n\t\t\telse\n\t\t\t\tdestinatario.selected = false;\n\n\t\t};\n\n\t\t/**\n\t\t * Ver as respostas do destinatário.\n\t\t */\n\t\tvm.verDestinatarioResposta = function(destinatario) {\n\n\t\t\tvm.destinatarioResposta = [];\n\t\t\tvm.selecionarDestinatarioPainel(destinatario);\n\n\t\t\tvar dados \t= {\n\t\t            formulario_id \t: destinatario.FORMULARIO_ID,\n\t\t            destinatario_id\t: destinatario.ID\n\t\t        },\n\t        \turl \t= '/_25010/painelResposta'\n\t        ;\n\t    \n\t        $ajax\n\t        \t.post(url, JSON.stringify(dados), {contentType: 'application/json'})\n\t            .then(function(response) {  \n\n\t            \tvar resposta = {};\n\n\t                for (var i in response) {\n\n\t                \tresposta = response[i];\n\n\t                \tvm.destinatarioResposta.push({\n\n\t\t\t\t\t\t\tFORMULARIO_PERGUNTA_ID\t\t: resposta.FORMULARIO_PERGUNTA_ID,\t\n\t\t\t\t\t\t\tFORMULARIO_PERGUNTA_ORDEM\t: resposta.FORMULARIO_PERGUNTA_ORDEM,\t\n\t\t\t\t\t\t\tPERGUNTA_DESCRICAO\t\t\t: resposta.PERGUNTA_DESCRICAO,\t\n\t\t\t\t\t\t\tALTERNATIVA_DESCRICAO\t\t: resposta.ALTERNATIVA_DESCRICAO,\n\t\t\t\t\t\t\tALTERNATIVA_NOTA\t\t\t: resposta.ALTERNATIVA_NOTA,\n\t\t\t\t\t\t\tALTERNATIVA_NOTA_MAIOR\t\t: resposta.ALTERNATIVA_NOTA_MAIOR,\n\t\t\t\t\t\t\tNIVEL_SATISFACAO\t\t\t: resposta.NIVEL_SATISFACAO,\n\t\t\t\t\t\t\tNIVEL_SATISFACAO_DESCRICAO\t: resposta.NIVEL_SATISFACAO_DESCRICAO,\n\t\t\t\t\t\t\tJUSTIFICATIVA\t\t\t\t: resposta.JUSTIFICATIVA\n\n\t\t\t\t\t\t});\n\t                }\n\n\t                if (vm.formulario.TIPO != 3)\n\t                \tvm.calcularSatisfacaoPorUsuario(vm.destinatarioResposta);\n\t                else\n\t                \tvm.calcularSatisfacaoPorCliente(destinatario);\n\t            })\n\t        ;\n\n\t\t};\n\n\t\t/**\n\t\t * Calcular satisfação geral.\n\t\t */\n\t\tvm.calcularSatisfacaoGeral = function(satisfacao) {\n\t\t\t\n\t\t\t// Satisfação geral.\n\t\t\tvm.satisf_geral\t \t= satisfacao[0].PERC_SATISF;\n\t\t\tvm.insatisf_geral \t= 100 - satisfacao[0].PERC_SATISF;\n\n\t\t\tvm.graficoSatisfacaoGeral().carregar();\n\n\t\t};\n\n\t\t/**\n\t\t * Calcular satisfação por pergunta.\n\t\t */\n\t\tvm.calcularSatisfacaoPorPergunta = function(satisf_pergunta) {\n\n\t\t\tvar pergunta = {};\n\n\t\t\tfor (var i in satisf_pergunta) {\n\n\t\t\t\tpergunta = satisf_pergunta[i];\n\n\t\t\t\t// Satisfação da pergunta.\n\t\t\t\tvm.satisf_pergunta\t = parseFloat(pergunta.PERC_SATISF);\n\t\t\t\tvm.insatisf_pergunta = 100 - parseFloat(pergunta.PERC_SATISF);\n\n\t\t\t\tvm.graficoSatisfacaoPorPergunta().carregar(document.getElementById('grafico-satisf-pergunta-'+pergunta.FORMULARIO_PERGUNTA_ID));\n\t\t\t\tvm.calcularSatisfacaoPorAlternativa(pergunta);\n\t\t\t}\n\t\t};\n\n\n\t\t// vm.filtrarStatusDestinatario = function() {\n\n\t\t// \tif (vm.filtroStatusDestinatario) {\n\t\t// \t\tvm.painel.DESTINATARIO = $filter('filter')(vm.painel.DESTINATARIO, STATUS_RESPOSTA = '1');\n\t\t// \t\tvm.filtroStatusDestinatario = false;\n\t\t// \t}\n\t\t// \telse {\n\t\t// \t\tvm.painel.DESTINATARIO = $filter('filter')(vm.painel.DESTINATARIO, STATUS_RESPOSTA = '0');\n\t\t// \t\tvm.filtroStatusDestinatario = true;\n\t\t// \t}\n\n\t\t// };\n\n\n\t\t/**\n\t\t * Ações ao fechar modal.\n\t\t */\n\t\t$('#modal-create')\n\t\t\t.on('hidden.bs.modal', function() {\n\t\t\t\t\n\t\t\t\t// Foco no input de pesquisa.\n\t\t\t\t$('.filtro-obj').focus();\n\n\t\t\t})\n\t\t;\n\n\n\n\t\t/**\n\t\t * CREATE\n\t\t */\n\n        /**\n         * Listar tipos de formulário.\n         */\n\t\tvm.listarTipoFormulario = function() {\n\n\t\t\t$ajax\n\t\t\t\t.post('/_25010/listarTipoFormulario')\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tvm.tipoFormulario = response;\n\n\t\t\t\t})\n\t\t\t;\n\n\t\t};\n\n\t\t/**\n\t\t * Verificação ao trocar o tipo de destinatário.\n\t\t */\n\t\tvm.alterarDestinatarioTipo = function() {\n\t\t\t\n\t\t\tif ( (vm.formulario.DESTINATARIO_TIPO == \"usuario\") && (vm.listaCCustoSelec.length > 0) ) {\n\n\t\t\t\taddConfirme(\n\t\t\t\t\t'<h4>Confirmação</h4>',\n                \t'Você só pode escolher um tipo de destinatário para esta pesquisa.<br />Deseja excluir os <b>Centro de Custos</b> escolhidos?',\n                \t[obtn_sim, obtn_nao],\n                \t[\n\t                \t{\n\t                \t\tret: 1,\n\t                \t\tfunc: function() { vm.excluirCCustoEscolhido(vm.listaCCustoSelec); }\n\t                \t},\n\t                \t{\n\t                \t\tret: 2,\n\t                \t\tfunc: function() { $timeout(function() { vm.formulario.DESTINATARIO_TIPO = \"ccusto\"; }); }                \t\n\t                \t}\n                \t]\n                );\n\n\t\t\t}\n\t\t\telse if ( (vm.formulario.DESTINATARIO_TIPO == \"ccusto\") && (vm.listaUsuarioSelec.length > 0) ) {\n\n\t\t\t\taddConfirme(\n\t\t\t\t\t'<h4>Confirmação</h4>',\n                \t'Você só pode escolher um tipo de destinatário para esta pesquisa.<br />Deseja excluir os <b>Usuários</b> escolhidos?',\n                \t[obtn_sim, obtn_nao],\n                \t[\n\t                \t{\n\t                \t\tret: 1,\n\t                \t\tfunc: function() { vm.excluirUsuarioEscolhido(vm.listaUsuarioSelec); }\n\t                \t},\n\t                \t{\n\t                \t\tret: 2,\n\t                \t\tfunc: function() { $timeout(function() { vm.formulario.DESTINATARIO_TIPO = \"usuario\"; }); }\n\t                \t}\n                \t]\n                );\n\n\t\t\t}\n\n\t\t};\n\n\t\t/**\n\t\t * Listar usuários.\n\t\t */\n\t\tvm.listarUsuario = function() {\n            \n\t\t\t$ajax\n\t\t\t\t.post('/_11010/listarTodos')\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tvm.listaUsuario = response;\n\t\t\t\t})\n\t\t\t;\n\n\t\t};\n\n\t\t/**\n\t\t * Selecionar usuários (modal).\n\t\t */\n\t\tvm.selecionarUsuario = function(usuario, $event) {\n\n\t\t\t// Não exibir caso o checkbox seja clicado.\n\t\t\t// if ( $($event.target).hasClass('chk-selec-usuario') )\n\t\t\t// \treturn false;\n\n\t\t\tif (vm.verificarUsuarioEhDestinatario(usuario) > -1)\n\t\t\t\treturn false;\n\n\t\t\tvar indexUsuario = vm.listaUsuarioSelec.indexOf(usuario);\n\n\t\t\tif (indexUsuario > -1) {\n\t\t\t\tvm.listaUsuarioSelec.splice(indexUsuario, 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tusuario.PESO = 1;\n\t\t\t\tvm.listaUsuarioSelec.push(usuario);\n\t\t\t}\n\n\t\t};\n\n\t\t/**\n\t     * Verificar se o usuário da lista de usuários (modal) já é um destinatário.\n\t     */\n\t    vm.verificarUsuarioEhDestinatario = function(usuario) { \n\n\t    \tvar ret = \tvm.listaUsuarioSelec\n\t\t    \t\t\t\t.map(function(item) { return item.ID; })\n\t\t    \t\t\t\t.indexOf(usuario.ID)\n\t\t\t    \t\t;\n\n\t    \treturn ret;\n\t\t};\n\n\t\t/**\n\t\t * Selecionar usuários escolhidos.\n\t\t */\n\t\tvm.selecionarUsuarioEscolhido = function($event, usuario) {\n\n\t\t\t// Não exibir caso o checkbox seja clicado.\n\t\t\tif ( $($event.target).hasClass('chk-reabilitar-usuario') || $($event.target).hasClass('chk-visualiza-cadastro') )\n\t\t\t\treturn false;\n\n\t\t\tvar indexUsuario = vm.listaUsuarioSelecEscolhido.indexOf(usuario);\n\n\t\t\tif (indexUsuario > -1) {\n\t\t\t\tvm.listaUsuarioSelecEscolhido.splice(indexUsuario, 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvm.listaUsuarioSelecEscolhido.push(usuario);\n\t\t\t}\n\n\t\t};\n\n\t\t/**\n\t\t * Excluir usuários escolhidos.\n\t\t */\n\t\tvm.excluirUsuarioEscolhido = function(usuario) {\n\n\t\t\tvar indexUsuario = -1,\n\t\t\t\tusu = '',\n\t\t\t\tusuario_length = usuario.length\n\t\t\t;\n\n\t\t\tfor (var i = usuario_length-1; i >= 0; i--) {\n\n\t\t\t\tusu \t\t = usuario[i];\n\t\t\t\tindexUsuario = vm.listaUsuarioSelec.indexOf(usu);\n\n\t\t\t\tif (indexUsuario > -1) {\n\t\t\t\t\tvm.listaDestinatarioExcluir.push(usu);\n\t\t\t\t\tvm.listaUsuarioSelec.splice(indexUsuario, 1);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvm.listaUsuarioSelecEscolhido = [];\n\n\t\t};\n\n\t\t/**\n\t\t * Reabilitar usuários (modal).\n\t\t */\n\t\tvm.reabilitarUsuario = function(usuario) {\n\n\t\t\tif (usuario.STATUS_RESPOSTA == '0' || usuario.STATUS_RESPOSTA == 'undefined')\n\t\t\t\treturn false;\n\n\t\t\tvar usu = [];\n\n\t\t\tfor (var i in vm.listaUsuarioSelec) {\n\n\t\t\t\tusu = vm.listaUsuarioSelec[i];\n\n\t\t\t\tif (usu.ID == usuario.ID)\n\t\t\t\t\tusu.STATUS_RESPOSTA = '0';\n\t\t\t}\n\n\t\t};\n\n\n\t\t$('#modal-destinatario-usuario')\n\t\t\t.on('shown.bs.modal', function() {\n\n\t\t\t\t$('#input-filtrar-usuario').select();\n\n\t\t\t})\n\t\t;\n\n\n\t\t/**\n\t\t * Listar Centro de Custos.\n\t\t */\n\t\tvm.listarCCusto = function() {\n            \n\t\t\t$ajax\n\t\t\t\t.post('/_20030/pesquisaCCustoTodos')\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tvm.listaCCusto = response;\t\t\t\t\t\n\n\t\t\t\t})\n\t\t\t;\n\n\t\t};\n\n\t\t/**\n\t\t * Selecionar Centro de Custos (modal).\n\t\t */\n\t\tvm.selecionarCCusto = function(ccusto) {\n\n\t\t\tvar indexCCusto = vm.listaCCustoSelec.indexOf(ccusto);\n\n\t\t\tif (indexCCusto > -1) {\n\t\t\t\tvm.listaCCustoSelec.splice(indexCCusto, 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tccusto.PESO = 1;\n\t\t\t\tvm.listaCCustoSelec.push(ccusto);\n\t\t\t}\n\n\t\t\tvm.todosCCustoSelecionado = false;\n\n\t\t};\n\n\t\t/**\n\t\t * Selecionar Centro de Custos escolhidos.\n\t\t */\n\t\tvm.selecionarCCustoEscolhido = function(ccusto) {\n\n\t\t\tvar indexCCusto = vm.listaCCustoSelecEscolhido.indexOf(ccusto);\n\n\t\t\tif (indexCCusto > -1) {\n\t\t\t\tvm.listaCCustoSelecEscolhido.splice(indexCCusto, 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvm.listaCCustoSelecEscolhido.push(ccusto);\n\t\t\t}\n\n\t\t};\n\n\t\t/**\n\t\t * Excluir Centro de Custos escolhidos.\n\t\t */\n\t\tvm.excluirCCustoEscolhido = function(ccusto) {\n\n\t\t\tvar indexCCusto \t= -1,\n\t\t\t\tcc \t\t\t\t= '',\n\t\t\t\tccusto_length \t= ccusto.length\n\t\t\t;\n\n\t\t\tfor (var i = ccusto_length-1; i >= 0; i--) {\n\n\t\t\t\tcc \t\t \t= ccusto[i];\n\t\t\t\tindexCCusto = vm.listaCCustoSelec.indexOf(cc);\n\n\t\t\t\tif (indexCCusto > -1) {\n\t\t\t\t\tvm.listaDestinatarioExcluir.push(cc);\n\t\t\t\t\tvm.listaCCustoSelec.splice(indexCCusto, 1);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvm.listaCCustoSelecEscolhido = [];\n\n\t\t};\n\n\t\t/**\n\t\t * Selecionar todos os Centro de Custos.\n\t\t */\n\t\tvm.selecionarTodosCCusto = function() {\n\n\t\t\t// Limpar todos.\n\t\t\tif (vm.listaCCustoSelec.length > 0 && vm.todosCCustoSelecionado) {\n\n\t\t\t\tvm.listaCCustoSelec = [];\n\t\t\t\tvm.todosCCustoSelecionado = false;\n\n\t\t\t}\n\t\t\t// Selecionados todos.\n\t\t\telse {\n\n\t\t\t\tvar ccusto = [];\n\t\t\t\tvm.listaCCustoSelec = [];\n\n\t\t\t\tfor (var i in vm.listaCCusto) {\n\n\t\t\t\t\tccusto = vm.listaCCusto[i];\n\n\t\t\t\t\tccusto.PESO = 1;\n\t\t\t\t\tvm.listaCCustoSelec.push(ccusto);\n\n\t\t\t\t}\n\n\t\t\t\tvm.todosCCustoSelecionado = true;\n\n\t\t\t}\n\n\t\t};\n\n\t\t$('#modal-destinatario-ccusto')\n\t\t\t.on('shown.bs.modal', function() {\n\n\t\t\t\t$('#input-filtrar-ccusto').select();\n\n\t\t\t})\n\t\t;\n\n\t\t/**\n\t\t * Adicionar pergunta.\n\t\t */\n\t\tvm.addPergunta = function() {\n\n\t\t\tvar perguntaNova = {};\n\t\t\tangular.copy(vm.perguntaPadrao, perguntaNova);\n\t\t\tperguntaNova.ORDEM = vm.pergunta.length+1;\n\t\t\tvm.pergunta.push(perguntaNova);\n\n\t\t\tvm.somarNota();\n\n\t\t};\n\n\t\t/**\n\t\t * Excluir pergunta.\n\t\t */\n\t\tvm.excluirPergunta = function(index) {\n\n\t\t\tvm.perguntaExcluir.push(vm.pergunta[index]);\n\t\t\tvm.pergunta.splice(index, 1);\n\n\t\t\tvm.somarNota();\n\n\t\t};\n\n\t\t/**\n         * Listar tipos de resposta.\n         */\n\t\tvm.listarTipoResposta = function() {\n\n\t\t\t$ajax\n\t\t\t\t.post('/_25010/listarTipoResposta')\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tvm.tipoResposta = response;\t\t\t\t\t\n\n\t\t\t\t})\n\t\t\t;\n\n\t\t};\n\n\t\t/**\n         * Listar níveis de satisfação das alternativas.\n         */\n\t\tvm.listarNivelSatisfacao = function() {\n\n\t\t\t$ajax\n\t\t\t\t.post('/_25010/listarNivelSatisfacao')\n\t\t\t\t.then(function(response) {\n\n\t\t\t\t\tvm.nivelSatisfacao = response;\t\t\t\n\n\t\t\t\t})\n\t\t\t;\n\n\t\t};\n\n\t\t/**\n\t\t * Ações ao selecionar um nível de satisfação.\n\t\t */\n\t\tvm.selecionarNivelSatisfacao = function(alternativa) {\n\n\t\t\tif (alternativa.NIVEL_SATISFACAO == 3)\n\t\t\t\talternativa.NOTA = '0';\n\n\t\t};\n\n\t\t/**\n\t\t * Adicionar alternativas.\n\t\t */\n\t\tvm.addAlternativa = function(perg) {\n\n\t\t\tvar alternativaNova = {};\n\t\t\tangular.copy(vm.alternativaPadrao, alternativaNova);\n\t\t\tperg.ALTERNATIVA.push(alternativaNova);\n\n\t\t\tvm.somarNota();\n\n\t\t};\n\n\t\t/**\n\t\t * Excluir alternativa.\n\t\t */\n\t\tvm.excluirAlternativa = function(perg, index) {\n\n\t\t\tperg.ALTERNATIVA_EXCLUIR.push(perg.ALTERNATIVA[index]);\n\t\t\tperg.ALTERNATIVA.splice(index, 1);\n\n\t\t\tvm.somarNota();\n\n\t\t};\n\n\t\t/**\n\t\t * Ações ao selecionar um tipo de resposta.\n\t\t */\n\t\tvm.selecionarTipoResposta = function(perg) {\n\n\t\t\tif (perg.TIPO_RESPOSTA == '3')\n\t\t\t\tfor (var i in perg.ALTERNATIVA)\n\t\t\t\t\tperg.ALTERNATIVA[i].NOTA = 0;\n\n\t\t\tvm.somarNota();\n\t\t};\n\n\n\t\t/**\n\t\t * Verificar dados antes de gravar.\n\t\t */\n\t\tvm.verificarDados = function() {\n\n\t\t\tvar ret = true;\n\n\t\t\t// Verificar se algum destinatário foi escolhido.\n\t\t\tif ( (vm.formulario.TIPO != 3) && (vm.listaUsuarioSelec.length == 0 && vm.listaCCustoSelec.length == 0) ) {\n\n\t\t\t\tshowErro('Escolha destinatários.');\n\t\t\t\tret = false;\n\n\t\t\t}\n\t\t\t// Verificar se existem perguntas.\n\t\t\telse if ( vm.pergunta.length == 0 ) {\n\n\t\t\t\tshowErro('Adicione perguntas.');\n\t\t\t\tret = false;\n\n\t\t\t}\n\t\t\t// Verificar se o total das notas é igual a 10.\n\t\t\telse if ( vm.formulario.TIPO == 3 && ($filter('number')(vm.totalNota) != '10,000' && $filter('number')(vm.totalNota) != '10') ) {\n\t    \t\t\n\t    \t\tshowErro('A soma das notas deve ser igual à 10.');\n\t    \t\tret = false;\n\t\t\t}\n\t\t\t// Verificações para as alternativas.\n\t\t\telse if ( vm.formulario.TIPO != 3 ) {\n\n\t\t\t\tvar perg \t\t\t\t= [],\n\t\t\t\t\taltern \t\t\t\t= [],\n\t\t\t\t\tconta_satisf \t\t= 0,\n\t\t\t\t\tconta_insatisf\t\t= 0,\n\t\t\t\t\tconta_nao_se_aplica = 0\n\t\t\t\t;\n\n\t\t\t\tfor (var i in vm.pergunta) {\n\n\t\t\t\t\tperg = vm.pergunta[i];\n\n\t\t\t\t\tconta_satisf \t\t= 0;\n\t\t\t\t\tconta_insatisf\t\t= 0;\n\t\t\t\t\tconta_nao_se_aplica = 0;\n\n\t\t\t\t\tfor (var j in perg.ALTERNATIVA) {\n\n\t\t\t\t\t\taltern = perg.ALTERNATIVA[j];\n\n\t\t\t\t\t\t// Contar níveis escolhidos.\n\t\t\t\t\t\tif (altern.NIVEL_SATISFACAO == '1')\n\t\t\t\t\t\t\tconta_satisf++;\n\t\t\t\t\t\telse if (altern.NIVEL_SATISFACAO == '2')\n\t\t\t\t\t\t\tconta_insatisf++;\n\t\t\t\t\t\telse if (altern.NIVEL_SATISFACAO == '3')\n\t\t\t\t\t\t\tconta_nao_se_aplica++;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Se o tipo de resposta não for subjetiva.\n\t\t\t\t\tif (perg.TIPO_RESPOSTA != '3') {\n\n\t\t\t\t\t\t// Se o nível selecionado for 'SATISFATÓRIO',\n\t\t\t\t\t\t// pelo menos uma das alternativas deve ser 'INSATISFATÓRIA' e vice-versa.\n\t\t\t\t\t\tif (conta_nao_se_aplica == 0 && (conta_satisf == 0 || conta_insatisf == 0)) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tshowErro('Ao selecionar o nível \"Satisfatório\" ou \"Insatisfatório\", alguma alternativa precisa ter nível oposto. Verifique a pergunta '+ $filter('lpad')([(parseInt(i)+1)], [2,\"0\"]) +'.');\n\t\t\t\t\t\t\tret = false;\n\t\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Se um nível selecionado for 'NÃO SE APLICA', \n\t\t\t\t\t\t// todas as outras alternativas também deverão ser desse nível.\n\t\t\t\t\t\t// if (conta_nao_se_aplica > 0 && (conta_satisf > 0 || conta_insatisf > 0)) {\n\n\t\t\t\t\t\t// \tshowErro('Ao selecionar o nível \"Não se aplica\" em uma alternativa, todas as outras também deverão ser desse nível. Verifique a pergunta '+ $filter('lpad')([(parseInt(i)+1)], [2,\"0\"]) +'.');\n\t\t\t\t\t\t// \tret = false;\n\t\t\t\t\t\t// \treturn false;\n\n\t\t\t\t\t\t// }\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn ret;\n\n\t\t};\n\n\t\t/**\n\t\t * Ações no sucesso ao gravar formulário.\n\t\t */\n\t\tvm.sucessoGravarFormulario = function() {\n\n\t\t\tif (vm.tipoTela == 'incluir') \n            \tshowSuccess('Formulário gravado com sucesso.');\n            else if (vm.tipoTela == 'alterar') \n            \tshowSuccess('Formulário alterado com sucesso.');\n\n            vm.tipoTela \t\t\t\t= 'exibir';\n            vm.listaDestinatarioExcluir = [];\n            vm.perguntaExcluir \t\t\t= [];\n\n            vm.listarFormulario();\n\n\t\t};\n\n\t\t/**\n\t\t * Incluir/alterar formulário.\n\t\t */\n\t\tvm.gravarFormulario = function() {\n\n\t\t\tif ( !vm.verificarDados() ) return false;\n\n\t\t\tvar dados \t= {\n\t\t            formulario \t\t\t\t: vm.formulario,\n\t\t            destinatario\t\t\t: (vm.listaUsuarioSelec.length > 0) ? vm.listaUsuarioSelec : vm.listaCCustoSelec,\n\t\t            destinatario_excluir\t: vm.listaDestinatarioExcluir,\n\t\t            pergunta \t\t\t\t: vm.pergunta,\n\t\t            pergunta_excluir\t\t: vm.perguntaExcluir\n\t\t        },\n\t        \turl \t= (vm.tipoTela == 'incluir') ? '/_25010/gravar' : '/_25010/alterar'\n\t        ;\n\t    \n\t        $ajax\n\t        \t.post(url, JSON.stringify(dados), {contentType: 'application/json'})\n\t            .then(function(response) {  \n\n\t                vm.sucessoGravarFormulario();\n\n\t            })\n\t        ;\n\n\t    };\n\n\t    /**\n\t     * Somar notas.\n\t     * Na pesquisa de cliente (tipo 3), precisa ser 10.\n\t     */\n\t    vm.somarNota = function() {\n\n\t    \tif (vm.formulario.TIPO != 3)\n\t    \t\treturn false;\n\n\t    \tvar alt = {};\n\t    \tvm.totalNota = 0;\n\n\t    \tfor (var i in vm.pergunta) {\n\n\t    \t\tfor (var j in vm.pergunta[i].ALTERNATIVA) {\n\n\t    \t\t\talt = vm.pergunta[i].ALTERNATIVA[j];\n\n\t    \t\t\tvm.totalNota += (alt.NOTA) ? parseFloat(alt.NOTA) : 0;\n\t    \t\t}\n\t    \t}\n\t    };\n\n\t    vm.redefinirFormulario();\n\t\tvm.listarTipoFormulario();\n\t\tvm.listarTipoResposta();\n\t\tvm.listarNivelSatisfacao();\n\t\tvm.listarUsuario();\n\t\tvm.listarCCusto();\n\t\tvm.addPergunta();\n\n\t};\n\n\t//Injetando Components ao Controller.\n\tctrl.$inject = ['$ajax', '$filter', '$timeout'];\n\n    angular\n    \t.module('app', ['vs-repeat', 'gc-ajax', 'gc-find', 'gc-transform', 'gc-form'])\n    \t.controller('ctrl', ctrl)\n\t; \n    \n    //angular.bootstrap(document.getElementById('main'), ['app']);\n\n})(angular);"]}