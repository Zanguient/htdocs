{"version":3,"sources":["app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_11190.js","sourcesContent":["/**\n * _11190 - Notificacao\n */\n\n;(function(angular) {\n\n    var Ctrl = function($scope,$ajax,$timeout, $sce) {\n\n        var vm    = this;\n        vm.USERS  = {};\n        vm.filtro = '';\n        vm.ordem  = 'NOME';\n        vm.ordem2 = '-ID';\n        vm.user_marcados = [];\n        vm.lista  = [];\n        vm.lista2 = [];\n        vm.NOTIFICACAO = {};\n        vm.msg    = {\n            MENSAGEM : '',\n            TITULO   : '',\n        };\n\n        vm.PERMICAO = {\n            INCLUIR  : 0,\n            ALTERAR  : 0,\n            EXCLUIR  : 0,\n            IMPRIMIR : 0\n        };\n\n        $scope.trustAsHtml = function(string) {\n            return $sce.trustAsHtml(string);\n        };\n\n        var ckConfig = {\n            toolbar: [{\n                name: \"document\",\n                items: [\"Print\"]\n            }, {\n                name: \"clipboard\",\n                items: [\"Undo\", \"Redo\"]\n            }, {\n                name: \"styles\",\n                items: [\"Format\", \"Font\", \"FontSize\"]\n            }, {\n                name: \"basicstyles\",\n                items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\", \"RemoveFormat\", \"CopyFormatting\"]\n            }, {\n                name: \"colors\",\n                items: [\"TextColor\", \"BGColor\"]\n            }, {\n                name: \"align\",\n                items: [\"JustifyLeft\", \"JustifyCenter\", \"JustifyRight\", \"JustifyBlock\"]\n            }, {\n                name: \"links\",\n                items: [\"Link\", \"Unlink\"]\n            }, {\n                name: \"paragraph\",\n                items: [\"NumberedList\", \"BulletedList\", \"-\", \"Outdent\", \"Indent\", \"-\", \"Blockquote\"]\n            }, {\n                name: \"insert\",\n                items: [\"Table\"]\n            }],\n            removePlugins: \"autoembed,embedsemantic,image2,sourcedialog\",\n            disallowedContent: \"img{width,height,float}\",\n            extraAllowedContent: \"img[width,height,align]\",\n            bodyClass: \"document-editor\"\n        };\n\n        \n\n        var init = function(){\n\n            vm.PERMICAO.INCLUIR  = $('.menu-incluir' ).val();\n            vm.PERMICAO.ALTERAR  = $('.menu-alterar' ).val();\n            vm.PERMICAO.EXCLUIR  = $('.menu-excluir' ).val();\n            vm.PERMICAO.IMPRIMIR = $('.menu-imprimir').val();\n\n        \tvar ds = {\n\t\t\t\t\tID : 0\n\t\t\t\t};\n\n            if(vm.PERMICAO.INCLUIR == 1){\n    \t\t\t$ajax.post('_11190/getUsuarios',ds)\n                    .then(function(response) {\n                        vm.USERS = response;                   \n                    }\n                );\n            }\n\n            $ajax.post('_11190/getNotificacao',ds)\n                .then(function(response) {\n                    vm.NOTIFICACAO = response;\n\n                    angular.forEach(vm.NOTIFICACAO, function (iten) {\n                      iten.ID = parseFloat(iten.ID);\n                    });\n\n                }\n            );\n                \n        };\n\n        vm.Acoes = {\n            StatusIten: function(iten){\n                if(iten.SELECTED == 1){\n                    iten.SELECTED = 0;\n                }else{\n                    iten.SELECTED = 1;\n                }\n            },\n        \tatualizar: function(){\n        \t\tinit();\n        \t},\n        \tTratarOrdem : function(filtro){\n                if(vm.ordem == filtro){\n                    vm.ordem = '-'+filtro;\n                }else{\n                    vm.ordem = filtro;\n                }\n            },\n            TratarOrdem2 : function(filtro){\n                if(vm.ordem2 == filtro){\n                    vm.ordem2 = '-'+filtro;\n                }else{\n                    vm.ordem2 = filtro;\n                }\n            },\n        \topen: function(){\n        \t\t//init();\n        \t},\n        \tmarcarTodos: function(){\n        \t\tangular.forEach(vm.lista, function(iten, key) {\n                \titen.SELECTED = 1;    \n                });\n        \t},\n        \tdesmarcarTodos: function(){\n        \t\tangular.forEach(vm.lista, function(iten, key) {\n                \titen.SELECTED = 0;    \n                });\n        \t},\n        \tivertMarcar: function(){\n        \t\tangular.forEach(vm.lista, function(iten, key) {\n        \t\t\tif(iten.SELECTED == 1){\n                \t\titen.SELECTED = 0;\n                \t}else{\n                \t\titen.SELECTED = 1;\n                \t} \n                });\n        \t},\n            enviarNotificacoes: function(metodo, msg){\n                var that = this;\n                var str  = '<div class=\"envio-user\">';\n\n                vm.msg.MENSAGEM  = CKEDITOR.instances.editorHtml.getData();\n                \n                vm.user_marcados = [];\n                angular.forEach(vm.USERS, function(iten, key) {\n                    if(iten.SELECTED == 1){\n                        vm.user_marcados.push(iten.ID);\n                        str = str + '<b>' + iten.USUARIO + '</b><br>';\n                    }\n                });\n\n                str = str + '</div>';\n\n                if(vm.user_marcados.length > 0){\n\n                    addConfirme('<h4>Notificação</h4>',\n                    ' Deseja realmente enviar '+msg+' para:<br>' +str\n                    ,[obtn_sim,obtn_cancelar],\n                        [\n                            {ret:1,func:function(){\n                                var ds = {\n                                    USERS : vm.user_marcados,\n                                    MSG   : vm.msg\n                                };\n\n                                $ajax.post('_11190/'+metodo,ds)\n                                    .then(function(response) {\n                                        showSuccess(msg+' enviados.');\n                                        that.desmarcarTodos();\n                                        that.fecharModal();                    \n                                    }\n                                );\n                            }},\n                            {ret:2,func:function(){\n                                    \n                            }}\n                        ]     \n                    );\n                }else{\n                    showErro('Selecione ao menos um usuário');\n                }\n            },\n            modal: function(){\n                vm.user_marcados = [];\n                angular.forEach(vm.USERS, function(iten, key) {\n                    if(iten.SELECTED == 1){\n                        vm.user_marcados.push(iten.ID);\n                    }\n                });\n\n                if(vm.user_marcados.length > 0){\n                    $('#modal-mensagem').modal();\n                    CKEDITOR.instances.editorHtml.setData('');\n                    vm.msg.TITULO = '';\n                }else{\n                    showErro('Selecione ao menos um usuário');\n                }\n            },\n            fecharModal: function(){\n                $('#modal-mensagem').modal('hide');    \n            }\n        };\n\n        init();\n        CKEDITOR.replace('editorHtml',ckConfig);\n\n    };\n\n    Ctrl.$inject = [\n\t\t'$scope',\n\t\t'$ajax',\n\t\t'$timeout',\n        '$sce'\n\t];\n \n    angular\n    .module    ('app' , ['angular.filter','vs-repeat','gc-ajax','gc-form','gc-find','gc-transform'])\n    .controller('Ctrl', Ctrl);\n        \n})(angular);\n\n;(function($){\n\n        \n\n})(jQuery);"]}