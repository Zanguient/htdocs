{"version":3,"sources":["_13040.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_13040.js","sourcesContent":["/**\r\n * Script com funções da tela 13040\r\n * Produtos para Geração de Ordem de Compra \r\n * */\r\n\r\n\r\n(function($) {\r\n\r\n\t/**\r\n\t * Abre a lista de pesquisa \r\n\t * @param {type} input_group\r\n\t */\r\n\tfunction abreListaPesquisa(input_group) {\r\n\t\tvar btn_filtro = input_group.find('.btn-filtro');     \r\n\r\n\t\t$(input_group)\r\n\t\t\t.next('.pesquisa-res-container')\r\n\t\t\t.addClass('ativo')\r\n\t\t;\r\n\r\n\t\t$(btn_filtro)\r\n\t\t\t.attr('tabindex', '-1')\r\n\t\t;\r\n\t}\r\n\r\n\t/**\r\n\t * Fecha a lista de pesquisa\r\n\t * @param {type} input_group\r\n\t */\r\n\tfunction fechaListaPesquisa(input_group) {\r\n\t\tvar btn_filtro = input_group.find('.btn-filtro');  \r\n\r\n\t\t$(input_group)\r\n\t\t\t.next('.pesquisa-res-container')\r\n\t\t\t.removeClass('ativo')\r\n\t\t\t.children('.pesquisa-res')\r\n\t\t\t.empty();\r\n\r\n\t\t$(btn_filtro)\r\n\t\t\t.removeAttr('tabindex');\r\n\t}\r\n\r\n    {/** Calcula campos em tempo de execução */\r\n        function clickRadioItem() {\r\n            //Calcula o total para os itens selecionados\r\n            $('input[type=radio],input[type=checkbox]').click(function(){\r\n                var total \t\t\t= 0;\r\n                var previousValue\t= $(this).attr('previousValue');\r\n                var name \t\t\t= $(this).attr('name');\r\n                var coluna;\r\n\r\n                coluna = \r\n                $(this) \t\t\t//<- botão do radio\r\n                    .parent()\t\t//<- label do radio\r\n                    .parent()\t\t//<- div radio\r\n                    .parent()\t\t//<- td\r\n                    .attr('coluna')\t//codigo coluna\r\n                ;\t\t\t\t\t\t\t\t\r\n\r\n                {// Responsavel por realizar o 'uncheck' do radio button\r\n                    if (previousValue === 'checked'){\r\n                        $(this).removeAttr('checked');\r\n                        $(this).attr('previousValue', false);\r\n\r\n                    } else {\r\n                        $(\"input[name=\"+name+\"]:radio\").attr('previousValue', false);\r\n                        $(this).attr('previousValue', 'checked');\t\r\n\r\n                    }\t\r\n                }\r\n\r\n                {//Desmarca todos os campos required e input head\r\n                    $('input:radio, input:checkbox').each(function () {\r\n                        //código da coluna\r\n                        coluna = \r\n                        $(this) \t\t\t//<- botão do radio\r\n                            .parent()\t\t//<- label do radio\r\n                            .parent()\t\t//<- div radio\r\n                            .parent()\t\t//<- td\r\n                            .attr('coluna')\t//codigo coluna\r\n                        ;\t\r\n\r\n                        //remove required da coluna\r\n                        $('td[coluna=' + coluna + ']')\r\n                            .children('.form-group')\r\n                            .find('input, select')\r\n                            .removeAttr('required')\r\n                        ;\t\r\n\r\n                        //remove o name para que não seja enviado no submit\r\n                        $('div[coluna=' + coluna + ']')\t\t//<- coluna head\r\n                            .children()\t\t\t\t\t\t//<- filho da coluna\r\n                            .siblings('input')\t\t\t\t//<- irmãos input\r\n                            .each(function () {\t\t\t\t//<- todos os inputs\r\n                                $(this)\t\t\t\t\t\t//<- input\r\n                                    .removeAttr('name')\t\t//<- remove o atritubo name\r\n                                ;\r\n                            })\r\n                        ;\r\n                        \r\n                        //remove o required da operacao\r\n                        $(this)                             //<- botão do radio\r\n                            .parents('tr')                  //<- linha\r\n                            .first()                        //<- linha corrente\r\n                            .find('.operacao-descricao')    //<- input operacao\r\n                            .removeAttr('required')         //<= remove o atritubo required\r\n                        ;\r\n                        \r\n                        //remove o required do ipi\r\n                        $(this)                             //<- botão do radio\r\n                            .parents('tr')                  //<- linha\r\n                            .first()                        //<- linha corrente\r\n                            .find('.perc-ipi')              //<- input ipi\r\n                            .removeAttr('required')         //<= remove o atritubo required\r\n                        ;\r\n                        \r\n                        //remove o required da data entrega\r\n                        $(this)                             //<- botão do radio\r\n                            .parents('tr')                  //<- linha\r\n                            .first()                        //<- linha corrente\r\n                            .find('.data-entrega')          //<- input data entrega\r\n                            .removeAttr('required')         //<= remove o atritubo required\r\n                        ;\r\n                        \r\n                        \r\n                    });\t\t\r\n                }\r\n\r\n                $('input:radio, input:checkbox').each(function () {\t\t\r\n\r\n                    coluna = \r\n                    $(this) \t\t\t//<- botão do radio\r\n                        .parent()\t\t//<- label do radio\r\n                        .parent()\t\t//<- div radio\r\n                        .parent()\t\t//<- td\r\n                        .attr('coluna')\t//codigo coluna\r\n                    ;\t\r\n\r\n                    if ($(this).prop('checked')) {\r\n\r\n                        {//Calcula o total\r\n                            total = \r\n                            total +\r\n                            formataPadrao(\r\n                                $(this) \t\t\t  //<- botão do radio\r\n                                    .parent() \t\t  //<- label do radio\r\n                                    .children('span') //<- campo do valor\r\n                                    .text() \t\t  //<- valor\r\n                            );\t\t\r\n                        }\r\n\r\n                        $(this) \t\t\t \t\t\t\t//<- botão do radio\r\n                            .parent()\t\t\t\t\t\t//<- label do radio\r\n                            .siblings('input')\t\t\t\t//<- irmãos de label\r\n                            .each(function () {\t\t\t\t//<- todos os inputs\r\n                                $(this)\t\t\t\t\t\t//<- input\r\n                                    .attr('name',\t\t\t//<- atributo name\r\n                                        $(this)\t\t\t\t//<- input\r\n                                            .attr('field')\t//<- atributo field\r\n                                    );\r\n                            })\r\n                        ;\r\n\r\n                        {//Marca os campos required e campos input head\r\n                            \r\n                            //add required na coluna\r\n                            $('td[coluna=' + coluna + ']')\r\n                                .children('.form-group')\r\n                                .find('input, select')\r\n                                .attr('required',true)\r\n                            ;\r\n\r\n                            //add o atritubo name para ser enviado no submit\r\n                            $('div[coluna=' + coluna + ']')\r\n                                .children()\r\n                                .siblings('input')\r\n                                .each(function () {\t\t\t\t//<- todos os inputs\r\n                                    $(this)\t\t\t\t\t\t//<- input\r\n                                        .attr('name',\t\t\t//<- atributo name\r\n                                            $(this)\t\t\t\t//<- input\r\n                                                .attr('field')\t//<- atributo field\r\n                                        );\r\n                                })\r\n                            ;\r\n                            \r\n                            //add o required da operacao\r\n                            $(this)                             //<- botão do radio\r\n                                .parents('tr')                  //<- linha\r\n                                .first()                        //<- linha corrente\r\n                                .find('.operacao-descricao')    //<- input operacao\r\n                                .attr('required',true)          //<= add o atritubo required\r\n                            ;     \r\n                            \r\n                            //add o required do ipi\r\n                            $(this)                             //<- botão do radio\r\n                                .parents('tr')                  //<- linha\r\n                                .first()                        //<- linha corrente\r\n                                .find('.perc-ipi')              //<- input ipi\r\n                                .attr('required',true)          //<= add o atritubo required\r\n                            ;    \r\n                            \r\n                            //add o required da data entrega\r\n                            $(this)                             //<- botão do radio\r\n                                .parents('tr')                  //<- linha\r\n                                .first()                        //<- linha corrente\r\n                                .find('.data-entrega')          //<- input data entrega\r\n                                .attr('required',true)          //<= add o atritubo required\r\n                            ;                           \r\n                        }\r\n\r\n                    } else {\t\t\t\t\t\r\n\r\n                        $(this) \t\t \t\t//<- botão do radio\r\n                            .parent()\t\t\t//<- label do radio\r\n                            .siblings('input')\t//<- irmãos de label\r\n                            .each(function () {\t//<- todos os inputs\r\n                                $(this).removeAttr('name');\r\n                            })\r\n                        ;\r\n                    }\r\n\r\n                });\r\n\r\n                ( total > 0 ) ? $('button.js-gravar').removeAttr('disabled') : $('button.js-gravar').attr('disabled',true); \r\n\r\n                total = formataReal( total.toFixed(4) );\r\n                $('.total-calculado').text(total);\r\n\r\n            });\r\n        }\r\n    }\r\n\r\n    { /** Pesquisar Operações Fiscais */\r\n\r\n        var filtro;\r\n        var operacao_campo;\r\n        var operacao_btn_filtro;\r\n        var operacao_btn_filtro_apagar;\r\n        var input_group;\r\n        var operacao_itens;\r\n        var _operacao_id;\r\n        var _produto_id;\r\n        var _ccusto;\r\n        var _ccontabil;\r\n        var tempo_focus;\r\n        var operacao_selecionado = false;\r\n\r\n        /**\r\n         * Filtrar objeto.\r\n         * \r\n\t\t * @param {object} campo\r\n         */\r\n        function filtrarOperacao( campo ) {\r\n\r\n            operacao_campo              = campo;\t//campo\r\n            operacao_btn_filtro         = operacao_campo.nextAll('.btn-filtro-operacao');\r\n\t\t\toperacao_btn_filtro_apagar\t= operacao_campo.nextAll('.btn-apagar-filtro-operacao');\r\n\r\n            input_group\t\t= $(operacao_campo).parent('.input-group');\t//input-group\r\n            input_linha     = input_group.parents('tr').first();\r\n            _operacao_id    = input_linha.find('input[field=\"item[operacao][]\"]');\r\n            _produto_id     = input_linha.find('input[field=\"_produto_id\"]');\r\n            _ccusto         = input_linha.find('input[field=\"item[ccusto][]\"]');\r\n            _ccontabil      = input_linha.find('input[field=\"item[ccontabil][]\"]');\r\n\r\n            filtro = operacao_campo.val();    \r\n\r\n            //esvazia campo hidden caso algum item já tenha sido escolhido antes\r\n            if(operacao_selecionado) $(_operacao_id).val('');\r\n\r\n            if( !filtro ) {\r\n                fechaListaPesquisa( input_group );\r\n                $(_operacao_id).val('');\r\n                //return false;\r\n            }\r\n\t\t\t\r\n\t\t\t//ajax\r\n\t\t\tvar type\t= \"POST\",\r\n                url\t\t= \"/_21010/pesquisa\",\r\n                data\t= {\r\n                    'filtro'        : filtro,\r\n                    'produto_id'    : _produto_id.val()\r\n                },\r\n\t\t\t\tsuccess\t= function(data) {\r\n\r\n                    abreListaPesquisa( input_group );\r\n\r\n                    $('.lista-operacao')\r\n                        .html(data)\r\n                    ;\r\n\r\n                    //existem dados cadastrados\r\n                    if( data.indexOf('nao-cadastrado') === -1 ) {\r\n\r\n                        operacao_itens = $('ul.operacao li a');\r\n\r\n                        selecItemListaOperacao( $(operacao_itens), operacao_campo, _operacao_id, _ccusto, _ccontabil);\r\n\r\n                        $(operacao_itens)\r\n                            .focusout(function() {\r\n\r\n                                if(tempo_focus) \r\n                                    clearTimeout(tempo_focus);\r\n\r\n                                tempo_focus = setTimeout(function() {\r\n\r\n                                    if( !$(operacao_itens).is(':focus') && \r\n                                        !$(operacao_campo).is(':focus') && \r\n                                        !$(operacao_btn_filtro).is(':focus') \r\n                                    ) {\r\n                                        $(operacao_campo).val('');\r\n                                        fechaListaPesquisa( input_group );\r\n                                    }\r\n\r\n                                }, 200);\r\n\r\n                            });\r\n\r\n                        $(operacao_campo)\r\n                            .focusout(function() {\r\n\r\n                                if(tempo_focus) \r\n                                    clearTimeout(tempo_focus);\r\n\r\n                                tempo_focus = setTimeout(function() {\r\n\r\n                                    if( !$(operacao_itens).is(':focus') &&\r\n                                        !$(_operacao_id).val() && \r\n                                        !$(operacao_btn_filtro).is(':focus') \r\n                                    ) {\r\n                                        $(operacao_campo).val('');\r\n                                        fechaListaPesquisa( input_group );\r\n                                    }\r\n\r\n                                }, 200);\r\n\r\n                            });\r\n                    }\r\n                    else {\r\n                        $(_operacao_id).val('');\r\n\r\n                        $(operacao_campo)\r\n                            .focusout(function() {\r\n                                if( $('.lista-operacao').children().children().hasClass('nao-cadastrado') ) {\r\n                                    $(operacao_campo).val('');\r\n                                    fechaListaPesquisa( input_group );\r\n                                }\r\n                            });\r\n                    }\r\n                    bootstrapInit();\r\n                }\r\n\t\t\t;\r\n\t\t\t\t\t\t\r\n\t\t\texecAjax2(type, url, data, success, null, operacao_btn_filtro);\r\n\r\n        }\r\n\r\n        /**\r\n         * Preencher campos de acordo com o item selecionado.\r\n         * \r\n         * @param {object} itens\r\n         * @param {object} campo\r\n         * @returns {undefined}\r\n         */\r\n        function selecItemListaOperacao(itens, campo, operacao, ccusto, ccontabil) {\r\n\r\n\t\t\t\r\n\t\t\t$(itens)\r\n\t\t\t\t.click(function(e) {\r\n\t\t\t\t\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\r\n\t\t\t\t\t$(campo)\r\n\t\t\t\t\t\t.val( $(this).nextAll('.descricao').val() )\r\n\t\t\t\t\t\t.focus()\r\n                    ;\r\n\t\t\t\t\t\r\n\t\t\t\t\t$(operacao)\r\n\t\t\t\t\t\t.val( $(this).nextAll('.codigo').val() )\r\n                    ;\r\n\r\n\t\t\t\t\t$(ccusto)\r\n\t\t\t\t\t\t.val( $(this).nextAll('.ccusto').val() )\r\n                    ;\r\n\r\n\t\t\t\t\t$(ccontabil)\r\n\t\t\t\t\t\t.val( $(this).nextAll('.ccontabil').val() )\r\n                    ;\r\n                    \r\n\t\t\t\t\tselecionadoOperacao(campo, operacao_btn_filtro, operacao_btn_filtro_apagar);\r\n\r\n\t\t\t\t\tfechaListaPesquisa( input_group );\r\n\t\t\t\t\tproduto_selecionado = true;\r\n            });\r\n\r\n        }\r\n        \r\n\t\t/**\r\n\t\t * Ações que devem acontecer após o item ser selecionado.\r\n\t\t *\r\n         * @param input campo_produto\r\n         * @param button btn_filtro\r\n         * @param button btn_filtro_apagar\r\n         */\r\n\t\tfunction selecionadoOperacao(campo_produto, btn_filtro, btn_filtro_apagar) {\r\n\t\t\t\r\n\t\t\t$(campo_produto)\r\n\t\t\t\t.attr('readonly', true)\r\n            ;\r\n\t\t\r\n\t\t\t$(btn_filtro)\r\n\t\t\t\t.hide()\r\n            ;\r\n\r\n\t\t\t$(btn_filtro_apagar)\r\n\t\t\t\t.show()\r\n\t\t\t\t.click(function() {\r\n\r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.hide()\r\n\t\t\t\t\t\t.prev('button')\r\n\t\t\t\t\t\t.show()\r\n                    ;\r\n                    \r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.siblings('input')\r\n\t\t\t\t\t\t.removeAttr('readonly')\r\n                        .val('')\r\n                    ;                    \r\n                    \r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.parents('tr')\r\n                        .first()\r\n                        .find('input[field=\"item[operacao][]\"]')\r\n\t\t\t\t\t\t.val('')\r\n                    ;\r\n                                \r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.parents('tr')\r\n                        .first()\r\n                        .find('input[field=\"item[ccusto][]\"]')\r\n\t\t\t\t\t\t.val('')\r\n                    ;\r\n                                \r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.parents('tr')\r\n                        .first()\r\n                        .find('input[field=\"item[ccontabil][]\"]')\r\n\t\t\t\t\t\t.val('')\r\n                    ;\r\n             \r\n                    \r\n\t\t\t\t});\r\n\t\t}      \r\n\r\n        /**\r\n         * Eventos para o filtro de CCusto.\r\n         */\r\n        function iniciarFiltroOperacao() {\r\n            var linha_item;\r\n            var click_item;     \r\n\t\t\t\r\n\t\t\t$('.operacao-descricao').each(function() {\r\n\t\t\t\r\n\t\t\t\tif ( $(this).val() !== '' || $(this).attr('readonly') ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tselecionadoOperacao(\r\n\t\t\t\t\t\t$(this), \r\n\t\t\t\t\t\t$(this).next('.btn-filtro-operacao'), \r\n\t\t\t\t\t\t$(this).siblings('.btn-apagar-filtro-operacao')\r\n\t\t\t\t\t);\r\n\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t});\r\n            \r\n            //Botão de filtrar\r\n            $('.btn-filtro-operacao').on({\r\n\r\n                click: function() {\r\n                    if ( !$(this).parents('tr').first().find('input[field=\"item[operacao][]\"]').val() )\r\n                        filtrarOperacao( $(this).prev('input') )\r\n                    ;\r\n                },\r\n                \r\n\t\t\t\tfocusout: function() {\r\n                    linha_item = $(this).parents('tr').first();\r\n                    \r\n\t\t\t\t\tif(tempo_focus) \r\n\t\t\t\t\t\tclearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif (\r\n                           !linha_item\r\n                                .find('input[field=\"item[operacao][]\"]')\r\n                                .val() \r\n                            &&\r\n                            linha_item\r\n                                .find('.lista-operacao')\r\n                                .is(':empty')\r\n                        ) {\r\n                            linha_item\r\n                                .find('.operacao-descricao')\r\n                                .val('')\r\n                            ;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( \r\n                           !linha_item\r\n                                .find('input[field=\"item[operacao][]\"]')\r\n                                .val() \r\n                            && \r\n                           !linha_item\r\n                                .find('.lista-operacao ul li a')\r\n                                .is(':focus')\r\n                            && \r\n\t\t\t\t\t\t\tlinha_item\r\n                                .find('.operacao-descricao')\r\n                                .val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tlinha_item\r\n                                .find('.operacao-descricao')\r\n                                .val('')\r\n                            ;\r\n\t\t\t\t\t\t\tfechaListaPesquisa(input_group);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif ( \r\n                           !linha_item\r\n                                .find('input[field=\"item[operacao][]\"]')\r\n                                .val()\r\n                            && \r\n                           !linha_item\r\n                                .find('.lista-operacao ul li a')\r\n                                .is(':focus')\r\n                            && \r\n                           !linha_item\r\n                                .find('.operacao-descricao')\r\n                                .val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tfechaListaPesquisa(input_group);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n            });\r\n\r\n            //Campo de filtro\r\n            $('.operacao-descricao').on({\r\n\r\n                keydown: function(e) {\r\n\r\n                    //Eventos após a escolha de um item\r\n                    if ( $(this).is('[readonly]') ) {\r\n\r\n                        //Deletar teclando 'Backspace' ou 'Delete'\r\n                        if ( (e.keyCode === 8) || (e.keyCode === 46) ) {\r\n\t\t\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t\t\t.nextAll('.btn-apagar-filtro-operacao')\r\n\t\t\t\t\t\t\t\t.click();\r\n                        }\r\n                    }\r\n                    else {\r\n\r\n                        //Pesquisar com 'Enter'\r\n                        if (e.keyCode === 13) {\r\n                            filtrarOperacao( $(this) );\r\n                        }\r\n                    }\r\n                },  \r\n                \r\n\t\t\t\tfocusout: function() {\r\n                    linha_item = $(this).parents('tr').first();\r\n                    click_item = $(this);\r\n                    \r\n\t\t\t\t\t//verificar quando o campo deve ser zerado\r\n\t\t\t\t\tif(tempo_focus) clearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif (\r\n                           !linha_item\r\n                                .find('input[field=\"item[operacao][]\"]')\r\n                                .val('') \r\n                            && \r\n\t\t\t\t\t\t\tclick_item\r\n                                .parent()\r\n                                .nextAll('.lista-operacao-container')\r\n                                .children('.lista-operacao')\r\n                                .is(':empty')\r\n                            &&\r\n                           !click_item\r\n                                .nextAll('.btn-filtro-operacao')\r\n                                .is(':focus') \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tclick_item\r\n                                .val('');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Filtrar Empresa\r\n     * @returns void\r\n     */\r\n    function filtroEmpresa() { \r\n        var tempo_focus;\r\n        var url;\r\n\r\n        function filtrarEmpresa( input_group, input, campo_id ) {\r\n            var result_itens;\r\n            var srlz        = $(input_group).find('select, input, textarea').serialize();\r\n            var btn_filtro  = input_group.find('.btn-filtro');           \r\n            \r\n\t\t\t//ajax\r\n\t\t\tvar type\t= \"POST\",\r\n\t\t\t\turl_act\t= url,\r\n\t\t\t\tdata\t= srlz,\r\n\t\t\t\tsuccess\t= function(data) {\r\n\r\n                    abreListaPesquisa( input_group );\r\n\r\n                    $('.lista-empresa')\r\n                        .html(data)\r\n                    ;\r\n\r\n                    //existem dados cadastrados\r\n                    if( data.indexOf('nao-cadastrado') === -1 ) {\r\n\r\n                        result_itens = $('ul.empresa li a');\r\n\r\n                        selecItemListaEmpresa( result_itens, input_group, input, campo_id);\r\n\r\n                        $(result_itens)\r\n                            .focusout(function() {\r\n\r\n                                if(tempo_focus) \r\n                                    clearTimeout(tempo_focus);\r\n\r\n                                tempo_focus = setTimeout(function() {\r\n\r\n                                    if( !$(result_itens).is(':focus') && \r\n                                        !$(input).is(':focus') && \r\n                                        !$(btn_filtro).is(':focus') \r\n                                    ) {\r\n                                        $(input).val('');\r\n                                        fechaListaPesquisa( input_group );\r\n                                    }\r\n\r\n                                }, 200);\r\n\r\n                            });\r\n\r\n                        $(input)\r\n                            .focusout(function() {\r\n\r\n                                if(tempo_focus) \r\n                                    clearTimeout(tempo_focus);\r\n\r\n                                tempo_focus = setTimeout(function() {\r\n\r\n                                    if( !$(result_itens).is(':focus') &&\r\n                                        !$(campo_id).val() && \r\n                                        !$(btn_filtro).is(':focus') \r\n                                    ) {\r\n                                        $(input).val('');\r\n                                        fechaListaPesquisa( input_group );\r\n                                    }\r\n\r\n                                }, 200);\r\n\r\n                            });\r\n                    }\r\n                    else {\r\n                        $(campo_id).val('');\r\n\r\n                        $(input)\r\n                            .focusout(function() {\r\n                                if( $('.pesquisa-res').children().children().hasClass('nao-cadastrado') ) {\r\n                                    $(input).val('');\r\n                                    fechaListaPesquisa( input_group );\r\n                                }\r\n                            });\r\n                    }\r\n                    bootstrapInit();\r\n                }\r\n\t\t\t;\r\n\t\t\t\t\r\n\t\t\texecAjax2(type, url_act, data, success, null, btn_filtro);\r\n\r\n        }\r\n\r\n        function selecItemListaEmpresa(itens, input_group, input, campo_id) { \r\n\t\t\t\r\n\t\t\t$(itens)\r\n\t\t\t\t.click(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n            \r\n\t\t\t\t\t$(input)\r\n\t\t\t\t\t\t.val( $(this).nextAll('.descricao').val() )\r\n\t\t\t\t\t\t.focus()\r\n                    ;\r\n\t\t\t\t\t\r\n\t\t\t\t\t$(campo_id)\r\n\t\t\t\t\t\t.val( $(this).nextAll('.codigo').val() )\r\n\t\t\t\t\t\t.trigger('change')\r\n                    ;\r\n                    \r\n\t\t\t\t\tselecionadoEmpresa(input,campo_id);\r\n\t\t\t\t\tfechaListaPesquisa( input_group );\r\n            });\r\n\r\n        }\r\n        \r\n\t\tfunction selecionadoEmpresa(input, campo_id) {\r\n            var btn_filtro         = input.nextAll('.btn-filtro');     \r\n\t\t\tvar btn_filtro_apagar  = input.nextAll('.btn-filtro-apagar'); \r\n\t\t\t\r\n\t\t\t$(input)\r\n\t\t\t\t.attr('readonly', true)\r\n            ;\r\n\t\t\r\n\t\t\t$(btn_filtro)\r\n\t\t\t\t.hide()\r\n            ;\r\n\r\n\t\t\t$(btn_filtro_apagar)\r\n\t\t\t\t.show()\r\n\t\t\t\t.click(function() {\r\n\r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.hide()\r\n\t\t\t\t\t\t.prev('button')\r\n\t\t\t\t\t\t.show()\r\n                    ;\r\n                    \r\n\t\t\t\t\t$(this)\r\n\t\t\t\t\t\t.siblings('input')\r\n\t\t\t\t\t\t.removeAttr('readonly')\r\n                        .val('')\r\n                    ;                    \r\n                    \r\n\t\t\t\t\tcampo_id.val('');             \r\n\t\t\t\t})\r\n            ;\r\n\t\t}      \r\n\r\n        /**\r\n         * Eventos para o filtro de CCusto.\r\n         */\r\n        function iniciarFiltroEmpresa() {\r\n            var linha_item;\r\n            var click_item;     \r\n                        \r\n\t\t\t//Se o item já estiver selecionado (tela de update), efetua as devidas ações.\r\n\t\t\t$('input[field=\"oc[empresa][]\"]').each(function() {\r\n                var input_ref;\r\n                var input_group;\r\n                var input;\r\n                \r\n                input_ref   = $(this).parent('div').attr('coluna');\r\n                input_group = $(this).parents('fieldset').first().find('td[coluna=\"'+input_ref+'\"]');\r\n                input       = input_group.find('input.empresa-descricao');\r\n\r\n\t\t\t\tif ( ( $(this).val() !== '' ) && ( $(this).val() > 0 ) ) {\r\n\t\t\t\r\n\t\t\t\t\tselecionadoEmpresa(\r\n\t\t\t\t\t\tinput,\r\n                        $(this)\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});            \r\n            \r\n            //Botão de filtrar\r\n            $('.btn-filtro-empresa').on({\r\n\r\n                click: function() {\r\n                    var input_group = $(this).parent('.input-group');\r\n                    var input_ref;\r\n                    var input_linha;\r\n                    var input;\r\n                    var campo_id;\r\n\r\n                    input_ref   = input_group.parents('td').first().attr('coluna');\r\n                    input_linha = input_group.parents('fieldset').first().find('div[coluna=\"'+input_ref+'\"]');\r\n                    input       = input_group.find('input.empresa-descricao');\r\n                    campo_id    = input_linha.find('input[field=\"oc[empresa][]\"]');      \r\n                                        \r\n                    if ( !campo_id.val() || !(campo_id.val() > 0) ) {\r\n                        url = \"/_13060/pesquisa\";\r\n                        filtrarEmpresa( input_group, input, campo_id );\r\n                    }\r\n                },\r\n                \r\n\t\t\t\tfocusout: function() {\r\n                    var input_group = $(this).parent('.input-group');\r\n                    var input_ref;\r\n                    var input_linha;\r\n                    var campo_id;\r\n\r\n                    input_ref   = input_group.parents('td').first().attr('coluna');\r\n                    input_linha = input_group.parents('fieldset').first().find('div[coluna=\"'+input_ref+'\"]');\r\n                    campo_id    = input_linha.find('input[field=\"oc[empresa][]\"]');   \r\n                    \r\n\t\t\t\t\tif(tempo_focus) \r\n\t\t\t\t\t\tclearTimeout(tempo_focus)\r\n                    ;\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif (\r\n                           (\r\n                           !(campo_id.val() > 0) ||\r\n                           !campo_id.val() \r\n                           )\r\n                            &&\r\n                            input_group\r\n                                .parent()\r\n                                .find('.pesquisa-res')\r\n                                .is(':empty')\r\n                        ) {\r\n                            input_group\r\n                                .find('input[type=\"search\"]')\r\n                                .val('')\r\n                            ;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( \r\n                           ( !(campo_id.val() > 0) || !campo_id.val() )\r\n                            && \r\n                           !input_group\r\n                                .parent()\r\n                                .find('.pesquisa-res ul li a')\r\n                                .is(':focus')\r\n                            && \r\n\t\t\t\t\t\t\tinput_group\r\n                                .find('input[type=\"search\"]')\r\n                                .val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tinput_group\r\n                                .find('input[type=\"search\"]')\r\n                                .val('')\r\n                            ;\r\n\t\t\t\t\t\t\tfechaListaPesquisa(input_group);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif ( \r\n                            ( !(campo_id.val() > 0) || !campo_id.val() )\r\n                            && \r\n                           !input_group\r\n                                .parent()\r\n                                .find('.pesquisa-res ul li a')\r\n                                .is(':focus')\r\n                            && \r\n                           !input_group\r\n                                .find('input[type=\"search\"]')\r\n                                .val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tfechaListaPesquisa(input_group);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n            });\r\n\r\n            //Campo de filtro\r\n            $('.empresa-descricao').on({\r\n\r\n                keydown: function(e) {\r\n\r\n                    var input_group = $(this).parent('.input-group');\r\n                    var input_ref;\r\n                    var input_linha;\r\n                    var campo_id;\r\n\r\n                    input_ref       = input_group.parents('td').first().attr('coluna');\r\n                    input_linha     = input_group.parents('fieldset').first().find('div[coluna=\"'+input_ref+'\"]');;\r\n                    campo_id        = input_linha.find('input[field=\"oc[empresa][]\"]');\r\n\r\n\r\n                        //Eventos após a escolha de um item\r\n                        if ( $(this).is('[readonly]') ) {\r\n\r\n                            //Deletar teclando 'Backspace' ou 'Delete'\r\n                            if ( (e.keyCode === 8) || (e.keyCode === 46) ) {\r\n                                $(this)\r\n                                    .nextAll('.btn-filtro-apagar')\r\n                                    .click();\r\n                            }\r\n                        }\r\n                        else {\r\n\r\n                            //Pesquisar com 'Enter'\r\n                            if (e.keyCode === 13) {\r\n                                url = \"/_13060/pesquisa\";\r\n                                filtrarEmpresa( input_group, $(this), campo_id );\r\n                            }\r\n                        }\r\n                },  \r\n                \r\n\t\t\t\tfocusout: function() {\r\n                    var input_group = $(this).parent('.input-group');\r\n                    var input_ref;\r\n                    var input_linha;\r\n                    var campo_id;\r\n\r\n                    input_ref   = input_group.parents('td').first().attr('coluna');\r\n                    input_linha = input_group.parents('fieldset').first().find('div[coluna=\"'+input_ref+'\"]');\r\n                    campo_id    = input_linha.find('input[field=\"oc[empresa][]\"]');                       \r\n                    \r\n                    \r\n                    \r\n                    linha_item = $(this).parents('tr').first();\r\n                    click_item = $(this);\r\n                    \r\n\t\t\t\t\t//verificar quando o campo deve ser zerado\r\n\t\t\t\t\tif(tempo_focus) clearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif (\r\n                           !campo_id\r\n                                .val('') \r\n                            && \r\n\t\t\t\t\t\t\t$(this)\r\n                                .parent()\r\n                                .nextAll('.pesquisa-res-container')\r\n                                .children('.pesquisa-res')\r\n                                .is(':empty')\r\n                            &&\r\n                           !$(this)\r\n                                .nextAll('.btn-filtro')\r\n                                .is(':focus') \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t$(this)\r\n                                .val('')\r\n                            ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n            });\r\n        }\r\n        \r\n\r\n        /**\r\n         * Eventos para o filtro de CCusto.\r\n         */\r\n        function iniciarFiltroTransp() {\r\n            var linha_item;\r\n            var click_item;     \r\n            \r\n\t\t\t//Se o item já estiver selecionado (tela de update), efetua as devidas ações.\r\n\t\t\t$('input[field=\"oc[transp][]\"]').each(function() {\r\n                var input_ref;\r\n                var input_group;\r\n                var input;\r\n                \r\n                input_ref   = $(this).parent('div').attr('coluna');\r\n                input_group = $(this).parents('fieldset').first().find('td[coluna=\"'+input_ref+'\"]');\r\n                input       = input_group.find('input.transp-descricao');\r\n\r\n\t\t\t\tif ( $(this).val() !== '' ) {\r\n\t\t\t\r\n\t\t\t\t\tselecionadoEmpresa(\r\n\t\t\t\t\t\tinput,\r\n                        $(this)\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});            \r\n            \r\n            //Botão de filtrar\r\n            $('.btn-filtro-transp').on({\r\n\r\n                click: function() {\r\n                    var input_group = $(this).parent('.input-group');\r\n                    var input_ref;\r\n                    var input_linha;\r\n                    var input;\r\n                    var campo_id;\r\n\r\n                    input_ref   = input_group.parents('td').first().attr('coluna');\r\n                    input_linha = input_group.parents('fieldset').first().find('div[coluna=\"'+input_ref+'\"]');\r\n                    input       = input_group.find('input.transp-descricao');\r\n                    campo_id    = input_linha.find('input[field=\"oc[transp][]\"]');      \r\n                    \r\n                    if ( !(campo_id.val() > 0) || !campo_id.val() ) {\r\n                        url = \"/_14010/pesquisa\";\r\n                        filtrarEmpresa( input_group, input, campo_id );\r\n                    }\r\n                },\r\n                \r\n\t\t\t\tfocusout: function() {\r\n                    var input_group = $(this).parent('.input-group');\r\n                    var input_ref;\r\n                    var input_linha;\r\n                    var campo_id;\r\n\r\n                    input_ref   = input_group.parents('td').first().attr('coluna');\r\n                    input_linha = input_group.parents('fieldset').first().find('div[coluna=\"'+input_ref+'\"]');\r\n                    campo_id    = input_linha.find('input[field=\"oc[transp][]\"]');   \r\n                    \r\n\t\t\t\t\tif(tempo_focus) \r\n\t\t\t\t\t\tclearTimeout(tempo_focus)\r\n                    ;\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif (\r\n                           ( !(campo_id.val() > 0) || !campo_id.val() )\r\n                            &&\r\n                            input_group\r\n                                .parent()\r\n                                .find('.pesquisa-res')\r\n                                .is(':empty')\r\n                        ) {\r\n                            input_group\r\n                                .find('input[type=\"search\"]')\r\n                                .val('')\r\n                            ;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( \r\n                           ( !(campo_id.val() > 0) || !campo_id.val() ) \r\n                            && \r\n                           !input_group\r\n                                .parent()\r\n                                .find('.pesquisa-res ul li a')\r\n                                .is(':focus')\r\n                            && \r\n\t\t\t\t\t\t\tinput_group\r\n                                .find('input[type=\"search\"]')\r\n                                .val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tinput_group\r\n                                .find('input[type=\"search\"]')\r\n                                .val('')\r\n                            ;\r\n\t\t\t\t\t\t\tfechaListaPesquisa(input_group);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif ( \r\n                           ( !(campo_id.val() > 0) || !campo_id.val() )\r\n                            && \r\n                           !input_group\r\n                                .parent()\r\n                                .find('.pesquisa-res ul li a')\r\n                                .is(':focus')\r\n                            && \r\n                           !input_group\r\n                                .find('input[type=\"search\"]')\r\n                                .val() \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tfechaListaPesquisa(input_group);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n            });\r\n\r\n            //Campo de filtro\r\n            $('.transp-descricao').on({\r\n\r\n                keydown: function(e) {\r\n\r\n                    var input_group = $(this).parent('.input-group');\r\n                    var input_ref;\r\n                    var input_linha;\r\n                    var campo_id;\r\n\r\n                    input_ref       = input_group.parents('td').first().attr('coluna');\r\n                    input_linha     = input_group.parents('fieldset').first().find('div[coluna=\"'+input_ref+'\"]');;\r\n                    campo_id        = input_linha.find('input[field=\"oc[transp][]\"]');\r\n\r\n\r\n                        //Eventos após a escolha de um item\r\n                        if ( $(this).is('[readonly]') ) {\r\n\r\n                            //Deletar teclando 'Backspace' ou 'Delete'\r\n                            if ( (e.keyCode === 8) || (e.keyCode === 46) ) {\r\n                                $(this)\r\n                                    .nextAll('.btn-filtro-apagar')\r\n                                    .click();\r\n                            }\r\n                        }\r\n                        else {\r\n\r\n                            //Pesquisar com 'Enter'\r\n                            if (e.keyCode === 13) {\r\n                                url = \"/_14010/pesquisa\";\r\n                                filtrarEmpresa( input_group, $(this), campo_id );\r\n                            }\r\n                        }\r\n                },  \r\n                \r\n\t\t\t\tfocusout: function() {\r\n                    var input_group = $(this).parent('.input-group');\r\n                    var input_ref;\r\n                    var input_linha;\r\n                    var campo_id;\r\n\r\n                    input_ref   = input_group.parents('td').first().attr('coluna');\r\n                    input_linha = input_group.parents('fieldset').first().find('div[coluna=\"'+input_ref+'\"]');\r\n                    campo_id    = input_linha.find('input[field=\"oc[transp][]\"]');                       \r\n                    \r\n                    \r\n                    \r\n                    linha_item = $(this).parents('tr').first();\r\n                    click_item = $(this);\r\n                    \r\n\t\t\t\t\t//verificar quando o campo deve ser zerado\r\n\t\t\t\t\tif(tempo_focus) clearTimeout(tempo_focus);\r\n\r\n\t\t\t\t\ttempo_focus = setTimeout(function() {\r\n\r\n\t\t\t\t\t\tif (\r\n                           !campo_id\r\n                                .val('') \r\n                            && \r\n\t\t\t\t\t\t\t$(this)\r\n                                .parent()\r\n                                .nextAll('.pesquisa-res-container')\r\n                                .children('.pesquisa-res')\r\n                                .is(':empty')\r\n                            &&\r\n                           !$(this)\r\n                                .nextAll('.btn-filtro')\r\n                                .is(':focus') \r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t$(this)\r\n                                .val('')\r\n                            ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n            });\r\n        }   \r\n        \r\n        iniciarFiltroEmpresa();\r\n        iniciarFiltroTransp();\r\n    }\r\n      \r\n    \r\n\r\n    { /** Setar o select para o input*/\r\n        function setSelectToInput() {\r\n            \r\n//\t\t\t$('.select-to-input').val().trigger('change');\r\n\t\t\t\r\n            $('.select-to-input').on('change', function() {\r\n//                var input_group = $(this).parent();\r\n\r\n                var input_name;\r\n                var input_id;\r\n\r\n                input_name      = $(this).attr('input-name');\r\n                input_id        = $('input[field=\"' + input_name + '\"]');  \r\n                input_id.val($(this).val());\r\n            });\r\n        }\r\n    }\r\n    \r\n    \r\n\t/** \r\n\t * Visualizar arquivo \r\n\t * */\r\n\tfunction visualizarArquivo() {\r\n\t\t\r\n        $('.view-arquivo').click(function() {\r\n\t\t\t\r\n            var arq     = $(this);\r\n            var arq_id  = $(arq).parent('.form-group').parent('.item-dinamico').children('.form-group').first().children('input[name=\"_vinculo_id[]\"]').val();\r\n\r\n\t\t\t//ajax\r\n\t\t\tvar type\t= 'POST',\r\n\t\t\t\turl\t\t= '/_13010/DownloadArquivo',\r\n\t\t        data\t= {'item': arq_id},\r\n\t\t\t\tsuccess\t= function(data) {\r\n\r\n\t\t        \tvar obj = JSON.parse(data);\r\n\r\n\t\t        \tvar nome= obj.nome;\r\n//\t\t        \tvar tamanho = obj.tamanho;\r\n\t\t\t\t\tvar tipo = nome.split(\".\").pop();\r\n\r\n\t\t\t\t\tvar vis_arq = $('.visualizar-arquivo');\r\n\t\t\t\r\n\t\t\t\t\t$(vis_arq)\r\n\t\t\t\t\t\t.children('a')\r\n\t\t\t\t\t\t.attr('href', '/assets/temp/'+nome)\r\n\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t.children('input.arquivo_nome_deletar')\r\n\t\t\t\t\t\t.val(nome)\r\n\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t.children('object')\r\n\t\t\t\t\t\t.attr('data', '/assets/temp/'+nome)\r\n\t\t\t\t\t\t.removeClass()\r\n\t\t\t\t\t\t.addClass(tipo)\r\n\t\t\t\t\t\t.parent()\t\t\t\t\r\n\t\t\t\t\t\t.fadeIn();\r\n\r\n\r\n\t\t        \tativarCliqueFecharArquivo();\r\n\t\t        }\r\n\t\t\t;\r\n\t\t\t\r\n\t\t    execAjax1(type, url, data, success, null, null, false);\r\n\t\t\t\r\n\t\t});\r\n\t} \r\n    \r\n    \r\n    function calcTotal() {\r\n        var total = 0;\r\n        var coluna;\r\n                {//Desmarca todos os campos required e input head\r\n                    $('input:radio, input:checkbox').each(function () {\r\n                        //código da coluna\r\n                        coluna = \r\n                        $(this) \t\t\t//<- botão do radio\r\n                            .parent()\t\t//<- label do radio\r\n                            .parent()\t\t//<- div radio\r\n                            .parent()\t\t//<- td\r\n                            .attr('coluna')\t//codigo coluna\r\n                        ;\t\r\n\r\n                        //remove required da coluna\r\n                        $('td[coluna=' + coluna + ']')\r\n                            .children('.form-group')\r\n                            .find('input, select')\r\n                            .removeAttr('required')\r\n                        ;\t\r\n\r\n                        //remove o name para que não seja enviado no submit\r\n                        $('div[coluna=' + coluna + ']')\t\t//<- coluna head\r\n                            .children()\t\t\t\t\t\t//<- filho da coluna\r\n                            .siblings('input')\t\t\t\t//<- irmãos input\r\n                            .each(function () {\t\t\t\t//<- todos os inputs\r\n                                $(this)\t\t\t\t\t\t//<- input\r\n                                    .removeAttr('name')\t\t//<- remove o atritubo name\r\n                                ;\r\n                            })\r\n                        ;\r\n                        \r\n                        //remove o required da operacao\r\n                        $(this)                             //<- botão do radio\r\n                            .parents('tr')                  //<- linha\r\n                            .first()                        //<- linha corrente\r\n                            .find('.operacao-descricao')    //<- input operacao\r\n                            .removeAttr('required')         //<= remove o atritubo required\r\n                        ;\r\n                        \r\n                        //remove o required do ipi\r\n                        $(this)                             //<- botão do radio\r\n                            .parents('tr')                  //<- linha\r\n                            .first()                        //<- linha corrente\r\n                            .find('.perc-ipi')              //<- input ipi\r\n                            .removeAttr('required')         //<= remove o atritubo required\r\n                        ;\r\n                        \r\n                        //remove o required da data entrega\r\n                        $(this)                             //<- botão do radio\r\n                            .parents('tr')                  //<- linha\r\n                            .first()                        //<- linha corrente\r\n                            .find('.data-entrega')          //<- input data entrega\r\n                            .removeAttr('required')         //<= remove o atritubo required\r\n                        ;\r\n                        \r\n                        \r\n                    });\t\t\r\n                }\r\n\r\n                $('input:radio, input:checkbox').each(function () {\t\t\r\n\r\n                    coluna = \r\n                    $(this) \t\t\t//<- botão do radio\r\n                        .parent()\t\t//<- label do radio\r\n                        .parent()\t\t//<- div radio\r\n                        .parent()\t\t//<- td\r\n                        .attr('coluna')\t//codigo coluna\r\n                    ;\t\r\n\r\n                    if ($(this).prop('checked')) {\r\n\r\n                        {//Calcula o total\r\n                            total = \r\n                            total +\r\n                            formataPadrao(\r\n                                $(this) \t\t\t  //<- botão do radio\r\n                                    .parent() \t\t  //<- label do radio\r\n                                    .children('span') //<- campo do valor\r\n                                    .text() \t\t  //<- valor\r\n                            );\t\t\r\n                        }\r\n\r\n                        $(this) \t\t\t \t\t\t\t//<- botão do radio\r\n                            .parent()\t\t\t\t\t\t//<- label do radio\r\n                            .siblings('input')\t\t\t\t//<- irmãos de label\r\n                            .each(function () {\t\t\t\t//<- todos os inputs\r\n                                $(this)\t\t\t\t\t\t//<- input\r\n                                    .attr('name',\t\t\t//<- atributo name\r\n                                        $(this)\t\t\t\t//<- input\r\n                                            .attr('field')\t//<- atributo field\r\n                                    );\r\n                            })\r\n                        ;\r\n\r\n                        {//Marca os campos required e campos input head\r\n                            \r\n                            //add required na coluna\r\n                            $('td[coluna=' + coluna + ']')\r\n                                .children('.form-group')\r\n                                .find('input, select')\r\n                                .attr('required',true)\r\n                            ;\r\n\r\n                            //add o atritubo name para ser enviado no submit\r\n                            $('div[coluna=' + coluna + ']')\r\n                                .children()\r\n                                .siblings('input')\r\n                                .each(function () {\t\t\t\t//<- todos os inputs\r\n                                    $(this)\t\t\t\t\t\t//<- input\r\n                                        .attr('name',\t\t\t//<- atributo name\r\n                                            $(this)\t\t\t\t//<- input\r\n                                                .attr('field')\t//<- atributo field\r\n                                        );\r\n                                })\r\n                            ;\r\n                            \r\n                            //add o required da operacao\r\n                            $(this)                             //<- botão do radio\r\n                                .parents('tr')                  //<- linha\r\n                                .first()                        //<- linha corrente\r\n                                .find('.operacao-descricao')    //<- input operacao\r\n                                .attr('required',true)          //<= add o atritubo required\r\n                            ;     \r\n                            \r\n                            //add o required do ipi\r\n                            $(this)                             //<- botão do radio\r\n                                .parents('tr')                  //<- linha\r\n                                .first()                        //<- linha corrente\r\n                                .find('.perc-ipi')              //<- input ipi\r\n                                .attr('required',true)          //<= add o atritubo required\r\n                            ;    \r\n                            \r\n                            //add o required da data entrega\r\n                            $(this)                             //<- botão do radio\r\n                                .parents('tr')                  //<- linha\r\n                                .first()                        //<- linha corrente\r\n                                .find('.data-entrega')          //<- input data entrega\r\n                                .attr('required',true)          //<= add o atritubo required\r\n                            ;                           \r\n                        }\r\n\r\n                    } else {\t\t\t\t\t\r\n\r\n                        $(this) \t\t \t\t//<- botão do radio\r\n                            .parent()\t\t\t//<- label do radio\r\n                            .siblings('input')\t//<- irmãos de label\r\n                            .each(function () {\t//<- todos os inputs\r\n                                $(this).removeAttr('name');\r\n                            })\r\n                        ;\r\n                    }\r\n\r\n                });\r\n\r\n                ( total > 0 ) ? $('button.js-gravar').removeAttr('disabled') : $('button.js-gravar').attr('disabled',true); \r\n\r\n                total = formataReal( total.toFixed(4) );\r\n                $('.total-calculado').text(total);\r\n    }\r\n    \r\n    function frete() {\r\n\t\tfunction verificarFrete(tipo) {\r\n\t\t\t//CIF\r\n\t\t\tif ( tipo === '1' ) {\r\n\t\t\t\t$('.frete-valor')\r\n\t\t\t\t\t.removeAttr('readonly')\r\n                ;\r\n            \r\n                $('input[field=\"oc[frete][]\"]').val('CIF');\r\n\t\t\t}\r\n\t\t\t//FOB\r\n\t\t\telse {\r\n\t\t\t\t\r\n\t\t\t\t$('.frete-valor')\r\n\t\t\t\t\t.attr('readonly', true)\r\n\t\t\t\t\t.val('0,00')\r\n                ;\r\n            \r\n                $('input[field=\"oc[frete][]\"]').val('FOB');\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tverificarFrete( $('.frete').val() );\r\n        \r\n\t\t$('.frete').change(function() {\r\n\t\t\tverificarFrete( $(this).val() );\t\t\t\r\n\t\t});   \r\n        \r\n        $('.frete-valor').change(function() {\r\n            $('input[field=\"oc[frete][]\"]').val( $(this).val() );\r\n        });\r\n    }\r\n    \r\n\t/**\r\n\t * Ativar Datatable.\r\n\t */\r\n\tfunction ativarDatatable() {\r\n\t\t\r\n\t\tvar data_table = $.extend({}, table_default);\r\n\t\t\tdata_table.scrollY = 'auto';             \r\n\r\n\t\t$('.table').DataTable(data_table);   \r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Passar entre itens com as teclas up/down.\r\n\t */\r\n\tfunction ativarTabSeta() {\r\n\r\n\t\t$(document)\r\n\t\t\t.on('keydown', '.pesquisa-res ul li a', 'down', function() {\r\n\t\t\t\t\r\n\t\t\t\t$.tabNext();\r\n\t\t\t\treturn false;\r\n\t\t\t\t\r\n\t\t\t})\r\n\t\t\t.on('keydown', '.pesquisa-res ul li a', 'up', function() {\r\n\t\t\t\t\r\n\t\t\t\t$.tabPrev();\r\n\t\t\t\treturn false;\r\n\t\t\t\r\n\t\t\t})\r\n\t\t\t.on('keydown', '.operacao-descricao, .transp-descricao', 'down', function() {\r\n\t\t\t\t\r\n\t\t\t\t$.tabNext();\r\n\t\t\t\treturn false;\r\n\t\t\t\t\r\n\t\t\t});\r\n\t\t\t\r\n\t}\r\n\t\r\n\tfunction replicarData() {\r\n\t\t\r\n\t\t$('.replicar-data-saida').click(function() {\r\n\t\t\t\r\n\t\t\tvar data_saida =\t$(this)\r\n\t\t\t\t\t\t\t\t\t.prev('.data-saida')\r\n\t\t\t\t\t\t\t\t\t.val()\r\n\t\t\t\t\t\t\t\t;\r\n\t\t\t\r\n\t\t\t$('.data-saida')\r\n\t\t\t\t.val(data_saida)\r\n\t\t\t;\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\t$('.replicar-data-entrega').click(function() {\r\n\t\t\t\r\n\t\t\tvar data_entrega =\t$(this)\r\n\t\t\t\t\t\t\t\t\t.prev('.data-entrega')\r\n\t\t\t\t\t\t\t\t\t.val()\r\n\t\t\t\t\t\t\t\t;\r\n\t\t\t\r\n\t\t\t$('.data-entrega')\r\n\t\t\t\t.val(data_entrega)\r\n\t\t\t;\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t}\r\n\t\r\n    frete();\r\n    calcTotal();\r\n    clickRadioItem();\r\n    iniciarFiltroOperacao();\r\n    filtroEmpresa();\r\n    setSelectToInput();\r\n\tvisualizarArquivo();\r\n\t//ativarDatatable();\r\n\t\r\n\t$(function() {\r\n\t\t\r\n\t\tativarTabSeta();\r\n\t\treplicarData();\r\n\t\t\r\n\t});\r\n\r\n})(jQuery);"]}