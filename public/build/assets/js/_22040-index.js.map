{"version":3,"sources":["_22040-index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_22040-index.js","sourcesContent":["(function($) {\n\nif(window.name === 'remessa-componente') {\n\twindow.close();\n} \n    \n    /**\n     * Funções do index\n     * @returns {void}\n     */\n    function index()\n    {   \n        \n        /**\n        * Realiza a chamada ajax\n        */\n        function reabrirTalao(id,talao_id,remessa_id,programacao_id) {           \n            var dados = {\n                id              : id,\n                talao_id        : talao_id,\n                remessa_id      : remessa_id,\n                programacao_id  : programacao_id\n\t\t\t};\n                    \n           function success(data) {\t\t\t\t\t\t\n               if(data) {\n                   var id;\n                    var selector;\n            \n                   $('div.modal-body').html(data);\n                        //selector.popUp();\n                        dataTableItens();\n                        dataTableEstacao();\n                        dataTableResize();\n                        bootstrapInit();\n\t\t\t\t\t\tativarBtnSwitch();\n\t\t\t\t\t\t//switchStatus();\n\t\t\t\t\t\t//selecAbaUp();\n                        //edit();\n                    showSuccess('Finalização do talão desfeita');\n               }\n           }\n           \n           function erro(data) {\n           }\n           \n            execAjax1('POST','/_22040/reabrirTalao',dados,success,erro);  \n           \n       }\n        \n        /**\n         * Carrega e configura tabela\n         * @returns {void}\n         */\n        function dataTable() {\n\n\t\t\tvar data_table\t\t\t= $.extend({}, table_default);\n                data_table.sScrollY = '65vh'; \n\t\t\t\t\n            $('.lista-obj')\n                .DataTable(data_table)\n            ;\n        }\n\n        /**\n         * Carrega e configura tabela de itens (show)\n         * @returns {void}\n         */\n        function dataTableItens() {\n\n            var data_table\t\t\t= $.extend({}, table_default);\n                data_table.sScrollY = 'auto'; \n                \n            $('.table-itens')\n                .DataTable(data_table)\n            ;\n        }\n        \n        /**\n         * Ativar Datatable nas tabelas menores.\n         */\n        function dataTableEstacao() {\n\n            var data_table\t\t\t= $.extend({}, table_default);\n                data_table.sScrollY = '197px';\n                \n            $('table.estacao').DataTable(data_table);\n        }        \n        \n        function dataTableResize()\n        {\n            $('#accordion').on('shown.bs.collapse', function () {\n\t\t\t\t\n                //setTimeout(function() {\n                $(this).trigger('resize');\n                //}, 300);\n            });            \n        }\n\n        /**\n         * Exibir (popup).\n         */\n        function show() {\n\n            var id;\n            var selector;\n\t\t\t\n            function imprimirConsumo() {\n                $('#imprimir-consumo').click(function(){\n                    $(this).button('loading');\n                    execAjax1('POST','/_22040/getPdfConsumo',{remessa_id : id, familia_id_consumo: $('#filtro-familia-id-consumo').val()},\n                        function success(data) {\t\t\t\t\t\t\n                            if(data) {\n                                printPdf(data);   \n                            }\n                        },null,\n                        function complete() {\n                            $('#imprimir-consumo').button('reset');\n                        }\n                    );\n                });\n            }\n            \n\t\t\t/**\n\t\t\t * Evento ao mudar o status.\n\t\t\t */\n\t\t\tfunction switchStatus() {\n\t\t\t\t\n\t\t\t\t$('.chk-switch')\n\t\t\t\t\t.on('switchChange.bootstrapSwitch', function(event, state) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif ( state ) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t/**\n\t\t\t * Evento ao selecionar a aba de UP\n\t\t\t */\n\t\t\tfunction selecAbaUp() {\n\t\t\t\t\n\t\t\t\t$('#ups-tab')\n\t\t\t\t\t.click(function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$('#ups')\n\t\t\t\t\t\t\t\t.trigger('resize')\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t\t\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t\t\n\t\t\t}\n\n            /**\n             * Realiza a chamada ajax\n             */\n            function carregarDados() {           \n\n                function success(data) {\t\t\t\t\t\t\n                    if(data) {\n                        $('.popup .modal-body').html(data);\n                        selector.popUp();\n                        dataTableItens();\n                        dataTableEstacao();\n                        dataTableResize();\n                        bootstrapInit();\n                        imprimirConsumo();\n\t\t\t\t\t\tativarBtnSwitch();\n\t\t\t\t\t\tswitchStatus();\n\t\t\t\t\t\tselecAbaUp();\n                        edit();\n                    }\n                }\n\n                execAjax1('GET','/_22040/show/'+id,null,success);\n            }\n\n            function clickItem() {\n\n                $('.btn-componente')\n                    .on('click',function(e){\n                        e.stopPropagation();\n                    })\n                ;\n\n                $('tr[data-remessa]')\n                    .click(function(){\n                        selector = $(this);\n                        id = selector.data('remessa');\n\t\t\t\t\t\t$('#modal-historico .historico-corpo').data('id',id);\n                        carregarDados();\n                    })\n                ;\n            }\n\n            clickItem();\n        }\n\n        /**\n         * Realiza filtros na OC\n         */\n        function filtrar() {\n\n            var qtd_por_pag   = 30;\n            var pagina_atual  = 1;\n            var pagina_inc    = 0;\n            var final_pag\t  = false;\n\n            /**\n             * Realiza a coleta dos dados<br/>\n             * Realiza a chamada ajax\n             */\n            function tratarDados() {\n\n                if( final_pag ) {\n                    pagina_atual = 1;\n                    pagina_inc = 0;\n                    return false;\n                }\n\n                var estabelecimento_id = $('.estab'       ).val();\n                var status             = $('#filter-status').val();\n                var perfil             = $('#filter-perfil').val();\n                var data_1             = $('.data-inicial').val();\n                var data_2             = $('.data-final'  ).val();\n                var pesquisa           = $('.pesquisa'    ).val();\n\n                var dados = {\n                    retorno            : 'view',\n                    qtd_por_pagina     : qtd_por_pag,\n                    pagina             : pagina_inc,\n                    estabelecimento_id : estabelecimento_id,\n                    data               : [data_1,data_2],\n                    status             : status,\n                    perfil\t\t\t   : perfil,\n                    filtro             : pesquisa\n    //                familia_id         : \n    //                remessa_id         : \n    //                remessa            : \n                };\n\n                //Ativa o botão de loading\n                $('.btn-oc-filtrar').button('loading');\n\n                execAjax1('POST','/_22040/filtrar',dados,\n                    function(data) { //Função success\n                        if(data) {\n                            $('.lista-obj tbody').append(data);\n                            show();\n                            bootstrapInit();\n                        } else {\n                            final_pag = true;\n                        }\n                    },     \n                    null, //Função error\n                    function() { //Função complete\n                        $('.btn-oc-filtrar').button('reset'); \n                    }\n                );\n            }\n\n            /**\n             * Realiza a parametrização inicial<br/>\n             * Realiza o acionamento da consulta\n             */\n            function acionarFiltro() {\n\n                var campo_pesquisa = $('.filtro-obj');\n                var btn_filtrar    = $('.btn-filtrar');\n                var scroll_timer   = 0;\n\n                btn_filtrar.click(function(){\n                    final_pag\t  = false;\n                    pagina_atual  = 1;\n                    pagina_inc    = 0;\n                    $('table.lista-obj tbody').empty();\n                    tratarDados();\n                });\n\n                campo_pesquisa.keyEnter(function(){\n                    final_pag\t  = false;\n                    pagina_atual  = 1;\n                    pagina_inc    = 0;\n                    $('table.lista-obj tbody').empty();\n                    tratarDados();\n                });\n\n                //carregar página com scroll\n                $('.dataTables_scrollBody').scroll(function() {\n\n                    if (popUpShowing) return false; \n\n                    var div = $(this);\n\n                    clearTimeout(scroll_timer);\n\n                    scroll_timer = setTimeout(function() {\n\n                        //final do scroll da tabela\n                        if( ( div.scrollTop() + div.height() ) >= div.children('table').height() ) {\n\n                            pagina_atual += 1;\n                            pagina_inc = pagina_atual * qtd_por_pag - qtd_por_pag;                        \n                            tratarDados();\n\n                        }\n                    }, 200);\n                });\n\n                //carregar página com clique\n                $('.carregar-pagina').click(function() {\n\n                    pagina_atual += 1;\n                    pagina_inc = pagina_atual * qtd_por_pag - qtd_por_pag;                                        \n                    tratarDados();\n                });            \n            }\n\n            acionarFiltro();\n            $('.btn-filtrar').trigger('click');\n        }\n        \n        $(document)\n            .on('click', '.btn-reabrir-talao', function() {\n                \n                id = parseInt($(this).data('id'));\n                talao_id = parseInt($(this).data('talao_id'));\n                remessa_id = parseInt($(this).data('remessa_id'));\n                programacao_id = parseInt($(this).data('programacao_id'));\n                \n                msg = $(this).data('msg');\n\n                addConfirme('Remessa','Deseja reabrir o talão '+talao_id+'?',[obtn_sim,obtn_cancelar],\n                    [\n                        {ret:1,func:function(){ reabrirTalao(id,talao_id,remessa_id,programacao_id);}}\n                    ]     \n                );\n                \n                \n            });\n        ;\n        \n        dataTable();\n        filtrar();\n    }\n\n    /**\n     * Funções do edit\n     * @returns {void}\n     */\n    function edit()\n    {\n        function ups()\n        {\n            function contextMenu()\n            {\n\n            }\n            \n            function checkBoxTr()\n            {\n                var table =  $('.up-container table');\n                \n                $(table)\n                    .on('change', 'tbody tr td input[type=\"checkbox\"]', function() {\n                        var tr = $(this).closest('tr');\n                    \n                        if ( $(this).is(':checked') ) {\n                            $(tr)\n                                .addClass('selected');\n                            ;\n                        } else {\n                            $(tr)\n                                .removeClass('selected');\n                            ;\n                        }\n                    })\n                ;\n\n                $(table)\n                    .on('click', 'tbody tr', function() {\n                        $(this)\n                            .find('input[type=\"checkbox\"]')\n                            .trigger('click')\n                        ;\n                    });\n                ;\t\n            }\n            \n            contextMenu();\n            checkBoxTr();\n        }\n        ups();\n    }\n    \n    \n\t$(function() {\n\t\tindex();\n\t});\n\t\n})(jQuery);"]}