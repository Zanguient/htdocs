{"version":3,"sources":["_22160.app.js","_22160.factory.consumo-baixado-transacao.js","_22160.factory.consumo-baixado-talao.js","_22160.factory.consumo-baixado-produto.js","_22160.factory.consumo-baixado-filtro.js","_22160.factory.consumo-baixar-balanca.js","_22160.factory.consumo-baixar-talao.js","_22160.factory.consumo-baixar-produto.js","_22160.factory.consumo-baixar-filtro.js","_22160.controller.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_22160.js","sourcesContent":["'use strict';\n\nangular\n\t.module('app', [\n\t\t'vs-repeat', \n        'gc-find',\n\t\t'gc-ajax',\n\t\t'gc-transform',\n\t\t'gc-form',\n\t\t'gc-utils'\n\t])\n;\n     ","angular\n    .module('app')\n    .factory('ConsumoBaixadoTransacao', ConsumoBaixadoTransacao);\n    \n\n\tConsumoBaixadoTransacao.$inject = [\n        '$ajax',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ConsumoBaixadoTransacao($ajax, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ConsumoBaixadoTransacao(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.ConsumoBaixadoTransacao = this; \n        \n        this.DADOS    = [];\n        this.SELECTED = {};\n        this.FILTRO = '';\n    }\n    \n\n    ConsumoBaixadoTransacao.prototype.pick = function(talao,setfocus) {\n        \n        var that = this;\n\n        if ( talao != undefined ) {\n        \n            this.SELECTED = talao;\n\n            if ( setfocus ) {\n                that.setFocus();\n            }\n        }\n    };\n    \n    ConsumoBaixadoTransacao.prototype.keypress = function($event) {\n\n        $event.preventDefault();\n         \n        \n        switch ($event.key) {\n\n            case 'Enter':\n\n                gScope.Balanca.open();\n\n                break;\n\n        }\n    };    \n    \n    ConsumoBaixadoTransacao.prototype.consultar = function() {\n        \n        var that = this;\n        \n        $ajax.post('/_22160/api/consumo-baixado/transacao',gScope.ConsumoBaixadoTalao.SELECTED,{progress: false}).then(function(response){\n            \n            gcCollection.merge(gScope.ConsumoBaixadoTransacao.DADOS, response, ['TIPO','CONSUMO_ID']);\n            \n        });\n    };    \n    \n    ConsumoBaixadoTransacao.prototype.delete = function(transacao) {\n        \n        var that = this;\n        \n        addConfirme('<h4>Confirmação</h4>',\n            'Deseja realmente excluir esta transação?',\n            [obtn_sim,obtn_nao],\n            [{ret:1,func:function(){\n                $rootScope.$apply(function(){\n                    \n                    var dados = {\n                        FILTRO: gScope.ConsumoBaixadoFiltro,\n                        FILTRO_TRANSACAO: gScope.ConsumoBaixadoTalao.SELECTED,\n                        DADOS: {\n                            ITENS : [transacao]\n                        }\n                    };        \n\n                    $ajax.post('/_22160/api/consumo-baixado/transacao/delete',dados,{progress: false}).then(function(response){\n\n                        gScope.ConsumoBaixadoFiltro.merge(response.DATA_RETURN.DADOS);\n                        gcCollection.merge(gScope.ConsumoBaixadoTransacao.DADOS, response.DATA_RETURN.TRANSACOES, ['TIPO','CONSUMO_ID']);\n\n                    });\n                    \n                });\n            }}]     \n        );        \n\n\n    };    \n\n    /**\n     * Return the constructor function\n     */\n    return ConsumoBaixadoTransacao;\n};","angular\n    .module('app')\n    .factory('ConsumoBaixadoTalao', ConsumoBaixadoTalao);\n    \n\n\tConsumoBaixadoTalao.$inject = [\n        '$ajax',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ConsumoBaixadoTalao($ajax, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ConsumoBaixadoTalao(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.ConsumoBaixadoTalao = this; \n        \n        this.DADOS    = [];\n        this.SELECTED = {};\n        this.FILTRO = '';\n    }\n    \n\n    ConsumoBaixadoTalao.prototype.pick = function(talao,setfocus) {\n        \n        var that = this;\n\n        if ( talao != undefined ) {\n        \n            this.SELECTED = talao;\n\n            if ( setfocus ) {\n                that.setFocus();\n            }\n            \n            gScope.ConsumoBaixadoTransacao.consultar();\n        }\n\n    };\n    \n    ConsumoBaixadoTalao.prototype.setFocus = function() {\n        \n        $timeout(function(){\n            $('.table-container.table-taloes .table-lc-body tr.selected:focusable').focus();\n        },50);                      \n    };\n    \n    \n    ConsumoBaixadoTalao.prototype.keypress = function($event) {\n\n        $event.preventDefault();\n         \n        \n        switch ($event.key) {\n\n            case 'Enter':\n\n                gScope.Balanca.open();\n\n                break;\n\n        }\n    };    \n    \n    ConsumoBaixadoTalao.prototype.confirm = function () {\n        var that = this;\n\n        var dados = {\n            FILTRO: gScope.ConsumoBaixadoFiltro,\n            FILTRO_TRANSACAO: {ESTOQUE_MINIMO_ID: that.SELECTED.ESTOQUE_MINIMO_ID},\n            DADOS: {\n                ITENS : [that.SELECTED],\n                QUANTIDADE : that.QUANTIDADE,\n                PECA_BARRAS : that.PECA_BARRAS\n            }\n        };\n        \n        var input = null;\n        \n        if ( that.PECA_BARRAS != undefined && that.PECA_BARRAS.length > 0 ) {\n            that.QUANTIDADE = null;   \n            input = that.Modal.inputPeca();\n        }\n        if ( that.QUANTIDADE != undefined && parseFloat(that.QUANTIDADE) > 0 ) {\n            that.PECA_BARRAS = '';\n            input = that.Modal.inputQuantidade();\n        }\n\n        that.Modal.enableButton(false);\n        \n        $ajax.post('/_22160/api/transacao/post',dados,{complete: function(){\n\n            that.Modal.enableButton(true);\n\n        }}).then(function(response){\n\n            gScope.ConsumoBaixadoFiltro.merge(response.DATA_RETURN.DADOS);\n            gcCollection.merge(gScope.ConsumoBaixadoTalao.DADOS,response.DATA_RETURN.TRANSACOES,['TIPO','TABELA_ID','TABELA_NIVEL']);\n            \n            input.focus();\n            input.val('');\n            \n            if ( that.SELECTED.ESTOQUE_NECESSIDADE <= 0 ) {\n                that.Modal.close(function(){\n                    gScope.ConsumoBaixadoTalao.setFocus();                  \n                });\n            }\n        },function(){\n            input.select();\n        });        \n    };\n    \n    ConsumoBaixadoTalao.prototype.imprimirEtiqueta = function() {\n\n        if ( this.SELECTED != undefined && this.SELECTED != {} ) {\n\n            $ajax.post('/_22160/api/etiqueta',{ITENS:[this.SELECTED]}).then(function(response){\n                postprint(response);\n            });        \n        }\n    };   \n\n    /**\n     * Return the constructor function\n     */\n    return ConsumoBaixadoTalao;\n};","angular\n    .module('app')\n    .factory('ConsumoBaixadoProduto', ConsumoBaixadoProduto);\n    \n\n\tConsumoBaixadoProduto.$inject = [\n        '$ajax',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ConsumoBaixadoProduto($ajax, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ConsumoBaixadoProduto(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.ConsumoBaixadoProduto = this; \n        \n        this.DADOS    = [];\n        this.SELECTED = {};\n        this.FILTRO = '';\n    }\n    \n\n    ConsumoBaixadoProduto.prototype.pick = function(talao,setfocus) {\n        \n        var that = this;\n\n        if ( talao != undefined ) {\n        \n            this.SELECTED = talao;\n\n            if ( setfocus ) {\n                that.setFocus();\n            }\n        }\n\n    };\n    \n    ConsumoBaixadoProduto.prototype.setFocus = function() {\n        \n        $timeout(function(){\n            $('.table-container.table-taloes .table-lc-body tr.selected:focusable').focus();\n        },50);                      \n    };\n    \n    \n    ConsumoBaixadoProduto.prototype.keypress = function($event) {\n\n        $event.preventDefault();\n         \n        \n        switch ($event.key) {\n\n            case 'Enter':\n\n                gScope.Reposicao.Modal.open();\n\n                break;\n\n        }\n    };    \n    \n    ConsumoBaixadoProduto.prototype.confirm = function () {\n        var that = this;\n\n        var dados = {\n            FILTRO: gScope.ConsumoBaixadoFiltro,\n            FILTRO_TRANSACAO: {ESTOQUE_MINIMO_ID: that.SELECTED.ESTOQUE_MINIMO_ID},\n            DADOS: {\n                ITENS : [that.SELECTED],\n                QUANTIDADE : that.QUANTIDADE,\n                PECA_BARRAS : that.PECA_BARRAS\n            }\n        };\n        \n        var input = null;\n        \n        if ( that.PECA_BARRAS != undefined && that.PECA_BARRAS.length > 0 ) {\n            that.QUANTIDADE = null;   \n            input = that.Modal.inputPeca();\n        }\n        if ( that.QUANTIDADE != undefined && parseFloat(that.QUANTIDADE) > 0 ) {\n            that.PECA_BARRAS = '';\n            input = that.Modal.inputQuantidade();\n        }\n\n        that.Modal.enableButton(false);\n        \n        $ajax.post('/_22160/api/transacao/post',dados,{complete: function(){\n\n            that.Modal.enableButton(true);\n\n        }}).then(function(response){\n\n            gScope.ConsumoBaixadoFiltro.merge(response.DATA_RETURN.DADOS);\n            gcCollection.merge(gScope.ConsumoBaixadoProduto.DADOS,response.DATA_RETURN.TRANSACOES,['TIPO','TABELA_ID','TABELA_NIVEL']);\n            \n            input.focus();\n            input.val('');\n            \n            if ( that.SELECTED.ESTOQUE_NECESSIDADE <= 0 ) {\n                that.Modal.close(function(){\n                    gScope.ConsumoBaixadoProduto.setFocus();                  \n                });\n            }\n        },function(){\n            input.select();\n        });        \n    };\n    \n\n    /**\n     * Return the constructor function\n     */\n    return ConsumoBaixadoProduto;\n};","angular\n    .module('app')\n    .factory('ConsumoBaixadoFiltro', ConsumoBaixadoFiltro);\n    \n\n\tConsumoBaixadoFiltro.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ConsumoBaixadoFiltro($ajax, $httpParamSerializer, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ConsumoBaixadoFiltro(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n        \n        this.DATA_1 = new Date(Clock.DATETIME_SERVER);\n        this.DATA_2 = new Date(Clock.DATETIME_SERVER);\n        this.CONSUMO_STATUS = \"= '1'\";\n\t\tgScope.ConsumoBaixadoFiltro = this; \n        \n    }\n    \n    ConsumoBaixadoFiltro.prototype.consultar = function() {\n        \n        var that = this;\n        \n//        loading('.main-ctrl');     \n        \n        this.DATAHORA = {\n            DATAHORA_1 : moment(this.DATA_1).format('YYYY.MM.DD 00:00:00'),\n            DATAHORA_2 : moment(this.DATA_2).format('YYYY.MM.DD 23:59:59')\n        };\n        \n        $ajax.post('/_22160/api/consumo-baixado',that,{progress: false}).then(function(response){\n            \n            that.merge(response);\n            \n//            loading('hide');\n            \n        });\n    };\n   \n    \n    ConsumoBaixadoFiltro.prototype.merge = function(response) {\n        \n        function isNumber(n) {\n            return !isNaN(parseFloat(n)) && isFinite(n);\n        }\n\n        for ( var i in response ) {\n            var item = response[i];\n            \n            for (var k in item){\n                if (item.hasOwnProperty(k)) {\n                    \n                    if ( isNumber(item[k]) && (String(item[k]).substr(0, 1) !== '0' || String(item[k]).indexOf('.') !== -1) ) {               \n                        item[k] = parseFloat(item[k]);\n                    }\n                }\n            }            \n        }\n\n        gcCollection.merge(gScope.ConsumoBaixadoTalao.DADOS, response, 'TALAO_ID');\n      \n        \n        \n        \n        /**\n         * Vinculo dos ConsumoBaixadoProdutos - Incio\n         */\n        \n        var produtos = gcCollection.groupBy(gScope.ConsumoBaixadoTalao.DADOS, [\n            'CONSUMO_PRODUTO_ID',\n            'CONSUMO_PRODUTO_DESCRICAO',\n            'CONSUMO_TAMANHO',\n            'CONSUMO_TAMANHO_DESCRICAO',\n            'CONSUMO_PROCESSO_LOCALIZACAO_ID'\n        ], 'TALOES',function(produto,talao){\n            \n            produto.TALAO_QUANTIDADE       == undefined ? produto.TALAO_QUANTIDADE       = 0 : '';\n            produto.QUANTIDADE_PROJECAO    == undefined ? produto.QUANTIDADE_PROJECAO    = 0 : '';\n            produto.QUANTIDADE_CONSUMO     == undefined ? produto.QUANTIDADE_CONSUMO     = 0 : '';\n            produto.QUANTIDADE_SALDO       == undefined ? produto.QUANTIDADE_SALDO       = 0 : '';                \n            \n            produto.TALAO_UM   == undefined ? produto.TALAO_UM   = talao.TALAO_UM   : '';\n            produto.CONSUMO_UM == undefined ? produto.CONSUMO_UM = talao.CONSUMO_UM : '';\n            \n            produto.TALAO_QUANTIDADE       += talao.TALAO_QUANTIDADE;\n            produto.QUANTIDADE_PROJECAO    += talao.QUANTIDADE_PROJECAO;\n            produto.QUANTIDADE_CONSUMO     += talao.QUANTIDADE_CONSUMO;\n            produto.QUANTIDADE_SALDO       += talao.QUANTIDADE_SALDO;\n            produto.CONSUMO_TOLERANCIA_MAX += talao.CONSUMO_TOLERANCIA_MAX;\n        });\n        \n        \n        gcCollection.merge(gScope.ConsumoBaixadoProduto.DADOS, produtos, ['CONSUMO_PRODUTO_ID','CONSUMO_TAMANHO']);\n        \n        /////\n                \n        \n    };\n\n    /**\n     * Return the constructor function\n     */\n    return ConsumoBaixadoFiltro;\n};","angular\n    .module('app')\n    .factory('ConsumoBaixarBalanca', ConsumoBaixarBalanca);\n    \n\n\tConsumoBaixarBalanca.$inject = [\n        '$ajax',\n        '$rootScope',\n        '$timeout',\n        '$q',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ConsumoBaixarBalanca($ajax, $rootScope, $timeout, $q, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ConsumoBaixarBalanca(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.ConsumoBaixarBalanca = this; \n        \n        var that = this;\n        \n        this.DADOS           = [];\n        this.SELECTED        = {};\n        this.PESO            = null;\n        this.PESO_AUTOMATICO = false;\n        this.FILTRO          = '';\n        this.ITENS_BAIXAR    = [];\n        this.OPERADOR_BARRAS = '';\n        this.OPERADOR_NOME   = '';\n        this.OPERADOR_ID     = 0;\n        \n        var balanca_timeout = null;     \n        \n        $('.gc-print-recebe-peso').click(function(){\n                        \n            var str = $(this).val();\n            var res = str.replace(\",\", \".\");                        \n            var value = parseFloat(res);\n            \n            var changed = false;\n\n            if ( that.PESO != value ) {\n                changed = true;\n            }\n                \n            $rootScope.$apply(function(){\n                                \n                that.PESO_AUTOMATICO = true;\n                that.PESO = parseFloat(value.toFixed(4));\n                \n                if ( changed ) {\n                    that.setItens();\n                }\n            });\n            \n            clearTimeout( balanca_timeout );\n\n            balanca_timeout = setTimeout(function(){\n                $rootScope.$apply(function(){                \n                    that.PESO_AUTOMATICO = false;\n                    that.PESO = null;\n                    \n                    if ( changed ) {\n                        that.setItens();\n                    }                    \n                });\n            },3000);            \n        });        \n        \n    }\n    \n    var modal = $('#modal-balanca');\n    var modalOperador = $('#modal-autenticar-operador');\n    \n    ConsumoBaixarBalanca.prototype.open = function() {\n        \n        var that = this;\n        if ( gScope.ConsumoBaixarTalao.SELECTED != undefined && gScope.ConsumoBaixarTalao.SELECTED != {} ) {\n            \n            this.SELECTED = gScope.ConsumoBaixarTalao.SELECTED;\n            comunicacao.conectar();\n            this.show(function(){\n                $('#balanca-quantidade-baixar:focusable').first().focus();\n            },function(){\n                $('.table-container.table-taloes tr.selected').first().focus();                \n                comunicacao.desconectar();\n                that.PESO_AUTOMATICO = false;\n                that.PESO = null;                \n            });\n        }\n        \n    };\n  \n\n    ConsumoBaixarBalanca.prototype.confirm = function () {\n\n        var that = this;\n\n        var dados = {\n            FILTRO   : gScope.ConsumoBaixarFiltro,\n            OPERADOR : {NOME: that.OPERADOR_NOME , ID: that.OPERADOR_ID},\n            DADOS    : {\n               ITENS : that.ITENS_BAIXAR,\n               PESO  : that.PESO\n            }\n        };\n        \n        \n        that.enableButton(false);\n        \n        $ajax.post('/_22160/api/consumo-baixar/post',dados,{complete: function(){\n                \n            that.enableButton(true);\n            \n        }}).then(function(response){\n        \n            postprint(response.ETIQUETAS);        \n        \n            gScope.ConsumoBaixarFiltro.merge(response.DATA_RETURN);\n            that.close();\n            \n        });        \n    };\n\n    ConsumoBaixarBalanca.prototype.operadorButton = function(bool) {\n        modalOperador.find('button').prop('disabled',!bool);\n    };\n\n    ConsumoBaixarBalanca.prototype.altenticarOperador = function (flag) {\n        var that = this;\n\n        var dados = {\n            COD_BARRAS : that.OPERADOR_BARRAS\n        };\n        \n        that.operadorButton(false);\n\n        $ajax.post('/_22160/api/operador',dados,{complete: function(){\n                \n            that.operadorButton(true);\n            \n        }}).then(function(response){\n            \n            if(Object.keys(response).length > 0){\n\n                if(response.PERMICAO == 1){\n\n                    that.OPERADOR_BARRAS = '';\n                    that.OPERADOR_ID     = response.CODIGO;\n                    that.OPERADOR_NOME   = response.NOME;\n\n                    modalOperador.modal('hide');\n\n                    if(flag = 1){\n                        that.confirm();\n                    }\n\n                }else{\n                    showErro('Operador não tem permissão.<br>' + response.DESCRICAO);\n                    that.OPERADOR_BARRAS = '';\n                    modalOperador.find('input').focus();   \n                }\n\n            }else{\n                showErro('Operador não encontrado!');\n                that.OPERADOR_BARRAS = '';\n                modalOperador.find('input').focus();\n            }           \n            \n        });    \n    };\n\n    ConsumoBaixarBalanca.prototype.modalOperador = function () {\n        that.OPERADOR_ID     = 0;\n        that.OPERADOR_BARRAS = '';\n        that.OPERADOR_NOME   = '';\n        \n        modalOperador.modal();\n\n        setTimeout(function(){\n            modalOperador.find('input').focus();\n        },300); \n    };\n\n    ConsumoBaixarBalanca.prototype.setItens = function () {\n        \n        this.ITENS_BAIXAR = [];\n        var array = this.ITENS_BAIXAR;\n        \n        if ( this.SELECTED.FILTERED == undefined ) {\n            array.push(this.SELECTED);\n        } else {\n            \n            var quantidade = 0;\n            for ( var i in this.SELECTED.FILTERED ) {\n                \n                var item = this.SELECTED.FILTERED[i];\n                \n                quantidade += item.QUANTIDADE_SALDO;\n                \n                if ( quantidade <= (this.PESO + item.QUANTIDADE_SALDO) ) {\n                    array.push(item);                    \n                } else {\n                    break;\n                }\n            }\n        }\n    };  \n\n    ConsumoBaixarBalanca.prototype.show = function(shown,hidden) {\n\n        modal\n            .modal('show')\n        ;                         \n        \n        if ( shown ) {\n            modal\n                .one('shown.bs.modal', function(){\n                    shown();\n                })\n            ;     \n        }\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden();\n                })\n            ;              \n        }\n    };\n\n    ConsumoBaixarBalanca.prototype.close = function(hidden) {\n\n        modal\n            .modal('hide')\n        ;\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden ? hidden() : '';\n                })\n            ;                      \n        }\n    };\n    \n    ConsumoBaixarBalanca.prototype.inputKeydown = function($event) {\n         \n        if ( this.PESO_AUTOMATICO ) {\n            if ( isNumber($event.key) || $event.key == 'Backspace' || $event.key == 'Delete' ) {\n                $event.preventDefault();\n            }\n        }\n    };\n    \n    ConsumoBaixarBalanca.prototype.enableButton = function(bool) {\n        modal.find('button').prop('disabled',!bool);\n    };\n \n       \n    function isNumber(o) {\n        return o == '' || !isNaN(o - 0);\n    }    \n    \n    \n    var time = null;\n    var comunicacao = {\n        conectar: function (){\n            \n            console.log('conectou');\n            $( \".gc-print-open-com\" )\n                .trigger( \"click\" )\n            ;\n\n            $( \".gc-print-set-config\" )\n                .trigger( \"click\" )\n            ;\n\n            time = setInterval(function(){ \n                $( \".gc-print-set-config\" )\n                    .trigger( \"click\" )\n                ;\n            },1000);\n        },\n        desconectar: function (){\n            \n            console.log('desconectou');\n            $( \".gc-print-close-com\" )\n                .trigger( \"click\" )\n            ;\n            clearInterval(time);\n        }\n    }    \n    \n    /**\n     * Return the constructor function\n     */\n    return ConsumoBaixarBalanca;\n};","angular\n    .module('app')\n    .factory('ConsumoBaixarTalao', ConsumoBaixarTalao);\n    \n\n\tConsumoBaixarTalao.$inject = [\n        '$ajax',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ConsumoBaixarTalao($ajax, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ConsumoBaixarTalao(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.ConsumoBaixarTalao = this; \n        \n        this.DADOS    = [];\n        this.SELECTED = {};\n        this.FILTRO = '';\n    }\n    \n\n    ConsumoBaixarTalao.prototype.pick = function(talao,setfocus) {\n        \n        var that = this;\n\n        if ( talao != undefined ) {\n        \n            this.SELECTED = talao;\n\n            if ( setfocus ) {\n                that.setFocus();\n            }\n        }\n\n    };\n    \n    ConsumoBaixarTalao.prototype.setFocus = function() {\n        \n        $timeout(function(){\n            $('.table-container.table-taloes .table-lc-body tr.selected:focusable').focus();\n        },50);                      \n    };\n    \n    \n    ConsumoBaixarTalao.prototype.keypress = function($event) {\n\n        $event.preventDefault();\n         \n        \n        switch ($event.key) {\n\n            case 'Enter':\n\n                gScope.ConsumoBaixarBalanca.open();\n\n                break;\n\n        }\n    };    \n    \n    ConsumoBaixarTalao.prototype.confirm = function () {\n\n        var that = this;\n\n        var dados = {\n            FILTRO: gScope.ConsumoBaixarFiltro,\n            FILTRO_TRANSACAO: {ESTOQUE_MINIMO_ID: that.SELECTED.ESTOQUE_MINIMO_ID},\n            DADOS: {\n                ITENS : [that.SELECTED],\n                QUANTIDADE : that.QUANTIDADE,\n                PECA_BARRAS : that.PECA_BARRAS\n            }\n        };\n        \n        var input = null;\n        \n        if ( that.PECA_BARRAS != undefined && that.PECA_BARRAS.length > 0 ) {\n            that.QUANTIDADE = null;   \n            input = that.Modal.inputPeca();\n        }\n        if ( that.QUANTIDADE != undefined && parseFloat(that.QUANTIDADE) > 0 ) {\n            that.PECA_BARRAS = '';\n            input = that.Modal.inputQuantidade();\n        }\n\n        that.Modal.enableButton(false);\n        \n        $ajax.post('/_22160/api/transacao/post',dados,{complete: function(){\n\n            that.Modal.enableButton(true);\n\n        }}).then(function(response){\n\n            gScope.ConsumoBaixarFiltro.merge(response.DATA_RETURN.DADOS);\n            gcCollection.merge(gScope.ConsumoBaixarTalao.DADOS,response.DATA_RETURN.TRANSACOES,['TIPO','TABELA_ID','TABELA_NIVEL']);\n            \n            input.focus();\n            input.val('');\n            \n            if ( that.SELECTED.ESTOQUE_NECESSIDADE <= 0 ) {\n                that.Modal.close(function(){\n                    gScope.ConsumoBaixarTalao.setFocus();                  \n                });\n            }\n        },function(){\n            input.select();\n        });        \n    };\n    \n\n    /**\n     * Return the constructor function\n     */\n    return ConsumoBaixarTalao;\n};","angular\n    .module('app')\n    .factory('ConsumoBaixarProduto', ConsumoBaixarProduto);\n    \n\n\tConsumoBaixarProduto.$inject = [\n        '$ajax',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ConsumoBaixarProduto($ajax, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ConsumoBaixarProduto(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.ConsumoBaixarProduto = this; \n        \n        this.DADOS    = [];\n        this.SELECTED = {};\n        this.FILTRO = '';\n    }\n    \n\n    ConsumoBaixarProduto.prototype.pick = function(talao,setfocus) {\n        \n        var that = this;\n\n        if ( talao != undefined ) {\n        \n            this.SELECTED = talao;\n\n            if ( setfocus ) {\n                that.setFocus();\n            }\n        }\n\n    };\n    \n    ConsumoBaixarProduto.prototype.setFocus = function() {\n        \n        $timeout(function(){\n            $('.table-container.table-taloes .table-lc-body tr.selected:focusable').focus();\n        },50);                      \n    };\n    \n    \n    ConsumoBaixarProduto.prototype.keypress = function($event) {\n\n        $event.preventDefault();\n         \n        \n        switch ($event.key) {\n\n            case 'Enter':\n\n                gScope.Reposicao.Modal.open();\n\n                break;\n\n        }\n    };    \n    \n    ConsumoBaixarProduto.prototype.confirm = function () {\n        var that = this;\n\n        var dados = {\n            FILTRO: gScope.ConsumoBaixarFiltro,\n            FILTRO_TRANSACAO: {ESTOQUE_MINIMO_ID: that.SELECTED.ESTOQUE_MINIMO_ID},\n            DADOS: {\n                ITENS : [that.SELECTED],\n                QUANTIDADE : that.QUANTIDADE,\n                PECA_BARRAS : that.PECA_BARRAS\n            }\n        };\n        \n        var input = null;\n        \n        if ( that.PECA_BARRAS != undefined && that.PECA_BARRAS.length > 0 ) {\n            that.QUANTIDADE = null;   \n            input = that.Modal.inputPeca();\n        }\n        if ( that.QUANTIDADE != undefined && parseFloat(that.QUANTIDADE) > 0 ) {\n            that.PECA_BARRAS = '';\n            input = that.Modal.inputQuantidade();\n        }\n\n        that.Modal.enableButton(false);\n        \n        $ajax.post('/_22160/api/transacao/post',dados,{complete: function(){\n\n            that.Modal.enableButton(true);\n\n        }}).then(function(response){\n\n            gScope.ConsumoBaixarFiltro.merge(response.DATA_RETURN.DADOS);\n            gcCollection.merge(gScope.ConsumoBaixarProduto.DADOS,response.DATA_RETURN.TRANSACOES,['TIPO','TABELA_ID','TABELA_NIVEL']);\n            \n            input.focus();\n            input.val('');\n            \n            if ( that.SELECTED.ESTOQUE_NECESSIDADE <= 0 ) {\n                that.Modal.close(function(){\n                    gScope.ConsumoBaixarProduto.setFocus();                  \n                });\n            }\n        },function(){\n            input.select();\n        });        \n    };\n    \n\n    /**\n     * Return the constructor function\n     */\n    return ConsumoBaixarProduto;\n};","angular\n    .module('app')\n    .factory('ConsumoBaixarFiltro', ConsumoBaixarFiltro);\n    \n\n\tConsumoBaixarFiltro.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        '$q',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ConsumoBaixarFiltro($ajax, $httpParamSerializer, $rootScope, $timeout, $q, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ConsumoBaixarFiltro(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n        this.CONSUMO_STATUS = \"= '0'\";\n        \n\t\tgScope.ConsumoBaixarFiltro = this; \n        \n    }\n    \n    ConsumoBaixarFiltro.prototype.consultar = function() {\n        \n        var that = this;\n            \n        \n        return $q(function(resolve,reject){\n\n            $ajax.post('/_22160/api/consumo-baixar',that,{progress: false}).then(function(response){\n\n                that.merge(response);\n                \n                resolve(response);\n\n            },function(e){\n                reject(e);\n            });\n\n        });\n    };\n   \n    \n    ConsumoBaixarFiltro.prototype.merge = function(response) {\n        \n        function isNumber(n) {\n            return !isNaN(parseFloat(n)) && isFinite(n);\n        }\n\n        for ( var i in response ) {\n            var item = response[i];\n            \n            for (var k in item){\n                if (item.hasOwnProperty(k)) {\n                    \n                    if ( isNumber(item[k]) && (String(item[k]).substr(0, 1) !== '0' || String(item[k]).indexOf('.') !== -1) ) {               \n                        item[k] = parseFloat(item[k]);\n                    }\n                }\n            }            \n        }\n\n        gcCollection.merge(gScope.ConsumoBaixarTalao.DADOS, response, 'TALAO_ID');\n      \n        \n        \n        \n        /**\n         * Vinculo dos ConsumoBaixarProdutos - Incio\n         */\n        \n        var produtos = gcCollection.groupBy(gScope.ConsumoBaixarTalao.DADOS, [\n            'CONSUMO_PRODUTO_ID',\n            'CONSUMO_PRODUTO_DESCRICAO',\n            'CONSUMO_TAMANHO',\n            'CONSUMO_TAMANHO_DESCRICAO',\n            'CONSUMO_PROCESSO_LOCALIZACAO_ID'\n        ], 'TALOES',function(produto,talao){\n            \n            produto.TALAO_QUANTIDADE       == undefined ? produto.TALAO_QUANTIDADE       = 0 : '';\n            produto.QUANTIDADE_PROJECAO    == undefined ? produto.QUANTIDADE_PROJECAO    = 0 : '';\n            produto.QUANTIDADE_CONSUMO     == undefined ? produto.QUANTIDADE_CONSUMO     = 0 : '';\n            produto.QUANTIDADE_SALDO       == undefined ? produto.QUANTIDADE_SALDO       = 0 : '';                \n            \n            produto.TALAO_UM   == undefined ? produto.TALAO_UM   = talao.TALAO_UM   : '';\n            produto.CONSUMO_UM == undefined ? produto.CONSUMO_UM = talao.CONSUMO_UM : '';\n            \n            produto.TALAO_QUANTIDADE       += talao.TALAO_QUANTIDADE;\n            produto.QUANTIDADE_PROJECAO    += talao.QUANTIDADE_PROJECAO;\n            produto.QUANTIDADE_CONSUMO     += talao.QUANTIDADE_CONSUMO;\n            produto.QUANTIDADE_SALDO       += talao.QUANTIDADE_SALDO;\n            produto.CONSUMO_TOLERANCIA_MAX += talao.CONSUMO_TOLERANCIA_MAX;\n        });\n        \n        \n        gcCollection.merge(gScope.ConsumoBaixarProduto.DADOS, produtos, ['CONSUMO_PRODUTO_ID','CONSUMO_TAMANHO']);\n        \n        /////\n                \n        \n    };\n\n    /**\n     * Return the constructor function\n     */\n    return ConsumoBaixarFiltro;\n};","angular\n    .module('app')\n    .value('gScope', {})\n    .controller('Ctrl', Ctrl);\n    \n    \n\tCtrl.$inject = [\n        '$scope',\n        '$timeout',\n        'gScope',\n        'ConsumoBaixarFiltro',\n        'ConsumoBaixarProduto',\n        'ConsumoBaixarTalao',\n        'ConsumoBaixarBalanca',\n        'ConsumoBaixadoFiltro',\n        'ConsumoBaixadoProduto',\n        'ConsumoBaixadoTalao',\n        'ConsumoBaixadoTransacao'\n    ];\n\n\tfunction Ctrl( \n        $scope, \n        $timeout, \n        gScope, \n        ConsumoBaixarFiltro, \n        ConsumoBaixarProduto,\n        ConsumoBaixarTalao, \n        ConsumoBaixarBalanca,\n        ConsumoBaixadoFiltro, \n        ConsumoBaixadoProduto,\n        ConsumoBaixadoTalao,\n        ConsumoBaixadoTransacao\n    ) {\n\n\t\tvar vm = this;\n\n\t\tvm.ConsumoBaixarFiltro  = new ConsumoBaixarFiltro();\n\t\tvm.ConsumoBaixarTalao   = new ConsumoBaixarTalao();\n\t\tvm.ConsumoBaixarProduto = new ConsumoBaixarProduto();\n\t\tvm.ConsumoBaixarBalanca = new ConsumoBaixarBalanca();\n\n\t\tvm.ConsumoBaixadoFiltro    = new ConsumoBaixadoFiltro();\n\t\tvm.ConsumoBaixadoTalao     = new ConsumoBaixadoTalao();\n\t\tvm.ConsumoBaixadoProduto   = new ConsumoBaixadoProduto();\n\t\tvm.ConsumoBaixadoTransacao = new ConsumoBaixadoTransacao();\n\n\n        loading('.main-ctrl');    \n        vm.ConsumoBaixarFiltro.consultar().then(function(){\n            loading('hide');\n        });\n\n\t}   \n  "]}