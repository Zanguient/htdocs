{"version":3,"sources":["ng-file-upload.min.js","_29012.app.js","_29012-index.component.js","_29012-index.service.js","_29012-index.controller.js","_29012-create.component.js","_29012-create.service.js","_29012-create.controller.js","_29012-info-geral.component.js","_29012-info-geral.service.js","_29012-info-geral.controller.js","_29012-tarefa.component.js","_29012-tarefa.service.js","_29012-tarefa.controller.js"],"names":[],"mappings":"AAAA;AACA;AACA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_29012.js","sourcesContent":["/*! 12.2.13 */\n!window.XMLHttpRequest||window.FileAPI&&FileAPI.shouldLoad||(window.XMLHttpRequest.prototype.setRequestHeader=function(a){return function(b,c){if(\"__setXHR_\"===b){var d=c(this);d instanceof Function&&d(this)}else a.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var ngFileUpload=angular.module(\"ngFileUpload\",[]);ngFileUpload.version=\"12.2.13\",ngFileUpload.service(\"UploadBase\",[\"$http\",\"$q\",\"$timeout\",function(a,b,c){function d(d){function e(a){j.notify&&j.notify(a),k.progressFunc&&c(function(){k.progressFunc(a)})}function h(a){return null!=d._start&&g?{loaded:a.loaded+d._start,total:d._file&&d._file.size||a.total,type:a.type,config:d,lengthComputable:!0,target:a.target}:a}function i(){a(d).then(function(a){if(g&&d._chunkSize&&!d._finished&&d._file){var b=d._file&&d._file.size||0;e({loaded:Math.min(d._end,b),total:b,config:d,type:\"progress\"}),f.upload(d,!0)}else d._finished&&delete d._finished,j.resolve(a)},function(a){j.reject(a)},function(a){j.notify(a)})}d.method=d.method||\"POST\",d.headers=d.headers||{};var j=d._deferred=d._deferred||b.defer(),k=j.promise;return d.disableProgress||(d.headers.__setXHR_=function(){return function(a){a&&a.upload&&a.upload.addEventListener&&(d.__XHR=a,d.xhrFn&&d.xhrFn(a),a.upload.addEventListener(\"progress\",function(a){a.config=d,e(h(a))},!1),a.upload.addEventListener(\"load\",function(a){a.lengthComputable&&(a.config=d,e(h(a)))},!1))}}),g?d._chunkSize&&d._end&&!d._finished?(d._start=d._end,d._end+=d._chunkSize,i()):d.resumeSizeUrl?a.get(d.resumeSizeUrl).then(function(a){d._start=d.resumeSizeResponseReader?d.resumeSizeResponseReader(a.data):parseInt((null==a.data.size?a.data:a.data.size).toString()),d._chunkSize&&(d._end=d._start+d._chunkSize),i()},function(a){throw a}):d.resumeSize?d.resumeSize().then(function(a){d._start=a,d._chunkSize&&(d._end=d._start+d._chunkSize),i()},function(a){throw a}):(d._chunkSize&&(d._start=0,d._end=d._start+d._chunkSize),i()):i(),k.success=function(a){return k.then(function(b){a(b.data,b.status,b.headers,d)}),k},k.error=function(a){return k.then(null,function(b){a(b.data,b.status,b.headers,d)}),k},k.progress=function(a){return k.progressFunc=a,k.then(null,null,function(b){a(b)}),k},k.abort=k.pause=function(){return d.__XHR&&c(function(){d.__XHR.abort()}),k},k.xhr=function(a){return d.xhrFn=function(b){return function(){b&&b.apply(k,arguments),a.apply(k,arguments)}}(d.xhrFn),k},f.promisesCount++,k[\"finally\"]&&k[\"finally\"]instanceof Function&&k[\"finally\"](function(){f.promisesCount--}),k}function e(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var f=this;f.promisesCount=0,this.isResumeSupported=function(){return window.Blob&&window.Blob.prototype.slice};var g=this.isResumeSupported();this.isUploadInProgress=function(){return f.promisesCount>0},this.rename=function(a,b){return a.ngfName=b,a},this.jsonBlob=function(a){null==a||angular.isString(a)||(a=JSON.stringify(a));var b=new window.Blob([a],{type:\"application/json\"});return b._ngfBlob=!0,b},this.json=function(a){return angular.toJson(a)},this.isFile=function(a){return null!=a&&(a instanceof window.Blob||a.flashId&&a.name&&a.size)},this.upload=function(a,b){function c(b,c){if(b._ngfBlob)return b;if(a._file=a._file||b,null!=a._start&&g){a._end&&a._end>=b.size&&(a._finished=!0,a._end=b.size);var d=b.slice(a._start,a._end||b.size);return d.name=b.name,d.ngfName=b.ngfName,a._chunkSize&&(c.append(\"_chunkSize\",a._chunkSize),c.append(\"_currentChunkSize\",a._end-a._start),c.append(\"_chunkNumber\",Math.floor(a._start/a._chunkSize)),c.append(\"_totalSize\",a._file.size)),d}return b}function h(b,d,e){if(void 0!==d)if(angular.isDate(d)&&(d=d.toISOString()),angular.isString(d))b.append(e,d);else if(f.isFile(d)){var g=c(d,b),i=e.split(\",\");i[1]&&(g.ngfName=i[1].replace(/^\\s+|\\s+$/g,\"\"),e=i[0]),a._fileKey=a._fileKey||e,b.append(e,g,g.ngfName||g.name)}else if(angular.isObject(d)){if(d.$$ngfCircularDetection)throw\"ngFileUpload: Circular reference in config.data. Make sure specified data for Upload.upload() has no circular reference: \"+e;d.$$ngfCircularDetection=!0;try{for(var j in d)if(d.hasOwnProperty(j)&&\"$$ngfCircularDetection\"!==j){var k=null==a.objectKey?\"[i]\":a.objectKey;d.length&&parseInt(j)>-1&&(k=null==a.arrayKey?k:a.arrayKey),h(b,d[j],e+k.replace(/[ik]/g,j))}}finally{delete d.$$ngfCircularDetection}}else b.append(e,d)}function i(){a._chunkSize=f.translateScalars(a.resumeChunkSize),a._chunkSize=a._chunkSize?parseInt(a._chunkSize.toString()):null,a.headers=a.headers||{},a.headers[\"Content-Type\"]=void 0,a.transformRequest=a.transformRequest?angular.isArray(a.transformRequest)?a.transformRequest:[a.transformRequest]:[],a.transformRequest.push(function(b){var c,d=new window.FormData;b=b||a.fields||{},a.file&&(b.file=a.file);for(c in b)if(b.hasOwnProperty(c)){var e=b[c];a.formDataAppender?a.formDataAppender(d,c,e):h(d,e,c)}return d})}return b||(a=e(a)),a._isDigested||(a._isDigested=!0,i()),d(a)},this.http=function(b){return b=e(b),b.transformRequest=b.transformRequest||function(b){return window.ArrayBuffer&&b instanceof window.ArrayBuffer||b instanceof window.Blob?b:a.defaults.transformRequest[0].apply(this,arguments)},b._chunkSize=f.translateScalars(b.resumeChunkSize),b._chunkSize=b._chunkSize?parseInt(b._chunkSize.toString()):null,d(b)},this.translateScalars=function(a){if(angular.isString(a)){if(a.search(/kb/i)===a.length-2)return parseFloat(1024*a.substring(0,a.length-2));if(a.search(/mb/i)===a.length-2)return parseFloat(1048576*a.substring(0,a.length-2));if(a.search(/gb/i)===a.length-2)return parseFloat(1073741824*a.substring(0,a.length-2));if(a.search(/b/i)===a.length-1)return parseFloat(a.substring(0,a.length-1));if(a.search(/s/i)===a.length-1)return parseFloat(a.substring(0,a.length-1));if(a.search(/m/i)===a.length-1)return parseFloat(60*a.substring(0,a.length-1));if(a.search(/h/i)===a.length-1)return parseFloat(3600*a.substring(0,a.length-1))}return a},this.urlToBlob=function(c){var d=b.defer();return a({url:c,method:\"get\",responseType:\"arraybuffer\"}).then(function(a){var b=new Uint8Array(a.data),e=a.headers(\"content-type\")||\"image/WebP\",f=new window.Blob([b],{type:e}),g=c.match(/.*\\/(.+?)(\\?.*)?$/);g.length>1&&(f.name=g[1]),d.resolve(f)},function(a){d.reject(a)}),d.promise},this.setDefaults=function(a){this.defaults=a||{}},this.defaults={},this.version=ngFileUpload.version}]),ngFileUpload.service(\"Upload\",[\"$parse\",\"$timeout\",\"$compile\",\"$q\",\"UploadExif\",function(a,b,c,d,e){function f(a,b,c){var e=[i.emptyPromise()];return angular.forEach(a,function(d,f){0===d.type.indexOf(\"image/jpeg\")&&i.attrGetter(\"ngfFixOrientation\",b,c,{$file:d})&&e.push(i.happyPromise(i.applyExifRotation(d),d).then(function(b){a.splice(f,1,b)}))}),d.all(e)}function g(a,b,c,e){var f=i.attrGetter(\"ngfResize\",b,c);if(!f||!i.isResizeSupported()||!a.length)return i.emptyPromise();if(f instanceof Function){var g=d.defer();return f(a).then(function(d){h(d,a,b,c,e).then(function(a){g.resolve(a)},function(a){g.reject(a)})},function(a){g.reject(a)})}return h(f,a,b,c,e)}function h(a,b,c,e,f){function g(d,g){if(0===d.type.indexOf(\"image\")){if(a.pattern&&!i.validatePattern(d,a.pattern))return;a.resizeIf=function(a,b){return i.attrGetter(\"ngfResizeIf\",c,e,{$width:a,$height:b,$file:d})};var j=i.resize(d,a);h.push(j),j.then(function(a){b.splice(g,1,a)},function(a){d.$error=\"resize\",(d.$errorMessages=d.$errorMessages||{}).resize=!0,d.$errorParam=(a?(a.message?a.message:a)+\": \":\"\")+(d&&d.name),f.$ngfValidations.push({name:\"resize\",valid:!1}),i.applyModelValidation(f,b)})}}for(var h=[i.emptyPromise()],j=0;j<b.length;j++)g(b[j],j);return d.all(h)}var i=e;return i.getAttrWithDefaults=function(a,b){if(null!=a[b])return a[b];var c=i.defaults[b];return null==c?c:angular.isString(c)?c:JSON.stringify(c)},i.attrGetter=function(b,c,d,e){var f=this.getAttrWithDefaults(c,b);if(!d)return f;try{return e?a(f)(d,e):a(f)(d)}catch(g){if(b.search(/min|max|pattern/i))return f;throw g}},i.shouldUpdateOn=function(a,b,c){var d=i.attrGetter(\"ngfModelOptions\",b,c);return d&&d.updateOn?d.updateOn.split(\" \").indexOf(a)>-1:!0},i.emptyPromise=function(){var a=d.defer(),c=arguments;return b(function(){a.resolve.apply(a,c)}),a.promise},i.rejectPromise=function(){var a=d.defer(),c=arguments;return b(function(){a.reject.apply(a,c)}),a.promise},i.happyPromise=function(a,c){var e=d.defer();return a.then(function(a){e.resolve(a)},function(a){b(function(){throw a}),e.resolve(c)}),e.promise},i.updateModel=function(c,d,e,h,j,k,l){function m(f,g,j,l,m){d.$$ngfPrevValidFiles=f,d.$$ngfPrevInvalidFiles=g;var n=f&&f.length?f[0]:null,o=g&&g.length?g[0]:null;c&&(i.applyModelValidation(c,f),c.$setViewValue(m?n:f)),h&&a(h)(e,{$files:f,$file:n,$newFiles:j,$duplicateFiles:l,$invalidFiles:g,$invalidFile:o,$event:k});var p=i.attrGetter(\"ngfModelInvalid\",d);p&&b(function(){a(p).assign(e,m?o:g)}),b(function(){})}function n(){function a(a,b){return a.name===b.name&&(a.$ngfOrigSize||a.size)===(b.$ngfOrigSize||b.size)&&a.type===b.type}function b(b){var c;for(c=0;c<r.length;c++)if(a(b,r[c]))return!0;for(c=0;c<s.length;c++)if(a(b,s[c]))return!0;return!1}if(j){q=[],t=[];for(var c=0;c<j.length;c++)b(j[c])?t.push(j[c]):q.push(j[c])}}function o(a){return angular.isArray(a)?a:[a]}function p(){function a(){b(function(){m(w?r.concat(v):v,w?s.concat(u):u,j,t,x)},z&&z.debounce?z.debounce.change||z.debounce:0)}var f=y?q:v;g(f,d,e,c).then(function(){y?i.validate(q,w?r.length:0,c,d,e).then(function(b){v=b.validsFiles,u=b.invalidsFiles,a()}):a()},function(){for(var b=0;b<f.length;b++){var c=f[b];if(\"resize\"===c.$error){var d=v.indexOf(c);d>-1&&(v.splice(d,1),u.push(c)),a()}}})}var q,r,s,t=[],u=[],v=[];r=d.$$ngfPrevValidFiles||[],s=d.$$ngfPrevInvalidFiles||[],c&&c.$modelValue&&(r=o(c.$modelValue));var w=i.attrGetter(\"ngfKeep\",d,e);q=(j||[]).slice(0),(\"distinct\"===w||i.attrGetter(\"ngfKeepDistinct\",d,e)===!0)&&n(d,e);var x=!w&&!i.attrGetter(\"ngfMultiple\",d,e)&&!i.attrGetter(\"multiple\",d);if(!w||q.length){i.attrGetter(\"ngfBeforeModelChange\",d,e,{$files:j,$file:j&&j.length?j[0]:null,$newFiles:q,$duplicateFiles:t,$event:k});var y=i.attrGetter(\"ngfValidateAfterResize\",d,e),z=i.attrGetter(\"ngfModelOptions\",d,e);i.validate(q,w?r.length:0,c,d,e).then(function(a){l?m(q,[],j,t,x):(z&&z.allowInvalid||y?v=q:(v=a.validFiles,u=a.invalidFiles),i.attrGetter(\"ngfFixOrientation\",d,e)&&i.isExifSupported()?f(v,d,e).then(function(){p()}):p())})}},i}]),ngFileUpload.directive(\"ngfSelect\",[\"$parse\",\"$timeout\",\"$compile\",\"Upload\",function(a,b,c,d){function e(a){var b=a.match(/Android[^\\d]*(\\d+)\\.(\\d+)/);if(b&&b.length>2){var c=d.defaults.androidFixMinorVersion||4;return parseInt(b[1])<4||parseInt(b[1])===c&&parseInt(b[2])<c}return-1===a.indexOf(\"Chrome\")&&/.*Windows.*Safari.*/.test(a)}function f(a,b,c,d,f,h,i,j){function k(){return\"input\"===b[0].tagName.toLowerCase()&&c.type&&\"file\"===c.type.toLowerCase()}function l(){return t(\"ngfChange\")||t(\"ngfSelect\")}function m(b){if(j.shouldUpdateOn(\"change\",c,a)){var e=b.__files_||b.target&&b.target.files,f=[];if(!e)return;for(var g=0;g<e.length;g++)f.push(e[g]);j.updateModel(d,c,a,l(),f.length?f:null,b)}}function n(a,d){function e(b){a.attr(\"id\",\"ngf-\"+b),d.attr(\"id\",\"ngf-label-\"+b)}for(var f=0;f<b[0].attributes.length;f++){var g=b[0].attributes[f];\"type\"!==g.name&&\"class\"!==g.name&&\"style\"!==g.name&&(\"id\"===g.name?(e(g.value),u.push(c.$observe(\"id\",e))):a.attr(g.name,g.value||\"required\"!==g.name&&\"multiple\"!==g.name?g.value:g.name))}}function o(){if(k())return b;var a=angular.element('<input type=\"file\">'),c=angular.element(\"<label>upload</label>\");return c.css(\"visibility\",\"hidden\").css(\"position\",\"absolute\").css(\"overflow\",\"hidden\").css(\"width\",\"0px\").css(\"height\",\"0px\").css(\"border\",\"none\").css(\"margin\",\"0px\").css(\"padding\",\"0px\").attr(\"tabindex\",\"-1\"),n(a,c),g.push({el:b,ref:c}),document.body.appendChild(c.append(a)[0]),a}function p(c){if(b.attr(\"disabled\"))return!1;if(!t(\"ngfSelectDisabled\",a)){var d=q(c);if(null!=d)return d;r(c);try{k()||document.body.contains(x[0])||(g.push({el:b,ref:x.parent()}),document.body.appendChild(x.parent()[0]),x.bind(\"change\",m))}catch(f){}return e(navigator.userAgent)?setTimeout(function(){x[0].click()},0):x[0].click(),!1}}function q(a){var b=a.changedTouches||a.originalEvent&&a.originalEvent.changedTouches;if(b){if(\"touchstart\"===a.type)return w=b[0].clientX,v=b[0].clientY,!0;if(\"touchend\"===a.type){var c=b[0].clientX,d=b[0].clientY;if(Math.abs(c-w)>20||Math.abs(d-v)>20)return a.stopPropagation(),a.preventDefault(),!1}return!0}}function r(b){j.shouldUpdateOn(\"click\",c,a)&&x.val()&&(x.val(null),j.updateModel(d,c,a,l(),null,b,!0))}function s(a){if(x&&!x.attr(\"__ngf_ie10_Fix_\")){if(!x[0].parentNode)return void(x=null);a.preventDefault(),a.stopPropagation(),x.unbind(\"click\");var b=x.clone();return x.replaceWith(b),x=b,x.attr(\"__ngf_ie10_Fix_\",\"true\"),x.bind(\"change\",m),x.bind(\"click\",s),x[0].click(),!1}x.removeAttr(\"__ngf_ie10_Fix_\")}var t=function(a,b){return j.attrGetter(a,c,b)};j.registerModelChangeValidator(d,c,a);var u=[];t(\"ngfMultiple\")&&u.push(a.$watch(t(\"ngfMultiple\"),function(){x.attr(\"multiple\",t(\"ngfMultiple\",a))})),t(\"ngfCapture\")&&u.push(a.$watch(t(\"ngfCapture\"),function(){x.attr(\"capture\",t(\"ngfCapture\",a))})),t(\"ngfAccept\")&&u.push(a.$watch(t(\"ngfAccept\"),function(){x.attr(\"accept\",t(\"ngfAccept\",a))})),u.push(c.$observe(\"accept\",function(){x.attr(\"accept\",t(\"accept\"))}));var v=0,w=0,x=b;k()||(x=o()),x.bind(\"change\",m),k()?b.bind(\"click\",r):b.bind(\"click touchstart touchend\",p),-1!==navigator.appVersion.indexOf(\"MSIE 10\")&&x.bind(\"click\",s),d&&d.$formatters.push(function(a){return(null==a||0===a.length)&&x.val()&&x.val(null),a}),a.$on(\"$destroy\",function(){k()||x.parent().remove(),angular.forEach(u,function(a){a()})}),h(function(){for(var a=0;a<g.length;a++){var b=g[a];document.body.contains(b.el[0])||(g.splice(a,1),b.ref.remove())}}),window.FileAPI&&window.FileAPI.ngfFixIE&&window.FileAPI.ngfFixIE(b,x,m)}var g=[];return{restrict:\"AEC\",require:\"?ngModel\",link:function(e,g,h,i){f(e,g,h,i,a,b,c,d)}}}]),function(){function a(a){return\"img\"===a.tagName.toLowerCase()?\"image\":\"audio\"===a.tagName.toLowerCase()?\"audio\":\"video\"===a.tagName.toLowerCase()?\"video\":/./}function b(b,c,d,e,f,g,h,i){function j(a){var g=b.attrGetter(\"ngfNoObjectUrl\",f,d);b.dataUrl(a,g)[\"finally\"](function(){c(function(){var b=(g?a.$ngfDataUrl:a.$ngfBlobUrl)||a.$ngfDataUrl;i?e.css(\"background-image\",\"url('\"+(b||\"\")+\"')\"):e.attr(\"src\",b),b?e.removeClass(\"ng-hide\"):e.addClass(\"ng-hide\")})})}c(function(){var c=d.$watch(f[g],function(c){var k=h;if(\"ngfThumbnail\"===g&&(k||(k={width:e[0].naturalWidth||e[0].clientWidth,height:e[0].naturalHeight||e[0].clientHeight}),0===k.width&&window.getComputedStyle)){var l=getComputedStyle(e[0]);l.width&&l.width.indexOf(\"px\")>-1&&l.height&&l.height.indexOf(\"px\")>-1&&(k={width:parseInt(l.width.slice(0,-2)),height:parseInt(l.height.slice(0,-2))})}return angular.isString(c)?(e.removeClass(\"ng-hide\"),i?e.css(\"background-image\",\"url('\"+c+\"')\"):e.attr(\"src\",c)):void(!c||!c.type||0!==c.type.search(a(e[0]))||i&&0!==c.type.indexOf(\"image\")?e.addClass(\"ng-hide\"):k&&b.isResizeSupported()?(k.resizeIf=function(a,e){return b.attrGetter(\"ngfResizeIf\",f,d,{$width:a,$height:e,$file:c})},b.resize(c,k).then(function(a){j(a)},function(a){throw a})):j(c))});d.$on(\"$destroy\",function(){c()})})}ngFileUpload.service(\"UploadDataUrl\",[\"UploadBase\",\"$timeout\",\"$q\",function(a,b,c){var d=a;return d.base64DataUrl=function(a){if(angular.isArray(a)){var b=c.defer(),e=0;return angular.forEach(a,function(c){d.dataUrl(c,!0)[\"finally\"](function(){if(e++,e===a.length){var c=[];angular.forEach(a,function(a){c.push(a.$ngfDataUrl)}),b.resolve(c,a)}})}),b.promise}return d.dataUrl(a,!0)},d.dataUrl=function(a,e){if(!a)return d.emptyPromise(a,a);if(e&&null!=a.$ngfDataUrl||!e&&null!=a.$ngfBlobUrl)return d.emptyPromise(e?a.$ngfDataUrl:a.$ngfBlobUrl,a);var f=e?a.$$ngfDataUrlPromise:a.$$ngfBlobUrlPromise;if(f)return f;var g=c.defer();return b(function(){if(window.FileReader&&a&&(!window.FileAPI||-1===navigator.userAgent.indexOf(\"MSIE 8\")||a.size<2e4)&&(!window.FileAPI||-1===navigator.userAgent.indexOf(\"MSIE 9\")||a.size<4e6)){var c=window.URL||window.webkitURL;if(c&&c.createObjectURL&&!e){var f;try{f=c.createObjectURL(a)}catch(h){return void b(function(){a.$ngfBlobUrl=\"\",g.reject()})}b(function(){if(a.$ngfBlobUrl=f,f){g.resolve(f,a),d.blobUrls=d.blobUrls||[],d.blobUrlsTotalSize=d.blobUrlsTotalSize||0,d.blobUrls.push({url:f,size:a.size}),d.blobUrlsTotalSize+=a.size||0;for(var b=d.defaults.blobUrlsMaxMemory||268435456,e=d.defaults.blobUrlsMaxQueueSize||200;(d.blobUrlsTotalSize>b||d.blobUrls.length>e)&&d.blobUrls.length>1;){var h=d.blobUrls.splice(0,1)[0];c.revokeObjectURL(h.url),d.blobUrlsTotalSize-=h.size}}})}else{var i=new FileReader;i.onload=function(c){b(function(){a.$ngfDataUrl=c.target.result,g.resolve(c.target.result,a),b(function(){delete a.$ngfDataUrl},1e3)})},i.onerror=function(){b(function(){a.$ngfDataUrl=\"\",g.reject()})},i.readAsDataURL(a)}}else b(function(){a[e?\"$ngfDataUrl\":\"$ngfBlobUrl\"]=\"\",g.reject()})}),f=e?a.$$ngfDataUrlPromise=g.promise:a.$$ngfBlobUrlPromise=g.promise,f[\"finally\"](function(){delete a[e?\"$$ngfDataUrlPromise\":\"$$ngfBlobUrlPromise\"]}),f},d}]),ngFileUpload.directive(\"ngfSrc\",[\"Upload\",\"$timeout\",function(a,c){return{restrict:\"AE\",link:function(d,e,f){b(a,c,d,e,f,\"ngfSrc\",a.attrGetter(\"ngfResize\",f,d),!1)}}}]),ngFileUpload.directive(\"ngfBackground\",[\"Upload\",\"$timeout\",function(a,c){return{restrict:\"AE\",link:function(d,e,f){b(a,c,d,e,f,\"ngfBackground\",a.attrGetter(\"ngfResize\",f,d),!0)}}}]),ngFileUpload.directive(\"ngfThumbnail\",[\"Upload\",\"$timeout\",function(a,c){return{restrict:\"AE\",link:function(d,e,f){var g=a.attrGetter(\"ngfSize\",f,d);b(a,c,d,e,f,\"ngfThumbnail\",g,a.attrGetter(\"ngfAsBackground\",f,d))}}}]),ngFileUpload.config([\"$compileProvider\",function(a){a.imgSrcSanitizationWhitelist&&a.imgSrcSanitizationWhitelist(/^\\s*(https?|ftp|mailto|tel|webcal|local|file|data|blob):/),a.aHrefSanitizationWhitelist&&a.aHrefSanitizationWhitelist(/^\\s*(https?|ftp|mailto|tel|webcal|local|file|data|blob):/)}]),ngFileUpload.filter(\"ngfDataUrl\",[\"UploadDataUrl\",\"$sce\",function(a,b){return function(c,d,e){if(angular.isString(c))return b.trustAsResourceUrl(c);var f=c&&((d?c.$ngfDataUrl:c.$ngfBlobUrl)||c.$ngfDataUrl);return c&&!f?(!c.$ngfDataUrlFilterInProgress&&angular.isObject(c)&&(c.$ngfDataUrlFilterInProgress=!0,a.dataUrl(c,d)),\"\"):(c&&delete c.$ngfDataUrlFilterInProgress,(c&&f?e?b.trustAsResourceUrl(f):f:c)||\"\")}}])}(),ngFileUpload.service(\"UploadValidate\",[\"UploadDataUrl\",\"$q\",\"$timeout\",function(a,b,c){function d(a){var b=\"\",c=[];if(a.length>2&&\"/\"===a[0]&&\"/\"===a[a.length-1])b=a.substring(1,a.length-1);else{var e=a.split(\",\");if(e.length>1)for(var f=0;f<e.length;f++){var g=d(e[f]);g.regexp?(b+=\"(\"+g.regexp+\")\",f<e.length-1&&(b+=\"|\")):c=c.concat(g.excludes)}else 0===a.indexOf(\"!\")?c.push(\"^((?!\"+d(a.substring(1)).regexp+\").)*$\"):(0===a.indexOf(\".\")&&(a=\"*\"+a),b=\"^\"+a.replace(new RegExp(\"[.\\\\\\\\+*?\\\\[\\\\^\\\\]$(){}=!<>|:\\\\-]\",\"g\"),\"\\\\$&\")+\"$\",b=b.replace(/\\\\\\*/g,\".*\").replace(/\\\\\\?/g,\".\"))}return{regexp:b,excludes:c}}function e(a,b){null==b||a.$dirty||(a.$setDirty?a.$setDirty():a.$dirty=!0)}var f=a;return f.validatePattern=function(a,b){if(!b)return!0;var c=d(b),e=!0;if(c.regexp&&c.regexp.length){var f=new RegExp(c.regexp,\"i\");e=null!=a.type&&f.test(a.type)||null!=a.name&&f.test(a.name)}for(var g=c.excludes.length;g--;){var h=new RegExp(c.excludes[g],\"i\");e=e&&(null==a.type||h.test(a.type))&&(null==a.name||h.test(a.name))}return e},f.ratioToFloat=function(a){var b=a.toString(),c=b.search(/[x:]/i);return b=c>-1?parseFloat(b.substring(0,c))/parseFloat(b.substring(c+1)):parseFloat(b)},f.registerModelChangeValidator=function(a,b,c){a&&a.$formatters.push(function(d){if(a.$dirty){var e=d;d&&!angular.isArray(d)&&(e=[d]),f.validate(e,0,a,b,c).then(function(){f.applyModelValidation(a,e)})}return d})},f.applyModelValidation=function(a,b){e(a,b),angular.forEach(a.$ngfValidations,function(b){a.$setValidity(b.name,b.valid)})},f.getValidationAttr=function(a,b,c,d,e){var g=\"ngf\"+c[0].toUpperCase()+c.substr(1),h=f.attrGetter(g,a,b,{$file:e});if(null==h&&(h=f.attrGetter(\"ngfValidate\",a,b,{$file:e}))){var i=(d||c).split(\".\");h=h[i[0]],i.length>1&&(h=h&&h[i[1]])}return h},f.validate=function(a,c,d,e,g){function h(b,c,h){if(a){for(var i=a.length,j=null;i--;){var n=a[i];if(n){var o=f.getValidationAttr(e,g,b,c,n);null!=o&&(h(n,o,i)||(-1===k.indexOf(b)?(n.$error=b,(n.$errorMessages=n.$errorMessages||{})[b]=!0,n.$errorParam=o,-1===m.indexOf(n)&&m.push(n),l||a.splice(i,1),j=!1):a.splice(i,1)))}}null!==j&&d.$ngfValidations.push({name:b,valid:j})}}function i(c,h,i,n,o){function p(b,d,e){function f(f){if(f())if(-1===k.indexOf(c)){if(d.$error=c,(d.$errorMessages=d.$errorMessages||{})[c]=!0,d.$errorParam=e,-1===m.indexOf(d)&&m.push(d),!l){var g=a.indexOf(d);g>-1&&a.splice(g,1)}b.resolve(!1)}else{var h=a.indexOf(d);h>-1&&a.splice(h,1),b.resolve(!0)}else b.resolve(!0)}null!=e?n(d,e).then(function(a){f(function(){return!o(a,e)})},function(){f(function(){return j(\"ngfValidateForce\",{$file:d})})}):b.resolve(!0)}var q=[f.emptyPromise(!0)];a&&(a=void 0===a.length?[a]:a,angular.forEach(a,function(a){var d=b.defer();return q.push(d.promise),!i||null!=a.type&&0===a.type.search(i)?void(\"dimensions\"===c&&null!=f.attrGetter(\"ngfDimensions\",e)?f.imageDimensions(a).then(function(b){p(d,a,j(\"ngfDimensions\",{$file:a,$width:b.width,$height:b.height}))},function(){d.resolve(!1)}):\"duration\"===c&&null!=f.attrGetter(\"ngfDuration\",e)?f.mediaDuration(a).then(function(b){p(d,a,j(\"ngfDuration\",{$file:a,$duration:b}))},function(){d.resolve(!1)}):p(d,a,f.getValidationAttr(e,g,c,h,a))):void d.resolve(!0)}));var r=b.defer();return b.all(q).then(function(a){for(var b=!0,e=0;e<a.length;e++)if(!a[e]){b=!1;break}d.$ngfValidations.push({name:c,valid:b}),r.resolve(b)}),r.promise}d=d||{},d.$ngfValidations=d.$ngfValidations||[],angular.forEach(d.$ngfValidations,function(a){a.valid=!0});var j=function(a,b){return f.attrGetter(a,e,g,b)},k=(f.attrGetter(\"ngfIgnoreInvalid\",e,g)||\"\").split(\" \"),l=f.attrGetter(\"ngfRunAllValidations\",e,g);if(null==a||0===a.length)return f.emptyPromise({validFiles:a,invalidFiles:[]});a=void 0===a.length?[a]:a.slice(0);var m=[];h(\"pattern\",null,f.validatePattern),h(\"minSize\",\"size.min\",function(a,b){return a.size+.1>=f.translateScalars(b)}),h(\"maxSize\",\"size.max\",function(a,b){return a.size-.1<=f.translateScalars(b)});var n=0;if(h(\"maxTotalSize\",null,function(b,c){return n+=b.size,n>f.translateScalars(c)?(a.splice(0,a.length),!1):!0}),h(\"validateFn\",null,function(a,b){return b===!0||null===b||\"\"===b}),!a.length)return f.emptyPromise({validFiles:[],invalidFiles:m});var o=b.defer(),p=[];return p.push(i(\"maxHeight\",\"height.max\",/image/,this.imageDimensions,function(a,b){return a.height<=b})),p.push(i(\"minHeight\",\"height.min\",/image/,this.imageDimensions,function(a,b){return a.height>=b})),p.push(i(\"maxWidth\",\"width.max\",/image/,this.imageDimensions,function(a,b){return a.width<=b})),p.push(i(\"minWidth\",\"width.min\",/image/,this.imageDimensions,function(a,b){return a.width>=b})),p.push(i(\"dimensions\",null,/image/,function(a,b){return f.emptyPromise(b)},function(a){return a})),p.push(i(\"ratio\",null,/image/,this.imageDimensions,function(a,b){for(var c=b.toString().split(\",\"),d=!1,e=0;e<c.length;e++)Math.abs(a.width/a.height-f.ratioToFloat(c[e]))<.01&&(d=!0);return d})),p.push(i(\"maxRatio\",\"ratio.max\",/image/,this.imageDimensions,function(a,b){return a.width/a.height-f.ratioToFloat(b)<1e-4})),p.push(i(\"minRatio\",\"ratio.min\",/image/,this.imageDimensions,function(a,b){return a.width/a.height-f.ratioToFloat(b)>-1e-4})),p.push(i(\"maxDuration\",\"duration.max\",/audio|video/,this.mediaDuration,function(a,b){return a<=f.translateScalars(b)})),p.push(i(\"minDuration\",\"duration.min\",/audio|video/,this.mediaDuration,function(a,b){return a>=f.translateScalars(b)})),p.push(i(\"duration\",null,/audio|video/,function(a,b){return f.emptyPromise(b)},function(a){return a})),p.push(i(\"validateAsyncFn\",null,null,function(a,b){return b},function(a){return a===!0||null===a||\"\"===a})),b.all(p).then(function(){if(l)for(var b=0;b<a.length;b++){var d=a[b];d.$error&&a.splice(b--,1)}l=!1,h(\"maxFiles\",null,function(a,b,d){return b>c+d}),o.resolve({validFiles:a,invalidFiles:m})}),o.promise},f.imageDimensions=function(a){if(a.$ngfWidth&&a.$ngfHeight){var d=b.defer();return c(function(){d.resolve({width:a.$ngfWidth,height:a.$ngfHeight})}),d.promise}if(a.$ngfDimensionPromise)return a.$ngfDimensionPromise;var e=b.defer();return c(function(){return 0!==a.type.indexOf(\"image\")?void e.reject(\"not image\"):void f.dataUrl(a).then(function(b){function d(){var b=h[0].naturalWidth||h[0].clientWidth,c=h[0].naturalHeight||h[0].clientHeight;h.remove(),a.$ngfWidth=b,a.$ngfHeight=c,e.resolve({width:b,height:c})}function f(){h.remove(),e.reject(\"load error\")}function g(){c(function(){h[0].parentNode&&(h[0].clientWidth?d():i++>10?f():g())},1e3)}var h=angular.element(\"<img>\").attr(\"src\",b).css(\"visibility\",\"hidden\").css(\"position\",\"fixed\").css(\"max-width\",\"none !important\").css(\"max-height\",\"none !important\");h.on(\"load\",d),h.on(\"error\",f);var i=0;g(),angular.element(document.getElementsByTagName(\"body\")[0]).append(h)},function(){e.reject(\"load error\")})}),a.$ngfDimensionPromise=e.promise,a.$ngfDimensionPromise[\"finally\"](function(){delete a.$ngfDimensionPromise}),a.$ngfDimensionPromise},f.mediaDuration=function(a){if(a.$ngfDuration){var d=b.defer();return c(function(){d.resolve(a.$ngfDuration)}),d.promise}if(a.$ngfDurationPromise)return a.$ngfDurationPromise;var e=b.defer();return c(function(){return 0!==a.type.indexOf(\"audio\")&&0!==a.type.indexOf(\"video\")?void e.reject(\"not media\"):void f.dataUrl(a).then(function(b){function d(){var b=h[0].duration;a.$ngfDuration=b,h.remove(),e.resolve(b)}function f(){h.remove(),e.reject(\"load error\")}function g(){c(function(){h[0].parentNode&&(h[0].duration?d():i>10?f():g())},1e3)}var h=angular.element(0===a.type.indexOf(\"audio\")?\"<audio>\":\"<video>\").attr(\"src\",b).css(\"visibility\",\"none\").css(\"position\",\"fixed\");h.on(\"loadedmetadata\",d),h.on(\"error\",f);var i=0;g(),angular.element(document.body).append(h)},function(){e.reject(\"load error\")})}),a.$ngfDurationPromise=e.promise,a.$ngfDurationPromise[\"finally\"](function(){delete a.$ngfDurationPromise}),a.$ngfDurationPromise},f}]),ngFileUpload.service(\"UploadResize\",[\"UploadValidate\",\"$q\",function(a,b){var c=a,d=function(a,b,c,d,e){var f=e?Math.max(c/a,d/b):Math.min(c/a,d/b);return{width:a*f,height:b*f,marginX:a*f-c,marginY:b*f-d}},e=function(a,e,f,g,h,i,j,k){var l=b.defer(),m=document.createElement(\"canvas\"),n=document.createElement(\"img\");return n.setAttribute(\"style\",\"visibility:hidden;position:fixed;z-index:-100000\"),document.body.appendChild(n),n.onload=function(){var a=n.width,b=n.height;if(n.parentNode.removeChild(n),null!=k&&k(a,b)===!1)return void l.reject(\"resizeIf\");try{if(i){var o=c.ratioToFloat(i),p=a/b;o>p?(e=a,f=e/o):(f=b,e=f*o)}e||(e=a),f||(f=b);var q=d(a,b,e,f,j);m.width=Math.min(q.width,e),m.height=Math.min(q.height,f);var r=m.getContext(\"2d\");r.drawImage(n,Math.min(0,-q.marginX/2),Math.min(0,-q.marginY/2),q.width,q.height),l.resolve(m.toDataURL(h||\"image/WebP\",g||.934))}catch(s){l.reject(s)}},n.onerror=function(){n.parentNode.removeChild(n),l.reject()},n.src=a,l.promise};return c.dataUrltoBlob=function(a,b,c){for(var d=a.split(\",\"),e=d[0].match(/:(.*?);/)[1],f=atob(d[1]),g=f.length,h=new Uint8Array(g);g--;)h[g]=f.charCodeAt(g);var i=new window.Blob([h],{type:e});return i.name=b,i.$ngfOrigSize=c,i},c.isResizeSupported=function(){var a=document.createElement(\"canvas\");return window.atob&&a.getContext&&a.getContext(\"2d\")&&window.Blob},c.isResizeSupported()&&Object.defineProperty(window.Blob.prototype,\"name\",{get:function(){return this.$ngfName},set:function(a){this.$ngfName=a},configurable:!0}),c.resize=function(a,d){if(0!==a.type.indexOf(\"image\"))return c.emptyPromise(a);var f=b.defer();return c.dataUrl(a,!0).then(function(b){e(b,d.width,d.height,d.quality,d.type||a.type,d.ratio,d.centerCrop,d.resizeIf).then(function(e){if(\"image/jpeg\"===a.type&&d.restoreExif!==!1)try{e=c.restoreExif(b,e)}catch(g){setTimeout(function(){throw g},1)}try{var h=c.dataUrltoBlob(e,a.name,a.size);f.resolve(h)}catch(g){f.reject(g)}},function(b){\"resizeIf\"===b&&f.resolve(a),f.reject(b)})},function(a){f.reject(a)}),f.promise},c}]),function(){function a(a,c,d,e,f,g,h,i,j,k){function l(){return c.attr(\"disabled\")||s(\"ngfDropDisabled\",a)}function m(b,c,d){if(b){var e;try{e=b&&b.getData&&b.getData(\"text/html\")}catch(f){}q(b.items,b.files,s(\"ngfAllowDir\",a)!==!1,s(\"multiple\")||s(\"ngfMultiple\",a)).then(function(a){a.length?n(a,c):o(d,e).then(function(a){n(a,c)})})}}function n(b,c){i.updateModel(e,d,a,s(\"ngfChange\")||s(\"ngfDrop\"),b,c)}function o(b,c){if(!i.shouldUpdateOn(b,d,a)||\"string\"!=typeof c)return i.rejectPromise([]);var e=[];c.replace(/<(img src|img [^>]* src) *=\\\"([^\\\"]*)\\\"/gi,function(a,b,c){e.push(c)});var f=[],g=[];if(e.length){angular.forEach(e,function(a){f.push(i.urlToBlob(a).then(function(a){g.push(a)}))});var h=k.defer();return k.all(f).then(function(){h.resolve(g)},function(a){h.reject(a)}),h.promise}return i.emptyPromise()}function p(a,b,c,d){var e=s(\"ngfDragOverClass\",a,{$event:c}),f=\"dragover\";if(angular.isString(e))f=e;else if(e&&(e.delay&&(w=e.delay),e.accept||e.reject)){var g=c.dataTransfer.items;if(null!=g&&g.length)for(var h=e.pattern||s(\"ngfPattern\",a,{$event:c}),j=g.length;j--;){if(!i.validatePattern(g[j],h)){f=e.reject;break}f=e.accept}else f=e.accept}d(f)}function q(b,c,e,f){function g(a,b){var c=k.defer();if(null!=a)if(a.isDirectory){var d=[i.emptyPromise()];if(m){var e={type:\"directory\"};e.name=e.path=(b||\"\")+a.name,n.push(e)}var f=a.createReader(),h=[],p=function(){f.readEntries(function(e){try{e.length?(h=h.concat(Array.prototype.slice.call(e||[],0)),p()):(angular.forEach(h.slice(0),function(c){n.length<=j&&l>=o&&d.push(g(c,(b?b:\"\")+a.name+\"/\"))}),k.all(d).then(function(){c.resolve()},function(a){c.reject(a)}))}catch(f){c.reject(f)}},function(a){c.reject(a)})};p()}else a.file(function(a){try{a.path=(b?b:\"\")+a.name,m&&(a=i.rename(a,a.path)),n.push(a),o+=a.size,c.resolve()}catch(d){c.reject(d)}},function(a){c.reject(a)});return c.promise}var j=i.getValidationAttr(d,a,\"maxFiles\");null==j&&(j=Number.MAX_VALUE);var l=i.getValidationAttr(d,a,\"maxTotalSize\");null==l&&(l=Number.MAX_VALUE);var m=s(\"ngfIncludeDir\",a),n=[],o=0,p=[i.emptyPromise()];if(b&&b.length>0&&\"file:\"!==h.location.protocol)for(var q=0;q<b.length;q++){if(b[q].webkitGetAsEntry&&b[q].webkitGetAsEntry()&&b[q].webkitGetAsEntry().isDirectory){var r=b[q].webkitGetAsEntry();if(r.isDirectory&&!e)continue;null!=r&&p.push(g(r))}else{var t=b[q].getAsFile();null!=t&&(n.push(t),o+=t.size)}if(n.length>j||o>l||!f&&n.length>0)break}else if(null!=c)for(var u=0;u<c.length;u++){var v=c.item(u);if((v.type||v.size>0)&&(n.push(v),o+=v.size),n.length>j||o>l||!f&&n.length>0)break}var w=k.defer();return k.all(p).then(function(){if(f||m||!n.length)w.resolve(n);else{for(var a=0;n[a]&&\"directory\"===n[a].type;)a++;w.resolve([n[a]])}},function(a){w.reject(a)}),w.promise}var r=b(),s=function(a,b,c){return i.attrGetter(a,d,b,c)};if(s(\"dropAvailable\")&&g(function(){a[s(\"dropAvailable\")]?a[s(\"dropAvailable\")].value=r:a[s(\"dropAvailable\")]=r}),!r)return void(s(\"ngfHideOnDropNotAvailable\",a)===!0&&c.css(\"display\",\"none\"));null==s(\"ngfSelect\")&&i.registerModelChangeValidator(e,d,a);var t,u=null,v=f(s(\"ngfStopPropagation\")),w=1;c[0].addEventListener(\"dragover\",function(b){if(!l()&&i.shouldUpdateOn(\"drop\",d,a)){if(b.preventDefault(),v(a)&&b.stopPropagation(),navigator.userAgent.indexOf(\"Chrome\")>-1){var e=b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect=\"move\"===e||\"linkMove\"===e?\"move\":\"copy\"}g.cancel(u),t||(t=\"C\",p(a,d,b,function(d){t=d,c.addClass(t),s(\"ngfDrag\",a,{$isDragging:!0,$class:t,$event:b})}))}},!1),c[0].addEventListener(\"dragenter\",function(b){!l()&&i.shouldUpdateOn(\"drop\",d,a)&&(b.preventDefault(),v(a)&&b.stopPropagation())},!1),c[0].addEventListener(\"dragleave\",function(b){!l()&&i.shouldUpdateOn(\"drop\",d,a)&&(b.preventDefault(),\nv(a)&&b.stopPropagation(),u=g(function(){t&&c.removeClass(t),t=null,s(\"ngfDrag\",a,{$isDragging:!1,$event:b})},w||100))},!1),c[0].addEventListener(\"drop\",function(b){!l()&&i.shouldUpdateOn(\"drop\",d,a)&&(b.preventDefault(),v(a)&&b.stopPropagation(),t&&c.removeClass(t),t=null,m(b.dataTransfer,b,\"dropUrl\"))},!1),c[0].addEventListener(\"paste\",function(b){navigator.userAgent.toLowerCase().indexOf(\"firefox\")>-1&&s(\"ngfEnableFirefoxPaste\",a)&&b.preventDefault(),!l()&&i.shouldUpdateOn(\"paste\",d,a)&&m(b.clipboardData||b.originalEvent.clipboardData,b,\"pasteUrl\")},!1),navigator.userAgent.toLowerCase().indexOf(\"firefox\")>-1&&s(\"ngfEnableFirefoxPaste\",a)&&(c.attr(\"contenteditable\",!0),c.on(\"keypress\",function(a){a.metaKey||a.ctrlKey||a.preventDefault()}))}function b(){var a=document.createElement(\"div\");return\"draggable\"in a&&\"ondrop\"in a&&!/Edge\\/12./i.test(navigator.userAgent)}ngFileUpload.directive(\"ngfDrop\",[\"$parse\",\"$timeout\",\"$window\",\"Upload\",\"$http\",\"$q\",function(b,c,d,e,f,g){return{restrict:\"AEC\",require:\"?ngModel\",link:function(h,i,j,k){a(h,i,j,k,b,c,d,e,f,g)}}}]),ngFileUpload.directive(\"ngfNoFileDrop\",function(){return function(a,c){b()&&c.css(\"display\",\"none\")}}),ngFileUpload.directive(\"ngfDropAvailable\",[\"$parse\",\"$timeout\",\"Upload\",function(a,c,d){return function(e,f,g){if(b()){var h=a(d.attrGetter(\"ngfDropAvailable\",g));c(function(){h(e),h.assign&&h.assign(e,!0)})}}}])}(),ngFileUpload.service(\"UploadExif\",[\"UploadResize\",\"$q\",function(a,b){function c(a,b,c,d){switch(b){case 2:return a.transform(-1,0,0,1,c,0);case 3:return a.transform(-1,0,0,-1,c,d);case 4:return a.transform(1,0,0,-1,0,d);case 5:return a.transform(0,1,1,0,0,0);case 6:return a.transform(0,1,-1,0,d,0);case 7:return a.transform(0,-1,-1,0,d,c);case 8:return a.transform(0,-1,1,0,0,c)}}function d(a){for(var b=\"\",c=new Uint8Array(a),d=c.byteLength,e=0;d>e;e++)b+=String.fromCharCode(c[e]);return window.btoa(b)}var e=a;return e.isExifSupported=function(){return window.FileReader&&(new FileReader).readAsArrayBuffer&&e.isResizeSupported()},e.readOrientation=function(a){var c=b.defer(),d=new FileReader,e=a.slice?a.slice(0,65536):a;return d.readAsArrayBuffer(e),d.onerror=function(a){return c.reject(a)},d.onload=function(a){var b={orientation:1},d=new DataView(this.result);if(65496!==d.getUint16(0,!1))return c.resolve(b);for(var e=d.byteLength,f=2;e>f;){var g=d.getUint16(f,!1);if(f+=2,65505===g){if(1165519206!==d.getUint32(f+=2,!1))return c.resolve(b);var h=18761===d.getUint16(f+=6,!1);f+=d.getUint32(f+4,h);var i=d.getUint16(f,h);f+=2;for(var j=0;i>j;j++)if(274===d.getUint16(f+12*j,h)){var k=d.getUint16(f+12*j+8,h);return k>=2&&8>=k&&(d.setUint16(f+12*j+8,1,h),b.fixedArrayBuffer=a.target.result),b.orientation=k,c.resolve(b)}}else{if(65280!==(65280&g))break;f+=d.getUint16(f,!1)}}return c.resolve(b)},c.promise},e.applyExifRotation=function(a){if(0!==a.type.indexOf(\"image/jpeg\"))return e.emptyPromise(a);var f=b.defer();return e.readOrientation(a).then(function(b){return b.orientation<2||b.orientation>8?f.resolve(a):void e.dataUrl(a,!0).then(function(g){var h=document.createElement(\"canvas\"),i=document.createElement(\"img\");i.onload=function(){try{h.width=b.orientation>4?i.height:i.width,h.height=b.orientation>4?i.width:i.height;var g=h.getContext(\"2d\");c(g,b.orientation,i.width,i.height),g.drawImage(i,0,0);var j=h.toDataURL(a.type||\"image/WebP\",.934);j=e.restoreExif(d(b.fixedArrayBuffer),j);var k=e.dataUrltoBlob(j,a.name);f.resolve(k)}catch(l){return f.reject(l)}},i.onerror=function(){f.reject()},i.src=g},function(a){f.reject(a)})},function(a){f.reject(a)}),f.promise},e.restoreExif=function(a,b){var c={};return c.KEY_STR=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",c.encode64=function(a){var b,c,d,e,f,g=\"\",h=\"\",i=\"\",j=0;do b=a[j++],c=a[j++],h=a[j++],d=b>>2,e=(3&b)<<4|c>>4,f=(15&c)<<2|h>>6,i=63&h,isNaN(c)?f=i=64:isNaN(h)&&(i=64),g=g+this.KEY_STR.charAt(d)+this.KEY_STR.charAt(e)+this.KEY_STR.charAt(f)+this.KEY_STR.charAt(i),b=c=h=\"\",d=e=f=i=\"\";while(j<a.length);return g},c.restore=function(a,b){a.match(\"data:image/jpeg;base64,\")&&(a=a.replace(\"data:image/jpeg;base64,\",\"\"));var c=this.decode64(a),d=this.slice2Segments(c),e=this.exifManipulation(b,d);return\"data:image/jpeg;base64,\"+this.encode64(e)},c.exifManipulation=function(a,b){var c=this.getExifArray(b),d=this.insertExif(a,c);return new Uint8Array(d)},c.getExifArray=function(a){for(var b,c=0;c<a.length;c++)if(b=a[c],255===b[0]&225===b[1])return b;return[]},c.insertExif=function(a,b){var c=a.replace(\"data:image/jpeg;base64,\",\"\"),d=this.decode64(c),e=d.indexOf(255,3),f=d.slice(0,e),g=d.slice(e),h=f;return h=h.concat(b),h=h.concat(g)},c.slice2Segments=function(a){for(var b=0,c=[];;){if(255===a[b]&218===a[b+1])break;if(255===a[b]&216===a[b+1])b+=2;else{var d=256*a[b+2]+a[b+3],e=b+d+2,f=a.slice(b,e);c.push(f),b=e}if(b>a.length)break}return c},c.decode64=function(a){var b,c,d,e,f,g=\"\",h=\"\",i=0,j=[],k=/[^A-Za-z0-9\\+\\/\\=]/g;k.exec(a)&&console.log(\"There were invalid base64 characters in the input text.\\nValid base64 characters are A-Z, a-z, 0-9, NaNExpect errors in decoding.\"),a=a.replace(/[^A-Za-z0-9\\+\\/\\=]/g,\"\");do d=this.KEY_STR.indexOf(a.charAt(i++)),e=this.KEY_STR.indexOf(a.charAt(i++)),f=this.KEY_STR.indexOf(a.charAt(i++)),h=this.KEY_STR.indexOf(a.charAt(i++)),b=d<<2|e>>4,c=(15&e)<<4|f>>2,g=(3&f)<<6|h,j.push(b),64!==f&&j.push(c),64!==h&&j.push(g),b=c=g=\"\",d=e=f=h=\"\";while(i<a.length);return j},c.restore(a,b)},e}]);","/**\n * _29012 - Workflow\n */\n'use strict';\n\nangular\n    .module('app', [\n        'vs-repeat', \n        'gc-ajax',\n        'gc-transform',\n        'gc-form',\n        'gc-find',\n        'ngFileUpload'\n    ])\n;","\t\t\r\nangular\r\n\t.module('app')\r\n\t.service('_29012IndexService', _29012IndexService)\r\n\t.controller('_29012IndexController', _29012IndexController)\r\n\t.component('index29012', {\r\n\t\ttemplateUrl: '/_29012/viewItem',\r\n\t\tcontroller: '_29012IndexController'\r\n\t})\r\n;","\t\r\n\t_29012IndexService.$inject = ['$ajax'];\r\n\r\n    function _29012IndexService($ajax) {\r\n\r\n    \t// MÉTODOS (REFERÊNCIAS)\r\n    \tthis.consultarWorkflowItem = consultarWorkflowItem;\r\n\r\n    \t// MÉTODOS\r\n    \t\r\n    \t/**\r\n    \t * Consultar item de workflow.\r\n    \t */\r\n\t    function consultarWorkflowItem(param) {\r\n\r\n\t\t\treturn $ajax\r\n                    .post(\r\n                        '/_29012/consultarWorkflowItem', \r\n                        JSON.stringify(param), \r\n                        {contentType: 'application/json'}\r\n                    );\r\n\t\t}\r\n\t}","\r\n\t_29012IndexController.$inject = ['_29012IndexService', '_29012TarefaService', '$scope', '$timeout'];\r\n\r\n\tfunction _29012IndexController(_29012IndexService, _29012TarefaService, $scope, $timeout) {\r\n\r\n\t\tvar ctrl = this;\r\n\r\n\t\t// MÉTODOS (REFERÊNCIAS).\r\n\t\tctrl.consultarWorkflowItem \t= consultarWorkflowItem;\r\n\t\tctrl.exibirItem\t\t\t\t= exibirItem;\r\n\t\tctrl.ativarIncluir \t\t\t= ativarIncluir;\r\n\t\tctrl.limparCampo \t\t\t= limparCampo;\r\n\t\tctrl.consultarTarefa \t\t= consultarTarefa;\r\n\t\tctrl.carregarInfoGeral\t\t= carregarInfoGeral;\r\n\t\tctrl.carregarTarefa\t\t\t= carregarTarefa;\r\n\t\tctrl.exibirModal\t\t\t= exibirModal;\r\n\r\n\t\t// VARIÁVEIS\r\n\t\tctrl.tipoTela \t\t= 'incluir';\r\n\t\tctrl.filtro \t\t= {};\r\n\t\tctrl.filtro.dataIni = moment().subtract(1, \"month\").toDate();\r\n\t\tctrl.filtro.dataFim = moment().toDate();\r\n\t\tctrl.workflowItem\t= [];\r\n\t\tctrl.usuarioId \t\t= parseInt( $('#usuario-id').val() );\r\n\r\n\t\t// MÉTODOS\r\n\r\n\t\tthis.$onInit = function() {\r\n\r\n\t\t\tctrl.filtro.workflowItemId \t= parseInt(getURLParameter('workflowItemId'));\r\n\t\t\tctrl.filtro.tarefaId \t\t= parseInt(getURLParameter('tarefaId'));\r\n\t\t};\r\n\r\n\t\t// Consultar workflow (filtro inicial) quando o id do workflow for passado na URL.\r\n\t\t$scope.$watch('$ctrl.filtro.workflowItemId', function(newValue, oldValue, scope) {\r\n            \r\n            if (newValue > 0) {\r\n\r\n                $timeout(function() {\r\n\t\t\t\t\tctrl.consultarWorkflowItem();\r\n                }, 100);\r\n            } \r\n        });\r\n\r\n\t\t// Depois que a lista de workflows for carregada,\r\n\t\t// exibir um workflow de acordo com o id do workflow passado na URL.\r\n        $scope.$watch('$ctrl.workflowItem', function(newValue, oldValue, scope) {\r\n\r\n        \tif (newValue.length > 0) {\r\n\r\n        \t\tfor (var i in newValue) {\r\n\r\n        \t\t\tif (newValue[i].ID == ctrl.filtro.workflowItemId) {\r\n\r\n        \t\t\t\tctrl.exibirItem(newValue[i]);\r\n        \t\t\t\t\r\n        \t\t\t\tif (ctrl.filtro.tarefaId) {\r\n\t        \t\t\t\r\n\t        \t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t\t$('#tab-tarefa a.tarefa-'+ctrl.filtro.tarefaId).tab('show');\r\n\t\t\t\t\t\t\t}, 2000);\r\n\t        \t\t\t}\r\n\r\n        \t\t\t\tctrl.filtro.workflowItemId = 0;\t\t// para não repetir o watch dele.\r\n\r\n        \t\t\t\tbreak;\r\n        \t\t\t}\r\n        \t\t}\r\n        \t}\r\n        });\r\n\r\n\t\t/**\r\n\t\t * Consultar item de workflow.\r\n\t\t */\r\n\t\tfunction consultarWorkflowItem() {\r\n\r\n\t\t\tvar param = {\r\n\t\t\t\t\tDATA_INI\t\t: moment(ctrl.filtro.dataIni).format('DD.MM.YYYY')+' 00:00:00',\r\n\t\t\t\t\tDATA_FIM\t\t: moment(ctrl.filtro.dataFim).format('DD.MM.YYYY')+' 23:59:59',\r\n\t\t\t\t\tSTATUS_CONCLUSAO: ctrl.filtro.status ? ctrl.filtro.status : null,\r\n\t\t\t\t\tWORKFLOW_ITEM_ID: ctrl.filtro.workflowItemId ? ctrl.filtro.workflowItemId : null\r\n\t\t\t\t};\r\n\r\n\t\t\t_29012IndexService\r\n\t\t\t\t.consultarWorkflowItem(param)\r\n\t\t\t\t.then(function(response) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tctrl.workflowItem = response;\r\n\r\n\t\t\t\t\tvar item = null;\r\n\r\n\t\t\t\t\tfor (var i in ctrl.workflowItem) {\r\n\r\n\t\t\t\t\t\titem = ctrl.workflowItem[i];\r\n\r\n\t\t\t\t\t\titem.DATAHORA_INSERT_FORMATADO = moment(item.DATAHORA_INSERT).format('DD/MM/YYYY HH:mm:ss');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t//uriHistory(param);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Definir URL com parâmetro do filtro e guardar em localStorage.\r\n\t\t */\r\n\t\t// function uriHistory(dado) {\r\n\r\n\t\t// \twindow.history.replaceState('', '', encodeURI(urlhost + '/_29012?'+ $.param(dado)));\r\n\r\n\t\t// \tlocalStorage.setItem('29012FiltroUrl', location.href);\r\n\t\t// }\r\n\r\n\t\tfunction exibirItem(workflow) {\r\n\r\n\t\t\tctrl.tipoTela = 'exibir';\r\n\t\t\tctrl.consultarTarefa(workflow);\r\n\t\t}\r\n\r\n\t\tfunction consultarTarefa(workflow) {\r\n\r\n\t\t\tvar param = {\r\n\t\t\t\t\tWORKFLOW_ITEM_ID: workflow.ID\r\n\t\t\t\t};\r\n\r\n\t\t\t_29012TarefaService\r\n\t\t\t\t.consultarWorkflowItemTarefa(param)\r\n\t\t\t\t.then(function(response) {\r\n\r\n\t\t\t\t\t// tarefa = response;\r\n\t\t\t\t\tctrl.carregarInfoGeral(workflow);\r\n\t\t\t\t\tctrl.carregarTarefa(response);\r\n\t\t\t\t\tctrl.exibirModal(workflow);\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction carregarInfoGeral(workflow) {\r\n\r\n\t\t\tvar infGrl = ctrl.create.infoGeral.infoGeral;\r\n\r\n\t\t\tif (infGrl.ID == null) {\r\n\r\n\t\t\t\tangular.copy(workflow, infGrl);\r\n\r\n\t\t\t\tinfGrl.WORKFLOW_MODELO \t\t  = {};\r\n\t\t\t\tinfGrl.WORKFLOW_MODELO.ID \t  = infGrl.WORKFLOW_ID;\r\n\t\t\t\tinfGrl.WORKFLOW_MODELO.TITULO = infGrl.WORKFLOW_TITULO;\r\n\r\n\t\t\t\tinfGrl.DATAHORA_INI_PREVISTA  = moment(infGrl.DATAHORA_INI_PREVISTA).toDate();\r\n\t\t\t\tinfGrl.DATAHORA_FIM_PREVISTA  = moment(infGrl.DATAHORA_FIM_PREVISTA).toDate();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction carregarTarefa(tarefa) {\r\n\r\n\t\t\tvar trf = {},\r\n\t\t\t\ttempoPrevistoDuration = null;\r\n\r\n\t\t\t// Limpa array que contém todos os arquivos.\r\n\t\t\tctrl.create.arquivoTodos = [];\r\n\r\n\t\t\t// Ordenar por sequencia e id.\r\n\t\t\ttarefa.TAREFA = tarefa\r\n\t\t\t\t\t\t\t\t.TAREFA\r\n\t\t\t\t\t\t\t\t.sort(function(a, b) { return a.SEQUENCIA - b.SEQUENCIA || a.ID - b.ID });\r\n\r\n\t\t\tfor (var i in tarefa.TAREFA) {\r\n\r\n\t\t\t\ttrf = tarefa.TAREFA[i];\r\n\r\n\t\t\t\ttrf.TEMPO_CONCLUSAO_HUMANIZE = moment.duration(parseFloat(trf.TEMPO_CONCLUSAO), \"minutes\").format('d[d] HH[h] mm[m] ss[s]');\r\n\r\n\t\t\t\ttempoPrevistoDuration \t\t= moment.duration(parseFloat(trf.TEMPO_PREVISTO), 'minutes');\r\n\r\n\t\t\t\ttrf.TEMPO_PREVISTO_HORA \t= moment.duration(tempoPrevistoDuration.days(), 'days').asHours();\t// dias em horas\r\n\t\t\t\ttrf.TEMPO_PREVISTO_HORA \t= moment\r\n\t\t\t\t\t\t\t\t\t\t\t\t.duration(trf.TEMPO_PREVISTO_HORA, 'hours')\r\n\t\t\t\t\t\t\t\t\t\t\t\t.add(tempoPrevistoDuration.hours(), 'h')\t// add horas do tempo previsto\r\n\t\t\t\t\t\t\t\t\t\t\t\t.asHours();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\ttrf.TEMPO_PREVISTO_MINUTO \t= tempoPrevistoDuration.minutes();\r\n\r\n\t\t\t\tcarregarTarefaDestinatario(trf);\r\n\t\t\t\thabilitarAcaoTarefa(trf, parseInt(i));\t// Precisa chamar depois de destinatário devido ao campo 'DO_USUARIO'.\r\n\t\t\t\tcarregarTarefaNotificado(trf);\r\n\t\t\t\tcarregarTarefaComentario(trf);\r\n\t\t\t\tcarregarTarefaMovimentacao(trf);\r\n\t\t\t\tcarregarTarefaCampo(trf);\r\n\t\t\t\tcarregarArquivoTodos(trf);\r\n\t\t\t\t\r\n\t\t\t\t// Caso não tenha nenhum arquivo, adiciona um vazio.\r\n\t\t\t\tif (trf.ARQUIVO_DESTINATARIO.length == 0)\r\n\t\t\t\t\tctrl.tarefa.addArquivo(trf);\r\n\t\t\t}\r\n\r\n\t\t\tctrl.tarefa.tarefa = tarefa.TAREFA;\r\n\r\n\r\n\t\t\tfunction carregarTarefaDestinatario(trf) {\r\n\r\n\t\t\t\tvar destin = {};\r\n\r\n\t\t\t\ttrf.DESTINATARIO = [];\r\n\r\n\t\t\t\tfor (var j in tarefa.DESTINATARIO) {\r\n\r\n\t\t\t\t\tdestin = tarefa.DESTINATARIO[j];\r\n\r\n\t\t\t\t\tif (trf.ID == destin.WORKFLOW_ITEM_TAREFA_ID)\r\n\t\t\t\t\t\ttrf.DESTINATARIO.push(destin);\r\n\r\n\t\t\t\t\t// Se não tiver permissão para reiniciar uma tarefa.\r\n\t\t\t\t\tif (ctrl.tarefa.pu224 == null || ctrl.tarefa.pu224 == '0')\r\n\t\t\t\t\t\tanalisarTarefaDestinatario(trf);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\ttrf.DO_USUARIO = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction carregarTarefaNotificado(trf) {\r\n\r\n\t\t\t\tvar notif = {};\r\n\r\n\t\t\t\ttrf.NOTIFICADO = [];\r\n\r\n\t\t\t\tfor (var j in tarefa.NOTIFICADO) {\r\n\r\n\t\t\t\t\tnotif = tarefa.NOTIFICADO[j];\r\n\r\n\t\t\t\t\tif (trf.ID == notif.WORKFLOW_ITEM_TAREFA_ID)\r\n\t\t\t\t\t\ttrf.NOTIFICADO.push(notif);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\t/**\r\n\t\t\t * Define se a tarefa pertence ao usuário.\r\n\t\t\t */\r\n\t\t\tfunction analisarTarefaDestinatario(trf) {\r\n\r\n\t\t\t\tfor (var j in tarefa.DESTINATARIO) {\r\n\r\n\t\t\t\t\tdestin = tarefa.DESTINATARIO[j];\r\n\r\n\t\t\t\t\tif (destin.WORKFLOW_ITEM_TAREFA_ID == trf.ID && destin.USUARIO_ID == ctrl.usuarioId) {\r\n\r\n\t\t\t\t\t\ttrf.DO_USUARIO = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\ttrf.DO_USUARIO = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Habilitar ações da tarefa.\r\n\t\t\t */\r\n\t\t\tfunction habilitarAcaoTarefa(trf, i) {\r\n\r\n\t\t\t\ttrf.habilitarIniciar  = true;\r\n\t\t\t\ttrf.habilitarPausar   = true;\r\n\t\t\t\ttrf.habilitarConcluir = true;\r\n\r\n\t\t\t\t// Evitar index negativo.\r\n\t\t\t\ti = (i > 0) ? i-1 : 0;\r\n\r\n\t\t\t\t// Desabilitar botão 'Iniciar', 'Pausar' e 'Concluir' se:\r\n\t\t\t\t// - a tarefa não for destinada ao usuário atual;\r\n\t\t\t\t// - (removido) outro destinatário já tiver iniciado a tarefa; \t\t-->> || (trf.USUARIO_CONCLUSAO_ID != null && trf.USUARIO_CONCLUSAO_ID != ctrl.usuarioId)\r\n\t\t\t\t// - a sequência da tarefa atual for maior que a sequência da tarefa anterior.\r\n\t\t\t\tif ((trf.DO_USUARIO == 0) \r\n\t\t\t\t\t|| (trf.SEQUENCIA > tarefa.TAREFA[i].SEQUENCIA && tarefa.TAREFA[i].STATUS_CONCLUSAO != '3')) {\r\n\r\n\t\t\t\t\ttrf.habilitarIniciar  = false;\r\n\t\t\t\t\ttrf.habilitarPausar   = false;\r\n\t\t\t\t\ttrf.habilitarConcluir = false;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\t// Desabilitar botão 'Iniciar' se:\r\n\t\t\t\t\t// - o status da tarefa for 'iniciado' ou 'concluído'.\r\n\t\t\t\t\tif (trf.STATUS_CONCLUSAO == '1' || trf.STATUS_CONCLUSAO == '3')\r\n\t\t\t\t\t\ttrf.habilitarIniciar = false;\r\n\r\n\t\t\t\t\t// Desabilitar botão 'Pausar' e 'Concluir' se:\r\n\t\t\t\t\t// - o status da tarefa não for 'iniciado';\r\n\t\t\t\t\tif (trf.STATUS_CONCLUSAO != '1') {\r\n\r\n\t\t\t\t\t\ttrf.habilitarPausar   = false;\r\n\t\t\t\t\t\ttrf.habilitarConcluir = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction carregarTarefaComentario(trf) {\r\n\r\n\t\t\t\tvar coment = {};\r\n\t\t\t\ttrf.COMENTARIO = [];\r\n\r\n\t\t\t\tfor (var i in tarefa.COMENTARIO) {\r\n\r\n\t\t\t\t\tcoment = tarefa.COMENTARIO[i];\r\n\r\n\t\t\t\t\tif (trf.ID == coment.WORKFLOW_ITEM_TAREFA_ID) {\r\n\t\t\t\t\t\ttrf.COMENTARIO.push(coment);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Caso não tenha nenhum comentário, adiciona um vazio.\r\n\t\t\t\tif (trf.COMENTARIO.length == 0)\r\n\t\t\t\t\tctrl.tarefa.addComentario(trf);\r\n\t\t\t}\r\n\r\n\t\t\tfunction carregarTarefaMovimentacao(trf) {\r\n\r\n\t\t\t\tvar mov = {};\r\n\r\n\t\t\t\ttrf.MOVIMENTACAO = [];\r\n\r\n\t\t\t\tfor (var j in tarefa.MOVIMENTACAO) {\r\n\r\n\t\t\t\t\tmov = tarefa.MOVIMENTACAO[j];\r\n\r\n\t\t\t\t\tif (trf.ID == mov.WORKFLOW_ITEM_TAREFA_ID) {\r\n\r\n\t\t\t\t\t\tmov.DATAHORA_FORMATADO = moment(mov.DATAHORA).format('DD/MM/YYYY HH:mm:ss');\r\n\t\t\t\t\t\ttrf.MOVIMENTACAO.push(mov);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction carregarTarefaCampo(trf) {\r\n\r\n\t\t\t\tvar campo = {};\r\n\t\t\t\ttrf.CAMPO = [];\r\n\r\n\t\t\t\tfor (var j in tarefa.CAMPO) {\r\n\r\n\t\t\t\t\tcampo = tarefa.CAMPO[j];\r\n\r\n\t\t\t\t\tif (trf.ID == campo.WORKFLOW_ITEM_TAREFA_ID) {\r\n\t\t\t\t\t\ttrf.CAMPO.push(campo);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction carregarArquivoTodos(trf) {\r\n\r\n\t\t\t\tfor (var i in trf.ARQUIVO)\r\n\t\t\t\t\tctrl.create.arquivoTodos.push(trf.ARQUIVO[i]);\r\n\r\n\t\t\t\tfor (var i in trf.ARQUIVO_DESTINATARIO)\r\n\t\t\t\t\tctrl.create.arquivoTodos.push(trf.ARQUIVO_DESTINATARIO[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction exibirModal(workflow) {\r\n\r\n\t\t\t$('#modal-create')\r\n\t\t\t\t.modal('show')\r\n\t\t\t\t.removeData('workflowId')\r\n\t\t\t\t.data('workflowId', workflow.ID);\t// Definindo id do workflow no modal para ser utilizado ao fechá-lo.\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Ativar comportamento padrão da tela de Incluir.\r\n\t\t */\r\n\t\tfunction ativarIncluir() {\r\n\r\n\t\t\tctrl.tipoTela = 'incluir';\r\n\t\t\t$('#modal-create').modal('show');\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Limpar campos do modal.\r\n\t\t */\r\n\t\tfunction limparCampo() {\r\n\r\n\t\t\tctrl.infoGeral.infoGeral = {};\r\n\t\t\tctrl.infoGeral.STATUS \t = '1';\r\n\r\n\t\t\tctrl.tarefa.tarefa = [];\r\n\t\t\tctrl.tarefa.addTarefa();\r\n\r\n\t\t\tctrl.arquivoTodos = [];\r\n\t\t}\r\n\r\n\t}","\t\t\r\nangular\r\n\t.module('app')\r\n\t.service('_29012CreateService', _29012CreateService)\r\n\t.controller('_29012CreateController', _29012CreateController)\r\n\t.component('create29012', {\r\n\t\ttemplateUrl: '/_29012/viewCreate',\r\n\t\trequire: {\r\n\t\t\t'index29012': '^index29012'\r\n\t\t},\r\n\t\tbindings: {\r\n\t\t\ttipoTela: '='\r\n\t\t},\r\n\t\tcontroller: '_29012CreateController'\r\n\t})\r\n;","\t\r\n\t_29012CreateService.$inject = ['$ajax'];\r\n\r\n    function _29012CreateService($ajax) {\r\n\r\n    \t// MÉTODOS (REFERÊNCIAS)\r\n\r\n\r\n        // MÉTODOS\r\n\r\n\t}","\r\n\t_29012CreateController.$inject = ['_29012CreateService'];\r\n\r\n\tfunction _29012CreateController(_29012CreateService) {\r\n\r\n\t\tvar ctrl = this;\r\n\r\n\t\t// MÉTODOS (REFERÊNCIAS)\r\n\t\tctrl.limparCampo  \t\t\t = limparCampo;\r\n\t\tctrl.exibirModalArquivoTodos = exibirModalArquivoTodos;\r\n\t\tctrl.fecharModalArquivoTodos = fecharModalArquivoTodos;\r\n\t\tctrl.fecharModal  \t\t\t = fecharModal;\r\n\r\n\t\t// VARIÁVEIS\r\n\t\tctrl.arquivoTodos = [];\r\n\r\n\t\t// Métodos iniciados ao carregar página.\r\n\t\tctrl.$onInit = function() {\r\n\r\n\t\t\tctrl.index29012.create = this;\r\n\t\t};\r\n\r\n\t\t// MÉTODOS\r\n\r\n\t\t/**\r\n\t\t * Limpar campos.\r\n\t\t */\r\n\t\tfunction limparCampo() {\r\n\r\n\t\t\tctrl.infoGeral.infoGeral = {};\r\n\t\t\tctrl.infoGeral.STATUS \t = '1';\r\n\t\t\tctrl.tarefa.tarefa \t\t = [];\r\n\t\t\tctrl.arquivoTodos \t\t = [];\r\n\r\n\t\t\tctrl.tarefa.excluirArquivoTmpPorUsuario();\r\n\t\t}\r\n\r\n\t\tfunction exibirModalArquivoTodos() {\r\n\r\n\t\t\t$('#modal-create-arquivo-todos')\r\n\t\t\t\t.modal('show');\r\n\t\t}\r\n\r\n\t\tfunction fecharModalArquivoTodos() {\r\n\t\t\t\r\n\t\t\t$('#modal-create-arquivo-todos')\r\n\t\t\t\t.modal('hide')\r\n\t\t\t\t.find('.modal-body')\r\n\t\t\t\t.animate({ scrollTop: 0 }, 'fast');\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Fechar modal.\r\n\t\t */\r\n\t\tfunction fecharModal() {\r\n\t\t\t\r\n\t\t\t$('#modal-create')\r\n\t\t\t\t.modal('hide')\r\n\t\t\t\t.find('.modal-body')\r\n\t\t\t\t.animate({ scrollTop: 0 }, 'fast');\r\n\r\n\t\t\t// Foco na linha da tabela do workflow.\r\n\t\t\tvar workflowId = $('#modal-create').data('workflowId');\r\n\t\t\t$('tr.workflow-'+workflowId).focus();\r\n\t\t\t\r\n\t\t\tctrl.limparCampo();\r\n\t\t}\r\n\r\n\t}","\t\t\r\nangular\r\n\t.module('app')\r\n\t.service('_29012InfoGeralService', _29012InfoGeralService)\r\n\t.controller('_29012InfoGeralController', _29012InfoGeralController)\r\n\t.component('infoGeral29012', {\r\n\t\ttemplateUrl: '/_29012/viewInfoGeral',\r\n\t\trequire: {\r\n\t\t\tcreate29012: '^create29012'\r\n\t\t},\r\n\t\tbindings: {\r\n\t\t\ttipoTela: '='\r\n\t\t},\r\n\t\tcontroller: '_29012InfoGeralController'\r\n\t})\r\n;","\t\r\n\t_29012InfoGeralService.$inject = ['$ajax'];\r\n\r\n    function _29012InfoGeralService($ajax) {\r\n\r\n    \t// MÉTODOS (REFERÊNCIAS)\r\n\r\n    \t// MÉTODOS    \t\r\n    \t\r\n\t}","\r\n\t_29012InfoGeralController.$inject = ['Historico', '$scope'];\r\n\r\n\tfunction _29012InfoGeralController(Historico, $scope) {\r\n\r\n\t\tvar ctrl = this;\r\n\r\n\t\t// MÉTODOS (REFERÊNCIAS).\r\n\t\t\r\n\r\n\t\t// VARIÁVEIS\r\n\t\tctrl.infoGeral = {};\r\n\t\tctrl.Historico = new Historico('$ctrl.Historico', $scope);\r\n\r\n\t\t// Métodos iniciados ao carregar página.\r\n\t\tctrl.$onInit = function() {\r\n\r\n\t\t\tctrl.create29012.infoGeral = this;\r\n\t\t};\r\n\r\n\r\n\t\t// MÉTODOS\r\n\r\n\t}","\t\t\r\nangular\r\n\t.module('app')\r\n\t.service('_29012TarefaService', _29012TarefaService)\r\n\t.controller('_29012TarefaController', _29012TarefaController)\r\n\t.component('tarefa29012', {\r\n\t\ttemplateUrl: '/_29012/viewTarefa',\r\n\t\trequire: {\r\n\t\t\tindex29012 : '^index29012',\r\n\t\t\tcreate29012: '^create29012'\r\n\t\t},\r\n\t\tbindings: {\r\n\t\t\ttipoTela: '='\r\n\t\t},\r\n\t\tcontroller: '_29012TarefaController'\r\n\t})\r\n;","\r\n\t_29012TarefaService.$inject = ['$ajax', 'Upload'];\r\n\r\n    function _29012TarefaService($ajax, Upload) {\r\n\r\n    \t// MÉTODOS (REFERÊNCIAS)\r\n    \tthis.consultarWorkflowItemTarefa             = consultarWorkflowItemTarefa;\r\n        this.excluirArquivoTmpPorUsuario             = excluirArquivoTmpPorUsuario;\r\n        this.alterarSituacao                         = alterarSituacao;\r\n        this.gravarWorkflowItemTarefaComentario      = gravarWorkflowItemTarefaComentario;\r\n        this.gravarWorkflowItemArquivoDoDestinatario = gravarWorkflowItemArquivoDoDestinatario;\r\n        this.gravarWorkflowItemTarefaCampo           = gravarWorkflowItemTarefaCampo;\r\n\r\n    \t// MÉTODOS\r\n\r\n        /**\r\n         * Consultar tarefa.\r\n         */\r\n        function consultarWorkflowItemTarefa(param) {\r\n\r\n            return $ajax.post('/_29012/consultarWorkflowItemTarefa', JSON.stringify(param), {contentType: 'application/json'});\r\n        }\r\n\r\n        /**\r\n         * Excluir arquivos da pasta temporária (por usuário).\r\n         */\r\n        function excluirArquivoTmpPorUsuario(param) {\r\n\r\n            return $ajax.post('/excluirArquivoTmpPorUsuario', JSON.stringify(param), {contentType: 'application/json'});\r\n        }\r\n\r\n        /**\r\n         * Alterar situação da tarefa.\r\n         */\r\n        function alterarSituacao(param) {\r\n\r\n            return $ajax.post('/_29012/alterarSituacaoWorkflowItemTarefa', JSON.stringify(param), {contentType: 'application/json'});\r\n        }\r\n\r\n        /**\r\n         * Gravar comentário para a tarefa.\r\n         */\r\n        function gravarWorkflowItemTarefaComentario(param) {\r\n\r\n            return $ajax.post('/_29012/gravarWorkflowItemTarefaComentario', JSON.stringify(param), {contentType: 'application/json'});\r\n        }\r\n\r\n        /**\r\n         * Gravar arquivo.\r\n         */\r\n        function gravarWorkflowItemArquivoDoDestinatario(param) {\r\n\r\n            $('.carregando-pagina').fadeIn(200);\r\n\r\n            var upload = Upload\r\n                            .upload({\r\n                                url : '/_29012/gravarWorkflowItemArquivoDoDestinatario', \r\n                                data: param\r\n                            });\r\n\r\n            upload\r\n                .finally(\r\n                    function(e) {\r\n                    \r\n                        $('.carregando-pagina').fadeOut(200);\r\n\r\n                        setTimeout(function() {\r\n                            $('.carregando-pagina .progress .progress-bar')\r\n                                .attr({'aria-valuenow': 0,'aria-valuemax': 0})\r\n                                .css('width', 0);\r\n                        }, 300);\r\n                    }\r\n                );\r\n\r\n            return upload;\r\n        }\r\n\r\n        /**\r\n         * Gravar valores dos campos dinâmicos.\r\n         */\r\n        function gravarWorkflowItemTarefaCampo(param) {\r\n\r\n            return $ajax.post('/_29012/gravarWorkflowItemTarefaCampo', JSON.stringify(param), {contentType: 'application/json'});\r\n        }\r\n\t}","\t\r\n\t_29012TarefaController.$inject = ['_29012TarefaService', '$rootScope'];\r\n\r\n\tfunction _29012TarefaController(_29012TarefaService, $rootScope) {\r\n\r\n\t\tvar ctrl = this;\r\n\r\n\t\t// MÉTODOS (REFERÊNCIAS)\r\n\r\n\t\tctrl.alterarSituacao \t\t\t \t\t\t = alterarSituacao;\r\n\t\tctrl.addComentario \t\t\t\t \t\t\t = addComentario;\r\n\t\tctrl.gravarWorkflowItemTarefaComentario \t = gravarWorkflowItemTarefaComentario;\r\n\t\tctrl.excluirComentario \t\t\t\t\t\t = excluirComentario;\r\n\t\tctrl.addCampo \t\t\t\t\t\t\t\t = addCampo;\r\n\t\tctrl.gravarWorkflowItemTarefaCampo\t\t\t = gravarWorkflowItemTarefaCampo;\r\n\t\tctrl.addArquivo \t\t\t\t \t\t\t = addArquivo;\r\n\t\tctrl.gravarWorkflowItemArquivoDoDestinatario = gravarWorkflowItemArquivoDoDestinatario;\r\n\t\tctrl.processarArquivo \t\t\t \t\t\t = processarArquivo;\r\n\t\tctrl.excluirArquivo \t\t \t \t\t\t = excluirArquivo;\r\n\t\tctrl.excluirArquivoTmpPorUsuario \t\t\t = excluirArquivoTmpPorUsuario;\r\n\t\tctrl.calcularTempo\t\t\t\t\t\t\t = calcularTempo;\r\n\r\n\t\t\r\n\t\t// VARIÁVEIS\r\n\r\n\t\tctrl.usuarioId  \t  = 0;\r\n\t\tctrl.usuarioDescricao = '';\r\n\r\n\t\tctrl.comentarioPadrao = {\r\n\t\t\tCOMENTARIO: null\r\n\t\t};\r\n\r\n\t\tctrl.campoPadrao = {\r\n\t\t\tROTULO\t: null,\r\n\t\t\tTIPO\t: '1'\r\n\t\t};\r\n\r\n\t\tctrl.arquivoPadrao = {\r\n\t\t\tNOME \t: null,\r\n\t\t\tTABELA \t: null,\r\n\t\t\tTIPO \t: null,\r\n\t\t\tTAMANHO\t: null,\r\n\t\t\tBINARIO\t: null,\r\n\t\t\tCONTEUDO: null\r\n\t\t};\r\n\r\n\t\tvar tempoTotal \t = 0;\r\n\t\tvar timeInterval = null;\r\n\r\n\r\n\t\t// Métodos iniciados ao carregar página.\r\n\t\tctrl.$onInit = function() {\r\n\r\n\t\t\tctrl.index29012.tarefa  = this;\r\n\t\t\tctrl.create29012.tarefa = this;\r\n\r\n\t\t\tctrl.usuarioId \t\t  = parseInt( $('#usuario-id').val() );\r\n\t\t\tctrl.usuarioDescricao = $('#usuario-descricao').val();\r\n\t\t};\r\n\r\n\t\t\r\n\t\t// MÉTODOS\r\n\r\n\t\tfunction alterarSituacao(situacao, tarefa) {\r\n\r\n\t\t\tverificarTarefa();\r\n\r\n\t\t\t// Limpar contagem de intervalo das movimentações.\r\n\t\t\tclearInterval(timeInterval);\r\n\t\t\ttimeInterval = null;\r\n\r\n\t\t\tvar param = {\r\n\t\t\t\t\tINFO_GERAL \t\t: ctrl.create29012.infoGeral.infoGeral,\r\n\t\t\t\t\tSITUACAO \t\t: situacao,\r\n\t\t\t\t\tTAREFA_ID \t\t: tarefa.ID,\r\n\t\t\t\t\tTAREFA_ATUAL\t: tarefa,\r\n\t\t\t\t\tTAREFA  \t\t: ctrl.tarefa,\r\n\t\t\t\t\tWORKFLOW_ITEM_ID: ctrl.create29012.infoGeral.infoGeral.ID\r\n\t\t\t\t};\r\n\r\n\t\t\t_29012TarefaService\r\n\t\t\t\t.alterarSituacao(param)\r\n\t\t\t\t.then(function(response) {\r\n\r\n\t\t\t\t\tif (situacao == 4) {\r\n\r\n\t\t\t\t\t\tctrl.index29012.carregarTarefa(response);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\ttarefa.STATUS_CONCLUSAO = situacao;\r\n\r\n\t\t\t\t\t\trecarregarMovimentacao(response.MOVIMENTACAO);\r\n\t\t\t\t\t\treabilitarBotaoAcao();\r\n\t\t\t\t\t\tctrl.calcularTempo(tarefa);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trecarregarProgresso(response.PROGRESSO[0].PROGRESSO);\r\n\t\t\t\t});\r\n\r\n\r\n\t\t\tfunction verificarTarefa() {\r\n\r\n\t\t\t\t// Se não for uma Reativação da Tarefa.\r\n\t\t\t\tif (situacao != 0) {\r\n\r\n\t\t\t\t\tvar msg  = '',\r\n\t\t\t\t\t\terro = false;\r\n\r\n\t\t\t\t\tif (tarefa.DO_USUARIO == 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tmsg  = 'Você não está listado para executar essa tarefa.';\r\n\t\t\t\t\t\terro = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// if (tarefa.USUARIO_CONCLUSAO_ID != null && tarefa.USUARIO_CONCLUSAO_ID != ctrl.usuarioId) {\r\n\r\n\t\t\t\t\t// \tmsg  = 'Outro usuário já iniciou essa tarefa.';\r\n\t\t\t\t\t// \terro = true;\r\n\t\t\t\t\t// }\r\n\r\n\r\n\t\t\t\t\tif (erro) {\r\n\r\n\t\t\t\t\t\tshowErro(msg);\r\n\t\t\t\t\t\tthrow msg;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction recarregarProgresso(progresso) {\r\n\r\n\t\t\t\tctrl.create29012.infoGeral.infoGeral.PROGRESSO = progresso;\r\n\t\t\t}\r\n\r\n\t\t\tfunction recarregarMovimentacao(movimentacao) {\r\n\r\n\t\t\t\ttarefa.MOVIMENTACAO = [];\r\n\r\n\t\t\t\tfor (var i in movimentacao) {\r\n\r\n\t\t\t\t\tmovimentacao[i].DATAHORA_FORMATADO = moment(movimentacao[i].DATAHORA).format('DD/MM/YYYY HH:mm:ss');\r\n\t\t\t\t\ttarefa.MOVIMENTACAO.push(movimentacao[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction reabilitarBotaoAcao() {\r\n\r\n\t\t\t\ttarefa.habilitarIniciar  = (situacao == 0 || situacao == 2) ? true : false;\r\n\t\t\t\ttarefa.habilitarPausar   = (situacao == 1) ? true : false;\r\n\t\t\t\ttarefa.habilitarConcluir = (situacao == 1) ? true : false;\r\n\r\n\t\t\t\t// Se a tarefa estiver sendo concluída.\r\n\t\t\t\tif (situacao == 3) {\r\n\t\t\t\t\r\n\t\t\t\t\tvar trf = {};\r\n\r\n\t\t\t\t\tfor (var i in ctrl.tarefa) {\r\n\r\n\t\t\t\t\t\ttrf = ctrl.tarefa[i];\r\n\r\n\t\t\t\t\t\t// Pular tarefa atual e tarefas concluídas.\r\n\t                    if ( (trf.ID != tarefa.ID) && (trf.STATUS_CONCLUSAO != '3') ) {\r\n\r\n\t                        // Se a tarefa tiver a sequência posterior à atual.\r\n\t                        if ( parseInt(tarefa.SEQUENCIA)+1 == parseInt(trf.SEQUENCIA) ) {\r\n\r\n\t                        \tfor (var j in trf.DESTINATARIO) {\r\n\r\n\t                        \t\t// Se for destinado para a próxima tarefa com sequência posterior à atual.\r\n\t\t                        \tif (trf.DESTINATARIO[j].USUARIO_ID == ctrl.usuarioId) {\r\n\r\n\t\t\t                            trf.habilitarIniciar = true;\r\n\t\t\t                            break;\r\n\t\t\t                        }\r\n\t\t\t                    }\r\n\r\n\t\t\t                    break;\r\n\t                        }\r\n\t                    }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction addComentario(tarefa) {\r\n\r\n\t\t\tvar comentarioNovo = {};\r\n\t\t\tangular.copy(ctrl.comentarioPadrao, comentarioNovo);\r\n\t\t\ttarefa.COMENTARIO.push(comentarioNovo);\r\n\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\t$('.comentario-container .scroll .form-group:last-of-type textarea').focus();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Gravar comentário.\r\n\t\t */\r\n\t\tfunction gravarWorkflowItemTarefaComentario(tarefa) {\r\n\r\n\t\t\tvar param = {\r\n\t\t\t\t\tCOMENTARIO \t\t  \t\t: tarefa.COMENTARIO,\r\n\t\t\t\t\tWORKFLOW_ID \t\t\t: tarefa.WORKFLOW_ID,\r\n\t\t\t\t\tWORKFLOW_ITEM_ID \t\t: tarefa.WORKFLOW_ITEM_ID,\r\n\t\t\t\t\tWORKFLOW_ITEM_TAREFA_ID : tarefa.ID,\r\n\t\t\t\t\tUSUARIO_ID \t\t\t\t: ctrl.usuarioId\r\n\t\t\t\t};\r\n\r\n\t        _29012TarefaService\r\n\t        \t.gravarWorkflowItemTarefaComentario(param)\r\n\t\t        .then(function(resp) {\r\n\t\t            \r\n\t\t            showSuccess('Gravado com sucesso.');\r\n\t\t            tarefa.COMENTARIO = resp;\r\n\t\t        });\r\n\t\t}\r\n\r\n\t\tfunction excluirComentario(tarefa, comentario) {\r\n\r\n\t\t\t// Só exclui do banco de dados se o comentário tiver ID, ou seja, já está gravado no banco.\r\n\t\t\tif (comentario.ID > 0) {\r\n\r\n\t\t\t\tcomentario.STATUSEXCLUSAO = '1';\r\n\t\t\t\ttarefa.existeComentarioParaExcluir = true;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\ttarefa.COMENTARIO.splice(tarefa.COMENTARIO.indexOf(comentario), 1);\r\n\r\n\t\t\t// Adiciona um comentário vazio se não tiver mais nenhum outro.\r\n\t\t\tif (tarefa.COMENTARIO.length == 0) {\r\n\t\t\t\tctrl.addComentario(tarefa);\r\n\t\t\t}\r\n\t\t\telse {\r\n\r\n\t\t\t\tvar possuiComent = false;\r\n\r\n\t\t\t\tfor(var i in tarefa.COMENTARIO)\r\n\t\t\t\t\tif (tarefa.COMENTARIO[i].STATUSEXCLUSAO == 0)\r\n\t\t\t\t\t\tpossuiComent = true;\r\n\r\n\t\t\t\tif (possuiComent == false)\r\n\t\t\t\t\tctrl.addComentario(tarefa);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction addCampo(tarefa) {\r\n\r\n\t\t\tvar campoNovo = {};\r\n\t\t\tangular.copy(ctrl.campoPadrao, campoNovo);\r\n\t\t\ttarefa.CAMPO.push(campoNovo);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Gravar campos dinâmicos.\r\n\t\t */\r\n\t\tfunction gravarWorkflowItemTarefaCampo(tarefa) {\r\n\r\n\t\t\tvar param = {\r\n\t\t\t\t\tCAMPO: tarefa.CAMPO\r\n\t\t\t\t};\r\n\r\n\t        _29012TarefaService\r\n\t        \t.gravarWorkflowItemTarefaCampo(param)\r\n\t\t        .then(function(resp) {\r\n\t\t            \r\n\t\t            showSuccess('Gravado com sucesso.');\r\n\t\t        });\r\n\t\t}\r\n\r\n\t\tfunction addArquivo(tarefa) {\r\n\r\n\t\t\tvar arquivoNovo = {};\r\n\t\t\tangular.copy(ctrl.arquivoPadrao, arquivoNovo);\r\n\t\t\ttarefa.ARQUIVO_DESTINATARIO.push(arquivoNovo);\r\n\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\t$('.arquivo-container .scroll .form-group:last-of-type input.arquivo-binario').focus();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Gravar arquivo do destinatário.\r\n\t\t */\r\n\t\tfunction gravarWorkflowItemArquivoDoDestinatario(tarefa) {\r\n\r\n\t\t\tvar param = {\r\n\t\t\t\t\tTAREFA_ID \t\t\t\t\t: tarefa.ID,\r\n\t\t\t\t\tARQUIVO_DESTINATARIO \t\t: tarefa.ARQUIVO_DESTINATARIO,\r\n\t\t\t\t\tARQUIVO_DESTINATARIO_EXCLUIR: tarefa.ARQUIVO_DESTINATARIO_EXCLUIR\r\n\t\t\t\t};\r\n\r\n\t        _29012TarefaService\r\n\t        \t.gravarWorkflowItemArquivoDoDestinatario(param)\r\n\t        \t.then(\r\n                    function(resp) {\r\n                        \r\n                        showSuccess('Gravado com sucesso.');\r\n                        tarefa.ARQUIVO_DESTINATARIO = resp.data.ARQUIVO;\r\n                        delete tarefa.ARQUIVO_DESTINATARIO_EXCLUIR;\r\n                    }, \r\n                    function(resp) {\r\n\r\n                        showErro('Erro ao gravar ('+ resp.status +')'); \r\n                    },\r\n                    function(e) {\r\n\r\n                        progressPagina(e);\r\n                    }\r\n                );\r\n\t\t}\r\n\r\n\t\tfunction processarArquivo(event, arquivo) {\r\n\r\n\t\t\tarquivo.NOME \t = event.target.files[0].name;\r\n\t\t\tarquivo.TABELA \t = 'TBWORKFLOW_ITEM_TAREFA_DESTINAT';\r\n\t\t\tarquivo.TIPO \t = event.target.files[0].type;\r\n\t\t\tarquivo.TAMANHO\t = event.target.files[0].size;\r\n\t\t}\r\n\r\n\t\tfunction excluirArquivo(tarefa, arquivo) {\r\n\r\n\t\t\t// Só adiciona para excluir do banco de dados se o arquivo tiver ID, ou seja, já está gravado no banco.\r\n\t\t\tif (arquivo.ID > 0) {\r\n\r\n\t\t\t\ttarefa.ARQUIVO_DESTINATARIO_EXCLUIR = (typeof tarefa.ARQUIVO_DESTINATARIO_EXCLUIR != 'undefined') \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? tarefa.ARQUIVO_DESTINATARIO_EXCLUIR \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: [];\r\n\t\t\t\ttarefa.ARQUIVO_DESTINATARIO_EXCLUIR.push(arquivo);\r\n\t\t\t}\r\n\r\n\t\t\ttarefa.ARQUIVO_DESTINATARIO.splice(tarefa.ARQUIVO_DESTINATARIO.indexOf(arquivo), 1);\r\n\r\n\t\t\t// Adiciona um arquivo vazio se não tiver mais nenhum outro.\r\n\t\t\tif (tarefa.ARQUIVO_DESTINATARIO.length == 0)\r\n\t\t\t\tctrl.addArquivo(tarefa);\r\n\t\t}\r\n\r\n\t\tfunction excluirArquivoTmpPorUsuario() {\r\n\r\n\t\t\tvar param = {\r\n\t\t\t\tDIRETORIO: 'workflowTarefa'\r\n\t\t\t};\r\n\r\n\t\t\t_29012TarefaService.excluirArquivoTmpPorUsuario(param);\r\n\t\t}\r\n\r\n\r\n\t\tfunction calcularTempo(tarefa) {\r\n\r\n\t\t\tif (tarefa.STATUS_CONCLUSAO == 1) {\r\n\t\t\t\tcalcular(tarefa);\r\n\t\t\t\tcalcularTempoAndamento(tarefa);\r\n\t\t\t}\r\n\t\t\t// reativando\r\n\t\t\telse if (tarefa.STATUS_CONCLUSAO == 0) {\r\n\r\n\t\t\t\ttarefa.TEMPO_CONCLUSAO \t\t\t= 0;\r\n\t\t\t\ttarefa.TEMPO_CONCLUSAO_HUMANIZE = 0;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tcalcular(tarefa);\r\n\r\n\r\n\t\t\tfunction calcular(tarefa) {\r\n\r\n\t\t\t\tvar mov \t\t\t= {},\r\n\t\t\t\t\ttempoCorrente \t= '',\r\n\t\t\t\t\tstatusCorrente\t= '',\r\n\t\t\t\t\ttempoProximo \t= '',\r\n\t\t\t\t\tdiferenca \t\t= 0,\r\n\t\t\t\t\ttempoTotalObj \t= null,\r\n\t\t\t\t\tmovOrdenado\t\t= tarefa\r\n\t\t\t\t\t\t\t\t\t\t.MOVIMENTACAO\r\n\t\t\t\t\t\t\t\t\t\t.sort(function(a, b) { return a.ID - b.ID; });\r\n\r\n\t\t\t\ttempoTotal = 0;\r\n\r\n\t\t\t\tfor (var i in movOrdenado) {\r\n\r\n\t\t\t\t\ti = parseInt(i);\r\n\r\n\t\t\t\t\t// último\r\n\t\t\t\t\tif ( i === movOrdenado.length-1 )\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tmov = movOrdenado[i];\r\n\r\n\t\t\t\t\ttempoCorrente \t= mov.DATAHORA;\r\n\t\t\t\t\tstatusCorrente \t= mov.STATUS_CONCLUSAO;\r\n\t\t\t\t\ttempoProximo\t= movOrdenado[i+1].DATAHORA;\r\n\r\n\t\t\t\t\t// se estiver em 'reativado'\r\n\t\t\t\t\tif (statusCorrente == '0') {\r\n\r\n\t\t\t\t\t\ttempoTotal = 0;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// se estiver em pausar ou finalizar e for o penúltimo item\r\n\t\t\t\t\tif ( (statusCorrente == '2' || statusCorrente == '3') && (i === (movOrdenado.length-2)) ) {\r\n\r\n\t\t\t\t\t\t// diferença entre tempos (ms)\r\n\t\t\t\t\t\tdiferenca =\tmoment().diff(moment(tempoProximo));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t// se o status não for 'iniciado'\r\n\t\t\t\t\t\tif ( statusCorrente != '1' )\r\n\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\t// diferença entre tempos (ms)\r\n\t\t\t\t\t\tdiferenca = moment(tempoProximo).diff(moment(tempoCorrente));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttempoTotal += diferenca;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttempoTotalObj = moment.duration(tempoTotal);\r\n\r\n\t\t\t\ttarefa.TEMPO_CONCLUSAO \t\t\t= tempoTotalObj.asMinutes().toFixed(4);\r\n\t\t\t\ttarefa.TEMPO_CONCLUSAO_HUMANIZE = tempoTotalObj.format('d[d] HH[h] mm[m] ss[s]');\r\n\t\t\t}\r\n\r\n\t\t\tfunction calcularTempoAndamento(tarefa) {\r\n\r\n\t\t        var movOrdenado\t= tarefa\r\n\t\t\t\t\t\t\t\t\t.MOVIMENTACAO\r\n\t\t\t\t\t\t\t\t\t.sort(function(a, b) { return a.ID - b.ID; });\r\n\r\n\t\t\t\tvar ultimaMov\t= movOrdenado[movOrdenado.length-1];\r\n\r\n\t\t\t\tvar ultimaData  = (ultimaMov.DATAHORA && (ultimaMov.STATUS_CONCLUSAO != 0))\t\t// se existir um registro e o status nesse registro não for parado (ou reativado)\r\n\t\t\t\t\t\t\t\t\t? movOrdenado[movOrdenado.length-1].DATAHORA \r\n\t\t\t\t\t\t\t\t\t: new Date();\r\n\r\n\t\t\t\tvar diferenca \t\t = moment(Clock.DATETIME_SERVER).diff(moment(ultimaData));\r\n\t\t\t\ttempoTotal \t\t\t+= diferenca;\r\n\t\t\t\tvar tempoTotalObj \t = moment.duration(tempoTotal);\r\n\t\t        \r\n\t\t        timeInterval = setInterval(function() {\r\n\r\n\t\t            $rootScope.$apply(function() {\r\n\r\n\t\t                tempoTotalObj = tempoTotalObj.add(1, 's');\r\n\t\t            \r\n\t\t                tarefa.TEMPO_CONCLUSAO \t\t\t= tempoTotalObj.asMinutes().toFixed(4);\r\n\t\t                tarefa.TEMPO_CONCLUSAO_HUMANIZE = tempoTotalObj.format('d[d] HH[h] mm[m] ss[s]');\r\n\t\t            });\r\n\t\t        }, 1000);\r\n\t\t    }\r\n\t\t}\r\n\r\n\t}"]}