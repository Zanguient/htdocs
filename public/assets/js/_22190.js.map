{"version":3,"sources":["_22190.app.js","_22190.factory.sse.js","_22190.factory.operador.js","_22190.factory.talao-detalhe.js","_22190.factory.talao-produzir.js","_22190.factory.talao-produzido.js","_22190.factory.talao-historico.js","_22190.factory.talao-consumo.js","_22190.factory.talao.js","_22190.factory.filtro.js","_22190.controller.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_22190.js","sourcesContent":["'use strict';\n\nangular\n\t.module('app', [\n\t\t'vs-repeat', \n        'gc-find',\n\t\t'gc-ajax',\n\t\t'gc-transform',\n\t\t'gc-form',\n\t\t'gc-utils'\n\t])\n;\n     ","angular\n    .module('app')\n    .factory('ServerEvent', ServerEvent);\n    \n\n\tServerEvent.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction ServerEvent($ajax, $httpParamSerializer, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function ServerEvent(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.SSE = this; \n        \n        this.connection = null;\n        this.SELECTED = {};\n        this.UPDATED = true;\n        this.LAST_UPDATE = null;\n    }\n\n    \n    ServerEvent.prototype.connect = function() {\n\n        var that = this;\n        var url = '_22190/sse/taloes/composicao?'+$httpParamSerializer(gScope.Filtro);\n        \n        if(typeof(EventSource) !== \"undefined\") {\n        var evtSource = new EventSource(url);\n        } else {\n            showErro('Opss... Ocorreu uma falha!<br/>Seu navegador não possui suporte para eventos dinâmicos.<br><b>Recomendamos a utilização do Google Chrome.</b><br/>Entre em contato com suporte técnico para esclarecer demais dúvidas.');\n        }\n\n        evtSource.onmessage = function(e) {\n            $rootScope.$apply(function(){\n                var response = JSON.parse(event.data);\n                \n                if ( !that.UPDATED ) {\n                    showSuccess('Os dados foram atualizados!');\n                }\n                \n                gScope.Filtro.merge(response,true);\n                \n                \n                that.LAST_UPDATE = Clock.DATETIME_SERVER;\n                that.UPDATED     = false;\n            });\n        };\n        evtSource.onerror = function() {\n          showErro('Opss... Ocorreu uma falha!<br/>Os eventos dinâmicos foram desconectados.<br/><b>Estamos tentando reconectar automaticamente...</b><br/>Se o erro pesistir, entre em contato com suporte técnico.');\n        };\n        \n        this.connection = evtSource;\n\n    };\n\n    ServerEvent.prototype.close = function(item,action) {\n        \n        if ( this.connection != undefined ) {\n        \n            this.connection.close();    \n            this.connection = undefined;\n        }\n\n    };    \n\n\n\n    /**\n     * Return the constructor function\n     */\n    return ServerEvent;\n};","angular\n    .module('app')\n    .factory('Operador', Operador);\n    \n\n\tOperador.$inject = [\n        '$ajax',\n        '$q',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction Operador($ajax, $q, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function Operador(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.Operador = this; \n        \n        this.DADOS = [];\n        this.SELECTED = {};\n        this.BARRAS       = '';\n        this.OPERACAO_ID  = 7;\n        this.VALOR_EXT    = 1;\n        this.ABORT        = true;\n        this.VERIFICAR_UP = true;\n        this.AUTENTICADO  = false;\n        \n    }\n    \n    \n    Operador.prototype.consultar = function() {\n        \n        var that = this;\n        \n        return $q(function(resolve, reject){\n            $ajax.post('/_22050/autenticacao',that)\n                .then(function(response) {\n\n                    that.SELECTED = response[0];\n                    that.AUTENTICADO  = true;\n                    that.close();\n\n                    resolve(that.SELECTED);\n                },function(erro){\n                    that.BARRAS = '';\n                    modal.find('input:focusable').first().focus();\n                    \n                    reject(erro);\n                }\n            );        \n        });\n    };\n   \n    Operador.prototype.open = function() {\n        \n        var that = this;\n        if ( isEmpty(this.SELECTED) ) {        \n            this.show(function(){\n                modal.find('input:focusable').first().focus();\n            },function(){\n                that.BARRAS = '';\n            });\n        } else {\n            addConfirme('<h4>Confirmação</h4>',\n                'Deseja sair da sessão do operador <b>' + that.SELECTED.OPERADOR_NOME + '</b>?',\n                [obtn_sim,obtn_nao],\n                [{ret:1,func:function(){\n                    $rootScope.$apply(function(){\n\n                        that.SELECTED = {};\n                        that.AUTENTICADO = false;\n                    });\n                }}]     \n            );\n        }\n    };\n\n    var modal = $('#modal-operador');\n    \n    Operador.prototype.show = function(shown,hidden) {\n\n        modal\n            .modal('show')\n        ;                         \n        \n        if ( shown ) {\n            modal\n                .one('shown.bs.modal', function(){\n                    shown();\n                })\n            ;     \n        }\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden();\n                })\n            ;              \n        }\n    };\n\n    Operador.prototype.close = function(hidden) {\n\n        modal\n            .modal('hide')\n        ;\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden ? hidden() : '';\n                })\n            ;                      \n        }\n    };\n     \n\n    /**\n     * Return the constructor function\n     */\n    return Operador;\n};","angular\n    .module('app')\n    .factory('TalaoDetalhe', TalaoDetalhe);\n    \n\n\tTalaoDetalhe.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction TalaoDetalhe($ajax, $httpParamSerializer, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoDetalhe(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.TalaoDetalhe = this; \n        \n        this.DADOS = [];\n        this.SELECTED = {};\n        this.SELECTEDS = [];\n        this.SELECTEDS_PRODUZIR = [];\n    }\n    \n    TalaoDetalhe.prototype.checkAll = function() {\n        \n        var taloes = gScope.Talao.SELECTED.DETALHES;\n        for ( var i in taloes ) {\n            var detalhe = taloes[i];\n            \n            this.SELECTEDS.push(detalhe);\n            \n            if ( detalhe.TALAO_DETALHE_STATUS < 2 ) {\n                this.SELECTEDS_PRODUZIR.push(detalhe);\n            }            \n        }\n    };\n    \n    TalaoDetalhe.prototype.uncheckAll = function() {\n        this.SELECTEDS = [];\n        this.SELECTEDS_PRODUZIR = [];\n    };\n   \n    \n\n\n    TalaoDetalhe.prototype.pick = function(item,action) {\n\n        \n        \n        var that = this;\n        \n        var idx = this.SELECTEDS.indexOf(item);\n        var idx_prod = this.SELECTEDS_PRODUZIR.indexOf(item);\n        \n        if ( idx == -1 ) {\n            this.SELECTEDS.push(item);\n\n\n            if ( item.TALAO_DETALHE_STATUS < 2 ) {\n                this.SELECTEDS_PRODUZIR.push(item);\n            }\n            \n        } else {\n            this.SELECTEDS.splice(idx,1);\n        }\n        \n        if ( idx_prod > -1 ) {\n            this.SELECTEDS_PRODUZIR.splice(idx_prod,1);\n        }\n        \n    };    \n\n\n    TalaoDetalhe.prototype.confirm = function () {\n        var that = this;\n\n        var dados = {\n            FILTRO: gScope.ConsumoBaixarFiltro,\n            DADOS: {\n                ITENS : that.ITENS_BAIXAR,\n                PESO : that.PESO\n            }\n        };\n        \n        \n        that.enableButton(false);\n        \n        $ajax.post('/_22160/api/consumo-baixar/post',dados,{complete: function(){\n                \n            that.enableButton(true);\n            \n        }}).then(function(response){\n        \n            postprint(response.ETIQUETAS);        \n        \n            gScope.ConsumoBaixarFiltro.merge(response.DATA_RETURN);\n            that.close();\n            \n        });        \n    };  \n\n    TalaoDetalhe.prototype.setItens = function () {\n        \n        this.ITENS_BAIXAR = [];\n        var array = this.ITENS_BAIXAR;\n        \n        if ( this.SELECTED.FILTERED == undefined ) {\n            array.push(this.SELECTED);\n        } else {\n            \n            var quantidade = 0;\n            for ( var i in this.SELECTED.FILTERED ) {\n                \n                var item = this.SELECTED.FILTERED[i];\n                \n                quantidade += item.QUANTIDADE_SALDO;\n                \n                if ( quantidade <= (this.PESO + item.QUANTIDADE_SALDO) ) {\n                    array.push(item);                    \n                } else {\n                    break;\n                }\n            }\n        }\n    };  \n\n    TalaoDetalhe.prototype.inputKeydown = function($event) {\n         \n        if ( this.PESO_AUTOMATICO ) {\n            if ( isNumber($event.key) || $event.key == 'Backspace' || $event.key == 'Delete' ) {\n                $event.preventDefault();\n            }\n        }\n    };\n    \n\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoDetalhe;\n};","angular\n    .module('app')\n    .factory('TalaoProduzir', TalaoProduzir);\n    \n\n\tTalaoProduzir.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction TalaoProduzir($ajax, $httpParamSerializer, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoProduzir(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.TalaoProduzir = this; \n        \n        this.DADOS = [];\n        this.SELECTED = {};\n        this.FILTRO = {};\n        \n        var that = this;\n        $timeout(function(){\n            \n            if ( that.FILTRO.ESTABELECIMENTO_ID > 0 ) {\n                \n                gScope.ConsultaGp.autoload = false;\n                gScope.ConsultaEstabelecimento.option.data_request.ESTABELECIMENTO_ID = [that.FILTRO,'ESTABELECIMENTO_ID'];\n                gScope.ConsultaEstabelecimento.filtrar();\n                delete gScope.ConsultaEstabelecimento.option.data_request.ESTABELECIMENTO_ID;\n            }\n            \n            gScope.ConsultaEstabelecimento.onSelect = function(){\n                if ( that.FILTRO.GP_ID > 0 ) {\n                    gScope.ConsultaUp.autoload = false;\n                    gScope.ConsultaGp.option.data_request.GP_ID = [that.FILTRO,'GP_ID'];\n                    gScope.ConsultaGp.filtrar();\n                    delete gScope.ConsultaGp.option.data_request.GP_ID;   \n                }\n            };\n\n            gScope.ConsultaGp.onSelect = function(){\n                gScope.ConsultaGp.autoload = true;\n                if ( that.FILTRO.UP_ID > 0 ) {\n                    gScope.ConsultaEstacao.autoload = false;\n                    gScope.ConsultaUp.option.data_request.UP_ID = [that.FILTRO,'UP_ID'];\n                    gScope.ConsultaUp.filtrar();\n                    delete gScope.ConsultaUp.option.data_request.UP_ID;   \n                }\n            };\n\n            gScope.ConsultaUp.onSelect = function(){\n                gScope.ConsultaUp.autoload = true;\n                if ( that.FILTRO.ESTACAO > 0 ) {\n                    gScope.ConsultaEstacao.option.data_request.ESTACAO = [that.FILTRO,'ESTACAO'];\n                    gScope.ConsultaEstacao.filtrar();\n                    delete gScope.ConsultaEstacao.option.data_request.ESTACAO;   \n                }\n            };\n            \n            gScope.ConsultaEstacao.onSelect = function() {\n                if ( that.FILTRO.ESTACAO > 0 ) {\n                    gScope.Filtro.consultar().then(function(){\n                        if ( that.FILTRO.TALAO_ID > 0 ) {\n                            $timeout(function(){\n                                $('[data-talao-id=\"' + that.FILTRO.TALAO_ID + '\"]:focusable').focus().click();\n                            });\n                        }\n                    });\n                }\n            };\n//\n\n//                    \n//\n//                    if ( that.FILTRO.UP_ID > 0 ) {\n//                        gScope.ConsultaUp.option.filtro_sql = { UP_ID: that.FILTRO.UP_ID };\n//                        gScope.ConsultaUp.filtrar();\n//                        gScope.ConsultaUp.option.filtro_sql = {};\n//                        \n//\n//                        if ( that.FILTRO.ESTACAO > 0 ) {\n//                            gScope.ConsultaEstacao.option.filtro_sql = { ESTACAO: that.FILTRO.ESTACAO };\n//                            gScope.ConsultaEstacao.filtrar();\n//                            gScope.ConsultaEstacao.option.filtro_sql = {};\n//                        }  \n//                        \n//                    }   \n//\n//                }         \n              \n            \n            \n        });        \n    }\n    \n    \n    TalaoProduzir.prototype.consultar = function() {\n        \n        var that = this;\n        \n//        loading('.main-ctrl');     \n        \n\n        \n        var data = {};\n\n        angular.copy(that, data);\n        \n        if ( this.DATA_TODOS ) {\n            delete data.DATA_1;\n            delete data.DATA_2;\n        }\n        \n        data.PROGRAMACAO_STATUS = \"< 3\";\n        data.GP_ID              = gScope.ConsultaGp.GP_ID;\n        data.UP_ID              = gScope.ConsultaUp.UP_ID;\n        data.ESTACAO            = gScope.ConsultaEstacao.ESTACAO;\n        \n        $ajax.post('/_22190/api/talao',data,{progress: false}).then(function(response){\n            \n            that.merge(response);\n            \n//            loading('hide');\n            \n        });\n    };\n   \n    TalaoProduzir.prototype.acao = function (tipo) {\n        var that = this;\n\n        var talao = gScope.Talao.SELECTED;\n        talao.ULTIMO_TALAO = true;\n        for ( var i in talao.DETALHES ) {\n            var detalhe = talao.DETALHES[i];\n            \n            if ( detalhe.TALAO_DETALHE_STATUS < 2 ) {\n                var idx = gScope.TalaoDetalhe.SELECTEDS_PRODUZIR.indexOf(detalhe);\n                \n                if ( idx == -1 ) {\n                    talao.ULTIMO_TALAO = false;\n                    break;\n                }\n            }\n        }\n\n        var dados = {\n            FILTRO: gScope.Filtro,\n            DADOS: {\n                ITENS              : gScope.TalaoDetalhe.SELECTEDS_PRODUZIR,\n                TALAO              : gScope.Talao.SELECTED,\n                ESTABELECIMENTO_ID : gScope.ConsultaEstabelecimento.ESTABELECIMENTO_ID,\n                UP_ID              : gScope.ConsultaUp.UP_ID,\n                ESTACAO            : gScope.ConsultaEstacao.ESTACAO,\n                OPERADOR_ID        : gScope.Operador.SELECTED.OPERADOR_ID\n            }\n        };\n                \n        $ajax.post('/_22190/api/taloes/acao/'+tipo,dados).then(function(response){\n\n            if ( response.ETIQUETAS != undefined && response.ETIQUETAS.trim() != '' ) {\n                postprint(response.ETIQUETAS);\n            }          \n\n            if ( response.DATA_RETURN != undefined ) {\n                gScope.Filtro.merge(response.DATA_RETURN);\n            }\n            \n            if ( tipo == 'finalizar' ) {\n                \n                gScope.TalaoDetalhe.SELECTEDS_PRODUZIR = [];\n                \n                if ( indexOfAttr(gScope.TalaoProduzir.DADOS,'TALAO_ID',gScope.Talao.SELECTED.TALAO_ID) == -1 ) {\n                    gScope.Talao.close();\n                }\n            }  \n        },function(){\n            \n        });\n    };\n    \n    TalaoProduzir.prototype.check = function (acao,arg_talao) {\n\n        var ret         = {\n            status    : true,\n            descricao : ''\n        };\n\n        var em_producao = gScope.TalaoProduzir.EM_PRODUCAO || false;\n        var talao       = arg_talao != undefined ? arg_talao : gScope.Talao.SELECTED ;\n\n        if ( talao.PROGRAMACAO_STATUS > 2 ) {\n            ret.status = false;\n        } else\n        if ( isEmpty(gScope.Operador.SELECTED) ) {\n            ret.status = false;\n            ret.descricao = 'Operador não autenticado.';\n        }\n                        \n        if ( ret.status ) {\n            switch(acao) {\n                case 'iniciar':\n\n                    if ( talao.REMESSA_LIBERADA == 0 ) {\n                        ret.status = false;\n                        ret.descricao = 'Remessa bloqueada para produção';\n                    } else\n                    if ( talao.ESTOQUE_STATUS == '0' ) {\n                        ret.status = false;\n                        ret.descricao = 'Talão sem estoque para o consumo';\n                    } else                    \n                    if ( talao.PROGRAMACAO_STATUS == 1 ) {\n                        ret.descricao = 'Talão parado';\n                    } else                    \n                    if ( talao.PROGRAMACAO_STATUS > 1 ) {\n                        ret.status = false;\n                    }                \n\n                    break;\n                case 'pausar':\n\n                    // Se estiver em produção \n                    if ( talao.PROGRAMACAO_STATUS != 2 ) {\n                        ret.status = false;\n                    }  \n\n                    break;\n                case 'finalizar':\n\n                    // Se estiver em produção \n                    if ( talao.PROGRAMACAO_STATUS < 2 ) {\n                        ret.status = false;\n                    }  \n                    else                 \n                    if ( gScope.TalaoDetalhe.SELECTEDS_PRODUZIR.length == 0 ) {\n                        ret.status = false;\n                        ret.descricao = 'Selecione um detalhamento não produzido.';\n                    }\n//                \n//                    // Se estiver em produção \n////                    if ( gScope.Talao.SELECTED.PROGRAMACAO_STATUS < 2 ) {\n//                        ret.status = false;\n////                    }  \n\n                    break;\n                case 'imprimir':\n\n                    var talao_produzido = gScope.TalaoProduzido.SELECTED;\n\n\n                    // Se não estiver na tela de produção\n                    if ( gScope.Filtro.GUIA_ATIVA != 'TALAO_PRODUZIDO' ) {\n                        ret.status    = false;\n                    } else                 \n                    if ( talao_produzido == undefined ) {\n                        ret.status    = false;\n                        ret.descricao = 'Selecione um talão';\n                    }\n\n                    break;\n            }\n        }\n        \n        return ret;\n    };\n    \n    \n\n    /**\n     * Return the constructor function\n     */\n    return TalaoProduzir;\n};","angular\n    .module('app')\n    .factory('TalaoProduzido', TalaoProduzido);\n    \n\n\tTalaoProduzido.$inject = [\n        '$ajax',\n        '$q',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction TalaoProduzido($ajax, $q, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoProduzido(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.TalaoProduzido = this; \n        \n        this.DADOS = [];\n        this.SELECTED = {};\n        this.FILTRO = {};\n              \n    }\n    \n    \n    TalaoProduzido.prototype.consultar = function() {\n        \n        var that = this;\n        \n        return $q(function(resolve, reject){\n            \n            var data = {};\n\n            angular.copy(gScope.Filtro, data);\n\n            if ( !data.DATA_TODOS ) {                \n                data.DATA_PRODUCAO      = \"BETWEEN '\" + moment(data.DATA_1).format('YYYY.MM.DD') + \"' AND '\" + moment(data.DATA_2).format('YYYY.MM.DD') + \"'\";\n            }\n            \n            delete data.DATA_1;\n            delete data.DATA_2;\n                \n            data.PROGRAMACAO_STATUS = \"= 3\";\n            data.GP_ID              = gScope.ConsultaGp.GP_ID;\n            data.UP_ID              = gScope.ConsultaUp.UP_ID;\n            data.ESTACAO            = gScope.ConsultaEstacao.ESTACAO;\n\n            $ajax.post('/_22190/api/talao',data).then(function(response){\n\n                that.merge(response);\n\n            });\n            \n        });\n    };\n   \n\n    TalaoProduzido.prototype.merge = function(response,auto) {\n\n\n        var taloes = [];\n        if ( response.TALAO != undefined ) {\n            taloes = [response.TALAO];\n        } else {\n            taloes = response;\n        }\n        \n        sanitizeJson(response);\n        gcCollection.merge(this.DADOS, taloes, 'TALAO_ID');  \n        \n\n        if ( response.CONSUMOS != undefined ) {\n            sanitizeJson(response.DETALHES);\n            sanitizeJson(response.CONSUMOS);\n            sanitizeJson(response.HISTORICOS);   \n            sanitizeJson(response.ALOCADOS);\n\n            gcCollection.bind(response.CONSUMOS, response.ALOCADOS, 'CONSUMO_ID', 'ALOCACOES');   \n            gcCollection.bind(this.DADOS, response.DETALHES, ['REMESSA_ID','REMESSA_TALAO_ID'], 'DETALHES');\n            gcCollection.bind(this.DADOS, response.CONSUMOS, 'TALAO_ID', 'CONSUMOS');\n            gcCollection.bind(this.DADOS, response.HISTORICOS, 'PROGRAMACAO_ID', 'HISTORICOS');     \n\n            for ( var i in this.DADOS ) {\n\n                var talao = this.DADOS[i];\n\n                talao.CONSUMO_STATUS = '1';\n                talao.ESTOQUE_STATUS = '1';\n\n\n                for ( var y in talao.CONSUMOS ) {\n\n                    var consumo = talao.CONSUMOS[y];\n\n\n                    if ( talao.ESTOQUE_STATUS == '1' && consumo.ESTOQUE_STATUS == 0 ) {\n                        talao.ESTOQUE_STATUS = '0';\n                    }  \n\n                    talao.ULTIMO_TALAO = true;\n                    var i = 0;\n                    for ( var y in talao.DETALHES ) {\n\n\n                        var detalhe = talao.DETALHES[y];\n\n                        if ( detalhe.TALAO_DETALHE_STATUS < 2 ) {\n                            i++;    \n                        }\n\n                        if ( i > 1 ) {\n                            talao.ULTIMO_TALAO = false;\n                            break;\n                        }\n                    }                \n                }\n            }        \n        }\n    };   \n    \n\n    /**\n     * Return the constructor function\n     */\n    return TalaoProduzido;\n};","angular\n    .module('app')\n    .factory('TalaoHistorico', TalaoHistorico);\n    \n\n\tTalaoHistorico.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction TalaoHistorico($ajax, $httpParamSerializer, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoHistorico(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.TalaoHistorico = this; \n        \n        this.DADOS = [];\n        this.SELECTED = {};\n    }\n    \n    TalaoHistorico.prototype.consultar = function() {\n        \n        var that = this;\n        \n//        loading('.main-ctrl');     \n        \n\n        \n        var data = {};\n\n        angular.copy(that, data);\n        \n        if ( this.DATA_TODOS ) {\n            delete data.DATA_1;\n            delete data.DATA_2;\n        }\n        \n        data.PROGRAMACAO_STATUS = \"< 3\";\n        data.GP_ID              = gScope.ConsultaGp.GP_ID;\n        data.UP_ID              = gScope.ConsultaUp.UP_ID;\n        data.ESTACAO            = gScope.ConsultaEstacao.ESTACAO;\n        \n        $ajax.post('/_22190/api/talao',data,{progress: false}).then(function(response){\n            \n            that.merge(response);\n            \n//            loading('hide');\n            \n        });\n    };\n   \n    \n\n\n    TalaoHistorico.prototype.pick = function(item,action) {\n        \n        var that = this;\n\n        if ( item != undefined ) {\n        \n            this.SELECTED = item;\n\n            if ( action == 'modal-open' ) {\n                that.open();\n            }\n        }\n\n    };    \n\n\n \n    var modal = $('#modal-talao');\n    \n    TalaoHistorico.prototype.open = function() {\n        \n        var that = this;\n        if ( this.SELECTED != undefined ) {\n            \n            this.show();\n        }\n        \n    };\n  \n\n    TalaoHistorico.prototype.confirm = function () {\n        var that = this;\n\n        var dados = {\n            FILTRO: gScope.ConsumoBaixarFiltro,\n            DADOS: {\n                ITENS : that.ITENS_BAIXAR,\n                PESO : that.PESO\n            }\n        };\n        \n        \n        that.enableButton(false);\n        \n        $ajax.post('/_22160/api/consumo-baixar/post',dados,{complete: function(){\n                \n            that.enableButton(true);\n            \n        }}).then(function(response){\n        \n            postprint(response.ETIQUETAS);        \n        \n            gScope.ConsumoBaixarFiltro.merge(response.DATA_RETURN);\n            that.close();\n            \n        });        \n    };  \n\n    TalaoHistorico.prototype.setItens = function () {\n        \n        this.ITENS_BAIXAR = [];\n        var array = this.ITENS_BAIXAR;\n        \n        if ( this.SELECTED.FILTERED == undefined ) {\n            array.push(this.SELECTED);\n        } else {\n            \n            var quantidade = 0;\n            for ( var i in this.SELECTED.FILTERED ) {\n                \n                var item = this.SELECTED.FILTERED[i];\n                \n                quantidade += item.QUANTIDADE_SALDO;\n                \n                if ( quantidade <= (this.PESO + item.QUANTIDADE_SALDO) ) {\n                    array.push(item);                    \n                } else {\n                    break;\n                }\n            }\n        }\n    };  \n\n    TalaoHistorico.prototype.show = function(shown,hidden) {\n\n        modal\n            .modal('show')\n        ;                         \n        \n        if ( shown ) {\n            modal\n                .one('shown.bs.modal', function(){\n                    shown();\n                })\n            ;     \n        }\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden();\n                })\n            ;              \n        }\n    };\n\n    TalaoHistorico.prototype.close = function(hidden) {\n\n        modal\n            .modal('hide')\n        ;\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden ? hidden() : '';\n                })\n            ;                      \n        }\n    };\n    \n    TalaoHistorico.prototype.inputKeydown = function($event) {\n         \n        if ( this.PESO_AUTOMATICO ) {\n            if ( isNumber($event.key) || $event.key == 'Backspace' || $event.key == 'Delete' ) {\n                $event.preventDefault();\n            }\n        }\n    };\n    \n\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoHistorico;\n};","angular\n    .module('app')\n    .factory('TalaoConsumo', TalaoConsumo);\n    \n\n\tTalaoConsumo.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction TalaoConsumo($ajax, $httpParamSerializer, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoConsumo(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.TalaoConsumo = this; \n        \n        this.DADOS = [];\n        this.COMPONENTE_DADOS = [];\n        this.ALOCADOS = [];\n        this.SELECTED = {};\n    }\n    \n    TalaoConsumo.prototype.consultar = function() {\n        \n        var that = this;\n        \n//        loading('.main-ctrl');     \n        \n\n        \n        var data = {};\n\n        angular.copy(that, data);\n        \n        if ( this.DATA_TODOS ) {\n            delete data.DATA_1;\n            delete data.DATA_2;\n        }\n        \n        data.PROGRAMACAO_STATUS = \"< 3\";\n        data.GP_ID              = gScope.ConsultaGp.GP_ID;\n        data.UP_ID              = gScope.ConsultaUp.UP_ID;\n        data.ESTACAO            = gScope.ConsultaEstacao.ESTACAO;\n        \n        $ajax.post('/_22190/api/talao',data,{progress: false}).then(function(response){\n            \n            that.merge(response);\n            \n//            loading('hide');\n            \n        });\n    };\n   \n    \n\n\n    TalaoConsumo.prototype.pick = function(item,action) {\n        \n        var that = this;\n\n        if ( item != undefined ) {\n        \n            this.SELECTED = item;\n\n            if ( action == 'modal-open' ) {\n                that.open();\n            }\n        }\n\n    };    \n\n    TalaoConsumo.prototype.componenteAlocadoDelete = function(componente) {\n        var data = {\n            DADOS : componente,\n            FILTRO : {\n                REMESSA_ID          : gScope.Talao.SELECTED.REMESSA_ID,\n                REMESSA_TALAO_ID    : gScope.Talao.SELECTED.REMESSA_TALAO_ID,\n                TALAO_ID : gScope.Talao.SELECTED.TALAO_ID\n            }\n        };        \n        \n        $ajax.post('/_22190/api/consumo/componente/alocado/delete',data).then(function(response){\n            gScope.Talao.mergeComposicao(response.DATA_RETURN.DADOS);\n        });       \n\n    };    \n\n\n\n    $(document).off('click', '.alocado-excluir').on('click', '.alocado-excluir', function() {\n        var _this   = this;\n        \n        $ajax.post('/_22010/projecaoVinculoExcluir',{id: $(_this).data('talao-vinculo-id')}).then(function(response){\n            $('.popover').remove();\n            gScope.Talao.consultarComposicao();\n            \n        });        \n        \n    });\n\n    TalaoConsumo.prototype.componenteRegistrar = function(item,action) {\n        \n        var that = this;\n\n        var data = {\n            DADOS : {\n                COMPONENTE_BARRAS   : that.COMPONENTE_BARRAS,\n                TALAO_ID            : gScope.Talao.SELECTED.TALAO_ID,\n                REMESSA_ID          : gScope.Talao.SELECTED.REMESSA_ID,\n                REMESSA_TALAO_ID    : gScope.Talao.SELECTED.REMESSA_TALAO_ID\n            },\n            FILTRO : {\n                REMESSA_ID          : gScope.Talao.SELECTED.REMESSA_ID,\n                REMESSA_TALAO_ID    : gScope.Talao.SELECTED.REMESSA_TALAO_ID,\n                TALAO_ID : gScope.Talao.SELECTED.TALAO_ID\n            }\n        };\n        \n        $ajax.post('/_22190/api/consumo/componente/alocar',data).then(function(response){\n            \n            gScope.Talao.mergeComposicao(response.DATA_RETURN.DADOS);\n            $('#modal-registrar-componente').modal('hide');\n            \n        },function(){\n            that.COMPONENTE_BARRAS = '';\n        });\n    };    \n\n    TalaoConsumo.prototype.componenteModalOpen = function(item,action) {\n        \n        var that = this;\n\n        that.COMPONENTE_BARRAS = '';\n        \n        var modal = $('#modal-registrar-componente');\n        \n        modal.modal('show');\n        \n        modal.one('shown.bs.modal', function() {\n            $(this).find('input:focusable').first().focus();\n        });\n    };    \n\n\n    var modal = $('#modal-talao');\n    \n    TalaoConsumo.prototype.open = function() {\n        \n        var that = this;\n        if ( this.SELECTED != undefined ) {\n            \n            this.show();\n        }\n        \n    };\n  \n\n    TalaoConsumo.prototype.confirm = function () {\n        var that = this;\n\n        var dados = {\n            FILTRO: gScope.ConsumoBaixarFiltro,\n            DADOS: {\n                ITENS : that.ITENS_BAIXAR,\n                PESO : that.PESO\n            }\n        };\n        \n        \n        that.enableButton(false);\n        \n        $ajax.post('/_22160/api/consumo-baixar/post',dados,{complete: function(){\n                \n            that.enableButton(true);\n            \n        }}).then(function(response){\n        \n            postprint(response.ETIQUETAS);        \n        \n            gScope.ConsumoBaixarFiltro.merge(response.DATA_RETURN);\n            that.close();\n            \n        });        \n    };  \n\n    TalaoConsumo.prototype.setItens = function () {\n        \n        this.ITENS_BAIXAR = [];\n        var array = this.ITENS_BAIXAR;\n        \n        if ( this.SELECTED.FILTERED == undefined ) {\n            array.push(this.SELECTED);\n        } else {\n            \n            var quantidade = 0;\n            for ( var i in this.SELECTED.FILTERED ) {\n                \n                var item = this.SELECTED.FILTERED[i];\n                \n                quantidade += item.QUANTIDADE_SALDO;\n                \n                if ( quantidade <= (this.PESO + item.QUANTIDADE_SALDO) ) {\n                    array.push(item);                    \n                } else {\n                    break;\n                }\n            }\n        }\n    };  \n\n    TalaoConsumo.prototype.show = function(shown,hidden) {\n\n        modal\n            .modal('show')\n        ;                         \n        \n        if ( shown ) {\n            modal\n                .one('shown.bs.modal', function(){\n                    shown();\n                })\n            ;     \n        }\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden();\n                })\n            ;              \n        }\n    };\n\n    TalaoConsumo.prototype.close = function(hidden) {\n\n        modal\n            .modal('hide')\n        ;\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden ? hidden() : '';\n                })\n            ;                      \n        }\n    };\n    \n    TalaoConsumo.prototype.inputKeydown = function($event) {\n         \n        if ( this.PESO_AUTOMATICO ) {\n            if ( isNumber($event.key) || $event.key == 'Backspace' || $event.key == 'Delete' ) {\n                $event.preventDefault();\n            }\n        }\n    };\n    \n\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoConsumo;\n};","angular\n    .module('app')\n    .factory('Talao', Talao);\n    \n\n\tTalao.$inject = [\n        '$ajax',\n        '$q',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gcObject',\n        'gScope'\n    ];\n\nfunction Talao($ajax, $q, $rootScope, $timeout, gcCollection, gcObject, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function Talao(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.Talao = this; \n        \n        this.DADOS = [];\n        this.FILTERED = [];\n        this.SELECTED = {};\n    }\n    \n    var data = {};\n    \n    Talao.prototype.consultar = function() {\n        \n        var that = this;\n        \n//        loading('.main-ctrl');     \n        \n\n        \n\n        angular.copy(that, data);\n        \n        if ( this.DATA_TODOS ) {\n            delete data.DATA_1;\n            delete data.DATA_2;\n        }\n        \n        data.PROGRAMACAO_STATUS = \"< 3\";\n        data.GP_ID              = gScope.ConsultaGp.GP_ID;\n        data.UP_ID              = gScope.ConsultaUp.UP_ID;\n        data.ESTACAO            = gScope.ConsultaEstacao.ESTACAO;\n        \n        $ajax.post('/_22190/api/talao',data,{progress: false}).then(function(response){\n            \n            that.merge(response);\n            \n//            loading('hide');\n            \n        });\n    };\n   \n    \n    Talao.prototype.consultarComposicao = function() {\n\n        var that = this;\n        \n        return $q(function(resolve,reject){\n        \n            $ajax.post('/_22190/api/talao/composicao',that.SELECTED).then(function(response){\n\n                that.mergeComposicao(response);\n            \n                \n                resolve(response);\n            },function(erro){\n                reject(erro);\n            });\n        });\n    };    \n    \n    Talao.prototype.mergeComposicao = function(response) {\n         \n  \n        sanitizeJson(response.TALAO);\n        \n        var taloes = [];\n\n        if ( response.CONSUMOS != undefined ) {\n            sanitizeJson(response.DETALHES);\n            sanitizeJson(response.CONSUMOS);\n            sanitizeJson(response.HISTORICOS);   \n            sanitizeJson(response.ALOCADOS);\n            sanitizeJson(response.COMPONENTES);\n\n            gcCollection.bind(response.CONSUMOS, response.ALOCADOS, 'CONSUMO_ID', 'ALOCACOES');   \n            gcObject.bind(response.TALAO, response.DETALHES, ['REMESSA_ID','REMESSA_TALAO_ID'], 'DETALHES');\n            gcObject.bind(response.TALAO, response.CONSUMOS, 'TALAO_ID', 'CONSUMOS');\n            gcObject.bind(response.TALAO, response.COMPONENTES, 'TALAO_ID', 'COMPONENTES');\n            gcObject.bind(response.TALAO, response.HISTORICOS, 'PROGRAMACAO_ID', 'HISTORICOS');     \n\n            for ( var i in taloes ) {\n\n                var talao = taloes[i];\n\n                talao.CONSUMO_STATUS = '1';\n                talao.ESTOQUE_STATUS = '1';\n\n\n                for ( var y in talao.CONSUMOS ) {\n\n                    var consumo = talao.CONSUMOS[y];\n\n\n                    if ( talao.ESTOQUE_STATUS == '1' && consumo.ESTOQUE_STATUS == 0 ) {\n                        talao.ESTOQUE_STATUS = '0';\n                    }  \n\n                    talao.ULTIMO_TALAO = true;\n                    var i = 0;\n                    for ( var y in talao.DETALHES ) {\n\n\n                        var detalhe = talao.DETALHES[y];\n\n                        if ( detalhe.TALAO_DETALHE_STATUS < 2 ) {\n                            i++;    \n                        }\n\n                        if ( i > 1 ) {\n                            talao.ULTIMO_TALAO = false;\n                            break;\n                        }\n                    }                \n                }\n            }        \n        }\n        \n        \n        if ( gScope.Filtro.TAB_ACTIVE == 'PRODUZIDO' ) {\n            taloes = gScope.TalaoProduzido.DADOS;\n        } else\n        if ( gScope.Filtro.TAB_ACTIVE == 'PRODUZIR' ) {\n            taloes = gScope.TalaoProduzir.DADOS;\n        }         \n        \n        gcCollection.merge(taloes, [response.TALAO], 'TALAO_ID',true);  \n                \n        \n    };    \n\n\n    Talao.prototype.pick = function(item,action) {\n        \n        var that = this;\n\n        if ( item != undefined ) {\n\n            if ( item.TALAO_ID != this.SELECTED.TALAO_ID ) {\n                gScope.TalaoDetalhe.SELECTED = {};\n                gScope.TalaoDetalhe.SELECTEDS = [];\n                gScope.TalaoDetalhe.SELECTEDS_PRODUZIR = [];\n            }\n            \n            this.SELECTED = item;\n            \n            gScope.Filtro.TALAO_ID = item.TALAO_ID;\n            gScope.Filtro.uriHistory();                        \n\n            if ( gScope.Filtro.TAB_ACTIVE == 'PRODUZIDO' ) {\n                that.consultarComposicao();\n            }\n\n            if ( action == 'modal-open' ) {\n\n                \n                that.show(null,function(){\n\n                    $('[data-talao-id=\"' + gScope.Filtro.TALAO_ID + '\"]:focusable').focus();\n\n                    delete gScope.Filtro.TALAO_ID;\n                    gScope.Filtro.uriHistory();      \n                });               \n                \n            }\n        }\n\n    };    \n\n\n \n    \n    Talao.prototype.confirm = function () {\n        var that = this;\n\n        var dados = {\n            FILTRO: gScope.ConsumoBaixarFiltro,\n            DADOS: {\n                ITENS : that.ITENS_BAIXAR,\n                PESO : that.PESO\n            }\n        };\n        \n        \n        that.enableButton(false);\n        \n        $ajax.post('/_22160/api/consumo-baixar/post',dados,{complete: function(){\n                \n            that.enableButton(true);\n            \n        }}).then(function(response){\n        \n            postprint(response.ETIQUETAS);        \n        \n            gScope.ConsumoBaixarFiltro.merge(response.DATA_RETURN);\n            that.close();\n            \n        });        \n    };  \n\n    Talao.prototype.irPara = function (direcao) {\n        \n        var that = this;\n        var taloes = [];\n        \n        switch (gScope.Filtro.TAB_ACTIVE) {\n            case 'PRODUZIR':\n                taloes = gScope.TalaoProduzir.FILTERED;\n                break;\n            case 'PRODUZIDO':\n                taloes = gScope.TalaoProduzido.FILTERED;\n                break;\n                \n        }\n        \n        switch (direcao) {\n            case '|<':\n                that.pick(taloes[0]);\n                break;\n                \n            case '<':\n                \n                var idx = taloes.indexOf(that.SELECTED);\n                if ( taloes[idx-1] != undefined ) {\n                    that.pick(taloes[idx-1]);\n                }\n                break;\n                \n            case '>':\n\n                var idx = taloes.indexOf(that.SELECTED);\n                if ( taloes[idx+1] != undefined ) {\n                    that.pick(taloes[idx+1]);\n                }\n                break;\n                \n            case '>|':\n                that.pick(taloes[taloes.length-1]);\n                break;\n        }\n    };  \n\n    var modal = $('#modal-talao');\n    \n    Talao.prototype.show = function(shown,hidden) {\n\n        modal\n            .modal('show')\n        ;                         \n        \n        if ( shown ) {\n            modal\n                .one('shown.bs.modal', function(){\n                    shown();\n                })\n            ;     \n        }\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden();\n                })\n            ;              \n        }\n    };\n\n    Talao.prototype.close = function(hidden) {\n\n        modal\n            .modal('hide')\n        ;\n        \n        if ( hidden ) {\n            modal\n                .one('hidden.bs.modal', function(){\n                    hidden ? hidden() : '';\n                })\n            ;                      \n        }\n    };\n    \n    Talao.prototype.inputKeydown = function($event) {\n         \n        if ( this.PESO_AUTOMATICO ) {\n            if ( isNumber($event.key) || $event.key == 'Backspace' || $event.key == 'Delete' ) {\n                $event.preventDefault();\n            }\n        }\n    };\n    \n\n\n    /**\n     * Return the constructor function\n     */\n    return Talao;\n};","angular\n    .module('app')\n    .factory('Filtro', Filtro);\n    \n\n\tFiltro.$inject = [\n        '$ajax',\n        '$q',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction Filtro($ajax, $q, $httpParamSerializer, $rootScope, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function Filtro(data) {\n        if (data) {\n            this.setData(data);\n        }\n\n\t\tgScope.Filtro = this; \n        \n        this.TAB_ACTIVE = 'PRODUZIR';\n        this.DATA_1     = new Date(Clock.DATETIME_SERVER);\n        this.DATA_2     = new Date(Clock.DATETIME_SERVER);\n        this.DATA_TODOS = true;\n    }\n    \n    Filtro.prototype.consultar = function() {\n        \n        var that = this;\n        \n        return $q(function(resolve, reject){\n    //        loading('.main-ctrl');     \n\n            if ( ! (parseInt(gScope.ConsultaEstacao.ESTACAO) > -1) ) {\n                return false;\n            }\n            \n            if ( that.TAB_ACTIVE == 'PRODUZIDO' ) {\n                gScope.TalaoProduzido.consultar();\n            } else {\n\n                gScope.SSE.close();\n\n                var data = {};\n\n                angular.copy(that, data);\n\n                if ( that.DATA_TODOS ) {\n                    delete data.DATA_1;\n                    delete data.DATA_2;\n                }\n\n                data.PROGRAMACAO_STATUS = \"< 3\";\n                data.ESTABELECIMENTO_ID = gScope.ConsultaEstabelecimento.ESTABELECIMENTO_ID;\n                data.GP_ID              = gScope.ConsultaGp.GP_ID;\n                data.UP_ID              = gScope.ConsultaUp.UP_ID;\n                data.ESTACAO            = gScope.ConsultaEstacao.ESTACAO;\n\n                angular.extend(that, data);\n\n                $ajax.post('/_22190/api/taloes/composicao',data).then(function(response){\n\n                    that.merge(response);\n                    that.uriHistory();\n\n                    gScope.SSE.connect();\n\n    //                $timeout(function(){\n    //                    $('#filtrar-toggle[aria-expanded=\"true\"]').click(); \n    //                });    \n\n                    resolve(response);\n\n                },function(erro){\n                    reject(erro);\n                });\n            }\n        });\n    };\n   \n    \n    Filtro.prototype.merge = function(response,auto) {\n        \n        if ( auto == undefined ) {\n            gScope.SSE.UPDATED = true;\n        }\n\n        var arrayClean = function (response){\n            function isNumber(n) {\n                return !isNaN(parseFloat(n)) && isFinite(n);\n            }\n\n            for ( var i in response ) {\n                var item = response[i];\n\n                for (var k in item){\n                    if (item.hasOwnProperty(k)) {\n\n                        if ( isNumber(item[k]) && (String(item[k]).substr(0, 1) !== '0' || String(item[k]).indexOf('.') !== -1) ) {               \n                            item[k] = parseFloat(item[k]);\n                        }\n                    }\n                }            \n            }\n        };\n\n        arrayClean(response.DETALHES);\n        gcCollection.merge(gScope.TalaoDetalhe.DADOS, response.DETALHES, 'REMESSA_TALAO_DETALHE_ID');  \n        \n        arrayClean(response.CONSUMOS);\n        gcCollection.merge(gScope.TalaoConsumo.DADOS, response.CONSUMOS, 'CONSUMO_ID');    \n        \n        arrayClean(response.COMPONENTES);\n        gcCollection.merge(gScope.TalaoConsumo.COMPONENTE_DADOS, response.COMPONENTES, ['REMESSA_ID','REMESSA_TALAO_ID']);    \n        \n        arrayClean(response.HISTORICOS);   \n        gcCollection.merge(gScope.TalaoHistorico.DADOS, response.HISTORICOS, 'ID');      \n        \n        if ( response.TALOES != undefined ) {\n            arrayClean(response.TALOES);   \n            gcCollection.merge(gScope.TalaoProduzir.DADOS, response.TALOES, 'TALAO_ID'); \n        }\n        \n        if ( response.TALAO != undefined ) {\n            arrayClean(response.TALOES);   \n            gcCollection.merge(gScope.TalaoProduzir.DADOS, response.TALAO, 'TALAO_ID',true); \n        }\n        \n        arrayClean(response.ALOCADOS);\n        gcCollection.merge(gScope.TalaoConsumo.ALOCADOS, response.ALOCADOS, 'ID');\n        \n        gcCollection.bind(gScope.TalaoProduzir.DADOS, gScope.TalaoDetalhe.DADOS, ['REMESSA_ID','REMESSA_TALAO_ID'], 'DETALHES');\n        gcCollection.bind(gScope.TalaoProduzir.DADOS, gScope.TalaoConsumo.DADOS, 'TALAO_ID', 'CONSUMOS');\n        gcCollection.bind(gScope.TalaoProduzir.DADOS, gScope.TalaoConsumo.COMPONENTE_DADOS, 'TALAO_ID', 'COMPONENTES');\n        gcCollection.bind(gScope.TalaoProduzir.DADOS, gScope.TalaoHistorico.DADOS, 'PROGRAMACAO_ID', 'HISTORICOS');\n        gcCollection.bind(gScope.TalaoConsumo.DADOS, gScope.TalaoConsumo.ALOCADOS, 'CONSUMO_ID', 'ALOCACOES');        \n        \n        for ( var i in gScope.TalaoProduzir.DADOS ) {\n            \n            var talao = gScope.TalaoProduzir.DADOS[i];\n            \n            talao.CONSUMO_STATUS = '1';\n            talao.ESTOQUE_STATUS = '1';\n                \n            \n            for ( var y in talao.CONSUMOS ) {\n                \n                var consumo = talao.CONSUMOS[y];\n                \n                \n                if ( talao.ESTOQUE_STATUS == '1' && consumo.ESTOQUE_STATUS == 0 ) {\n                    talao.ESTOQUE_STATUS = '0';\n                }  \n\n                talao.ULTIMO_TALAO = true;\n                var i = 0;\n                for ( var y in talao.DETALHES ) {\n\n\n                    var detalhe = talao.DETALHES[y];\n\n                    if ( detalhe.TALAO_DETALHE_STATUS < 2 ) {\n                        i++;    \n                    }\n\n                    if ( i > 1 ) {\n                        talao.ULTIMO_TALAO = false;\n                        break;\n                    }\n                }                \n            }\n        }\n    };\n    \n    Filtro.prototype.uriHistory = function() { \n        window.history.replaceState('', '', encodeURI(urlhost + '/_22190?'+$httpParamSerializer(this)));\n        \n    };\n\n\n    /**\n     * Return the constructor function\n     */\n    return Filtro;\n};","angular\n    .module('app')\n    .value('gScope', {})\n    .controller('Ctrl', Ctrl);\n    \n    \n\tCtrl.$inject = [\n        '$scope',\n        '$timeout',\n        'gScope',\n        '$consulta',\n        'Filtro',\n        'Talao',\n        'TalaoDetalhe',\n        'TalaoConsumo',\n        'TalaoHistorico',\n        'TalaoProduzir',\n        'TalaoProduzido',\n        'Operador',\n        'ServerEvent'\n    ];\n\n\tfunction Ctrl( \n        $scope, \n        $timeout, \n        gScope, \n        $consulta,\n        Filtro,\n        Talao,\n        TalaoDetalhe,\n        TalaoConsumo,\n        TalaoHistorico,\n        TalaoProduzir,\n        TalaoProduzido,\n        Operador,\n        ServerEvent\n    ) {\n\n\t\tvar vm = this;\n        \n        vm.Clock      = Clock;\n        vm.Consulta   = new $consulta();\n        \n        vm.ConsultaEstabelecimento                             = vm.Consulta.getNew(true);\n        vm.ConsultaEstabelecimento.componente                  = '.consulta-estabelecimento';\n        vm.ConsultaEstabelecimento.model                       = 'vm.ConsultaEstabelecimento';\n        vm.ConsultaEstabelecimento.option.label_descricao      = 'Estabelecimento:';\n        vm.ConsultaEstabelecimento.option.obj_consulta         = '/_11020/api/estabelecimento';\n        vm.ConsultaEstabelecimento.option.tamanho_input        = 'input-maior';\n        vm.ConsultaEstabelecimento.option.tamanho_tabela       = 427;\n        vm.ConsultaEstabelecimento.option.campos_tabela        = [['ESTABELECIMENTO_ID', 'ID'],['ESTABELECIMENTO_NOMEFANTASIA','NOME FANTASIA']];\n        vm.ConsultaEstabelecimento.option.obj_ret              = ['ESTABELECIMENTO_ID', 'ESTABELECIMENTO_NOMEFANTASIA'];\n        vm.ConsultaEstabelecimento.compile();\n        gScope.ConsultaEstabelecimento = vm.ConsultaEstabelecimento;\n        \n        vm.ConsultaGp                             = vm.Consulta.getNew(true);\n        vm.ConsultaGp.componente                  = '.consulta-gp';\n        vm.ConsultaGp.model                       = 'vm.ConsultaGp';\n        vm.ConsultaGp.option.label_descricao      = 'GP:';\n        vm.ConsultaGp.option.obj_consulta         = '/_22030/api/gp';\n        vm.ConsultaGp.option.tamanho_input        = 'input-maior';\n        vm.ConsultaGp.option.tamanho_tabela       = 427;\n        vm.ConsultaGp.option.campos_tabela        = [['GP_ID', 'ID'],['GP_DESCRICAO','GRUPO DE PRODUÇÃO']];\n        vm.ConsultaGp.option.obj_ret              = ['GP_ID', 'GP_DESCRICAO'];\n        vm.ConsultaGp.require                     = vm.ConsultaEstabelecimento;\n        vm.ConsultaGp.vincular();\n        vm.ConsultaGp.compile();\n        gScope.ConsultaGp = vm.ConsultaGp;\n        \n        vm.ConsultaUp                             = vm.Consulta.getNew(true);\n        vm.ConsultaUp.componente                  = '.consulta-up';\n        vm.ConsultaUp.model                       = 'vm.ConsultaUp';\n        vm.ConsultaUp.option.label_descricao      = 'UP:';\n        vm.ConsultaUp.option.obj_consulta         = '/_22030/api/up';\n        vm.ConsultaUp.option.tamanho_input        = 'input-maior';\n        vm.ConsultaUp.option.tamanho_tabela       = 427;\n        vm.ConsultaUp.option.campos_tabela        = [['UP_ID', 'ID'],['UP_DESCRICAO','GRUPO DE PRODUÇÃO']];\n        vm.ConsultaUp.option.obj_ret              = ['UP_ID', 'UP_DESCRICAO'];\n        vm.ConsultaUp.require                     = vm.ConsultaGp;\n        vm.ConsultaUp.vincular();\n        vm.ConsultaUp.setRequireRequest({GP_ID: [vm.ConsultaGp, 'GP_ID']});\n        vm.ConsultaUp.compile();\n        gScope.ConsultaUp = vm.ConsultaUp;\n        \n        vm.ConsultaEstacao                             = vm.Consulta.getNew(true);\n        vm.ConsultaEstacao.componente                  = '.consulta-estacao';\n        vm.ConsultaEstacao.model                       = 'vm.ConsultaEstacao';\n        vm.ConsultaEstacao.option.label_descricao      = 'Estação:';\n        vm.ConsultaEstacao.option.obj_consulta         = '/_22030/api/estacao';\n        vm.ConsultaEstacao.option.tamanho_input        = 'input-maior';\n        vm.ConsultaEstacao.option.tamanho_tabela       = 427;\n        vm.ConsultaEstacao.option.campos_tabela        = [['ESTACAO', 'ID'],['ESTACAO_DESCRICAO','GRUPO DE PRODUÇÃO']];\n        vm.ConsultaEstacao.option.obj_ret              = ['ESTACAO', 'ESTACAO_DESCRICAO'];\n        vm.ConsultaEstacao.require                     = vm.ConsultaUp;\n        vm.ConsultaEstacao.vincular();\n        vm.ConsultaEstacao.setRequireRequest({UP_ID: [vm.ConsultaUp, 'UP_ID']});\n        vm.ConsultaEstacao.compile();\n        gScope.ConsultaEstacao = vm.ConsultaEstacao;\n        \n\t\tvm.Filtro         = new Filtro();\n\t\tvm.Talao          = new Talao();\n\t\tvm.TalaoDetalhe   = new TalaoDetalhe();\n\t\tvm.TalaoConsumo   = new TalaoConsumo();\n\t\tvm.TalaoHistorico = new TalaoHistorico();\n\t\tvm.TalaoProduzir  = new TalaoProduzir();\n\t\tvm.TalaoProduzido = new TalaoProduzido();\n\t\tvm.Operador       = new Operador();\n\t\tvm.SSE    = new ServerEvent();\n\n\n        $scope.$watch('vm.ConsultaEstacao.ESTACAO', function (newValue, oldValue, scope) {\n            if ( newValue == undefined || newValue <= 0 ) {\n                vm.SSE.close();\n                \n                vm.TalaoProduzir.DADOS = [];\n                vm.TalaoProduzido.DADOS = [];\n            }\n        }, true);\n\n        $scope.$watch('vm.Filtro.TAB_ACTIVE', function (newValue, oldValue, scope) {\n            \n            if ( newValue == 'PRODUZIDO' ) {\n                vm.Filtro.DATA_TODOS = false;\n                vm.Filtro.DATA_TODOS_DISABLED = true;\n                vm.Filtro.consultar();\n//                if ( $('#filtrar-toggle').hasClass('collapsed') ) {\n//                    $('#filtrar-toggle').click();\n//                }\n            } else\n            if ( newValue == 'PRODUZIR' ) {\n                vm.Filtro.DATA_TODOS = true;\n                vm.Filtro.DATA_TODOS_DISABLED = false;\n                vm.Filtro.consultar();\n                \n//                if ( !$('#filtrar-toggle').hasClass('collapsed') ) {\n//                    $('#filtrar-toggle').click();\n//                }                \n            } \n\n        }, true);\n\n\t}   \n  "]}