{"version":3,"sources":["file.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"file.js","sourcesContent":["/**\n * Script para arquivos.\n */\n\n/**\n * Enviar arquivos para o banco. <br>\n * OBS.: Necessário passar o parâmetro 'url_pag' pois a página pode conter parâmetros.\n * Esse parâmetro é o identificador da página. Ex.: '_1000'\n * \n * @param {object} input\n * @param {string} tabela\n */\nfunction enviarArquivo(input, tabela) {\n\t\t\n\tvar file\t\t= jQuery(input);\n\tvar fdata\t\t= new FormData();\n\tvar x\t\t\t= jQuery('.CLArquivo').length - 1;\n\tvar edit_desc\t= jQuery(input).parent('.form-group').parent('.item-dinamico').children('.form-group').first().children('input[name=\"anexo_descricao\"]');\n\tvar edit_file\t= file;\n\t\n\tedit_desc.val(edit_file.val());\n\n\tjQuery.each(jQuery(':file')[x].files, function(i, file) {\n\t\tfdata.append('file-0', file);\n\t});\n\n\tvar vinc\t\t= jQuery('input[name=\"_vinculo_id\"]').val();\n\n\tvar arquivo\t\t= jQuery(':file')[x].files[0];\n\tvar ftipo\t\t= arquivo.type;\n\tvar ftamanho\t= arquivo.size;\n\n\tfdata.append('vinc', vinc);\n\tfdata.append('tabela', tabela);\n\tfdata.append('tamanho', ftamanho);\n\tfdata.append('tipo', ftipo);\n\n\tjQuery.ajax({\n\t\ttype\t\t: 'POST',\n\t\turl\t\t\t: '/enviarArquivo',\n\t\tdata\t\t: fdata,\n\t\tcache\t\t: false,\n\t\tcontentType\t: false,\n\t\tprocessData\t: false,\n\t\t\n\t\tbeforeSend\t: function() { \n\t\t\tjQuery('progress').attr({value:20, max:100}); \n\t\t},\n\t\t\n\t\tsuccess\t\t: function(resposta) {\n\t\t\t\n\t\t\t//sucesso\n\t\t\tif (resposta['0'] === 'sucesso') {\n\t\t\t\tjQuery('progress').attr({value:100, max:100});\n\t\t\t}\n\t\t\t//erro\n\t\t\telse {\n\t\t\t\t\n\t\t\t\tjQuery('progress').attr({value:0, max:100});\n\n\t\t\t\tjQuery('.alert').removeClass('alert-success').addClass('alert-danger');\n\t\t\t\t//jQuery('body').scrollTop(0);\n\n\t\t\t\tvar excecao;\n\t\t\t\tif ( resposta['1'] )\n\t\t\t\t\texcecao = resposta['1'].match(/exception 1 ... (.*) At trigger (.*)/i);\n\n\t\t\t\t//se for exceção de trigger\n\t\t\t\tif ( excecao ) {\n\t\t\t\t\tif(excecao['1'] !== 'Duplicado') {\t\t//acontece devido ao problema de arquivo duplicado no banco\n\t\t\t\t\t\tjQuery('.alert .texto').html(excecao['1']).parent().fadeIn();\n\t\t\t\t\t\tjQuery('body').scrollTop(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tjQuery('.alert .texto').html(resposta['1']).parent().fadeIn();\n\t\t\t\t\tjQuery('body').scrollTop(0);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\n\t\terror\t\t: function() { \n\t\t\tjQuery('progress').attr({value:0, max:100}); jQuery(file).parent().next().hide(); \n\t\t}\n\t});\t\n}\n\n/**\n * Clique para fechar arquivo.\n */\nfunction ativarCliqueFecharArquivo() {\n\t\n\t$('.esconder-arquivo').click(function(){\n\n\t\t$('.visualizar-arquivo').fadeOut();\n\n\t\tvar arq_nome = $('.arquivo_nome_deletar').val();\n\n\t\t//$('.visualizar-arquivo').html(' ');\n\n\t\t//ajax\n\t\tvar url\t\t= '/deletararquivo',\n\t\t\ttype\t= 'POST',\n\t\t\tdata\t= {'arquivo': arq_nome}\n\t\t;\n\t\t\n\t\texecAjax1(type, url, data);\n\t});\n}"]}