{"version":3,"sources":["_23032.app.js","_23032.controller.js","_23032.factory.index.js","_23032.factory.create.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_23032.js","sourcesContent":["/**\n * App do objeto _23032 - Cadastro de fatores para avaliação de desempenho.\n */\n\n'use strict';\n\nangular\n\t.module('app', [\n\t\t'vs-repeat', \n        'gc-find',\n\t\t'gc-ajax',\n\t\t'gc-transform',\n\t\t'gc-form'\n\t])\n;","/**\r\n * Controller do objeto _23032 - Cadastro de fatores para avaliação de desempenho.\r\n */\r\n\r\nangular\r\n\t.module('app')\r\n\t.value('gScope', {})\r\n\t.controller('Ctrl', Ctrl);\r\n\r\nCtrl.$inject = [\r\n\t'$scope',\r\n\t'gScope',\r\n\t'Historico',\r\n\t'Index',\r\n\t'Create'\r\n];\r\n\r\nfunction Ctrl( \r\n\t$scope,\r\n\tgScope,\r\n\tHistorico,\r\n\tIndex,\r\n\tCreate\r\n) {\r\n\r\n\t// Public instance.\r\n\tgScope.Ctrl = this;\r\n\r\n\t// Local instance.\r\n\tvar $ctrl = this;\r\n\r\n\t// Global variables.\r\n\t$ctrl.tipoTela      = 'listar';\r\n\t$ctrl.permissaoMenu = {};\r\n\t$ctrl.Historico     = new Historico('$ctrl.Historico', $scope);\r\n\r\n\t// Objects.\r\n\t$ctrl.Index  = new Index();\r\n\t$ctrl.Create = new Create();\r\n}","/**\r\n * Factory index do objeto _23032 - Cadastro de fatores para avalia?o de desempenho.\r\n */\r\n\r\nangular\r\n    .module('app')\r\n    .factory('Index', Index);    \r\n\r\nIndex.$inject = [\r\n    '$ajax',\r\n    'gScope'\r\n];\r\n\r\nfunction Index($ajax, gScope) {\r\n\r\n    // Private variables.\r\n    var obj = null;\r\n\r\n    /**\r\n     * Constructor, with class name.\r\n     */\r\n    function Index() {\r\n\r\n        obj = this;\r\n\r\n        // Public variables\r\n        this.listaFator = [];\r\n\r\n        // Public methods\r\n        this.filtrar          = filtrar;\r\n        this.habilitarIncluir = habilitarIncluir;\r\n        this.exibirFator      = exibirFator;\r\n\r\n        // Init methods.\r\n        this.filtrar();\r\n    }\r\n    \r\n\r\n    function filtrar() {\r\n\r\n        $ajax\r\n            .post('/_23032/consultarFator')\r\n            .then(function(response){\r\n\r\n                obj.listaFator = response;\r\n            });\r\n    }\r\n\r\n    function habilitarIncluir() {\r\n\r\n        gScope.Ctrl.tipoTela = 'incluir';\r\n\r\n        setTimeout(function() { \r\n            $('.js-input-titulo').focus(); \r\n        }, 500);\r\n    }\r\n\r\n    function exibirFator(fator) {\r\n\r\n        gScope.Ctrl.tipoTela = 'exibir';\r\n        gScope.Ctrl.Create.exibirFator(fator);\r\n    }\r\n\r\n\r\n    /**\r\n     * Return the constructor function\r\n     */\r\n    return Index;\r\n};","/**\r\n * Factory create do objeto _23032 - Cadastro de fatores para avaliação de desempenho.\r\n */\r\n\r\nangular\r\n    .module('app')\r\n    .factory('Create', Create);    \r\n\r\nCreate.$inject = [\r\n    '$ajax',\r\n    'gScope'\r\n];\r\n\r\nfunction Create($ajax, gScope) {\r\n\r\n    // Private variables.\r\n    var obj = null;\r\n\r\n    /**\r\n     * Constructor, with class name.\r\n     */\r\n    function Create() {\r\n\r\n        obj = this;\r\n\r\n        // Public variables.\r\n        this.fator                  = {};\r\n        this.fator.TIPO_ID          = 1;\r\n        this.fator.ORDEM_PERC_NIVEL = '0';\r\n        this.fator.DESCRITIVO       = [];\r\n        this.descritivoPadrao       = {\r\n            NIVEL_ID  : 1,\r\n            DESCRICAO : ''\r\n        };\r\n        this.fatorBkp               = {};\r\n        this.listaFatorTipo         = [];\r\n        this.listaFatorNivel        = [];\r\n\r\n        // Public methods.\r\n        this.init               = init;\r\n        this.consultarInicial   = consultarInicial;\r\n        this.addDescritivo      = addDescritivo;\r\n        this.excluirDescritivo  = excluirDescritivo;\r\n        this.gravar             = gravar;\r\n        this.excluir            = excluir;\r\n        this.limparCampo        = limparCampo;\r\n        this.exibirFator        = exibirFator;\r\n        this.habilitarAlteracao = habilitarAlteracao;\r\n        this.cancelarAlteracao  = cancelarAlteracao;\r\n        this.exibirModal        = exibirModal;\r\n        this.fecharModal        = fecharModal;\r\n\r\n        // Init methods.\r\n        this.init();\r\n    }\r\n\r\n    function init() {\r\n\r\n        obj.consultarInicial();\r\n        addDescritivo();\r\n    }\r\n\r\n    function consultarInicial() {\r\n\r\n        $ajax\r\n            .post('/_23032/consultarInicial')\r\n            .then(function(response) {\r\n\r\n                obj.listaFatorTipo  = response.FATOR_TIPO;\r\n                obj.listaFatorNivel = response.FATOR_NIVEL;\r\n            });\r\n    }\r\n\r\n    function addDescritivo() {\r\n\r\n        var descritivoNovo = {};\r\n        angular.copy(obj.descritivoPadrao, descritivoNovo);\r\n        obj.fator.DESCRITIVO.push(descritivoNovo);\r\n    }\r\n\r\n    function excluirDescritivo(descritivo) {\r\n\r\n        if (descritivo.ID > 0)\r\n            descritivo.STATUSEXCLUSAO = '1';\r\n        else\r\n            obj.fator.DESCRITIVO.splice(obj.fator.DESCRITIVO.indexOf(descritivo), 1);\r\n\r\n        // Adicionar descritivo quando não houver nenhum.\r\n        if (obj.fator.DESCRITIVO.length == 0)\r\n            obj.addDescritivo();\r\n        else {\r\n\r\n            var desc  = {},\r\n                resta = false;\r\n\r\n            // Verificar se tem algum descritivo que não tenha sido marcado para excluir.\r\n            for (var i in obj.fator.DESCRITIVO) {\r\n                \r\n                desc = obj.fator.DESCRITIVO[i];\r\n\r\n                if (desc.STATUSEXCLUSAO != '1') {\r\n\r\n                    resta = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (resta == false)\r\n                obj.addDescritivo();\r\n        }\r\n    }\r\n\r\n    function gravar() {\r\n\r\n        $ajax\r\n            .post('/_23032/gravar', obj.fator)\r\n            .then(function(response) {\r\n\r\n                showSuccess('Gravado com sucesso.');\r\n                gScope.Ctrl.Index.filtrar();\r\n                fecharModal();\r\n            });\r\n    }\r\n\r\n    function excluir() {\r\n\r\n        confirmar();\r\n\r\n        function confirmar() {\r\n\r\n            addConfirme(\r\n                '<h4>Confirmação</h4>',\r\n                'Confirma a exclusão?',\r\n                [obtn_sim, obtn_nao],\r\n                [\r\n                    {\r\n                        ret: 1,\r\n                        func: function() {\r\n\r\n                            efetivar();\r\n                        }\r\n                    },\r\n                    {\r\n                        ret: 2,\r\n                        func: function() {}\r\n                    }\r\n                ]\r\n            );\r\n        }\r\n\r\n        function efetivar() {\r\n\r\n            $ajax\r\n                .post('/_23032/excluir', obj.fator)\r\n                .then(function(response){\r\n\r\n                    showSuccess('Excluído com sucesso.');\r\n                    gScope.Ctrl.Index.filtrar();\r\n                    fecharModal();\r\n                });\r\n        }\r\n    }\r\n\r\n    function limparCampo() {\r\n\r\n        obj.fator            = {};\r\n        obj.fator.DESCRITIVO = [];\r\n        \r\n        obj.addDescritivo();\r\n    }\r\n\r\n    function exibirFator(fator) {\r\n\r\n        $ajax\r\n            .post('/_23032/consultarFatorNivelDescritivo', fator)\r\n            .then(function(response) {\r\n\r\n                response = formatarCampo(response);\r\n\r\n                fator.DESCRITIVO = response;\r\n\r\n                obj.fator    = fator;\r\n                obj.fatorBkp = angular.copy(fator);\r\n\r\n                obj.exibirModal();\r\n            });\r\n\r\n\r\n        function formatarCampo(response) {\r\n\r\n            var desc = {};\r\n\r\n            for (var i in response) {\r\n\r\n                desc = response[i];\r\n\r\n                desc.FAIXA_INICIAL  = parseFloat(desc.FAIXA_INICIAL);\r\n                desc.FAIXA_FINAL    = parseFloat(desc.FAIXA_FINAL);\r\n            }\r\n\r\n            return response;\r\n        }\r\n    }\r\n\r\n    function habilitarAlteracao() {\r\n\r\n        gScope.Ctrl.tipoTela = 'alterar';\r\n    }\r\n\r\n    function cancelarAlteracao() {\r\n\r\n        angular.extend(obj.fator, obj.fatorBkp);\r\n        gScope.Ctrl.tipoTela = 'exibir';\r\n    }\r\n\r\n    function exibirModal() {\r\n\r\n        $('#modal-create').modal('show');\r\n    }\r\n\r\n    function fecharModal() {\r\n\r\n        $('#modal-create')\r\n            .modal('hide')\r\n            .find('.modal-body')\r\n            .animate({ scrollTop: 0 }, 'fast');\r\n\r\n        obj.limparCampo();        \r\n    }\r\n\r\n\r\n    /**\r\n     * Return the constructor function.\r\n     */\r\n    return Create;\r\n};"]}