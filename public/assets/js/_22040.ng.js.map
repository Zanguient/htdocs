{"version":3,"sources":["_22040.app.js","_22040.factory.reposicao.js","_22040.controller.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_22040.ng.js","sourcesContent":["/**\n * _22010 - Registro de Produção\n */\n'use strict';\n\nangular\n\t.module('app', [\n\t\t'vs-repeat', \n        'gc-find',\n\t\t'gc-ajax',\n\t\t'gc-transform',\n\t\t'gc-form',\n\t\t'gc-utils'\n\t])\n;","angular\n    .module('app')\n    .factory('Reposicao', Reposicao);\n    \n\n\tReposicao.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$q',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction Reposicao($ajax, $httpParamSerializer, $rootScope, $q, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function Reposicao(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.Reposicao = this; \n        \n        this.DADOS     = [];\n        this.DETALHAMENTO     = [];\n        this.SELECTED  = {};\n        this.ITENS     = [];\n        this.PENDENTES = [];\n        this.PENDENTESLOTE = [];\n        this.GRUPOS    = [];\n        this.GRUPOS2   = [];\n        this.FILTRO    = '';\n\n        this.DATA1     = '01.10.2017';\n        this.DATA2     = '26.10.2017';\n\n        this.OPERADOR_BARRAS = '';\n    }\n    \n\n    Reposicao.prototype.pick = function(item,action) {\n        \n        var that = this;\n\n        if ( item != undefined ) {\n        \n            this.SELECTED = item;\n\n        }\n\n    };     \n       \n\n    Reposicao.prototype.consultarOrigem = function(produto_id,tamanho) {\n        \n        var that = this;\n\n        var data = {\n            ESTABELECIMENTO_ID  : gScope.DADOS.estabelecimento_id,\n            FAMILIA_ID          : gScope.DADOS.familia,\n            PRODUTO_ID          : produto_id,\n            TAMANHO             : tamanho\n        };\n        \n        that.DATA = data; \n        \n        $ajax.post('/_22040/api/reposicao',data)\n            .then(function(response) {\n        \n                that.DADOS = response;\n        \n                $('#modal-reposicao-origem').modal('show');\n                \n            })\n        ;\n\n    };     \n       \n\n    Reposicao.prototype.consultarDetalhamento = function(tipo) {\n        \n        var that = this;\n\n        that.ORIGEM_TIPO = tipo;\n        \n        $ajax.post('/_22040/api/reposicao/'+tipo,that.DATA)\n            .then(function(response) {\n        \n                that.DETALHAMENTO = response;\n                        \n            })\n        ;\n\n    };     \n       \n\n    Reposicao.prototype.toggleCheck = function(item,type) {\n              \n        if ( item.CONFERENCIA > 0 ) {  \n            item.CONFERIR = (item.CONFERIR == '2') ? '1' : '2';\n\n            if ( type != undefined ) {\n                item.CONFERIR = type == true ? '2' : '1';\n            }\n            \n            var index = this.ITENS.indexOf(item);\n                \n            if ( item.CONFERIR != item.CONFERENCIA ) {\n                if ( index == -1 ) {\n                    this.ITENS.push(item);   \n                }                 \n            } else {\n                if ( index > -1 ) {\n                    this.ITENS.splice(index, 1);                      \n                }\n            }\n            \n        }\n    };     \n\n    Reposicao.prototype.checkAll = function() {\n                \n        for ( var i in this.DADOS ) {\n            var item = this.DADOS[i];\n            \n            this.toggleCheck(item,true);\n        }\n    };\n\n    Reposicao.prototype.Conferir = function(COD_BARRAS,TIPO) {\n\n        $('#tab1-tab').trigger('click');\n\n            gScope.Filtro.CONFERENCIA_TIPO = TIPO;\n            gScope.Filtro.CODIGO_BARRAS    = COD_BARRAS;\n            gScope.Filtro.consultar();\n\n    };\n\n    Reposicao.prototype.checkVisibility = function(item) {\n        \n        var that = this;\n        var ret  = true;\n        \n        for ( var i in that.GRUPOS ) {\n            var grupo = that.GRUPOS[i];\n            \n            if ( grupo.VALOR == (item.TIPO + ' ').trim() ) {\n                if ( !grupo.CHECKED ) {\n                    ret = false;\n                }\n                break;\n            }\n        }\n        \n        return ret;\n    };\n\n    Reposicao.prototype.checkVisibility2 = function(item) {\n        \n        var that = this;\n        var ret  = true;\n        \n        for ( var i in that.GRUPOS2 ) {\n            var grupo = that.GRUPOS2[i];\n            \n            if ( grupo.VALOR == (item.FAMILIA + ' ').trim() ) {\n                if ( !grupo.CHECKED ) {\n                    ret = false;\n                }\n                break;\n            }\n        }\n        \n        return ret;\n    };\n\n    Reposicao.prototype.pendencias = function() {\n        var that = this;\n\n        $ajax.post('/_15090/api/conferencia/pendentes',that).then(function(response){\n\n//            that.PENDENTES = response;\n\n            angular.forEach(response, function(item, key) {\n                var adicionar = true;\n                angular.forEach(that.GRUPOS, function(iten, key) {\n                    if((item.TIPO + ' ').trim() == iten.VALOR){\n                        adicionar = false;\n                    }\n                });\n\n                if(adicionar == true){\n                    that.GRUPOS.push({VALOR: (item.TIPO + ' ').trim(), CHECKED: true});\n                }\n            });\n\n            angular.forEach(response, function(item, key) {\n                var adicionar = true;\n                angular.forEach(that.GRUPOS2, function(iten, key) {\n                    if((item.FAMILIA + ' ').trim() == iten.VALOR){\n                        adicionar = false;\n                    }\n                });\n\n                if(adicionar == true){\n                    that.GRUPOS2.push({VALOR: (item.FAMILIA + ' ').trim(), CHECKED: true});\n                }\n            });\n\n            var grupos = gcCollection.groupBy(response, [\n                'GRUPO',\n                'TIPO_ID',\n                'DOCUMENTO',\n                'TIPO',\n                'LOCALIZACAO'\n            ], 'ITENS'); \n            \n            gcCollection.merge(that.PENDENTES, grupos, ['GRUPO']);\n       \n        });\n\n    };\n\n    Reposicao.prototype.pendenciasLote = function() {\n        var that = this;\n\n        $ajax.post('/_15090/api/conferencia/pendenciasLote',that).then(function(response){\n            that.PENDENTESLOTE = response;\n        });\n\n    };         \n    \n    \n    Reposicao.prototype.clearData = function() {\n        gScope.Filtro.CODIGO_BARRAS = ''; \n        this.DADOS = []; \n        this.ITENS = [];\n        \n        $('.input-codigo-barras:focusable').first().focus();\n    };     \n    \n    \n\n    Reposicao.prototype.keypress = function(item,$event) {\n        \n        if ( $event.key == ' ' ) {\n            \n            $event.preventDefault();\n            \n            this.toggleCheck(item);\n        } else        \n        if ( $event.key == 'Enter' ) {\n            \n            $event.preventDefault();\n            \n            \n            if ( this.ITENS.length > 0) {\n                this.modalOperador.show();\n            }\n        }\n    };     \n\n    Reposicao.prototype.modalOperador = {\n        _modal : function () {\n            return $('#modal-autenticar-operador');\n        },\n        show : function(shown,hidden) {\n\n            this._modal()\n                .modal('show')\n            ;                         \n\n            \n            this._modal()\n                .one('shown.bs.modal', function(){\n\n                    $(this).find('input:focusable').first().focus();\n\n                    if ( shown ) {\n                        shown(); \n                    }\n                })\n            ;    \n\n                this._modal()\n                    .one('hidden.bs.modal', function(){\n                        gScope.Reposicao.OPERADOR_BARRAS = '';\n                \n                        if ( hidden ) {\n                            hidden();      \n                        }\n                    })\n                ;        \n        },\n        hide : function(hidden) {\n\n            this._modal()\n                .modal('hide')\n            ;\n\n            if ( hidden ) {\n                this._modal()\n                    .one('hidden.bs.modal', function(){\n                        hidden ? hidden() : '';\n                    })\n                ;                      \n            }\n        }\n    };     \n    \n    \n    /**\n     * Return the constructor function\n     */\n    return Reposicao;\n};","angular\n    .module('app')\n    .value('gScope', {\n        indexOfAttr : function(array,attr, value) {\n            for(var i in array) {\n                if(array[i][attr] === value) {\n                    return i;\n                }\n            }\n            return -1;\n        }\n    })\n    .controller('Ctrl', Ctrl);\n    \n    \n\tCtrl.$inject = [\n        '$scope',\n        '$compile',\n        '$timeout',\n        'gScope',\n        'Reposicao'\n    ];\n\n\tfunction Ctrl( $scope, $compile, $timeout, gScope, Reposicao ) {\n\n\t\tvar vm = this;\n\n        vm.Reposicao         = new Reposicao();\n        vm.gScope            = gScope;\n\t}   \n    "]}