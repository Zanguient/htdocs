{"version":3,"sources":["app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["/**\n * _22100 - Geracao de Remessas de Bojo\n */\n\n;(function(angular) {\n\n    var Ctrl = function($scope,$ajax,$timeout,$filter,$window,$interval,$consulta) {\n        var vm = this;\n        var data_table = $.extend({}, table_default);\n            data_table.scrollY = 'auto';\n        vm.Consulta   = new $consulta();\n        vm.DADOS      = [];\n        vm.dtOptions  = data_table;\n        \n        vm.ConsultaProduto = vm.Consulta.getNew();\n        \n        vm.ConsultaProduto.componente                  = '.consulta-produto';\n        vm.ConsultaProduto.option.class                = 'produtoctrl';\n        vm.ConsultaProduto.model                       = 'vm.ConsultaProduto';\n        vm.ConsultaProduto.option.label_descricao      = 'Produto:';\n        vm.ConsultaProduto.option.obj_consulta         = '/_27050/consulta/json';\n        vm.ConsultaProduto.option.tamanho_input        = 'input-maior';\n        vm.ConsultaProduto.option.tamanho_tabela       = 427;\n        vm.ConsultaProduto.compile();\n        \n        var arr = vm.Consulta.getHistory();\n        \n        $timeout(function(){\n            if ( vm.DEF_PRODUTO_ID > 0 ) {\n                vm.ConsultaProduto.option.filtro_sql = { PRODUTO_ID: vm.DEF_PRODUTO_ID };\n                vm.ConsultaProduto.filtrar();\n                vm.ConsultaProduto.option.filtro_sql = {};\n            }\n        });\n        \n        vm.ConsultaProduto.onSelect = function(){\n            vm.FILTRO.PRODUTO_ID = vm.ConsultaProduto.item.dados.ID;\n        };\n        \n        vm.ConsultaProduto.onClear = function (){\n            vm.DADOS = [];\n            vm.EstoqueLocalizacao.selected = [];\n        };\n        \n        vm.FILTRO = {\n            DATA_1 : moment().startOf(\"month\").toDate(),\n            DATA_2 : moment().endOf(\"month\").toDate()\n        };\n        \n        vm.filtrar = function() {\n                        \n            vm.EstoqueLocalizacao.selected = [];\n            $ajax.post('/_15060/find',vm.FILTRO)\n                .then(function(response) {\n                    vm.DADOS = response;\n            \n                    if ( vm.DEF_LOCALIZACAO_ID > 0 ) {\n                        for ( var i in vm.DADOS ) {\n                            var item = vm.DADOS[i];\n\n                            if ( parseInt(item.LOCALIZACAO_ID) == parseInt(vm.DEF_LOCALIZACAO_ID) && parseInt(item.ESTABELECIMENTO_ID) == 1 ) {\n                                vm.EstoqueLocalizacao.selected = item;\n                            }\n                        }\n                    }\n                }\n            );\n        };\n        \n        $scope.$watch('vm.FILTRO', function (newValue, oldValue, scope) {\n            vm.DADOS = [];\n            vm.EstoqueLocalizacao.selected = [];\n        }, true);\n        \n        $scope.$watch('vm.FILTRO.PRODUTO_ID', function (newValue, oldValue, scope) {\n            if (newValue > 0) {\n                vm.filtrar();\n            }\n        }, true);\n        \n        vm.EstoqueLocalizacao = {\n            selected : null\n        };\n        \n                        \n        $timeout(function () {\n            $('.resize')\n                .resizable({\n                    resize  : function( event, ui ) {\n                        $scope.$apply(function(){\n                            $(document).resize();\n                        });\n\n                    },\n                    handles  : 's',\n                    minHeight : 80\n                })\n            ;\n        });\n        //Aumentar tabela com duplo clique no puxador\n        $(document)\n            .on('dblclick','.table-lc .ui-resizable-s', function(e) {\n\n                var table = $(this).closest('.ui-resizable');\n\n                if ( $(table).data('original-size') == undefined || $(table).data('original-size') == 0 ) {\n                    $(table).data('original-size',$(table).height());\n                }  \n                \n                var bool = $(table).data('height-full') || false;\n                $(table).data('height-full', ! bool);\n                \n                if ( $(table).data('height-full') == true ) {\n        \n                    var datatable_scrollbody = $(table).find('.table-body');\n                    var tbody_height\t     = datatable_scrollbody.height(),\n                        window_height\t     = $(window).height(),\n                        vh_context\t\t     = window_height * 0.01,\t//converter px para vh - parte I\n                        tbody_height_vh      = tbody_height / vh_context //converter px para vh - parte II\n                    ;\n\n                    //Se a altura do tbody for maior que 70vh, tbody_height terá 70vh de altura, pois esse é o valor máximo permitido (altura da tela);\n                    //senão, a altura será a altura inicial + 34, que é a altura do cabeçalho da tabela.\n                    if (tbody_height_vh > 70) {\n\n                        var datatable_scroll     = $(table).find('.table-container');\n\n                        tbody_height = '70vh';\n\n                        //Posicionar scroll.\n                        //posição da tabela - altura do cabeçalho - altura da barra de ações - 50\n                        $(document)\n                            .scrollTop( datatable_scroll.offset().top - $('nav.navbar').outerHeight() - 50 )\n                        ;\n\n                    }\n                    else {\n                        tbody_height = tbody_height + 35;\n                    }\n                \n                    $(table)\n                        .height( tbody_height )\n                    ;\n                } else {\n                    $(table)\n                        .height( $(table).data('original-size') )\n                    ;                    \n                }\n            })\n        ;\n    };\n\n    Ctrl.$inject = ['$scope','$ajax','$timeout','$filter','$window','$interval', '$consulta'];\n\n    var bsInit = function() {\n        return function(scope, element, attrs) {         \n            bootstrapInit();\n        };\n    };\n    \n    var parseData = function() {\n        return function(input) {\n            if ( input ) return new Date(input);\n        };\n    };\n        \n    angular\n    .module    ('app'           , ['angular.filter','vs-repeat','gc-ajax','gc-form','gc-find','gc-transform'])\n    .filter    ('parseDate'     , parseData)\n    .controller('Ctrl'          , Ctrl     )\n    .value('gScope', {})\n    ;\n        \n})(angular);\n\n;(function($) {\n\n})(jQuery);"]}