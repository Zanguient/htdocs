{"version":3,"sources":["menu.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"menu.js","sourcesContent":["/**\r\n * Script relacionado ao menu com as seguintes funções:\r\n * - Abrir/fechar menu\r\n * - Filtrar menu\r\n * */\r\n(function($) {\r\n\t$(function() {\t\r\n        //Abrir/fechar menu pelo botão de menu\r\n        $('.navbar-toggle').click(function() {\r\n            $('#menu').toggleClass('aberto');\r\n            $('.navbar').toggleClass('menu-aberto');\r\n            if ( isMobile() ) return false;\r\n            $('#menu-filtro').focus();\r\n        });\r\n\r\n        //focar o campo de filtro quando estiver na página inicial\r\n        if( window.location.pathname === '/home' && !(isMobile()) )\r\n            $('#menu-filtro').focus();\r\n\t});\r\n})(jQuery);\r\n\r\n\r\n;(function(angular) {\r\n   \r\n    var MenuCtrl = function($scope,$ajax,$timeout,$localStorage,$window) {     \r\n        var vm = this;\r\n        \r\n        vm.itens               = [];\r\n        vm.$storage            = $localStorage;\r\n\r\n        vm.btnCarregarMenus = function() {\r\n            $ajax.post('/listarMenu')\r\n                .then(function(response) {\r\n                    vm.$storage.menus  = response.menus;\r\n                    vm.$storage.grupos = response.grupos;\r\n                    showSuccess('Menus atualizados com sucesso!');\r\n                }\r\n            );  \r\n        };\r\n        \r\n        vm.CarregarMenus = function() {\r\n            $ajax.post('/listarMenu')\r\n                .then(function(response) {\r\n                    vm.$storage.menus  = response.menus;\r\n                    vm.$storage.grupos = response.grupos;\r\n                }\r\n            );  \r\n        };\r\n\r\n        vm.LoadMenus = function() {\r\n            if ( vm.$storage.menus == undefined || vm.$storage.grupos == undefined ) {\r\n                vm.CarregarMenus();\r\n            }\r\n        };\r\n        \r\n        \r\n        vm.IndexOfAttr = function(array,attr, value) {\r\n            for(var i in array) {\r\n                if(array[i][attr] === value) {\r\n                    return i;\r\n                }\r\n            }\r\n            return -1;\r\n        };\r\n        \r\n        vm.menuSelecionar = function($event){\r\n            \r\n            /* Verifica se a tecla pressionada foi 'Enter' */\r\n            if ( $event.keyCode === 13 ) {\r\n                if ( vm.menus_filtered.length == 1 ) {\r\n                    var menus = $('#menu-filtro-itens');\r\n                    var ancora = menus.find('a[href]').first();\r\n                    var link = ancora.attr('href');\r\n                    \r\n                    $window.location.href = link;\r\n                }\r\n            }\r\n        };\r\n        \r\n        //Abre resultado da filtragem\r\n        function abreFiltroMenu() {\r\n\r\n            $('#menu-filtro-resultado')\r\n                .addClass('ativo');\r\n\r\n            $('#btn-filtro-menu')\r\n                .attr('tabindex', '-1');\r\n\r\n        }\r\n\r\n        //Fecha resultado da filtragem\r\n        function fechaFiltroMenu() {\r\n            $timeout(function () {\r\n                $scope.$apply(function(){\r\n                    vm.filtrar_menu = '';\r\n                    vm.menu_grupo = ''; \r\n                });\r\n            }, 100);\r\n            \r\n            $('#menu-filtro-resultado')\r\n                .removeClass('ativo');\r\n\r\n            $('#btn-filtro-menu')\r\n                .removeAttr('tabindex');\r\n        \r\n            if ( isMobile() ) return false;\r\n            $('#menu-filtro')\r\n                .val('')\r\n                .focus();\r\n        }\r\n        \r\n        vm.DropdownMenu = function( open ) {\r\n            var btn_filtro_menu = $('#btn-filtro-menu');\r\n            if ( vm.filtrar_menu != '' || open ) {\r\n\t\t\t\tabreFiltroMenu();\r\n            } else {\r\n\t\t\t\tfechaFiltroMenu();\r\n            }\r\n        };\r\n\r\n        //Fechar filtro do menu ao clicar em fechar\r\n        $('#menu-fechar').click(function() {\r\n            fechaFiltroMenu();\r\n        });\t\r\n        \r\n\t\t$(document)\r\n            .on('keydown', \r\n                '#menu-filtro',\r\n                'del',\r\n                function() {\r\n                    if ( $(this).prop('readonly') || $(this).prop('disabled') ) return false;\r\n                    $(this).val('');\r\n                    fechaFiltroMenu();\r\n                    return false;\r\n                }\r\n            )\r\n            .on('keydown', \r\n                function(e) {\r\n                    \r\n                    if ( $('#menu').hasClass('aberto') || pathname == '/home' ) {\r\n                        \r\n                        var letras = /[A-z]/;\r\n                        var numeros = /[0-9]/;\r\n\r\n                        var result_letras = letras.test(String.fromCharCode(e.keyCode));\r\n                        var result_numeros = numeros.test(String.fromCharCode(e.keyCode));\r\n                        var result = result_letras | result_numeros;\r\n\r\n                        if ( result || e.keyCode == 46 || e.keyCode == 8 ) {\r\n                            $('#menu-filtro').focus();\r\n                            \r\n                            if ( e.keyCode == 46 ) {\r\n                                var e = jQuery.Event(\"keydown\");\r\n                                e.which = 46;\r\n                                $('#menu-filtro').trigger(e);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            )\r\n\t\t;\r\n        \r\n    };\r\n\r\n    $(document)\r\n        .on('click','#voltar-User',\r\n            function() {\r\n                \r\n                function success(data) {\r\n                    var user_id = $('#usuario-id').val();\r\n                    window.localStorage.removeItem('ngStorage-menus');\r\n                    window.location.href = urlhost + '/_11010';\r\n\r\n                }\r\n\r\n                execAjax1('POST','/_11010/voltarUser',[],success);\r\n            }\r\n        );\r\n    \r\n    MenuCtrl.$inject = ['$scope','$ajax','$timeout','$localStorage','$window'];\r\n    \r\n    angular\r\n        .module('appMenu', ['angular.filter','vs-repeat','ngStorage','gc-ajax','gc-find','gc-transform'])\r\n        .controller('MenuCtrl', MenuCtrl)\r\n    ;\r\n    \r\n    angular.bootstrap(document.getElementById('menu'), ['appMenu']);\r\n    \r\n    // Servirá para evitar erro de inicialização do app\r\n    // no caso da tela não utilizar angular.\r\n    angular.module('app', []);\r\n\r\n})(angular);"]}