{"version":3,"sources":["_15040.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_15040.js","sourcesContent":["(function($){\n\t\n\tvar final_pag\t = false;\t//variável para verificar se chegou na última página\n\tvar pagina_atual = 1;\n\tvar pagina_inc   = 0;\n\tvar qtd_por_pag  = 30;\n\tvar filtro_ativ\t = false;\t//verificar se o filtro está ativo\n\t\n\t/**\n\t* Iniciar funções relacionadas ao botão baixar.\n\t*/\n\tfunction iniciarBtnBaixar() {\n\n\t\t/**\n\t\t * Clonar campos no popup de acordo com a quantidade de linhas selecionadas.\n\t\t * \n\t\t * @param {int} qtd_linha_selec\n\t\t */\n\t\tfunction clonarInput(qtd_linha_selec) {\n\n\t\t   for (var i = 1; i < qtd_linha_selec; i++) {\n\n\t\t\t   $('.popup')\n\t\t\t\t   .find('.grupo-req')\n\t\t\t\t   .first()\n\t\t\t\t   .clone(true)\n\t\t\t\t   .appendTo(\n\t\t\t\t\t   $('.modal-body')\n\t\t\t\t   );\n\t\t   }\n\t\t}\n\n\t\t/**\n\t\t * Define o valor dos inputs no popup de acordo com a linha selecionada.\n\t\t */\n\t\tfunction setarValorInput() {\n\n\t\t   var i\t\t\t= 1;\n\t\t   var id\t\t\t= '';\n\t\t   var prod\t\t\t= '';\n\t\t   var prod_id\t\t= '';\n\t\t   var loc_padrao\t= '';\n\t\t   var qtd\t\t\t= '';\n\t\t   var saldo\t\t= '';\n\t\t   var operacao_requisicao\t= '';\n\n\t\t   $('.chk-req-selec:checked')\n\t\t\t   .each(function() {\n\n\t\t\t\t\tvar tr\t\t= $(this).closest('tr');\n\t\t\t\t\tid\t\t\t= $(tr).find('.req-id').text();\n\t\t\t\t\tprod\t\t= $(tr).find('.req-produto').text();\n\t\t\t\t\tprod_id\t\t= $(tr).find('._req_produto_id').val();\n\t\t\t\t\tloc_padrao\t= $(tr).find('._req_localizacao_padrao').val();\n\t\t\t\t\tqtd\t\t\t= $(tr).find('.req-qtd').text();\n\t\t\t\t\tsaldo\t\t= $(tr).find('.req-saldo').text();\n\t\t\t\t\toperacao_requisicao = $(tr).find('._operacao_requisicao').val();\n\n\t\t\t\t\tvar popup = $('.popup');\n\t\t\t\t\tvar grupo = popup.find('.grupo-req:nth-of-type('+i+')');\n\n\t\t\t\t\tgrupo\n\t\t\t\t\t\t.find('input.req-id')\n\t\t\t\t\t\t.val(id);\n\n\t\t\t\t\tgrupo\n\t\t\t\t\t   .find('input.req-produto')\n\t\t\t\t\t   .val(prod);\n\n\t\t\t\t\tgrupo\n\t\t\t\t\t   .find('input.req-qtd')\n\t\t\t\t\t   .val(qtd);\n\n\t\t\t\t\tgrupo\n\t\t\t\t\t   .find('input.req-saldo')\n\t\t\t\t\t   .val(saldo);\n\n\t\t\t\t\t//valor máximo permitido para baixar (de acordo com o saldo)\n\t\t\t\t\tgrupo\n\t\t\t\t\t   .find('input.req-baixar')\n\t\t\t\t\t   .val(formataPadrao(saldo))\n\t\t\t\t\t   .attr('max', formataPadrao(saldo));\n\t\t\t   \n\t\t\t\t\tgrupo\n\t\t\t\t\t\t.find('._consulta_filtro[objcampo=\"_operacao_prod_id\"]')\n\t\t\t\t\t\t.val(prod_id);\n\t\t\t\t\n\t\t\t\t\t//localização padrão\n\t\t\t\t\tgrupo\n\t\t\t\t\t\t.find('._loc_cadastrado')\n\t\t\t\t\t\t.val(loc_padrao);\n\t\t\t\t\n\t\t\t\t\tgrupo\n\t\t\t\t\t\t.find('.loc')\n\t\t\t\t\t\t.children('option')\n\t\t\t\t\t\t.each(function() {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif ( $(this).val() === loc_padrao ) {\n\t\t\t\t\t\t\t\t$(this).attr('selected', true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$(this).removeAttr('selected');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\t});\n\t\t\t\t\t//\n\t\t\t\t\t\n\t\t\t\t\tgrupo\n\t\t\t\t\t\t.find('input._operacao_requisicao_modal')\n\t\t\t\t\t\t.val(operacao_requisicao);\n\n\t\t\t\t   i++;\n\n\t\t\t   });\n\t   }\n\n\t\t/**\n\t\t * Ativa ação do botão 'Baixar Estoque', \n\t\t * que abre o popup com os itens selecionados para dar baixa.\n\t\t */\n\t\tfunction acaoBtnBaixar() {\n\n\t\t\t //botão baixar estoque\n\t\t\t $('.baixar-estoque')\n\t\t\t\t .click(function() {\n\n\t\t\t\t\t var qtd_linha_selec = $('.chk-req-selec:checked').length;\n\n\t\t\t\t\t clonarInput(qtd_linha_selec);\n\t\t\t\t\t setarValorInput();\n\n\t\t\t\t\t $(this).popUp();\n\n\t\t\t\t });\n\n\t\t}\n\t   \n\t\t/**\n\t\t * Ativa ação do botão 'Voltar' do Popup.\n\t\t */\n\t\tfunction acaoBtnVoltar() {\n\n\t\t\t//ações ao fechar popup\n\t\t\t $('.popup-close')\n\t\t\t\t .click(function() {\n\n\t\t\t\t\t setTimeout(function() {\n\n\t\t\t\t\t\t var grupo = $('.popup').find('.grupo-req');\n\n\t\t\t\t\t\t $(grupo)\n\t\t\t\t\t\t\t .not(':first')\n\t\t\t\t\t\t\t .remove();\n\n\t\t\t\t\t\t $(grupo)\n\t\t\t\t\t\t\t .children('.form-group')\n\t\t\t\t\t\t\t .find('input')\n\t\t\t\t\t\t\t .val('');\n\n\t\t\t\t\t\t //resetar consulta de operação\n\t\t\t\t\t\t var consulta = $(grupo).children('.consulta-container');\n\n\t\t\t\t\t\t $(consulta)\n\t\t\t\t\t\t\t .find('input.consulta-descricao')\n\t\t\t\t\t\t\t .val('');\n\n\t\t\t\t\t\t $(consulta)\n\t\t\t\t\t\t\t .find('._consulta_imputs')\n\t\t\t\t\t\t\t .children('input')\n\t\t\t\t\t\t\t .val('');\n\n\t\t\t\t\t\t $(consulta)\n\t\t\t\t\t\t\t .find('input._consulta_filtro')\n\t\t\t\t\t\t\t .val('');\n\n\t\t\t\t\t\t $(consulta)\n\t\t\t\t\t\t\t .find('input._valor_selecionado_consulta')\n\t\t\t\t\t\t\t .val('');\n\n\t\t\t\t\t\t $(consulta)\n\t\t\t\t\t\t\t .find('input.consulta-descricao')\n\t\t\t\t\t\t\t .removeAttr('readonly')\n\t\t\t\t\t\t\t .val('');\n\n\t\t\t\t\t\t $(consulta)\n\t\t\t\t\t\t\t .find('.btn-apagar-filtro-consulta')\n\t\t\t\t\t\t\t .hide()\n\t\t\t\t\t\t\t .prev('button')\n\t\t\t\t\t\t\t .show();\n\t\t\t\t\t\t //\n\n\n\t\t\t\t\t }, 200);\n\n\t\t\t\t });\n\t\t}\n\n\t\tacaoBtnBaixar();\n\t\tacaoBtnVoltar();\n\t}\n\n\t/**\n\t * Habilitar botão 'Baixar Estoque' caso algum item da tabela\n\t * esteja selecionado.\n\t */\n\tfunction habilitarBtnBaixar() {\n\n\t   /**\n\t\t* Verifica se existe linha selecionada\n\t\t*/\n\t   function verifLinhaSelec() {\n\n\t\t   setTimeout(function() {\n\n\t\t\t   if( $('.chk-req-selec').is(':checked') )\n\t\t\t\t   $('.baixar-estoque').removeAttr('disabled');\n\t\t\t   else\n\t\t\t\t   $('.baixar-estoque').attr('disabled', true);\n\n\t\t   }, 200);\n\t   }\n\n\t   $('table')\n\t\t   .on('change', '.chk-req-selec', function() {\n\t\t\t   verifLinhaSelec();\n\t\t   });\n\n\t   verifLinhaSelec();\n\n\t}\n\t\n\t/**\n\t * Paginação.\n\t */\n\tfunction paginacaoScroll() {\n\t\t\n\t\t/**\n\t\t * Carregar páginas\n\t\t */\n\t\tfunction carregarPagina() {\n\n\t\t\tvar filtro\t = '';\n\t\t\tvar status\t = '';\n\t\t\tvar estab\t = '';\n\t\t\tvar data_ini = '';\n\t\t\tvar data_fim = '';\n\t\t\tvar dados\t = '';\n\t\t\tvar url\t\t = '';\n\t\t\tvar create\t = ($('#filter-status').length > 0) ? true : false; //verifica se está na tela create\n\t\t\t\n\t\t\t//Verifica se o filtro está ativo. Se sim, a paginação será filtrada também.\n\t\t\tif ( filtro_ativ ) {\n\t\t\t\t\n\t\t\t\tif (create)\t{\n\t\t\t\t\tstatus = $('#filter-status').val();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfiltro\t = $('.filtro-obj').val();\n\t\t\t\testab\t = $('.estab').val();\n\t\t\t\tdata_ini = $('#data-ini').val();\n\t\t\t\tdata_fim = $('#data-fim').val();\n\t\t\t}\n\n\t\t\tif ( final_pag || ($('.filtro-obj').val() !== '') ) {\n\t\t\t\tpagina_atual = 1;\n\t\t\t\tpagina_inc   = 0;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tpagina_atual   += 1;\n\t\t\tpagina_inc\t\t= pagina_atual * qtd_por_pag - qtd_por_pag;\n\n\t\t\t//ajax\n\t\t\tif (create) {\n\t\t\t\n\t\t\t\turl\t\t= '/_15040/paginacaoScroll';\n\t\t\t\tdados\t= {\n\t\t\t\t\t'qtd_por_pagina'\t: qtd_por_pag, \n\t\t\t\t\t'pagina'\t\t\t: pagina_inc,\n\t\t\t\t\t'filtro'\t\t\t: filtro,\n\t\t\t\t\t'status'\t\t\t: status,\n\t\t\t\t\t'estab'\t\t\t\t: estab,\n\t\t\t\t\t'data_ini'\t\t\t: data_ini,\n\t\t\t\t\t'data_fim'\t\t\t: data_fim\n\t\t\t\t};\n\t\t\t\t\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\n\t\t\t\turl\t\t= '/_15040/paginacaoScrollBaixa';\n\t\t\t\tdados\t= {\n\t\t\t\t\t'qtd_por_pagina'\t: qtd_por_pag, \n\t\t\t\t\t'pagina'\t\t\t: pagina_inc,\n\t\t\t\t\t'filtro'\t\t\t: filtro,\n\t\t\t\t\t'estab'\t\t\t\t: estab,\n\t\t\t\t\t'data_ini'\t\t\t: data_ini,\n\t\t\t\t\t'data_fim'\t\t\t: data_fim\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tsuccess = function(resposta) {\n\n\t\t\t\tif(resposta) {\t\t\t\t\t\t\n\n\t\t\t\t\t$('table.lista-obj-15040 tbody')\n\t\t\t\t\t\t.append(resposta);\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfinal_pag = true;\n\t\t\t\t}\n\n\t\t\t};\n\t\t\t\n\t\t\terror = function(xhr) {\n\t\t\t\tfinal_pag = true;\n\t\t\t\tshowErro(xhr);\n\t\t\t};\n\t\t\t\n\t\t\texecAjax1(\n\t\t\t\t'POST', \n\t\t\t\turl,\n\t\t\t\tdados,\n\t\t\t\tsuccess,\n\t\t\t\terror\n\t\t\t);\n\t\t\t//\n\n\t\t}\n\t\t\n\t\t/**\n\t\t * Eventos do scroll.\n\t\t */\n\t\tfunction eventoScroll() {\n\n\t\t\tsetTimeout(function() {\t\t//espera necessária devido ao plugin dataTable\n\n\t\t\t\tvar scroll_timer = 0;\t//verificar timeout\n\n\t\t\t\t//carregar página com scroll\n\t\t\t\t$('.dataTables_scrollBody').scroll(function() {\n\n\t\t\t\t\tvar div = $(this);\n\n\t\t\t\t\tclearTimeout(scroll_timer);\n\n\t\t\t\t\tscroll_timer = setTimeout(function() {\n\t\t\t\t\t\tif( ( div.scrollTop() + div.height() ) >= div.children('table').height() )\n\t\t\t\t\t\t\tcarregarPagina();\n\t\t\t\t\t}, 200);\n\n\t\t\t\t});\n\n\t\t\t}, 1000);\n\t\t\t\n\t\t}\n\t\t\n\t\teventoScroll();\n\t}\n\n\t/**\n\t * Filtrar tabela de acordo com as opções escolhidas.\n\t */\n\tfunction filtrarRefinado() {\n\t\t\n\t\t/**\n\t\t * Verificar se um dos períodos está vazio.\n\t\t * @param {string} data_ini\n\t\t * @param {string} data_fim\n\t\t * @returns {Boolean}\n\t\t */\n\t\tfunction verifPeriodo(data_ini, data_fim) {\n\t\t\t\n\t\t\tvar ret = false;\n\t\t\t\n\t\t\tif ( data_ini === '' && data_fim !== '' ) {\n\t\t\t\t\n\t\t\t\t$('#data-ini')\n\t\t\t\t\t.addClass('invalid');\n\t\t\t\n\t\t\t\tret = false;\n\t\t\t\t\n\t\t\t}\n\t\t\telse if ( data_ini !== '' && data_fim === '' ) {\t\t\t\t\t\n\t\t\t\n\t\t\t\t$('#data-fim')\n\t\t\t\t\t.addClass('invalid');\n\t\t\t\n\t\t\t\tret = false;\n\t\t\t\t\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\n\t\t\t\t$('#data-ini, #data-fim')\n\t\t\t\t\t.removeClass('invalid');\n\t\t\t\n\t\t\t\tret = true;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\treturn ret;\n\t\t}\n\t\n\t\t/**\n\t\t * Evento do botão filtrar.\n\t\t */\n\t\tfunction eventoBtnFiltrar() {\n\t\t\t\n\t\t\t$('#table-filter')\n\t\t\t\t.on('click', '#btn-table-filter', function() {\n\n\t\t\t\t\tvar data_ini = $('#data-ini').val();\n\t\t\t\t\tvar data_fim = $('#data-fim').val();\n\t\t\t\t\tvar url\t\t = '';\n\t\t\t\t\tvar dados\t = '';\n\t\t\t\t\tvar create\t = ($('#filter-status').length > 0) ? true : false; //verifica se está na tela create\n\n\t\t\t\t\tif ( !verifPeriodo(data_ini, data_fim) ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\t//se o filtro for alterado, a paginação deve reiniciar\n\t\t\t\t\tfinal_pag\t\t= false;\n\t\t\t\t\tpagina_atual\t= 1;\n\t\t\t\t\tpagina_inc\t\t= 0;\n\t\t\t\t\tfiltro_ativ\t\t= true;\n\t\t\t\t\t\n\t\t\t\t\t//tela create\n\t\t\t\t\tif ( create ) {\n\n\t\t\t\t\t\turl\t  = '/_15040/filtrar';\n\t\t\t\t\t\tdados = {\n\t\t\t\t\t\t\t'filtro'\t: $('.filtro-obj').val(),\n\t\t\t\t\t\t\t'status'\t: $('#filter-status').val(),\n\t\t\t\t\t\t\t'estab'\t\t: $('.estab').val(),\n\t\t\t\t\t\t\t'data_ini'\t: data_ini,\n\t\t\t\t\t\t\t'data_fim'\t: data_fim\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\n\t\t\t\t\t\turl\t  = '/_15040/filtrarBaixa';\n\t\t\t\t\t\tdados = {\n\t\t\t\t\t\t\t'filtro'\t: $('.filtro-obj').val(),\n\t\t\t\t\t\t\t'estab'\t\t: $('.estab').val(),\n\t\t\t\t\t\t\t'data_ini'\t: data_ini,\n\t\t\t\t\t\t\t'data_fim'\t: data_fim\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\t//ajax\n\t\t\t\t\texecAjax1(\n\t\t\t\t\t\t'POST',\n\t\t\t\t\t\turl,\n\t\t\t\t\t\tdados,\n\t\t\t\t\t\tfunction(data) {\n\n\t\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t$('.dataTables_scrollBody')\n\t\t\t\t\t\t\t\t\t.scrollTop(0);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t$('table.lista-obj-15040 tbody')\n\t\t\t\t\t\t\t\t\t.empty()\n\t\t\t\t\t\t\t\t\t.append(data);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\thabilitarBtnBaixar();\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\turiHistory(dados, create);\n\n\t\t\t\t});\t\n\t\t}\n\t\t\n\t\teventoBtnFiltrar();\n\t}\n\t\n\t/** \n\t * Filtrar tabela a partir do valor digitado no campo.\n\t */\n\tfunction filtrar() {\n\t\t\n\t\t/**\n\t\t * Filtro.\n\t\t */\n\t\tfunction iniciarFiltrar() {\n\n\t\t\tvar status\t = '';\n\t\t\tvar estab\t = '';\n\t\t\tvar data_ini = '';\n\t\t\tvar data_fim = '';\n\t\t\tvar url\t\t = '';\n\t\t\tvar dados\t = '';\n\t\t\tvar create\t = ($('#filter-status').length > 0) ? true : false; //verifica se está na tela create\n\t\t\t\n\t\t\t//Verifica se o filtro está ativo. Se sim, a paginação será filtrada também.\n\t\t\tif ( filtro_ativ ) {\n\t\t\t\t\n\t\t\t\t//tela create\n\t\t\t\tif ( create ) {\n\t\t\t\t\tstatus = $('#filter-status').val();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\testab\t = $('.estab').val();\n\t\t\t\tdata_ini = $('#data-ini').val();\n\t\t\t\tdata_fim = $('#data-fim').val();\n\t\t\t}\n\n\t\t\t//se o filtro for alterado, a paginação deve reiniciar\n\t\t\tfinal_pag\t\t= false;\n\t\t\tpagina_atual\t= 1;\n\t\t\tpagina_inc\t\t= 0;\n\t\t\tfiltro_ativ\t\t= true;\n\t\t\t\n\t\t\t//tela create\n\t\t\tif ( create ) {\n\t\t\t\t\n\t\t\t\turl\t  = '/_15040/filtrar';\n\t\t\t\tdados = {\n\t\t\t\t\t'filtro'\t: $('.filtro-obj').val(),\n\t\t\t\t\t'status'\t: status,\n\t\t\t\t\t'estab'\t\t: estab,\n\t\t\t\t\t'data_ini'\t: data_ini,\n\t\t\t\t\t'data_fim'\t: data_fim\n\t\t\t\t};\n\t\t\t\t\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\n\t\t\t\turl\t  = '/_15040/filtrarBaixa';\n\t\t\t\tdados = {\n\t\t\t\t\t'filtro'\t: $('.filtro-obj').val(),\n\t\t\t\t\t'estab'\t\t: estab,\n\t\t\t\t\t'data_ini'\t: data_ini,\n\t\t\t\t\t'data_fim'\t: data_fim\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\texecAjax1(\n\t\t\t\t'POST',\n\t\t\t\turl,\n\t\t\t\tdados,\n\t\t\t\tfunction(data) {\n\t\t\t\t\t\n\t\t\t\t\tif ( data ) {\n\n\t\t\t\t\t\t$('table.lista-obj-15040 tbody')\n\t\t\t\t\t\t\t.empty()\n\t\t\t\t\t\t\t.append(data);\n\n\t\t\t\t\t\t//tela create\n\t\t\t\t\t\tif ( create ) {\n\t\t\t\t\t\t\thabilitarBtnBaixar();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\turiHistory(dados, create);\n\n\t\t}\n\n\t    /**\n\t\t * Eventos da filtragem.\n\t\t */\n\t\tfunction eventoFiltrar() {\n\n\t\t\t$('.btn-filtro-obj').click(function() {\n\t\t\t\tiniciarFiltrar();\n\t\t\t});\t\t\t\t\n\n\t\t\t$('.filtro-obj').keydown(function(e) {\n\t\t\t\tif (e.keyCode === 13) \n\t\t\t\t\tiniciarFiltrar();\n\t\t\t});\n\n\t\t}\n\n\t\teventoFiltrar();\n\t}\n\n\t/**\n\t * Filtrar tabela ao carregar página se algum filtro tiver sido feito antes.\n\t */\n\tfunction filtrarAoCarregar() {\n\n\t\t// Se houver parâmetros na url, o que significa que um filtro já foi feito antes.\n\t\tif ( location.href.indexOf('?') > -1 ) {\n\t\t\t\n\t\t\tsetTimeout(function() { \n\t\t\t\t$('#btn-table-filter').click(); \n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\t/**\n\t * Definir URL com parâmetro do filtro e guardar em localStorage.\n\t * @param json dado\n\t * @param boolean create\n\t */\n\tfunction uriHistory(dado, create) {\n\n\t\tif (create) {\n\t\t\t\n\t\t\twindow.history.replaceState('', '', encodeURI(urlhost + '/_15040?'+ $.param(dado)));\n\t\t\tlocalStorage.setItem('15040FiltroUrl', location.href);\n\t\t}\n\t\telse {\n\t\t\n\t\t\twindow.history.replaceState('', '', encodeURI(urlhost + '/_15040/create?'+ $.param(dado)));\n\t\t\tlocalStorage.setItem('15040CreateFiltroUrl', location.href);\n\t\t}\n\t}\n\n\t/**\n\t * Ativar Datatable.\n     * @param {element} table\n\t * @param {string} height\n     * @returns {void}\n     */\n\tfunction ativarDatatable(table, height) {\n\t\t\n\t\tvar table = table || $('.table');\n        \n\t\tvar data_table = $.extend({}, table_default);\n\t\t\tdata_table.scrollY = height;\n\n\t\t$(table).DataTable(data_table);\n\t\t\n\t}\n\t\n\t$(function() {\n\t\t\n\t\tiniciarBtnBaixar();\n\t\thabilitarBtnBaixar();\n\t\tpaginacaoScroll();\n\t\tfiltrarRefinado();\n\t\tfiltrar();\n\t\tfiltrarAoCarregar();\n\t\t\n\t\tif ( $('.table-baixa-realizada').length > 0 ) {\n\t\t\tativarDatatable( $('.table-baixa-realizada'), '70vh' );\n\t\t}\n\t\telse {\n\t\t\tativarDatatable( $('.table-requisicao-pendente'), '53vh' );\n\t\t}\n\t\t\n\t\tativarSelecLinhaCheckbox();\n\t\t\n\t});\n})(jQuery);"]}