{"version":3,"sources":["_22010.app.js","_22010.service.js","_22010.factory.totalizador-diario.js","_22010.factory.talao-tempo.js","_22010.factory.talao-ficha.js","_22010.factory.talao-defeito.js","_22010.factory.talao-detalhe.js","_22010.factory.talao-consumo.js","_22010.factory.talao-historico.js","_22010.factory.talao-composicao.js","_22010.factory.talao-produzido.js","_22010.factory.talao-produzir.js","_22010.factory.defeito.js","_22010.factory.filtro.js","_22010.factory.acao.js","_22010.controller.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9EA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3uBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_22010.app.js","sourcesContent":["/**\n * _22010 - Registro de Produção\n */\n'use strict';\n\nangular\n\t.module('app', [\n\t\t'vs-repeat', \n        'gc-find',\n\t\t'gc-ajax',\n\t\t'gc-transform',\n\t\t'gc-form',\n\t\t'gc-utils',\n        'ngSanitize',\n        'gc-pessoal'\n\t])\n;","/* \r\n * To change this license header, choose License Headers in Project Properties.\r\n * To change this template file, choose Tools | Templates\r\n * and open the template in the editor.\r\n */\r\n\r\n\r\nangular\r\n    .module('app')\r\n    .service('Consulta', Consulta);\r\n    \r\n    \r\n\tConsulta.$inject = [];\r\n\r\n\tfunction Consulta() {\r\n        \r\n    \t// MÉTODOS (REFERÊNCIAS)\r\n        this.consultarUsuario = consultarUsuario;\r\n    \tthis.consultarTarefa  = consultarTarefa;\r\n\r\n    \t// MÉTODOS\r\n    \t\r\n    \t/**\r\n    \t * Consultar usuário.\r\n    \t */\r\n\t    function consultarUsuario() {\r\n\r\n\t    \treturn $ajax.post('/_11010/listarTodos', null, {contentType: 'application/json'});\r\n\t\t}\r\n\r\n        /**\r\n         * Consultar tarefa.\r\n         */\r\n        function consultarTarefa(param) {\r\n\r\n            return $ajax.post('/_29010/consultarTarefa', JSON.stringify(param), {contentType: 'application/json'});\r\n        }\r\n\t}    ","angular\n    .module('app')\n    .factory('TotalizadorDiario', TotalizadorDiario);\n    \n\n\tTotalizadorDiario.$inject = [\n        '$ajax',\n        '$q',\n        '$rootScope',\n        '$timeout',\n        'gScope',\n        'gcCollection',\n        'gcObject'\n    ];\n\nfunction TotalizadorDiario($ajax, $q, $rootScope, $timeout, gScope, gcCollection, gcObject) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TotalizadorDiario(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n        this.DADOS = [];\n        this.TOTALIZADOR = [];\n    }\n    \n    /**\n     * Private property\n     */\n    var url_base        = '_22010/api/totalizador-diario';\n    var possibleRoles   = ['admin', 'editor', 'guest'];\n\n    /**\n     * Public method, assigned to prototype\n     */\n    TotalizadorDiario.prototype = { \n        consultar : function (args) {\n            var that = this;\n            return $q(function(resolve) {\n        \n                var args = {\n                    estabelecimento_id\t: $('.estab').val(),\n                    gp_id               : $('._gp_id').val(),\n                    perfil_up_id\t\t: $('._perfil_up_id').val(),\n                    up_id\t\t\t\t: $('._up_id').val(),\n                    up_todos\t\t\t: $('._up_todos').val(),\n                    estacao\t\t\t\t: $('._estacao_id').val(),\n                    estacao_todos\t\t: $('._estacao_todos').val(),\n                    data_ini\t\t\t: $('.filtro-periodo .data-ini').val(),\n                    data_fim\t\t\t: $('.filtro-periodo .data-fim').val(),\n                    turno\t\t\t\t: $('#turno').val(),\n                    turno_hora_ini\t\t: $('#turno').find(':selected').data('hora-ini'),\n                    turno_hora_fim\t\t: $('#turno').find(':selected').data('hora-fim')\n                };\n                 \n\n                $ajax.post(url_base, args).then(function(res){\n\n                    that.DADOS = res;\n                    \n                    that.totalizadorCalc();\n                    \n                    resolve(true);\n                });\n            });            \n               \n        },\n        totalizadorCalc : function () {\n            var that = this;\n            var dados = that.DADOS;\n        \n            var total = {\n                CAPACIDADE_DISPONIVEL       : 0,\n                CARGA_PROGRAMADA            : 0,\n                QUANTIDADE_TALAO_PROGRAMADA : 0,\n                QUANTIDADE_CARGA_PROGRAMADA : 0,\n                QUANTIDADE_PARES_PROGRAMADA : 0,\n                PERC_CARGA_PROGRAMADA       : 0,\n                CARGA_PENDENTE              : 0,\n                QUANTIDADE_TALAO_PENDENTE   : 0,\n                QUANTIDADE_CARGA_PENDENTE   : 0,\n                QUANTIDADE_PARES_PENDENTE   : 0,\n                CARGA_UTILIZADA             : 0,\n                QUANTIDADE_TALAO_UTILIZADA  : 0,\n                QUANTIDADE_CARGA_UTILIZADA  : 0,\n                QUANTIDADE_PARES_UTILIZADA  : 0,\n                EFICIENCIA                  : 0,\n                PERC_APROVEITAMENTO         : 0,\n                UM                          : ''\n            };\n\n            if ( dados != undefined ) {\n                \n                var qtd = 0;\n                \n                for ( var i in dados ) {\n                    var item = dados[i];\n                    \n                    qtd++;\n           \n                    total.CAPACIDADE_DISPONIVEL       += parseFloat(item.CAPACIDADE_DISPONIVEL      || 0);\n                    total.CARGA_PROGRAMADA            += parseFloat(item.CARGA_PROGRAMADA           || 0);\n                    total.QUANTIDADE_TALAO_PROGRAMADA += parseFloat(item.QUANTIDADE_TALAO_PROGRAMADA|| 0);\n                    total.QUANTIDADE_CARGA_PROGRAMADA += parseFloat(item.QUANTIDADE_CARGA_PROGRAMADA|| 0);\n                    total.QUANTIDADE_PARES_PROGRAMADA += parseFloat(item.QUANTIDADE_PARES_PROGRAMADA|| 0);\n                    total.PERC_CARGA_PROGRAMADA       += parseFloat(item.PERC_CARGA_PROGRAMADA      || 0);\n                    total.CARGA_PENDENTE              += parseFloat(item.CARGA_PENDENTE             || 0);\n                    total.QUANTIDADE_TALAO_PENDENTE   += parseFloat(item.QUANTIDADE_TALAO_PENDENTE  || 0);\n                    total.QUANTIDADE_CARGA_PENDENTE   += parseFloat(item.QUANTIDADE_CARGA_PENDENTE  || 0);\n                    total.QUANTIDADE_PARES_PENDENTE   += parseFloat(item.QUANTIDADE_PARES_PENDENTE  || 0);\n                    total.CARGA_UTILIZADA             += parseFloat(item.CARGA_UTILIZADA            || 0);\n                    total.QUANTIDADE_TALAO_UTILIZADA  += parseFloat(item.QUANTIDADE_TALAO_UTILIZADA || 0);\n                    total.QUANTIDADE_CARGA_UTILIZADA  += parseFloat(item.QUANTIDADE_CARGA_UTILIZADA || 0);\n                    total.QUANTIDADE_PARES_UTILIZADA  += parseFloat(item.QUANTIDADE_PARES_UTILIZADA || 0);\n                    total.EFICIENCIA                  += parseFloat(item.EFICIENCIA                 || 0);\n                    total.PERC_APROVEITAMENTO         += parseFloat(item.PERC_APROVEITAMENTO        || 0);\n                }\n//                console.log(total.PERC_CARGA_PROGRAMADA);\n//                console.log(qtd);\n                \n                total.PERC_CARGA_PROGRAMADA = total.PERC_CARGA_PROGRAMADA / qtd;\n                total.EFICIENCIA            = total.EFICIENCIA            / qtd;\n                total.PERC_APROVEITAMENTO   = total.PERC_APROVEITAMENTO   / qtd;\n                \n                total.UM = dados[0].UM;\n            }\n                 \n            that.TOTALIZADOR = [total];\n\n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        }\n    };\n\n    /**\n     * Private function\n     */\n    function checkRole(role) {\n      return possibleRoles.indexOf(role) !== -1;\n    }\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n    TotalizadorDiario.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n    TotalizadorDiario.build = function (data) {\n        \n        if (!checkRole(data.role)) {\n          return;\n        }\n        \n        return new TotalizadorDiario(data);\n    };\n\n    /**\n     * Return the constructor function\n     */\n    return TotalizadorDiario;\n};","angular\n    .module('app')\n    .factory('TalaoTempo', TalaoTempo);\n    \n\n\tTalaoTempo.$inject = [        \n        '$ajax',\n        '$filter',\n        '$rootScope',\n        'gScope'\n    ];\n\nfunction TalaoTempo($ajax,$filter,$rootScope,gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoTempo(data) {\n        if (data) {\n            this.setData(data);\n        }\n    }\n    \n    this.TOTAL          = 0;\n    var time_interval = null;\n    \n    /**\n     * Private property\n     */\n    var url_base        = '_22010/api/talao/';\n    var possibleRoles   = ['admin', 'editor', 'guest'];\n\n    /**\n     * Public method, assigned to prototype\n     */\n    TalaoTempo.prototype = {\n        calcRealTime : function () {\n            var that = this;\n            var talao = gScope.TalaoProduzir.SELECTED;\n            \n            clearInterval(time_interval);\n            that.INTERVAL_TIME = null;\n                \n            if ( talao == undefined ) return false;\n            \n            if ( talao.PROGRAMACAO_STATUS == '2' ) {\n                \n                var calc = function () {\n                    var ultima_data =\t\n                    $('#historico')\n                        .find('tbody')\n                        .find('td.data-historico')\n                        .data('datahora') || new Date()\n                    ;\n\n                    var diferenca\t\t =\tmoment(Clock.DATETIME_SERVER).diff(moment(ultima_data));\n                    var tempo            = diferenca + talao.TEMPO_REALIZADO * 60 * 1000;\n\n                    var tempo_total_obj = moment.duration(tempo).add(1, 's');\n                    \n                    talao.TEMPO_REALIZADO_RELOGIO = tempo_total_obj.asMinutes().toFixed(4);\n                    talao.TEMPO_REALIZADO_HUMANIZE = tempo_total_obj.format('mm[m] ss[s]');\n\n                    $('#_tempo-realizado')\n                        .val( talao.TEMPO_REALIZADO_RELOGIO )\t//fração de minutos\n                    ;\n                };\n                \n                time_interval = setInterval(function() {\n                    $rootScope.$apply(function(){\n                        calc();\n                    });\n                }, 1000);  \n                \n                calc();\n            } else {\n                \n                var duracao = moment.duration(talao.TEMPO_REALIZADO * 60 * 1000);\n                talao.TEMPO_REALIZADO_RELOGIO  = talao.TEMPO_REALIZADO_RELOGIO  || duracao.asMinutes().toFixed(4);\n                talao.TEMPO_REALIZADO_HUMANIZE = talao.TEMPO_REALIZADO_HUMANIZE || duracao.format('mm[m] ss[s]');\n                \n                $('#_tempo-realizado')\n                    .val( talao.TEMPO_REALIZADO_RELOGIO )\t//fração de minutos\n                ;\n            }\n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        }\n    };\n\n    /**\n     * Private function\n     */\n    function checkRole(role) {\n      return possibleRoles.indexOf(role) !== -1;\n    }\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n    TalaoTempo.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n    TalaoTempo.build = function (data) {\n        \n        if (!checkRole(data.role)) {\n          return;\n        }\n        \n        return new Defeito(\n            data.first_name,\n            data.last_name,\n            data.role\n//            Organisation.build(data.organisation) // another model\n        );\n    };\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoTempo;\n};","angular\n    .module('app')\n    .factory('TalaoFicha', TalaoFicha);\n    \n\n\tTalaoFicha.$inject = [\n        '$ajax',\n        '$timeout',\n        '$q',\n        'gScope',\n        'gcCollection'\n    ];\n\nfunction TalaoFicha($ajax,$timeout,$q,gScope,gcCollection) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoFicha(data) {\n        if (data) {\n            this.setData(data);\n        }\n    }\n    \n    /**\n     * Private property\n     */\n    var url_base        = '_22010/defeitos';\n\n    /**\n     * Public method, assigned to prototype\n     */\n    TalaoFicha.prototype = {\n        OLD_VALUE : 0,\n        selectionar : function (ficha) {\n            \n            if ( ficha != undefined ) {\n            \n                this.SELECTED       = ficha;\n                \n                this.OLD_VALUE = ficha.QUANTIDADE;\n                $('input[ficha=\"' + ficha.TIPO_ID  + '\"').select();\n\n            }\n                \n        }, \n        gravar : function (ficha) {\n            return $q(function(resolve){\n                \n                var dados = {\n                    ID                  : gScope.TalaoProduzir.SELECTED.ID,\n                    REMESSA_ID          : gScope.TalaoProduzir.SELECTED.REMESSA_ID,\n                    REMESSA_TALAO_ID    : gScope.TalaoProduzir.SELECTED.REMESSA_TALAO_ID,\n                    MODELO_ID           : gScope.TalaoProduzir.SELECTED.MODELO_ID,\n                    TIPO_ID             : ficha.TIPO_ID,\n                    QUANTIDADE          : ficha.QUANTIDADE\n                };\n                \n                $ajax.post('/_22010/api/ficha/post',dados,{progress : false}).then(function(response){\n                    \n                    gcCollection.merge(gScope.TalaoComposicao.DADOS.FICHA, response.FICHA, 'TIPO_ID');                    \n                    \n                    resolve(true);\n                });\n            });\n        },\n        keydown : function (ficha,$event,model_old) {\n            var that = this;\n                /* Verifica se existe um evento */\n                if ( !($event === undefined) ) {\n\n                    if ( $event.key == 'ArrowUp' || $event.key == 'Enter' || $event.key == 'ArrowDown' ) {\n                        $event.preventDefault();\n                        $event.stopPropagation();\n                        \n                        var idx_selected = that.FILTERED.indexOf(that.SELECTED);\n\n                        switch ($event.key) {\n                            case 'Enter':\n                            case 'ArrowDown':\n                                var idx = idx_selected+1;\n                                break;\n                            case 'ArrowUp':\n                                var idx = idx_selected-1;\n                                break;\n                        }\n                        \n                        var tabIndex = function (idx) {\n                            if (  that.FILTERED[idx] != undefined ) { \n                                $('input[ficha=\"' + that.FILTERED[idx].TIPO_ID  + '\"').select();\n                            }\n                        };\n                        \n                        if ( parseFloat(that.OLD_VALUE) != parseFloat(ficha.QUANTIDADE) ) {\n                            \n                            that.OLD_VALUE = ficha.QUANTIDADE;\n                            \n                            console.log('val 1 ' + parseFloat(that.OLD_VALUE));\n                            console.log('val 2 ' + parseFloat(ficha.QUANTIDADE));\n                            that.gravar(ficha).then(function(){                        \n                                tabIndex(idx);\n                            });\n                        } else {\n                            tabIndex(idx);\n                        }  \n                    }\n                }            \n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        }\n    };\n\n    /**\n     * Private function\n     */\n//    function func(role) {\n//      \n//    }\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n//    TalaoFicha.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n//    TalaoFicha.build = function (data) {\n//        \n//        if (!checkRole(data.role)) {\n//          return;\n//        }\n//        \n//        return new TalaoFicha(data);\n//    };\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoFicha;\n};","angular\r\n    .module('app')\r\n    .factory('TalaoDefeito', TalaoDefeito);\r\n    \r\n\r\n\tTalaoDefeito.$inject = [        \r\n        '$ajax',\r\n        '$q',\r\n        '$timeout',\r\n        'gScope',\r\n        'gcObject',\r\n        'gcCollection'\r\n    ];\r\n\r\nfunction TalaoDefeito($ajax,$q,$timeout,gScope,gcObject,gcCollection) {\r\n\r\n    /**\r\n     * Constructor, with class name\r\n     */\r\n    function TalaoDefeito(data) {        \r\n        if (data) {\r\n            this.setData(data);\r\n        }\r\n        \r\n        this.dynanmicEvents();\r\n    }\r\n\r\n        \r\n    /**\r\n     * Private property\r\n     */\r\n    var url_base        = '_22010/api/talao/consumo';\r\n    var possibleRoles   = ['admin', 'editor', 'guest'];\r\n\r\n    /**\r\n     * Public method, assigned to prototype\r\n     */\r\n    TalaoDefeito.prototype = {\r\n        justificativa: null,\r\n        justiOperador: null,\r\n        OBJ_EDITING : {\r\n            QUANTIDADE : null,\r\n            OBSERVACAO : ''\r\n        },\r\n        openRegistrarProblema : function () {\r\n            that = this;\r\n\r\n            var dados_autenticacao = {\r\n                operacao_id   : 29,\r\n                modal_show    : true,\r\n                verificar_up  : gScope.Filtro.UP_ID,\r\n                success       : function(e) {\r\n\r\n                    that.justiOperador = e.OPERADOR_ID;\r\n                    that.justificativas();\r\n\r\n                    $('#modal-justificar').modal();\r\n                }\r\n            };\r\n\r\n            autenticacao(dados_autenticacao);\r\n            \r\n        },\r\n        justificar: function(descricao, justificativa){\r\n            var that = this;\r\n\r\n            addConfirme('Justificativa',\r\n                'Observação para o registro <b>' + descricao + '<b>:'+\r\n                '<p>'+\r\n                '<input type=\"search\" class=\"form-control input-medio justificativa_ineficiencia_reg\" maxlength=\"90\" autocomplete=\"off\">'+\r\n                ''\r\n\r\n                ,[obtn_ok,obtn_cancelar],\r\n            [\r\n                {ret:1,func:function(e){\r\n\r\n                    var ds = {\r\n                            TABELA_ID       : gScope.TalaoProduzir.SELECTED.REMESSA_TALAO_ID,\r\n                            TABELA          : 'PRODUCAO',\r\n                            STATUS          : justificativa,\r\n                            VINCULO_ID      : gScope.TalaoProduzir.SELECTED.REMESSA_ID,\r\n                            SUBVINCULO_ID   : gScope.TalaoProduzir.SELECTED.ID,\r\n                            OPERADOR_ID     : that.justiOperador,\r\n                            OBSERVACAO      : $('.justificativa_ineficiencia_reg').val()\r\n                        };\r\n\r\n                    $ajax.post('/_22130/justIneficiencia',JSON.stringify(ds),{contentType: 'application/json'})\r\n                        .then(function(response) {\r\n                            \r\n                            if(response.length > 0){\r\n                                if((gScope.TalaoProduzir.SELECTED.JUSTIFICATIVA + '').length > 0 && gScope.TalaoProduzir.SELECTED.JUSTIFICATIVA != null){\r\n                                    gScope.TalaoProduzir.SELECTED.JUSTIFICATIVA = gScope.TalaoProduzir.SELECTED.JUSTIFICATIVA +',<br>'+ descricao + ' - '+ ds.OBSERVACAO ;\r\n                                }else{\r\n                                    gScope.TalaoProduzir.SELECTED.JUSTIFICATIVA = descricao + ' - '+ ds.OBSERVACAO ;\r\n                                }\r\n                            }\r\n\r\n                            $('#modal-justificar').modal('hide');\r\n\r\n                            showSuccess('Talão Justificado!');\r\n                        }\r\n                    );\r\n\r\n                }},\r\n                {ret:2,func:function(e){\r\n\r\n\r\n                }},\r\n                ]  \r\n            );\r\n\r\n            setTimeout(function(){$('.justificativa_ineficiencia_reg').focus();},300);\r\n        },\r\n        justificativas: function(){\r\n            that = this;\r\n            $ajax.post('/_22010/consultaJustificativa',{}).then(function(response){\r\n                that.justificativa = response;       \r\n            });\r\n        },\r\n        registrar : function () {\r\n            \r\n            var that          = this;\r\n            var talao_detalhe = gScope.TalaoDetalhe.SELECTED;\r\n            var objDefeito    = this.API.DEFEITOS;\r\n            that.OBJ_EDITING = {};\r\n            if ( talao_detalhe.QUANTIDADE_PRODUCAO > 0 ) {\r\n                showErro('Para registrar defeitos, é necessário que não haja quantidade produzida. Operação cancelada.');\r\n                return false;\r\n                \r\n            }\r\n            \r\n            that.OBJ_EDITING = {};                                     \r\n            \r\n            objDefeito.consultar().then(function(){\r\n                \r\n                if ( !(objDefeito.DADOS.length > 0) ) {\r\n                    showErro('Não há defeitos cadastrados para esta familía de produtos');\r\n                    return false;\r\n                }  \r\n            \r\n                $('#modal-registrar-defeito')\r\n                    .modal('show')\r\n                    .one('shown.bs.modal', function(){\r\n                            var table = $(this).find('input').first().focus();                        \r\n                    })\r\n                ;\r\n            });\r\n       \r\n\r\n        },\r\n        gravar : function () {\r\n            \r\n            var that = this;\r\n            \r\n            that.OBJ_EDITING.DEFEITO_ID               = that.API.DEFEITOS.SELECTED.DEFEITO_ID;\r\n            that.OBJ_EDITING.ESTABELECIMENTO_ID       = gScope.Filtro.ESTABELECIMENTO_ID;\r\n            that.OBJ_EDITING.GP_ID                    = gScope.Filtro.GP_ID;\r\n            that.OBJ_EDITING.REMESSA_ID               = gScope.TalaoDetalhe.SELECTED.REMESSA_ID;\r\n            that.OBJ_EDITING.REMESSA_TALAO_DETALHE_ID = gScope.TalaoDetalhe.SELECTED.REMESSA_TALAO_DETALHE_ID;\r\n            that.OBJ_EDITING.PRODUTO_ID               = gScope.TalaoDetalhe.SELECTED.PRODUTO_ID;\r\n            that.OBJ_EDITING.TAMANHO                  = gScope.TalaoDetalhe.SELECTED.TAMANHO;\r\n            that.OBJ_EDITING.OPERADOR_ID              = $('#_operador-id').val();\r\n            \r\n            return $q(function(resolve){\r\n                $ajax.post('/_22010/api/defeitos/post',that.OBJ_EDITING).then(function(){\r\n                    \r\n                    gScope.TalaoProduzir.current(true).then(function(){\r\n\r\n                        $('#modal-registrar-defeito')\r\n                            .modal('hide');                    \r\n                    });   \r\n                    \r\n                    resolve(true);\r\n                });\r\n            });\r\n            \r\n\r\n        },\r\n        excluir : function (id) {\r\n            var that = this;\r\n\r\n            return $q(function(resolve){\r\n                $ajax.post('/_22010/api/defeitos/exclude',{DEFEITO_TRANSACAO_ID : id}).then(function(){\r\n                    \r\n                    $('.popover').remove();\r\n                    \r\n                    gScope.TalaoProduzir.current(true).then(function(){\r\n\r\n                        $('#modal-registrar-defeito')\r\n                            .modal('hide');                    \r\n                    });   \r\n                    \r\n                    resolve(true);\r\n                });\r\n            });\r\n        },\r\n        dynanmicEvents : function () {\r\n            \r\n            var that = this;\r\n            \r\n            /**\r\n             * Ativa o evento de exclusão de defeitos\r\n             */\r\n            $(document).off('click', '.defeito-excluir').on('click', '.defeito-excluir', function() {\r\n                that.excluir($(this).data('item-id'));\r\n            });      \r\n        },\r\n        API : {\r\n            DEFEITOS : {\r\n                DADOS : [],\r\n                SELECTED : {},\r\n                M_FILTRO : '',\r\n                consultar : function () {\r\n                    var that = this;\r\n                    var objDefeito = this;\r\n                    return $q(function(resolve){\r\n\r\n                        that.M_FILTRO = '';\r\n                        that.SELECTED = null;\r\n                        \r\n                        var data = {\r\n                            FAMILIA_ID : gScope.TalaoDetalhe.SELECTED.FAMILIA_ID\r\n                        };\r\n                        \r\n                        $ajax.post('/_22010/api/defeitos', data).then(function(resposta){\r\n\r\n                            objDefeito.DADOS = resposta;\r\n\r\n                            $timeout(function(){\r\n                                if ( that.FILTERED.length > 0 ) {\r\n                                    that.SELECTED = that.FILTERED[0];\r\n                                }\r\n                            });\r\n\r\n                            resolve(true);\r\n                        });  \r\n                    });   \r\n                },\r\n                selecionar : function (defeito) {\r\n                    this.SELECTED = defeito;\r\n                },\r\n                keydown : function (defeito, $event) {\r\n                    \r\n                    /* Verifica se existe um evento */\r\n                    if ( !($event === undefined) ) {\r\n\r\n                        if ( $event.key == 'Enter' ) {\r\n                            var table = $('#modal-registrar-defeito .table-registrar-defeito');\r\n                            var input = table.find('input').first();\r\n                            \r\n                            input.focus();\r\n                        }\r\n                    }    \r\n                },\r\n                mFiltroChange : function(oldValue) {\r\n                    var that = this;\r\n                    \r\n                    if ( that.M_FILTRO.length > oldValue.length ) {\r\n                        $timeout(function(){\r\n                            if ( that.FILTERED.length > 0 ) {\r\n                                that.SELECTED = that.FILTERED[0];\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        selectionar : function (consumo) {\r\n            this.SELECTED = consumo;\r\n        },\r\n        setData: function(data) {\r\n            angular.extend(this, data);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Private function\r\n     */\r\n    function fn () {\r\n        \r\n    }\r\n\r\n    /**\r\n     * Static property\r\n     * Using copy to prevent modifications to private property\r\n     */\r\n    TalaoDefeito.possibleRoles = angular.copy(possibleRoles);\r\n\r\n    /**\r\n     * Static method, assigned to class\r\n     * Instance ('this') is not available in static context\r\n     */\r\n    TalaoDefeito.build = function (data) {\r\n        \r\n        if (!checkRole(data.role)) {\r\n          return;\r\n        }\r\n        \r\n        return new Defeito(\r\n            data.first_name,\r\n            data.last_name,\r\n            data.role\r\n//            Organisation.build(data.organisation) // another model\r\n        );\r\n    };\r\n\r\n    /**\r\n     * Return the constructor function\r\n     */\r\n    return TalaoDefeito;\r\n};","\n        \nangular\n    .module('app')\n    .factory('TalaoDetalhe', TalaoDetalhe);\n    \n\n\tTalaoDetalhe.$inject = [\n        '$ajax',\n        '$timeout',\n        'gScope'\n    ];\n\nfunction TalaoDetalhe($ajax,$timeout,gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoDetalhe(data) {\n        if (data) {\n            this.setData(data);\n        }\n    }\n    \n    /**\n     * Private property\n     */\n    var url_base        = '_22010/defeitos';\n\n    /**\n     * Public method, assigned to prototype\n     */\n    TalaoDetalhe.prototype = {\n        QUANTIDADE_ALTERANDO : [],\n        QUANTIDADE_ALTERNATIVA_ALTERANDO : [],\n        selectionar : function (detalhe) {\n            \n            if ( detalhe != undefined ) {\n            \n                this.SELECTED       = detalhe;\n                this.SELECTED_RADIO = detalhe.ID;\n\n            }\n                \n        }, \n        alterarQuantidade : function (detalhe) {\n            \n//            if ( gScope.TalaoDetalhe.SELECTED != detalhe ) gScope.TalaoDetalhe.selectionar(detalhe);\n            \n            this.QUANTIDADE_ALTERANDO.push(detalhe);\n            detalhe.EDITANDO_QUANTIDADE = true;\n            \n            $timeout(function(){\n                $('#detalhe tr.selected td.qtd input.qtd').select();\n            });\n            \n        },\n        cancelarQuantidade : function (detalhe) {\n            \n//            if ( gScope.TalaoDetalhe.SELECTED != detalhe ) gScope.TalaoDetalhe.selectionar(detalhe);\n            \n            detalhe.M_QUANTIDADE_PRODUCAO = detalhe.QUANTIDADE_PRODUCAO;\n            detalhe.EDITANDO_QUANTIDADE = false; \n            \n            var index = this.QUANTIDADE_ALTERANDO.indexOf(detalhe);\n            this.QUANTIDADE_ALTERANDO.splice(index, 1);        \n        },\n        gravarQuantidade : function (detalhe,$event) {\n\n//            if ( gScope.TalaoDetalhe.SELECTED != detalhe ) gScope.TalaoDetalhe.selectionar(detalhe);\n            \n            var that               = this;\n            var btn                = $('#detalhe tr.selected .qtd .qtd-gravar');\n            var qtd                = detalhe.M_QUANTIDADE_PRODUCAO || 0;\n            var talao_id\t       = detalhe.ID;\n            var qtd_proj\t       = (detalhe.QUANTIDADE - detalhe.QUANTIDADE_DEFEITO).toFixed(4);\n            var qtd_unim\t       = detalhe.UM;\n            var qtd_max            = detalhe.TOLERANCIAM;\n            var qtd_min            = detalhe.TOLERANCIAN;\n            var qtd_tip            = detalhe.TOLERANCIA_TIPO;\n            var sobra_tipo         = detalhe.SOBRA_TIPO;\n            var qtd_aproveitamento = detalhe.APROVEITAMENTO_ALOCADO;\n            var REMESSA_ID         = detalhe.REMESSA_ID;\n            var REMESSA_TALAO_ID   = detalhe.REMESSA_TALAO_ID;\n            var cmp_sob            = detalhe.QUANTIDADE_SOBRA;\n\n            var cb = cmp_sob;\n\n            var input\t\t= 'input.qtd';\n            var url\t\t\t= '/_22010/alterarQtdTalaoDetalhe';\n            var retorno\t\t= 'QUANTIDADE';\n\n            //converter antes para reutilizar\n            var valide1 = isNaN(parseFloat(qtd));\n            var valide2 = isNaN(parseFloat(qtd_proj));\n            var valide3 = isNaN(parseFloat(qtd_aproveitamento));\n\n            //converter antes para reutilizar\n            var v1 = parseFloat(qtd);\n            var v2 = parseFloat(qtd_proj);\n            var v4 = parseFloat(qtd_aproveitamento);\n\n            // Qtd. Proj.  |  Qtd. Aprov.  |  Qtd. Prod.\n            //        50   |          20   |         10\n            //\t\n            // 10 - (50 - 20) = -20 SOBRA      \n            //  \n            // Qtd. Proj.  |  Qtd. Aprov.  |  Qtd. Prod.\n            //        50   |          20   |         30\n            //\t\n            // 30 - (50 - 20) = 0 SOBRA\n            //  \n            // Qtd. Proj.  |  Qtd. Aprov.  |  Qtd. Prod.\n            //        50   |          20   |         40\n            //\t\n            // 40 - (50 - 20) = 10 SOBRA\n\n            var v3 = (v1-(v2-v4)).toFixed(2);\n\n            if ( (valide1 === false) && (valide2 === false) && (valide3 === false)){\n\n                if( qtd_tip == 'Q'){\n                    var toleranciamais = parseFloat(qtd_max);\n                    var toleranciamens = parseFloat(qtd_min) * -1;\n                }else{\n                    if( qtd_tip == 'P'){\n                        var toleranciamais = parseFloat((qtd_max/100)*v2);\n                        var toleranciamens = parseFloat((qtd_min/100)*v2) * -1;\n                    }else{\n                        var toleranciamais = parseFloat(999999);\n                        var toleranciamens = parseFloat(999999) * -1;\n                    }\n                }\n\n                console.log('Tolerancia Mais:'+toleranciamais);\n                console.log('Tolerancia Menos:'+toleranciamens);\n                console.log('Dif:'+v3);\n\n                if ((v3 > toleranciamais) || (v3 < toleranciamens) && (v1 > 0)) {\n\n                    if (sobra_tipo == 'P'){\n                        if (v1 > 0){\n                            validar_prod(v1,v2,v3,v4,toleranciamais,toleranciamens,qtd_unim,talao_id,btn);\n                        }\n                    }else{\n                        showErro('Este produto não permite sobra de Produção!');\n                    }\n\n                }else{\n\n                   execAjax1(\n                       'POST',\n                       url, \n                       { \n                           retorno\t\t\t\t: retorno,\n                           qtd\t\t\t\t\t: qtd,\n                           sbr\t\t\t\t\t: 0,\n                           talao_detalhe_id\t: talao_id,\n                           REMESSA_ID          : REMESSA_ID,\n                           REMESSA_TALAO_ID    : REMESSA_TALAO_ID\n                       },\n                      function(data) {\n\n                          if(v1 > 0){\n                              validarRet(data,btn);\n                          }\n\n                          if(ret == 0){\n\n                             detalhe.QUANTIDADE_PRODUCAO_TMP = qtd;\n                             detalhe.QUANTIDADE_SOBRA_TMP    = 0;\n                             detalhe.EDITANDO_QUANTIDADE     = false; \n\n                             var index = that.QUANTIDADE_ALTERANDO.indexOf(detalhe);\n                             that.QUANTIDADE_ALTERANDO.splice(index, 1); \n\n                             angular.element('#AppCtrl').scope().vm.TalaoComposicao.consultar();\n\n                             showSuccess('Quantidade alterada com sucesso.');\n                          }else{\n                              ret = 0;\n                          }\n                      }\n\n                   );\n                }\n            }            \n        },\n        gravarTodos : function ( tipo ) {\n\t\t\tvar tr_selec\t\t = $('.table-talao-produzir').find('.selected');\n\t\t\tvar remessa_id\t\t = $(tr_selec).find('._remessa-id').val();\n\t\t\tvar remessa_talao_id = $(tr_selec).find('._remessa-talao-id').val();\n            var data = {\n                REMESSA_ID\t\t\t: remessa_id,\n                REMESSA_TALAO_ID\t: remessa_talao_id,\n                TIPO                : tipo\n            };\n\n\t\t\t$ajax.post('/_22010/alterarTodasQtdTalaoDetalhe',data).then(function(data) {\n                \n                gScope.TalaoComposicao.consultar();\n\n                validarRet(data);\n\n                showSuccess('Quantidade alterada com sucesso.');\n            });            \n        },\n        keydownQuantidade : function (detalhe,$event) {\n            var that = this;\n                /* Verifica se existe um evento */\n                if ( !($event === undefined) ) {\n\n                    if ( $event.key == 'Enter' ) {\n                        that.gravarQuantidade(detalhe);\n                    }\n                    if ( $event.key == 'Escape' ) {\n                        that.cancelarQuantidade(detalhe);\n                    }\n                }            \n        },\n        alterarQuantidadeAlternativa : function (detalhe) {\n            \n            this.QUANTIDADE_ALTERNATIVA_ALTERANDO.push(detalhe);\n            detalhe.EDITANDO_QUANTIDADE_ALTERNATIVA = true;\n        },\n        cancelarQuantidadeAlternativa : function (detalhe) {\n            \n            detalhe.M_QUANTIDADE_ALTERN_PRODUCAO = detalhe.QUANTIDADE_ALTERN_PRODUCAO;\n            detalhe.EDITANDO_QUANTIDADE_ALTERNATIVA = false;\n            \n            var index = this.QUANTIDADE_ALTERNATIVA_ALTERANDO.indexOf(detalhe);\n            this.QUANTIDADE_ALTERNATIVA_ALTERANDO.splice(index, 1);        \n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        }\n    };\n\n    /**\n     * Private function\n     */\n//    function func(role) {\n//      \n//    }\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n//    TalaoDetalhe.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n//    TalaoDetalhe.build = function (data) {\n//        \n//        if (!checkRole(data.role)) {\n//          return;\n//        }\n//        \n//        return new TalaoDetalhe(data);\n//    };\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoDetalhe;\n};","angular\n    .module('app')\n    .factory('TalaoConsumo', TalaoConsumo);\n    \n\n\tTalaoConsumo.$inject = [        \n        '$ajax',\n        '$q',\n        '$window',\n        'gScope',\n        'gcObject',\n        'gcCollection'\n    ];\n\nfunction TalaoConsumo($ajax,$q,$window,gScope,gcObject,gcCollection) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoConsumo(data) {\n        if (data) {\n            this.setData(data);\n        }\n    }\n        \n    /**\n     * Private property\n     */\n    var url_base        = '_22010/api/talao/consumo';\n    var possibleRoles   = ['admin', 'editor', 'guest'];\n\n    /**\n     * Public method, assigned to prototype\n     */\n    TalaoConsumo.prototype = {\n        selectionar : function (consumo) {\n            this.SELECTED = consumo;\n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        }\n    };\n\n    /**\n     * Private function\n     */\n    function fn () {\n        \n    }\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n    TalaoConsumo.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n    TalaoConsumo.build = function (data) {\n        \n        if (!checkRole(data.role)) {\n          return;\n        }\n        \n        return new Defeito(\n            data.first_name,\n            data.last_name,\n            data.role\n//            Organisation.build(data.organisation) // another model\n        );\n    };\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoConsumo;\n};","","angular\n    .module('app')\n    .factory('TalaoComposicao', TalaoComposicao);\n    \n\n\tTalaoComposicao.$inject = [        \n        '$ajax',\n        '$q',\n        '$rootScope',\n        '$timeout',\n        'gScope',\n        'gcObject',\n        'gcCollection'\n    ];\n\nfunction TalaoComposicao($ajax,$q,$rootScope,$timeout,gScope,gcObject,gcCollection) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoComposicao(data) {\n        if (data) {\n            this.setData(data);\n        }\n    }\n        \n    /**\n     * Private property\n     */\n    var url_base        = '_22010/api/talao/composicao';\n    var possibleRoles   = ['admin', 'editor', 'guest'];\n\n    /**\n     * Public method, assigned to prototype\n     */\n    TalaoComposicao.prototype = {        \n        TIMEOUT : null,\n        VINCULO_MODELOS : [],\n        consultar : function () {\n            \n            var that = this;\n            \n            return $q(function(resolve) {\n\n                $ajax.post(url_base, getDados(),{progress: false}).then(function(resposta){\n\n                    that.setComposicao(resposta);\n\n                    resolve(true);\n                });\n            });\n            \n        },\n        consultarVinculoModelos : function(talao_id){\n            var that = this;\n            $ajax.post('_22010/api/talao-vinculo-modelos',{TALAO_ID :talao_id }).then(function(response){\n                that.VINCULO_MODELOS = response;\n                \n                $('#modal-vinculo-modelos').modal('show');\n            });\n        },\n        producao : function (bool) {\n            this.EM_PRODUCAO = bool;\n        },\n        setComposicao : function (data) {\n            var that = this;\n            \n            if ( that.DADOS == undefined ) {\n                that.DADOS = [];\n            }\n\n            if ( that.DADOS.DETALHE == undefined ) {\n                that.DADOS.DETALHE = [];\n            }\n\n            if ( that.DADOS.CONSUMO == undefined ) {\n                that.DADOS.CONSUMO = [];\n            }\n\n            if ( that.DADOS.CONSUMO_ALOCACAO == undefined ) {\n                that.DADOS.CONSUMO_ALOCACAO = [];\n            }\n\n            if ( that.DADOS.CONSUMO_PECAS_DISPONIVEIS == undefined ) {\n                that.DADOS.CONSUMO_PECAS_DISPONIVEIS = [];\n            }\n\n            if ( that.DADOS.HISTORICO == undefined ) {\n                that.DADOS.HISTORICO = [];\n            }\n\n            if ( that.DADOS.DEFEITO == undefined ) {\n                that.DADOS.DEFEITO = [];\n            }\n\n            if ( that.DADOS.FICHA == undefined ) {\n                that.DADOS.FICHA = [];\n            }\n\n            gcCollection.merge(that.DADOS.DETALHE                  , data.DETALHE                  , 'ID');\n            gcCollection.merge(that.DADOS.CONSUMO                  , data.CONSUMO                  , 'ID');\n            gcCollection.merge(that.DADOS.CONSUMO_ALOCACAO         , data.CONSUMO_ALOCACAO         , 'ID');\n            gcCollection.merge(that.DADOS.CONSUMO_PECAS_DISPONIVEIS, data.CONSUMO_PECAS_DISPONIVEIS, 'ID');\n            gcCollection.merge(that.DADOS.HISTORICO                , data.HISTORICO                , 'ID');\n            gcCollection.merge(that.DADOS.DEFEITO                  , data.DEFEITO                  , 'DEFEITO_TRANSACAO_ID');\n            gcCollection.merge(that.DADOS.FICHA                    , data.FICHA                    , 'TIPO_ID');\n\n            gcCollection.bind(that.DADOS.DETALHE, that.DADOS.DEFEITO, 'REMESSA_TALAO_DETALHE_ID', 'DEFEITOS');\n            \n            gcCollection.bind(that.DADOS.CONSUMO, that.DADOS.CONSUMO_ALOCACAO         , 'CONSUMO_ID', 'ALOCACOES');\n            gcCollection.bind(that.DADOS.CONSUMO, that.DADOS.CONSUMO_PECAS_DISPONIVEIS, 'PRODUTO_ID', 'PECAS_DISPONIVEIS');\n\n            $timeout(function(){\n\n                $rootScope.$broadcast('bs-init');\n                \n                acoesTalaoDetalhe();\n            });                 \n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        }\n    };\n\n    /**\n     * Private function\n     */\n    function getDados() {\n\n        var table;\n        var tr_selec;\n        var dados = {};\n        var produzir_selecionado = gScope.Filtro.GUIA_ATIVA == 'TALAO_PRODUZIR';\n\n        //definir tabela\n        table\t\t= gScope.Filtro.GUIA_ATIVA == 'TALAO_PRODUZIR' ? $('#talao-produzir') : $('#talao-produzido');\n\n        //linha selecionada\n        tr_selec\t= $(table).find('tbody').find('tr.selected');\n\n        if ( gScope.Filtro.GUIA_ATIVA == 'TALAO_PRODUZIDO' && gScope.TalaoProduzido.SELECTED.ID > 0 ) {\n            dados = {\n                id      \t\t\t: gScope.TalaoProduzido.SELECTED.ID,\n                remessa_id\t\t\t: gScope.TalaoProduzido.SELECTED.REMESSA_ID,\n                remessa_talao_id\t: gScope.TalaoProduzido.SELECTED.REMESSA_TALAO_ID,\n                programacao_id\t\t: gScope.TalaoProduzido.SELECTED.PROGRAMACAO_ID,\n                status\t\t\t\t: '1'\n            };\n        } else \n        if ( gScope.TalaoProduzir.SELECTED != undefined && gScope.TalaoProduzir.SELECTED.ID > 0 ) {\n\n            dados = {\n                id\t\t\t\t\t : gScope.TalaoProduzir.SELECTED.ID,\n                remessa_id\t\t\t : gScope.TalaoProduzir.SELECTED.REMESSA_ID,\n                remessa_talao_id\t : gScope.TalaoProduzir.SELECTED.REMESSA_TALAO_ID,\n                programacao_id\t\t : gScope.TalaoProduzir.SELECTED.PROGRAMACAO_ID,\n                status\t\t\t\t : gScope.Filtro.GUIA_ATIVA == 'TALAO_PRODUZIR' ? '0' : '1',\n                gp_pecas_disponiveis : gScope.Filtro.GP_PECAS_DISPONIVEIS\n            };\n\n\n        }\n        else {\n            dados = {};\n        }\n\n        return dados;\n    }\n\n\t\tfunction preencheDetalhe(conteudo) {\n\n\t\t\tvar div_table\t\t= $('#detalhe .table-detalhe');\n\t\t\tvar scr\t\t\t\t= new $window.Scroll();\n\t\t\tvar scroll_posicao\t= scr.getX(div_table);\n\n\t\t\t$(div_table)\n\t\t\t\t.html(conteudo)\n\t\t\t;\n\n\t\t\t$window.ativarDatatable(div_table.find('table'));\n\t\t\t$window.ativarSelecLinhaRadio();\n\t\t\t$window.editarQtdDetalhe();\n\t\t\t$window.acoesTalaoDetalhe();\n\n\t\t\tscr.setX(div_table, scroll_posicao);\n\n\t\t\tif ( gScope.TalaoProduzir.EM_PRODUCAO ) {\n\t\t\t\t$window.habilitarBtnDetalhe(true);\n\t\t\t\t$window.habilitarBtnEditarQtd(true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$window.habilitarBtnDetalhe(false);\n\t\t\t\t$window.habilitarBtnEditarQtd(false);\n\t\t\t}\n\t\t\t\n\n\t\t}\n\n\t\t/**\n\t\t * Preencher tabela de histórico do talão.\n\t\t * @param {view} conteudo\n\t\t */\n\t\tfunction preencheHistorico(conteudo) {\n\n\t\t\tvar div_table = $('#historico .table-historico');\n\n\t\t\t$(div_table)\n\t\t\t\t.html(conteudo)\n\t\t\t;\n\n\t\t\tativarDatatable(div_table.find('table'));\n\n//\t\t\tnew tempoProducao().tempoRealizado(div_table, false);\n\n\t\t\tverificarTalaoSelecEmProducao();\n\t\t\t\n\t\t}\n\n\t\t/**\n\t\t * Preencher tabela de matéria-prima.\n\t\t * @param {view} conteudo\n\t\t */\n\t\tfunction preencheMateriaPrima(conteudo) {\n\n\t\t\tvar div_table = $('#materia-prima');\n\n\t\t\t$(div_table)\n\t\t\t\t.html(conteudo)\n\t\t\t;\n\n\t\t\tativarDatatable(div_table.find('table'));\n\t\t\tativarSelecLinhaRadio();\n\t\t\teditarQtdMateriaPrima();\n\n\t\t\tif ( gScope.TalaoProduzir.EM_PRODUCAO )\n\t\t\t\thabilitarBtnMateriaPrima(true);\n\t\t\telse\n\t\t\t\thabilitarBtnMateriaPrima(false);\n\t\t\t\n\t\t}\n\n\t\t/**\n\t\t * Preencher tabela de defeitos do talão.\n\t\t * @param {view} conteudo\n\t\t */\n\t\tfunction preencheDefeito(conteudo) {\n\n\t\t\tvar div_table = $('#defeito');\n\n\t\t\t$(div_table)\n\t\t\t\t.html(conteudo)\n\t\t\t;\n\n\t\t\tativarDatatable(div_table.find('table'));\n\t\t\t\n\t\t}\n\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n    TalaoComposicao.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n    TalaoComposicao.build = function (data) {\n        \n        if (!checkRole(data.role)) {\n          return;\n        }\n        \n        return new Defeito(\n            data.first_name,\n            data.last_name,\n            data.role\n//            Organisation.build(data.organisation) // another model\n        );\n    };\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoComposicao;\n};","angular\n    .module('app')\n    .factory('TalaoProduzido', TalaoProduzido);\n    \n\n\tTalaoProduzido.$inject = [        \n        '$ajax',\n        '$timeout',\n        '$q',\n        '$rootScope',\n        'gScope',\n        'gcCollection',\n        'gcObject'\n    ];\n\nfunction TalaoProduzido($ajax,$timeout,$q,$rootScope,gScope,gcCollection,gcObject) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoProduzido(data) {\n        if (data) {\n            this.setData(data);\n        }\n        this.TOTALIZADOR = {};\n        this.DADOS = [];\n    }\n    \n    /**\n     * Private property\n     */\n    var url_base = '_22010/api/talao/produzido/';\n    var dados    = {};\n\n    /**\n     * Coleta ou atualiza da variável dados do talão selecionado\n     * @returns {void}\n     */\n    var dadosTalao = function()\n    {\n        var f = gScope.Filtro;\n        var t = gScope.TalaoProduzido.SELECTED;\n        \n        var estabelecimento_id\t= f.ESTABELECIMENTO_ID;\n        var gp_id\t\t\t\t= f.GP_ID;\n        var up_id\t\t\t\t= f.UP_ID;\n        var estacao\t\t\t\t= f.ESTACAO;\n        var operador_id\t\t\t= $('#_operador-id').val();\n        var remessa_id\t\t\t= t.REMESSA_ID;\n        var remessa_talao_id\t= t.REMESSA_TALAO_ID;\n        var talao_id\t\t\t= t.ID;\n        var programacao_id\t\t= t.PROGRAMACAO_ID;\n        var tempo_realizado\t\t= t.TEMPO_REALIZADO_RELOGIO;\n\n        dados = {\n            estabelecimento_id\t: estabelecimento_id,\n            gp_id\t\t\t\t: gp_id,\n            up_id\t\t\t\t: up_id,\n            estacao\t\t\t\t: estacao,\n            operador_id\t\t\t: operador_id,\n            remessa_id\t\t\t: remessa_id,\n            remessa_talao_id\t: remessa_talao_id,\n            talao_id\t\t\t: talao_id,\n            programacao_id\t\t: programacao_id,\n            tempo_realizado\t\t: tempo_realizado\n        };\n    };  \n\n    /**\n     * Public method, assigned to prototype\n     */\n    TalaoProduzido.prototype = {    \n        selectionar : function (talao,setfocus) {\n            \n            if ( talao != undefined ) {\n            \n                this.SELECTED       = talao;\n                this.SELECTED_RADIO = talao.ID;\n                \n                if ( setfocus ) {\n                    $timeout(function(){\n                        $('.table-talao-produzido.table-lc-body tr.selected').focus();\n                    },50);                      \n                }\n\n                gScope.TalaoComposicao.consultar();\n            }\n                \n        },        \n        all : function () {\n            \n            var that = this;\n              \n            return $q(function(resolve) {\n        \n                var args = {\n                    estabelecimento_id\t: $('.estab').val(),\n                    gp_id\t\t\t\t: $('._gp_id').val(),\n                    up_id\t\t\t\t: $('._up_id').val(),\n                    up_todos\t\t\t: $('._up_todos').val(),\n                    up_origem\t\t\t: $('._up_origem_descricao').val(),\n                    estacao\t\t\t\t: $('._estacao_id').val(),\n                    estacao_todos\t\t: $('._estacao_todos').val(),\n                    remessa\t\t\t\t: $('#remessa').val(),\n                    data_producao\t\t: $('#data-destaque').find('.valor').text(),\n                    data_ini\t\t\t: $('.filtro-periodo .data-ini').val(),\n                    data_fim\t\t\t: $('.filtro-periodo .data-fim').val(),\n                    periodo_todos\t\t: $('#periodo-todos').is(':checked'),\n                    _perfil_gp\t\t\t: $('._perfil-gp').val().trim(),\n                    ver_pares\t\t\t: $('._ver-pares-gp').val().trim(),\n                    turno\t\t\t\t: $('#turno').val(),\n                    turno_hora_ini\t\t: $('#turno').find(':selected').data('hora-ini'),\n                    turno_hora_fim\t\t: $('#turno').find(':selected').data('hora-fim')\n                };\n\n                $ajax.post(url_base+'all', JSON.stringify(args), {contentType: 'application/json'})\n                .then(function(res){\n\n                    for ( var i in res ) {\n                        var item = res[i];\n                \n                        item.DATAHORA_REALIZADO_FIM  = new Date(item.DATAHORA_REALIZADO_FIM);\n                    }\n                    \n                    gcCollection.merge(gScope.TalaoProduzido.DADOS, res, 'ID');\n\n                    that.totalizadorCalc();\n                                         \n                    if ( gScope.TalaoProduzido.DADOS.length > 0 && gScope.TalaoProduzido.SELECTED != undefined ) {\n                        gScope.TalaoProduzido.selectionar(gScope.TalaoProduzido.SELECTED);\n                    }\n                    \n\n                    resolve(true);\n                });\n            });\n        },\n        totalizadorCalc : function () {\n            var that = this;\n            var dados = gScope.TalaoProduzido.DADOS;\n        \n            that.TOTALIZADOR.QUANTIDADE_PROJETADA   = 0;\n            that.TOTALIZADOR.QUANTIDADE_PRODUZIDA   = 0;\n            that.TOTALIZADOR.TEMPO_PREVISTO         = 0;\n            that.TOTALIZADOR.TEMPO_REALIZADO        = 0;\n            that.TOTALIZADOR.PAR_PRODUZIDO          = 0;\n            that.TOTALIZADOR.QUANTIDADE_UM          = '';\n\n            if ( dados != undefined ) {\n                for ( var i in dados ) {\n                    var item = dados[i];\n\n                    that.TOTALIZADOR.QUANTIDADE_PROJETADA   += parseFloat( ( item.UM_ALTERNATIVA != '' ? item.QUANTIDADE_ALTERNATIVA : item.QUANTIDADE ) );\n                    that.TOTALIZADOR.QUANTIDADE_PRODUZIDA   += parseFloat( ( item.UM_ALTERNATIVA != '' ? item.QUANTIDADE_ALTERNATIVA_PRODUCAO : item.QUANTIDADE_PRODUCAO ));\n                    that.TOTALIZADOR.TEMPO_PREVISTO         += parseFloat(item.TEMPO);\n                    that.TOTALIZADOR.TEMPO_REALIZADO        += parseFloat(item.TEMPO_REALIZADO);\n                    \n                    if ( gScope.Filtro.VER_PARES == '1' && item.PARES != undefined && item.PARES != '' ) {\n                        that.TOTALIZADOR.PAR_PRODUZIDO += parseFloat(item.PARES);\n                    }\n                }\n            }\n            \n            if ( dados.length > 0 ) {\n                var item = gScope.TalaoProduzido.DADOS[0];\n                if ( item.UM_ALTERNATIVA != '' ) {\n                    that.TOTALIZADOR.QUANTIDADE_UM = item.UM_ALTERNATIVA;\n                } else {\n                    that.TOTALIZADOR.QUANTIDADE_UM = item.UM;\n                }\n            }            \n\n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        }\n    };\n\n    /**\n     * Private function\n     */\n    function fn() {\n        //\n    }\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoProduzido;\n};","\n        \nangular\n    .module('app')\n    .factory('TalaoProduzir', TalaoProduzir);\n    \n\n\tTalaoProduzir.$inject = [        \n        '$ajax',\n        '$timeout',\n        '$q',\n        '$rootScope',\n        'gScope',\n        'gcCollection'\n    ];\n\nfunction TalaoProduzir($ajax,$timeout,$q,$rootScope,gScope,gcCollection) {\n\n    /**\n     * Constructor, with class name\n     */\n    function TalaoProduzir(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n        this.TOTALIZADOR = {};\n    }\n    \n    this.EM_PRODUCAO = false;\n    \n    /**\n     * Private property\n     */\n    var url_base        = '_22010/api/talao/produzir/';\n    var possibleRoles   = ['admin', 'editor', 'guest'];\n    var dados = {};\n\n    /**\n     * Coleta ou atualiza da variável dados do talão selecionado\n     * @returns {void}\n     */\n    var dadosTalao = function()\n    {\n        var f = gScope.Filtro;\n        var t = gScope.TalaoProduzir.SELECTED;\n        \n        var estabelecimento_id\t= f.ESTABELECIMENTO_ID;\n        var gp_id\t\t\t\t= f.GP_ID;\n        var up_id\t\t\t\t= f.UP_ID;\n        var estacao\t\t\t\t= f.ESTACAO;\n        var operador_id\t\t\t= $('#_operador-id').val();\n        var remessa_id\t\t\t= t.REMESSA_ID;\n        var remessa_talao_id\t= t.REMESSA_TALAO_ID;\n        var talao_id\t\t\t= t.ID;\n        var programacao_id\t\t= t.PROGRAMACAO_ID;\n        var tempo_realizado\t\t= t.TEMPO_REALIZADO_RELOGIO;\n\n        dados = {\n            estabelecimento_id\t: estabelecimento_id,\n            gp_id\t\t\t\t: gp_id,\n            up_id\t\t\t\t: up_id,\n            estacao\t\t\t\t: estacao,\n            operador_id\t\t\t: operador_id,\n            remessa_id\t\t\t: remessa_id,\n            remessa_talao_id\t: remessa_talao_id,\n            talao_id\t\t\t: talao_id,\n            programacao_id\t\t: programacao_id,\n            tempo_realizado\t\t: tempo_realizado\n        };\n    };  \n\n    /**\n     * Public method, assigned to prototype\n     */\n    TalaoProduzir.prototype = {    \n        DADOS           : [],\n        TEMPO_REALIZADO : 0,\n        selectionar : function (talao,setfocus) {\n            \n            if ( talao != undefined ) {\n            \n                this.SELECTED       = talao;\n                this.SELECTED_RADIO = talao.ID;\n                \n                if ( setfocus ) {\n                    $timeout(function(){\n                        $('.table-talao-produzir.table-lc-body tr.selected').focus();\n                    },50);                      \n                }\n\n                gScope.TalaoTempo.calcRealTime();\n                gScope.Filtro.TALAO_SELECTED = talao.ID;\n                gScope.Filtro.uriHistory();\n                gScope.TalaoComposicao.consultar();\n            }\n                \n        },        \n        all : function () {\n            \n            var that = this;\n            \n            return $q(function(resolve) {\n        \n                var args = {\n                    estabelecimento_id\t: $('.estab').val(),\n                    gp_id\t\t\t\t: $('._gp_id').val(),\n                    up_id\t\t\t\t: $('._up_id').val(),\n                    up_todos\t\t\t: $('._up_todos').val(),\n                    up_origem\t\t\t: $('._up_origem_descricao').val(),\n                    estacao\t\t\t\t: $('._estacao_id').val(),\n                    estacao_todos\t\t: $('._estacao_todos').val(),\n                    remessa\t\t\t\t: $('#remessa').val(),\n                    data_producao\t\t: $('#data-destaque').find('.valor').text(),\n                    data_ini\t\t\t: $('.filtro-periodo .data-ini').val(),\n                    data_fim\t\t\t: $('.filtro-periodo .data-fim').val(),\n                    periodo_todos\t\t: $('#periodo-todos').is(':checked'),\n                    _perfil_gp\t\t\t: $('._perfil-gp').val().trim(),\n                    ver_pares\t\t\t: $('._ver-pares-gp').val().trim(),\n                    turno\t\t\t\t: $('#turno').val(),\n                    turno_hora_ini\t\t: $('#turno').find(':selected').data('hora-ini'),\n                    turno_hora_fim\t\t: $('#turno').find(':selected').data('hora-fim')\n                };\n\n                $ajax.post(url_base+'all', JSON.stringify(args), {contentType: 'application/json'})\n                .then(function(res){\n\n                    for (var i in res) {\n                        var item = res[i];\n                        item.SEQUENCIA_PRODUCAO =  JSON.parse(item.SEQUENCIA_PRODUCAO);\n                    }\n                    \n                    gcCollection.merge(gScope.TalaoProduzir.DADOS, res, 'ID');\n            \n                    that.totalizadorCalc();\n\n                    if ( gScope.TalaoProduzir.DADOS.length > 0 ) {\n                        \n                        $timeout(function(){\n                            $('#filtrar-toggle[aria-expanded=\"true\"]').click(); \n                        });\n\n\n                        if ( gScope.Filtro.TALAO_SELECTED > 0 ) {\n                            var idx = gScope.indexOfAttr(gScope.TalaoProduzir.DADOS,'ID',gScope.Filtro.TALAO_SELECTED);\n                            gScope.TalaoProduzir.selectionar(gScope.TalaoProduzir.DADOS[idx]);\n                        }\n                    }\n                    \n                    resolve(true);\n                });\n            });\n        },\n        current : function (consultar_composicao) {\n            \n            var that = this;\n            \n            return $q(function(resolve, reject) {\n                dadosTalao();\n\n                var data = {};\n                var options = {progress : false};\n                \n                angular.copy(dados, data);\n                \n                if (consultar_composicao) {\n                    data.talao_composicao     = '1';\n                    data.gp_pecas_disponiveis = gScope.Filtro.GP_PECAS_DISPONIVEIS;\n                    options.progress          = true;\n                }\n                \n                $ajax.post('_22010/recarregarStatus',data,options).then(function(resposta) {\n\n                            if ( resposta.TALAO_COMPOSICAO != undefined ) {\n                                gScope.TalaoComposicao.setComposicao(resposta.TALAO_COMPOSICAO);\n                            }\n                                \n                            gcCollection.merge(gScope.TalaoProduzir.DADOS, resposta.TALAO, 'ID', true);\n                            \n                            that.totalizadorCalc();\n\n                            var em_producao = false;\n\n                            //se o talão estiver em produção\n                            if (resposta.PROGRAMACAO_STATUS.trim() == '2') {\n                                em_producao = true;\n                            }\n\n                            gScope.TalaoProduzir.INICIADO = em_producao;\n\n                            resumoProducao();\n\n                            resolve(true);\n                    },\n                    function() {\n                        reject(false);\n                    }\n                );\n            });            \n        },\n        producao : function (bool) {\n            this.EM_PRODUCAO = bool;\n        },\n        totalizadorCalc : function () {\n            var that = this;\n            var dados = gScope.TalaoProduzir.DADOS;\n        \n            that.TOTALIZADOR.QUANTIDADE_PROJETADA = 0;\n            that.TOTALIZADOR.TEMPO_PREVISTO       = 0;\n            that.TOTALIZADOR.PAR_PRODUZIR         = 0;\n            that.TOTALIZADOR.QUANTIDADE_UM        = '';\n\n            if ( dados != undefined ) {\n                for ( var i in dados ) {\n                    var item = dados[i];\n\n                    that.TOTALIZADOR.QUANTIDADE_PROJETADA   += parseFloat( ( item.UM_ALTERNATIVA != '' ? item.QUANTIDADE_ALTERNATIVA : item.QUANTIDADE ) );\n                    that.TOTALIZADOR.TEMPO_PREVISTO         += parseFloat(item.TEMPO);\n                    \n                    if ( gScope.Filtro.VER_PARES == '1' && item.PARES != undefined && item.PARES != '' ) {\n                        that.TOTALIZADOR.PAR_PRODUZIR += parseFloat(item.PARES);\n                    }\n                }\n            }\n            \n            if ( dados.length > 0 ) {\n                var item = gScope.TalaoProduzir.DADOS[0];\n                if ( item.UM_ALTERNATIVA != '' ) {\n                    that.TOTALIZADOR.QUANTIDADE_UM = item.UM_ALTERNATIVA;\n                } else {\n                    that.TOTALIZADOR.QUANTIDADE_UM = item.UM;\n                }\n            }            \n\n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        }\n    };\n\n    /**\n     * Private function\n     */\n    function checkRole(role) {\n      return possibleRoles.indexOf(role) !== -1;\n    }\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n    TalaoProduzir.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n    TalaoProduzir.build = function (data) {\n        \n        if (!checkRole(data.role)) {\n          return;\n        }\n        \n        return new Defeito(\n            data.first_name,\n            data.last_name,\n            data.role\n//            Organisation.build(data.organisation) // another model\n        );\n    };\n\n    /**\n     * Return the constructor function\n     */\n    return TalaoProduzir;\n};","\r\n        \r\nangular\r\n    .module('app')\r\n    .factory('Defeito', Defeito);\r\n    \r\n\r\n\tDefeito.$inject = [\r\n        '$ajax'\r\n    ];\r\n\r\nfunction Defeito($ajax) {\r\n\r\n    /**\r\n     * Constructor, with class name\r\n     */\r\n    function Defeito(firstName, lastName, role) {\r\n        \r\n        // Public properties, assigned to the instance ('this')\r\n        this.firstName      = firstName;\r\n        this.lastName       = lastName;\r\n        this.role           = role;\r\n    }\r\n    \r\n    /**\r\n     * Private property\r\n     */\r\n    var url_base        = '_22010/defeitos';\r\n    var possibleRoles   = ['admin', 'editor', 'guest'];\r\n\r\n    /**\r\n     * Public method, assigned to prototype\r\n     */\r\n    Defeito.prototype = {\r\n        \r\n        load : function (args) {\r\n            return $ajax.post(url_base+'all', JSON.stringify(args), {contentType: 'application/json'});\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Private function\r\n     */\r\n    function checkRole(role) {\r\n      return possibleRoles.indexOf(role) !== -1;\r\n    }\r\n\r\n    /**\r\n     * Static property\r\n     * Using copy to prevent modifications to private property\r\n     */\r\n    Defeito.possibleRoles = angular.copy(possibleRoles);\r\n\r\n    /**\r\n     * Static method, assigned to class\r\n     * Instance ('this') is not available in static context\r\n     */\r\n    Defeito.build = function (data) {\r\n        \r\n        if (!checkRole(data.role)) {\r\n          return;\r\n        }\r\n        \r\n        return new Defeito(\r\n            data.first_name,\r\n            data.last_name,\r\n            data.role\r\n//            Organisation.build(data.organisation) // another model\r\n        );\r\n    };\r\n\r\n    /**\r\n     * Return the constructor function\r\n     */\r\n    return Defeito;\r\n};","\n        \nangular\n    .module('app')\n    .factory('Filtro', Filtro);\n    \n\n\tFiltro.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$timeout',\n        'gScope'\n    ];\n\nfunction Filtro($ajax, $httpParamSerializer, $rootScope, $timeout, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function Filtro(data) {\n        if (data) {\n            this.setData(data);\n        }\n    }\n    \n    this.GUIA_ATIVA = 'TALAO_PRODUZIR';\n    \n    /**\n     * Private property\n     */\n    var url_base        = '_22010/defeitos';\n    var possibleRoles   = ['admin', 'editor', 'guest'];\n\n    /**\n     * Public method, assigned to prototype\n     */\n    Filtro.prototype = {\n        submit : function() {\n            $timeout(function(){\n                $('.btn-filtrar').click();\n            });\n        },\n        setData: function(data) {\n            angular.extend(this, data);\n        },        \n        consultar : function (args) {\n            this.AUTO_LOAD = 1;\n            this.uriHistory();\n            \n            switch(this.GUIA_ATIVA) {\n                case 'TALAO_PRODUZIR':\n                    \n                    if ( gScope.TalaoProduzir.EM_PRODUCAO ) {\n                        gScope.TalaoProduzir.current(true);\n                    } else {\n                        gScope.TalaoProduzir.all();\n                    }\n                    \n                    break;\n                case 'TALAO_PRODUZIDO':\n                    gScope.TalaoProduzido.all();                    \n                    break;\n                case 'TOTALIZADOR_DIARIO':\n                    gScope.TotalizadorDiario.consultar();                    \n                    break;\n            }\n        },\n        uriHistory : function() {\n            window.history.replaceState('', '', encodeURI(urlhost + '/_22010?'+$httpParamSerializer(this)));\n        }\n    };\n\n    /**\n     * Private function\n     */\n    function checkRole(role) {\n      return possibleRoles.indexOf(role) !== -1;\n    }\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n    Filtro.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n    Filtro.build = function (data) {\n        \n        if (!checkRole(data.role)) {\n          return;\n        }\n        \n        return new Filtro(data);\n    };\n\n    /**\n     * Return the constructor function\n     */\n    return Filtro;\n};","angular\n    .module('app')\n    .factory('Acao', Acao);\n    \n\n\tAcao.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$q',\n        '$rootScope',\n        '$filter',\n        'gScope',\n        'gcCollection'\n    ];\n\nfunction Acao($ajax, $httpParamSerializer, $q, $rootScope, $filter, gScope, gcCollection) {\n\n    /**\n     * Constructor, with class name\n     */\n    function Acao(data) {\n        if (data) {\n            this.setData(data);\n        }\n    }\n    \n    \n    /**\n     * Private property\n     */\n    var url_base        = '/_22010/';\n    var possibleRoles   = ['admin', 'editor', 'guest'];\n    \n    \n    /**\n     * Variável que recebe os valores do talão\n     * @type type\n     */\n    var dados = {};\n\n    /**\n     * Valores para validar o status para iniciar um talão\n     * @type {json}\n     */\n    var status_parado = \n    {\n        status_talao       : [1], // 1 - Em aberto\n        status_programacao : [0,1] // 0 - Parado ; 1 - Iniciado/Parado\n    };\n\n    /**\n     * Valores para validar o status para pausar um talão\n     * @type {json}\n     */\n    var status_andamento =\n    {\n        status_talao       : [1], // 1 - Em aberto\n        status_programacao : [2] // 2 - Em Andamento\n    };\n\n    /**\n     * Coleta ou atualiza da variável dados do talão selecionado\n     * @returns {void}\n     */\n    var dadosTalao = function()\n    {\n        var f = gScope.Filtro;\n        var t = gScope.TalaoProduzir.SELECTED;\n        \n        var estabelecimento_id\t= f.ESTABELECIMENTO_ID;\n        var gp_id\t\t\t\t= f.GP_ID;\n        var up_id\t\t\t\t= f.UP_ID;\n        var estacao\t\t\t\t= f.ESTACAO;\n        var operador_id\t\t\t= $('#_operador-id').val();\n        var remessa_id\t\t\t= t.REMESSA_ID;\n        var remessa_talao_id\t= t.REMESSA_TALAO_ID;\n        var talao_id\t\t\t= t.ID;\n        var programacao_id\t\t= t.PROGRAMACAO_ID;\n        var tempo_realizado\t\t= t.TEMPO_REALIZADO_RELOGIO;\n\n        dados = {\n            estabelecimento_id\t: estabelecimento_id,\n            gp_id\t\t\t\t: gp_id,\n            up_id\t\t\t\t: up_id,\n            estacao\t\t\t\t: estacao,\n            operador_id\t\t\t: operador_id,\n            remessa_id\t\t\t: remessa_id,\n            remessa_talao_id\t: remessa_talao_id,\n            talao_id\t\t\t: talao_id,\n            programacao_id\t\t: programacao_id,\n            tempo_realizado\t\t: tempo_realizado,\n            justificativa_id    : gScope.Acao.API.JUSTIFICATIVA.SELECTED.ID\n        };\n    };\n    \n\n    /**\n     * Public method, assigned to prototype\n     */\n    Acao.prototype = {   \n        iniciar : function (args) {\n            var that            = this;\n            \n\t\t\t/**\n\t\t\t * Verifica se a Estação está ocupada (em produção).\n\t\t\t * @returns {ajax}\n\t\t\t */\n            var verificaEstacaoOcupada = function()\n            {\n\t\t\t\t\n\t\t\t\t/**\n\t\t\t\t * Consulta o estado da Estação.\n\t\t\t\t * @returns {ajax}\n\t\t\t\t */\n\t\t\t\tvar consultar = function()\n                {\n\t\t\t\t\tvar dados = {\n\t\t\t\t\t\testabelecimento_id : gScope.Filtro.ESTABELECIMENTO_ID,\n\t\t\t\t\t\tup_id              : gScope.Filtro.UP_ID,\n\t\t\t\t\t\testacao_id         : gScope.Filtro.ESTACAO\n\t\t\t\t\t};\n\n\t\t\t\t\treturn $ajax.post('/_22010/verificarEstacaoAtiva', JSON.stringify(dados), {contentType: 'application/json', progress : false});\t\n\t\t\t\t};\n                \n                return $q(function(resolve, reject) {\n                    consultar()\n                        .then(function(resposta) {\n\n                            //se a estação estiver em produção\n                            if ( resposta[0]['EM_PRODUCAO'].trim() === \"1\" ) {\n                                                             \n\n                                var talao_id\t\t= (typeof resposta[0]['TALAO_ID'   ] == 'string' ) ? resposta[0]['TALAO_ID'   ].trim() : resposta[0]['TALAO_ID'   ];\n                                var operador_id\t\t= (typeof resposta[0]['OPERADOR_ID'] == 'string' ) ? resposta[0]['OPERADOR_ID'].trim() : resposta[0]['OPERADOR_ID'];\n                                var operador_nome\t= pegarPalavra(resposta[0]['OPERADOR_NOME'], 0, 2);\n                                \n\n                                var idx = gScope.indexOfAttr(gScope.TalaoProduzir.DADOS,'ID',talao_id);\n                                gScope.TalaoProduzir.selectionar(gScope.TalaoProduzir.DADOS[idx],true);   \n                                \n                                //colocar operador na área de destaque\n                                $('#operador span.valor')\n                                    .text(operador_nome)\n                                ;\n                                $('#_operador-id')\n                                    .val(operador_id)\n                                ;\n\n                                showAlert('A Estação selecionada está em produção com o operador '+ operador_nome +'. O Talão em andamento será Retomado.');\n\n                                resolve(true);\n                            }\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t\t\t}\n\n                        })\n                    ;\n                });\n\t\t\t};\n            \n\t\t\t\t\t\n            /**\n             * Retorno da função\n             * @param {type} resolve\n             * @param {type} reject\n             * @returns {undefined}\n             */\n            return $q(function(resolve, reject) {\n                verificaEstacaoOcupada()\n                    .then(function(em_producao) {\n                        \n\t\t\t\t\t\t//se estiver em produção, só autentica na função pausar\n\t\t\t\t\t\tif (em_producao == true) {\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t//pausar\n\t\t\t\t\t\t\tthat.pausar(em_producao)\n\t\t\t\t\t\t\t\t.then(function() {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//iniciar (sem autenticar, pois a autenticação está em pausar)\n\t\t\t\t\t\t\t\t\tvalidaTalao(status_parado)\n\t\t\t\t\t\t\t\t\t\t.then(function() {\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t//Registra o início\n\t\t\t\t\t\t\t\t\t\t\tregistraAcao({rota_ajax: '/_22010/acao/iniciar'})\n\t\t\t\t\t\t\t\t\t\t\t\t.then(function(){\n\n                                                        gScope.TalaoProduzir.current(true);\n\n\n                                                        resolve(true);\n\n\t\t\t\t\t\t\t\t\t\t\t\t}, \n\t\t\t\t\t\t\t\t\t\t\t\tfunction(error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\treject(false);\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\n\t\t\t\t\t\t}                        \n\t\t\t\t\t\telse {\n\n\t\t\t\t\t\t\t//iniciar\n\t\t\t\t\t\t\tvalidaTalao(status_parado)\n\t\t\t\t\t\t\t\t.then(function() {\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//dados da autenticação\n\t\t\t\t\t\t\t\t\tvar dados_autenticacao = {\n\n\t\t\t\t\t\t\t\t\t\tmodal_show\t\t: true,\n\t\t\t\t\t\t\t\t\t\tverificar_up\t: gScope.Filtro.UP_ID,\n\t\t\t\t\t\t\t\t\t\tsuccess\t\t\t: function() {\n\n\t\t\t\t\t\t\t\t\t\t\t//Registra o início\n\t\t\t\t\t\t\t\t\t\t\tregistraAcao({rota_ajax: '/_22010/acao/iniciar'})\n\t\t\t\t\t\t\t\t\t\t\t\t.then(function(){\n                                                    \n                                                        gScope.TalaoProduzir.current(true);\n\n                                                        resolve(true);\n\n\t\t\t\t\t\t\t\t\t\t\t\t}, \n\t\t\t\t\t\t\t\t\t\t\t\tfunction(error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\treject(false);\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//se o talão está pausado\n\t\t\t\t\t\t\t\t\tif( gScope.TalaoProduzir.SELECTED.PROGRAMACAO_STATUS == 1 ) {\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t//verifica permissão ps227\n\t\t\t\t\t\t\t\t\t\tif( $('#ps227').val() == '1' ) {\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t//autenticar UP\n\t\t\t\t\t\t\t\t\t\t\tautenticarUp()\n\t\t\t\t\t\t\t\t\t\t\t\t.then(function() {\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t//Autenticar operador\n\t\t\t\t\t\t\t\t\t\t\t\t\tautenticacao(dados_autenticacao);\n\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t//Autenticar operador\n\t\t\t\t\t\t\t\t\t\t\tautenticacao(dados_autenticacao);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t//autenticar UP\n\t\t\t\t\t\t\t\t\t\tautenticarUp()\n\t\t\t\t\t\t\t\t\t\t\t.then(function() {\n\n\t\t\t\t\t\t\t\t\t\t\t\t//Autenticar operador\n\t\t\t\t\t\t\t\t\t\t\t\tautenticacao(dados_autenticacao);\n\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\t}\n                    });\t\t\t\t\t\n            });\t\n        },\n        pausar : function (em_producao) {\n            var that = this;\n            return $q(function(resolve, reject) {\n                validaTalao(status_andamento)\n                    .then(function() {\n\n\t\t\t\t\t\tvar dados_autenticacao = {\n\t\t\t\t\t\t\tmodal_show : true,\n                            success    : function() \n                            {\t\t\t\n                                \n                                var registrar = function () {\n                                    //Registra a pausa\n                                    registraAcao({rota_ajax: '/_22010/acao/pausar'})\n                                        .then(function(){\n\n                                            if (em_producao !== true) {\n                                                gScope.TalaoProduzir.current(true);\n//                                                infoDestaqueLimpar();\n                                                showSuccess('Pausado com sucesso.');                  \n                                            } \n                                            resolve(true);\n\n                                        })\n                                    ;  \n                                };\n                                \n                                registrar();                                 \n                                                              \n                            }\n\t\t\t\t\t\t};\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Se estiver em produção, a pausa será seguida de um início, \n\t\t\t\t\t\t//sendo assim precisa verificar a UP.\n\t\t\t\t\t\tif( em_producao ) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdados_autenticacao.verificar_up = gScope.Filtro.UP_ID;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//verifica permissão ps227\n\t\t\t\t\t\t\tif( $('#ps227').val() == '1' ) {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//Autenticar UP\n\t\t\t\t\t\t\t\tautenticarUp()\n\t\t\t\t\t\t\t\t\t.then(function() {\n\n\t\t\t\t\t\t\t\t\t\t//Autenticar operador\n\t\t\t\t\t\t\t\t\t\tautenticacao(dados_autenticacao);\n\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//Autenticar operador\n\t\t\t\t\t\t\t\tautenticacao(dados_autenticacao);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//Autenticar operador\n\t\t\t\t\t\t\tautenticacao(dados_autenticacao);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n                    })\n                ;\n            });            \n        },\n        finalizar : function () {\n            return $q(function(resolve, reject) {\n                validaTalao(status_andamento)\n                    .then(function() {\n                        \n                        //Autenticar operador\n//                        autenticacao(\n//                        {\n//                            modal_show : true,\n//                            success    : function() \n//                            {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                //Registra a finalização\n                                registraAcao({rota_ajax: '/_22010/acao/finalizar'})\n                                    .then(function(){\n\n                                            var id                 = gScope.TalaoProduzir.SELECTED.ID;\n                                            var operador_id        = $('#_operador-id').val();\n                                            var operador_descricao = $('#operador').find('.valor').text();\n\n                                            var dados = {\n                                                id                  : id,\n                                                operador_id         : operador_id,\n                                                operador_descricao  : operador_descricao\n                                            };\n\n                                            getEtiqueta(dados)\n                                                .then(function(result){\n\n                                                    postprint(result);\n//                                                    infoDestaqueLimpar();\n                                                })\n                                                .catch(function(){\n\n//                                                    infoDestaqueLimpar();\n                                                })\n                                            ;\n\n                                            //indicar que o talão não está iniciado\n                                            gScope.TalaoProduzir.EM_PRODUCAO = false;\n                                            gScope.TalaoProduzir.SELECTED    = null;\n                                            gScope.Filtro.consultar();\n                                            $(document).scrollTop(0);\n                                            showSuccess('Finalizado com sucesso.');\n\n                                            resolve(true);\n                                    })\n                                ;\n                                \n//                            }\n//                        });\n                    })\n                ;\n            });            \n        },\n        check : function (acao) {\n                        \n            var ret         = {\n                status    : true,\n                descricao : ''\n            };\n            \n            var em_producao = gScope.TalaoProduzir.EM_PRODUCAO || false;\n            var talao       = gScope.TalaoProduzir.SELECTED;\n            \n            switch(acao) {\n                case 'justificar':\n                    \n                    // Se não estiver na tela de produção\n                    if ( gScope.Filtro.GUIA_ATIVA != 'TALAO_PRODUZIR' ) {\n                        ret.status = false;\n                    } else                 \n                    // Se não houver talao selecionado\n                    if ( talao == undefined ) {\n                        ret.status = false;\n                    } else                    \n                    // Se não houver estacao selecionada\n                    if ( gScope.Filtro.ESTACAO == '' ) {\n                        ret.status = false;\n                        ret.descricao = 'É necessário selecionar uma estação individual para iniciar um talão.';\n                    }\n                    \n                    break;\n                    case 'iniciar':\n                    \n                    // Se não estiver na tela de produção\n                    if ( gScope.Filtro.GUIA_ATIVA != 'TALAO_PRODUZIR' ) {\n                        ret.status = false;\n                    } else                 \n                    // Se não houver talao selecionado\n                    if ( talao == undefined ) {\n                        ret.status = false;\n                    } else                    \n                    // Se não houver estacao selecionada\n                    if ( gScope.Filtro.ESTACAO == '' ) {\n                        ret.status = false;\n                        ret.descricao = 'É necessário selecionar uma estação individual para iniciar um talão.';\n                    } else                    \n                    // Se estiver em produção \n                    if ( em_producao ) {\n                        ret.status = false;\n                    } else\n                    // Se houverem consumos não disponíveis\n                    if ( talao.STATUS_MP_CP == '0' ) {\n//                        ret.status    = false;\n                        ret.descricao = 'Há consumos com materia prima indisponível';\n                    } else\n                    // Se a remessa estiver fora do prazo para produção\n                    if ( talao.REMESSA_TIPO == '1' ) {\n                        \n                        if ( gScope.Filtro.GP_REMESSA_DIAS >= 0 || $('#_pu212').val() == '0' ) {\n                            var remessas_normais = $filter('filter')(gScope.TalaoProduzir.DADOS,{REMESSA_TIPO : '1'});\n                            var remessas_normais = $filter('orderBy')(remessas_normais,['PROGRAMACAO_DATA', '+DATAHORA_INICIO', 'REMESSA_ID', 'REMESSA_TALAO_ID']);\n\n                            if ( $('#_pu212').val() == '0' ) {\n                                var idx = remessas_normais.indexOf(talao);\n                                \n                                if ( idx > 0 ) {\n                                    ret.status    = false;\n                                    ret.descricao = 'Usuário não possui permissão para quebrar sequenciamento de talões';\n                                }\n                            }\n\n                            if ( gScope.Filtro.GP_REMESSA_DIAS >= 0 ) {\n                                var data_base = remessas_normais[0] != undefined ? remessas_normais[0].REMESSA_DATA : null;\n\n\n                                var data_limite = moment(data_base).add(gScope.Filtro.GP_REMESSA_DIAS, 'days');\n\n                                if ( moment(talao.REMESSA_DATA) > data_limite ) {\n                                    ret.status    = false;\n                                    ret.descricao = 'Remessa fora do prazo permitido de ' + gScope.Filtro.GP_REMESSA_DIAS + ' dias. Produza remessas normais com data até ' + data_limite.format(\"DD/MM\");\n                                }\n                            }\n                        }\n                    }\n                    \n                    break;\n                case 'pausar':\n                    \n                    // Se não estiver na tela de produção\n                    if ( gScope.Filtro.GUIA_ATIVA != 'TALAO_PRODUZIR' ) {\n                        ret.status    = false;\n                    } else                 \n                    if ( talao == undefined ) {\n                        ret.status    = false;\n                        ret.descricao = 'Selecione um talão';\n                    } else                    \n                    // Se estiver em produção \n                    if ( !em_producao ) {\n                        ret.status    = false;\n                    }\n                \n                    break;\n                case 'finalizar':\n                    \n                    // Se não estiver na tela de produção\n                    if ( gScope.Filtro.GUIA_ATIVA != 'TALAO_PRODUZIR' ) {\n                        ret.status    = false;\n                    } else                 \n                    if ( talao == undefined ) {\n                        ret.status    = false;\n                        ret.descricao = 'Selecione um talão';\n                    } else                    \n                    // Se estiver em produção \n                    if ( !em_producao ) {\n                        ret.status    = false;\n                    }\n                \n                    break;\n                case 'imprimir':\n                    \n                    var talao_produzido = gScope.TalaoProduzido.SELECTED;\n                    \n                    \n                    // Se não estiver na tela de produção\n                    if ( gScope.Filtro.GUIA_ATIVA != 'TALAO_PRODUZIDO' ) {\n                        ret.status    = false;\n                    } else                 \n                    if ( talao_produzido == undefined ) {\n                        ret.status    = false;\n                        ret.descricao = 'Selecione um talão';\n                    }\n                    \n                    break;\n            }\n            \n            return ret;\n        },\n        pausarProducao : function () {\n            var that = this;\n            \n            this.API.JUSTIFICATIVA.registrar();\n        },\n        setData : function (data) {\n            angular.extend(this, data);\n        },\n        API : {\n            JUSTIFICATIVA : {\n                DADOS : [],\n                SELECTED : {},\n                consultar : function () {\n                    var that = this;\n                    return $q(function(resolve){\n\n                        $ajax.get('/_22010/api/justificativa').then(function(response){\n                            gcCollection.merge(that.DADOS, response.JUSTIFICATIVA, 'ID');\n                            resolve(true);\n                        });\n                    });\n                    \n                },\n                registrar : function () {\n                    var that = this;\n                    return $q(function(resolve){\n                        \n                        that.consultar().then(function(){\n                            \n                            if ( that.DADOS.length > 0 ) {\n                                $('#modal-parada-justificativa').modal('show');\n\n                                resolve(true);\n                            } else {\n                                that.SELECTED = {};\n                                gScope.Acao.pausar().then(function(){\n\n                                    resolve(true);\n                                });\n                            }\n                        });\n                        \n                    });\n                    \n                },\n                selecionar : function ( item ) {     \n                    var that = this;\n                    return $q(function(resolve){\n                        \n                        that.SELECTED = item;\n                        \n                        gScope.Acao.pausar().then(function(){\n                            $('#modal-parada-justificativa').modal('hide');\n                            that.SELECTED = {};\n                            resolve(true);\n                        });\n                        \n                    });                                       \n                }\n            }\n        }\n    };\n\n    /**\n     * Private function\n     */\n    \n    /**\n     * Realiza o registro de inicio do talão selecionado\n     * @param {json} param\n     * @returns {void}\n     */\n    function registraAcao (param)\n    {\n        dadosTalao();\n\n        return $q(function(resolve, reject) {\n            execAjax1('POST',param.rota_ajax,dados,\n            function() {\n                resolve(true);\n            },\n            function() {\n                reject(false);\n            });\n        });\n    }\n\n    /**\n     * Realiza a validação do talão\n     * @param {json} param\n     * @returns {void}\n     */\n    function validaTalao (param)\n    {   \n        //Realiza a coleta dos dados do talão selecionado\n        dadosTalao();\n\n        //Realiza a cópia do dados do talão selecionado (mantem o original inalterado)\n        var dadosAjax = $.extend({}, dados);\n        dadosAjax.status_talao       = param.status_talao;\n        dadosAjax.status_programacao = param.status_programacao;\n\n        return $q(function(resolve) {\n            \n                $ajax.post('/_22010/talaoValido', JSON.stringify(dadosAjax), {contentType: 'application/json', progress : false})\n                    .then(function(){\n                        resolve(true);\n                    })\n                ;\n            }, \n            function(error) {\n\n//                new TalaoFiltrar().filtrar();\t//atualiza o status\n                reject(false);\n\n            }\n        );\n    }\n\n    /**\n     * Autenticar UP.\n     * @returns {Promise}\n     */\n    function autenticarUp () {\n\n        return $q(function(resolve, reject) {\n\n            var modal\t\t= $('#modal-autenticar-up');\n            var input_barra = $('#up-barra');\n\n            function consultar() {\n\n                //ajax\n                var type\t= 'POST',\n                    url\t\t= '/_22010/autenticarUp',\n                    data\t= {\n                        up_barra\t\t: $(input_barra).val(),\n                        up_selecionada\t: gScope.Filtro.UP_ID\n                    }\n                ;\n\n                return execAjax1(type, url, data);\n\n            }\n\n            function autenticar() {\n\n                $.when(consultar())\n                    .done(function() {\n                        $(modal).modal('hide');\n                        resolve(true);\n                    })\n                    .fail(function() {\n                        $(input_barra).val('').focus();\n                    })\n                ;\n            }\n\n            $(modal)\n                .modal('show')\n                .off('shown.bs.modal')\n                .on('shown.bs.modal', function () {\n                    $(input_barra).focus();\n                })\n                .off('hidden.bs.modal')\n                .on('hidden.bs.modal', function () {\n                    $(input_barra).val('');\n                })\n                .off('keydown', '#up-barra')\n                .on('keydown', '#up-barra', 'return', function () {\n                    autenticar();\n                })\n                .off('click', '#btn-confirmar-up')\n                .on('click', '#btn-confirmar-up', function () {\n                    autenticar();\n                })\n            ;\n\n        });\n\n    }\n\n\n    /**\n     * Static property\n     * Using copy to prevent modifications to private property\n     */\n    Acao.possibleRoles = angular.copy(possibleRoles);\n\n    /**\n     * Static method, assigned to class\n     * Instance ('this') is not available in static context\n     */\n    Acao.build = function (data) {\n        \n        if (!checkRole(data.role)) {\n          return;\n        }\n        \n        return new Acao(data);\n    };\n\n    /**\n     * Return the constructor function\n     */\n    return Acao;\n};","angular\n    .module('app')\n    .value('gScope', {\n        indexOfAttr : function(array,attr, value) {\n            for(var i in array) {\n                if(array[i][attr] === value) {\n                    return i;\n                }\n            }\n            return -1;\n        }\n    })\n    .controller('Ctrl', Ctrl);\n    \n    \n\tCtrl.$inject = [\n        '$scope',\n        '$compile',\n        '$timeout',\n        '$sce',\n        'gScope',\n        'Acao', \n        'Filtro', \n        'TalaoProduzir', \n        'TalaoProduzido', \n        'TalaoComposicao',\n        'TalaoDetalhe', \n        'TalaoDefeito',\n        'TalaoConsumo',\n        'TalaoTempo',\n        'TalaoFicha',\n        'TotalizadorDiario',\n        'ColaboradorCentroDeTrabalho'\n    ];\n\n\tfunction Ctrl( \n        $scope, \n        $compile, \n        $timeout, \n        $sce, \n        gScope, \n        Acao, \n        Filtro, \n        TalaoProduzir, \n        TalaoProduzido, \n        TalaoComposicao, \n        TalaoDetalhe, \n        TalaoDefeito, \n        TalaoConsumo, \n        TalaoTempo, \n        TalaoFicha, \n        TotalizadorDiario, \n        ColaboradorCentroDeTrabalho \n    ) {\n\n\t\tvar vm = this;\n\n        vm.Acao              = new Acao();\n\t\tvm.Filtro            = new Filtro();\n        vm.TalaoProduzir     = new TalaoProduzir();\n        vm.TalaoProduzido    = new TalaoProduzido();\n        vm.TalaoComposicao   = new TalaoComposicao();\n\t\tvm.TalaoDetalhe      = new TalaoDetalhe();\n\t\tvm.TalaoDefeito      = new TalaoDefeito();\n\t\tvm.TalaoConsumo      = new TalaoConsumo();\n        vm.TalaoTempo        = new TalaoTempo();\n        vm.TalaoFicha        = new TalaoFicha();\n        vm.TotalizadorDiario = new TotalizadorDiario();\n        \n        vm.ColaboradorCentroDeTrabalho = new ColaboradorCentroDeTrabalho();\n        \n        gScope.Acao              = vm.Acao             ; \n\t\tgScope.Filtro            = vm.Filtro           ; \n        gScope.TalaoProduzir     = vm.TalaoProduzir    ; \n        gScope.TalaoProduzido    = vm.TalaoProduzido   ; \n        gScope.TalaoComposicao   = vm.TalaoComposicao  ; \n\t\tgScope.TalaoDetalhe      = vm.TalaoDetalhe     ; \n\t\tgScope.TalaoDefeito      = vm.TalaoDefeito     ; \n\t\tgScope.TalaoConsumo      = vm.TalaoConsumo     ; \n        gScope.TalaoTempo        = vm.TalaoTempo       ; \n        gScope.TalaoFicha        = vm.TalaoFicha       ; \n        gScope.TotalizadorDiario = vm.TotalizadorDiario; \n               \n        \n        vm.trustedHtml = function (plainText) {\n            return $sce.trustAsHtml(plainText);\n        };        \n        \n        $scope.$on('bs-init', function(ngRepeatFinishedEvent) {\n            bootstrapInit();\n        });\n        \n        /**\n         * Escuta do filtro que realiza o autofiltro\n         */\n        $scope.$watch('vm.Filtro.ESTABELECIMENTO_ID', function (newValue, oldValue, scope) {\n            \n            if ( newValue > 0 ) {\n                $timeout(function(){\n                    if ( vm.Filtro.AUTO_LOAD ) {\n                        $('.btn-filtrar').click();\n                    }\n                },50);\n            } \n        });\n        \n        /**\n         * Escuta da guia ativa\n         */\n        $scope.$watch('vm.Filtro.GUIA_ATIVA', function (newValue, oldValue, scope) {\n            \n            if (newValue == 'TALAO_PRODUZIR') {\n                \n                if ( vm.TalaoProduzir.INICIADO ) {                  \n                    vm.TalaoProduzir.EM_PRODUCAO = true;\n                } else {\n                    vm.TalaoProduzir.EM_PRODUCAO = false;\n                }\n                \n                $('#periodo-todos').prop('disabled',false);\n                $('#turno').attr('disabled', true);\n            } else {\n                $('#turno').attr('disabled', false);\n                $('#periodo-todos').prop('disabled',true);\n                \n                $('#filtrar-toggle[aria-expanded=\"false\"]').click();\n            } \n            \n            if ( newValue == 'TOTALIZADOR_DIARIO') {\n                $('.filtro-periodo .data-ini').prop('required',true);\n                $('.filtro-periodo .data-fim').prop('required',true);\n            } else {\n                $('.filtro-periodo .data-ini').prop('required',false);\n                $('.filtro-periodo .data-fim').prop('required',false);\n            }\n            \n            if ( oldValue != undefined && oldValue != newValue ) {\n                vm.TalaoComposicao.DADOS = [];\n            }\n            \n            if ( oldValue != undefined && oldValue != newValue && newValue == 'TALAO_PRODUZIR' ) {                \n                $timeout(function(){\n                    $('.table-talao-produzir.table-lc-body tr.selected').focus();\n//                    vm.TalaoComposicao.consultar();\n                },500);                 \n            }\n        }, true);\n        \n\n        $scope.$watch('vm.Filtro.GP_ID', function (newValue, oldValue, scope) {\n            \n            if ( oldValue != undefined && newValue == '' ) {\n                vm.TalaoProduzir.DADOS = [];\n                vm.TalaoProduzido.DADOS = [];\n                vm.TotalizadorDiario.DADOS = [];\n                vm.TalaoProduzir.SELECTED = null;\n                vm.TalaoProduzido.SELECTED = null;\n            }\n        }, true);\n\n        $scope.$watch('vm.Filtro.PERFIL_UP', function (newValue, oldValue, scope) {\n            \n            if ( oldValue != undefined && newValue == '' ) {\n                vm.TalaoProduzir.DADOS = [];\n                vm.TalaoProduzido.DADOS = [];\n                vm.TotalizadorDiario.DADOS = [];\n                vm.TalaoProduzir.SELECTED = null;\n                vm.TalaoProduzido.SELECTED = null;\n            }\n        }, true);\n\n        $scope.$watch('vm.Filtro.UP_ID', function (newValue, oldValue, scope) {\n            \n            if ( oldValue != undefined && newValue == '' ) {\n                vm.TalaoProduzir.DADOS = [];\n                vm.TalaoProduzido.DADOS = [];\n                vm.TotalizadorDiario.DADOS = [];\n                vm.TalaoProduzir.SELECTED = null;\n                vm.TalaoProduzido.SELECTED = null;\n            }\n        }, true);\n\n        $scope.$watch('vm.Filtro.ESTACAO', function (newValue, oldValue, scope) {\n            \n            if ( oldValue != undefined && newValue == '' ) {\n                vm.TalaoProduzir.DADOS = [];\n                vm.TalaoProduzido.DADOS = [];\n                vm.TotalizadorDiario.DADOS = [];\n                vm.TalaoProduzir.SELECTED = null;\n                vm.TalaoProduzido.SELECTED = null;\n            }\n        }, true);\n        \n        /**\n         * Escuta do talão em produção\n         */\n        $scope.$watch('vm.TalaoProduzir.INICIADO', function (newValue, oldValue, scope) {\n            \n            if (newValue) {\n                if ( vm.Filtro.GUIA_ATIVA == 'TALAO_PRODUZIR' ) {\n                    vm.TalaoProduzir.EM_PRODUCAO = true;\n                } else {\n                    vm.TalaoProduzir.EM_PRODUCAO = false;\n                }\n            } else {\n                vm.TalaoProduzir.EM_PRODUCAO = false;\n                $timeout(function(){\n                    $('.table-talao-produzir.table-lc-body tr.selected').focus();\n                },100);\n            }\n            \n            gScope.TalaoTempo.calcRealTime();\n        }, true);\n             \n        /**\n         * Escuta do talão selecionado\n         */\n        $scope.$watch('vm.TalaoProduzir.SELECTED', function (newValue, oldValue, scope) {\n\n            if ( newValue === null ) {\n                \n                vm.TalaoProduzir.INICIADO = false;\n                delete vm.Filtro.TALAO_SELECTED;\n                \n\t\t\t\t\tvm.TalaoComposicao.DADOS = [];\n            } else\n            if ( oldValue == undefined && newValue != null ) {\n                $timeout(function(){\n                    $('.table-talao-produzir.table-lc-body tr.selected').focus();\n                },50);  \n            }        \n            \n        }, true);\n        \n        $scope.$watch('vm.TalaoProduzir.SELECTED.ID', function (newValue, oldValue, scope) {\n\n            if ( oldValue != undefined ) {\n                vm.TalaoDetalhe.SELECTED = null;\n                vm.TalaoConsumo.SELECTED = null;\n                vm.TalaoDetalhe.QUANTIDADE_ALTERANDO = [];\n                vm.TalaoDetalhe.QUANTIDADE_ALTERNATIVA_ALTERANDO = [];  \n            }          \n        }, true);\n        \n        \n        /**\n         * Escuta do status EM PRODUÇÃO\n         */\n        $scope.$watch('vm.TalaoProduzir.EM_PRODUCAO', function (newValue, oldValue, scope) {\n            \n            if ( newValue ) {\n                $(document).scrollTop(0);\n            }\n        }, true);\n        \n             \n        /**\n         * Escuta do talão selecionado\n         */\n        $scope.$watch('vm.TalaoProduzido.SELECTED', function (newValue, oldValue, scope) {\n\n            if ( newValue === null ) {\n                vm.TalaoComposicao.DADOS = [];\n            } else\n            if ( oldValue == undefined && newValue != null ) {\n                $timeout(function(){\n                    $('.table-talao-produzido.table-lc-body tr.selected').focus();\n                },50);  \n            }        \n            \n        }, true);\n        \n        $scope.$watch('vm.TalaoProduzido.SELECTED.ID', function (newValue, oldValue, scope) {\n\n            if ( oldValue != undefined ) {\n                vm.TalaoDetalhe.SELECTED = null;\n                vm.TalaoConsumo.SELECTED = null;\n            }          \n        }, true);\n             \n                        \n        $timeout(function () {\n            $('.recebe-puxador-talao, .recebe-puxador-detalhe, .recebe-puxador-consumo, .recebe-puxador-historico, .recebe-puxador-ficha')\n                .resizable({\n                    resize  : function( event, ui ) {\n                        $scope.$apply(function(){\n                            $(document).resize();\n                        });\n\n                    },\n                    handles  : 's',\n                    minHeight : 80\n                })\n            ;\n        }, 500);\n        \n\t\t\t\n        //Aumentar tabela com duplo clique no puxador\n        $(document)\n            .on('dblclick','.ui-resizable-s', function(e) {\n\n                var table = $(this).closest('.ui-resizable');\n\n                if ( $(table).data('original-size') == undefined || $(table).data('original-size') == 0 ) {\n                    $(table).data('original-size',$(table).height());\n                }  \n                \n                var bool = $(table).data('height-full') || false;\n                $(table).data('height-full', ! bool);\n                \n                if ( $(table).data('height-full') == true ) {\n        \n                    var datatable_scrollbody = $(table).find('.table-lc-body');;\n                    var tbody_height\t     = datatable_scrollbody.height(),\n                        window_height\t     = $(window).height(),\n                        vh_context\t\t     = window_height * 0.01,\t//converter px para vh - parte I\n                        tbody_height_vh      = tbody_height / vh_context //converter px para vh - parte II\n                    ;\n\n                    //Se a altura do tbody for maior que 70vh, tbody_height terá 70vh de altura, pois esse é o valor máximo permitido (altura da tela);\n                    //senão, a altura será a altura inicial + 34, que é a altura do cabeçalho da tabela.\n                    if (tbody_height_vh > 70) {\n\n                        var datatable_scroll     = $(table).find('.table-container');\n\n                        tbody_height = '70vh';\n\n                        //Posicionar scroll.\n                        //posição da tabela - altura do cabeçalho - altura da barra de ações - 50\n                        $(document)\n                            .scrollTop( datatable_scroll.offset().top - $('nav.navbar').outerHeight() - $('ul.acoes').outerHeight() - 50 )\n                        ;\n\n                    }\n                    else {\n                        tbody_height = tbody_height + 45;\n                    }\n                \n                    $(table)\n                        .height( tbody_height )\n                    ;\n                } else {\n                    $(table)\n                        .height( $(table).data('original-size') )\n                    ;                    \n                }\n            })\n        ;\n\t}   \n    "]}