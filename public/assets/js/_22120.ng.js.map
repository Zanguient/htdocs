{"version":3,"sources":["_22120.app.js","_22120.factory.remessa-intermediaria.js","_22120.factory.remessa-componente.js","_22120.controller.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChlBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_22120.ng.js","sourcesContent":["'use strict';\n\nangular\n\t.module('app', [\n\t\t'vs-repeat', \n        'gc-find',\n\t\t'gc-ajax',\n\t\t'gc-transform',\n\t\t'gc-form',\n\t\t'gc-utils',\n        'ngSanitize',\n        'angular.filter',\n        'datatables'        \n\t])\n;\n     \n     \n\nangular.module('app').directive('bsInit', function() {\n    return function(scope, element, attrs) {         \n        bootstrapInit();\n    };\n});\n\nangular.module('app').directive('stringToNumber', function() {\n    return {\n        require: 'ngModel',\n        link: function(scope, element, attrs, ngModel) {\n            ngModel.$parsers.push(function(value) {\n                return '' + value;\n            });\n            ngModel.$formatters.push(function(value) {\n                return parseFloat(value);\n            });\n        }\n    };\n});\n\nangular.module('app').directive('ngUpdateHidden', function () {\n    return {\n        restrict: 'AE', //attribute or element\n        scope: {},\n        replace: true,\n        require: 'ngModel',\n        link: function (vm, elem, attr, ngModel) {\n            vm.$watch(ngModel, function (nv) {\n                elem.val(nv);\n            });\n            elem.change(function () { //bind the change event to hidden input\n                vm.$apply(function () {\n                    ngModel.$setViewValue(  elem.val());\n                });\n            });\n        }\n    };\n});\n\nangular.module('app').directive('ngRightClick', ['$parse',function($parse) {\n    return function(scope, element, attrs) {\n        var fn = $parse(attrs.ngRightClick);\n        element.bind('contextmenu', function(event) {\n            scope.$apply(function() {\n                event.preventDefault();\n                fn(scope, {$event:event});\n            });\n        });\n    };\n}]);\n\n\nangular.module('app').filter('parseDate', function() {\n    return function(input) {\n        if ( input ) return new Date(input);\n    };\n});     ","angular\n    .module('app')\n    .factory('RemessaIntermediaria', RemessaIntermediaria);\n    \n\n\tRemessaIntermediaria.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$filter',\n        '$q',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction RemessaIntermediaria($ajax, $httpParamSerializer, $rootScope, $filter, $q, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function RemessaIntermediaria(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.RemessaIntermediaria = this; \n        \n        this.DADOS          = [];\n        this.UPS            = [];\n        this.ESTACOES       = [];\n        this.TALOES         = [];\n        this.TALOES_BKP     = [];\n        this.TALOES_DETALHE = [];\n        this.SELECTED  = {};\n        this.PENDENTES = [];\n        this.GRUPOS    = [];\n        this.FILTRO    = {};\n\n        this.OPERADOR_BARRAS = '';\n    }\n    \n\n    RemessaIntermediaria.prototype.modalOpen = function(remessa) {\n        \n        this.FILTRO.REMESSA = remessa;\n        this.FILTRO.REMESSA_SELECTED = true;\n        \n        \n        $('#modal-remessa-intermediaria').modal('show');\n\n    };     \n    \n\n    RemessaIntermediaria.prototype.modalClose = function(remessa) {\n        \n        this.FILTRO.REMESSA          = undefined;\n        this.FILTRO.REMESSA_SELECTED = false;\n        \n        this.TALOES = [];\n        this.TALOES_DETALHE = [];\n        \n        this.UPS            = [];\n        this.ESTACOES       = [];\n        \n        \n        $('#modal-remessa-intermediaria').modal('hide');\n\n    };     \n       \n\n    RemessaIntermediaria.prototype.pick = function(item,action) {\n        \n        var that = this;\n\n        if ( item != undefined ) {\n        \n            this.SELECTED = item;\n\n        }\n\n    };     \n       \n       \n       \n\n    RemessaIntermediaria.prototype.consultarRemessaIntermediariasVinculo = function(remessa) {\n        \n        var that = this;\n\n        return $q(function(resolve,reject){\n\n            $ajax.get('/_22120/api/remessas-vinculo?REMESSA_ID='+remessa)\n                .then(function(response) {\n\n                    that.merge(response);                \n            \n                    resolve(response);\n                })\n                .catch(function(e) {\n                    reject(e);\n                })\n            ;\n \n        });\n    };     \n\n    RemessaIntermediaria.prototype.consultarTaloesVinculo = function(remessa) {\n        \n        var that = this;\n\n        var data = {};\n        \n        angular.copy(gScope.ConsultaRemessaVinculo, data);\n        \n        data.GP_ID = gScope.ConsultaGp.GP_ID;\n        \n        return $q(function(resolve,reject){\n\n            $ajax.post('/_22120/api/taloes-vinculo',data)\n                .then(function(response) {\n\n                    that.dataMerge( response );\n            \n                    resolve(response);\n                })\n                .catch(function(e) {\n                    reject(e);\n                })\n            ;\n \n        });\n    };     \n       \n\n    RemessaIntermediaria.prototype.dataMerge = function(response) {\n        \n        sanitizeJson(response.ESTACOES);\n        sanitizeJson(response.TALOES);\n        \n        //////////////////////////////////////////////////////////\n        gcCollection.merge(this.ESTACOES, response.ESTACOES, [\n            'UP_ID', 'ESTACAO'\n        ]);\n        \n        for ( var i in this.ESTACOES ) {\n            this.ESTACOES[i].TALOES = [];\n        }\n\n        var ups = gcCollection.groupBy(this.ESTACOES, [\n            'UP_ID',\n            'UP_DESCRICAO'\n        ], 'ESTACOES'); \n\n        gcCollection.merge(this.UPS, ups, ['UP_ID']);\n \n        //////////////////////////////////////////////////////////\n        \n        \n        \n        //////////////////////////////////////////////////////////\n        gcCollection.merge(this.TALOES_DETALHE, response.TALOES, [\n            'ID'\n        ]);\n\n        var taloes = gcCollection.groupBy(response.TALOES, [\n            'TALAO_CONTROLE',\n            'TALAO_MODELO_ID',\n            'TALAO_MODELO_DESCRICAO',\n            'TALAO_TAMANHO',\n            'TALAO_TAMANHO_DESCRICAO',\n            'TALAO_COR_CLASSE',\n            'TALAO_COR_SUBCLASSE',\n            'TALAO_PERFIL_SKU',\n            'TALAO_PERFIL_SKU_DESCRICAO',\n            'TALAO_QUANTIDADE',\n            'UM'\n        ], 'ITENS'); \n\n        gcCollection.merge(this.TALOES, taloes, ['TALAO_CONTROLE']);\n        //////////////////////////////////////////////////////////\n        \n    };     \n\n    RemessaIntermediaria.prototype.processarAuto = function() {\n                \n        var that = this;\n        \n        \n        var taloes = [];\n         \n\n        taloes = $filter('orderBy')(that.TALOES,['TALAO_COR_CLASSE*1','TALAO_COR_SUBCLASSE*1','-TALAO_QUANTIDADE*1']);\n\n            for ( var j in taloes ) {\n                var talao = taloes[j];\n\n\n                var estacao_receiver = null;\n\n                // Busca a estacao com menor quantidade\n                for ( var i in that.UPS ) {\n                    var up = that.UPS[i];\n\n                    for ( var y in up.ESTACOES ) {\n                        var estacao = up.ESTACOES[y];\n\n                        // Verifica se o perfil da estação é compatível com do talão\n                        if ( estacao.PERFIL_SKU_AUTO.indexOf( talao.TALAO_PERFIL_SKU ) != -1 ) {\n                            if ( estacao_receiver == null ) {\n                                estacao_receiver = estacao;\n                            } \n                            else \n                            if ( estacao.QUANTIDADE < estacao_receiver.QUANTIDADE ) {\n                                estacao_receiver = estacao;\n                            }\n                        }\n                    }\n                }\n\n                if ( estacao_receiver != null ) {\n                    \n                   \n                    talao.PROGRAMADO = true;\n                    estacao_receiver.TALOES.push(talao);\n                    that.estacaoQuantidade(estacao_receiver);\n                }\n            }\n            \n        taloes = $filter('orderBy')(taloes,['TALAO_CONTROLE']);\n        \n        angular.extend(that.TALOES,taloes);\n        \n        \n        \n//        var taloes = $filter('orderBy')(remessas_normais,['PROGRAMACAO_DATA', '+DATAHORA_INICIO', 'REMESSA_ID', 'REMESSA_TALAO_ID']);        ;\n    };\n    \n    \n\n    RemessaIntermediaria.prototype.checkGravar = function(estacao) {\n        \n        var that = this;\n        \n        var ret = true;\n        \n        for ( var i in that.TALOES ) {\n            var talao = that.TALOES[i];\n            \n            if ( talao.PROGRAMADO ) {\n                ret = false;\n                break;\n            }\n        }\n        \n        return ret;\n    };\n    \n\n    RemessaIntermediaria.prototype.gravar = function() {\n        var that = this;\n\n        var data = {};\n        \n        angular.copy(gScope.ConsultaRemessaVinculo, data);\n        \n        data.GP_ID  = gScope.ConsultaGp.GP_ID;\n        data.UPS    = that.UPS;\n        \n        var data = {\n            DADOS : data,\n            FILTRO : { remessa : that.FILTRO.REMESSA }\n        };\n        \n        $ajax.post('/_22120/api/remessa/intermediaria',data).then(function(response){\n\n            gScope.Estrutura.loadData(response.DATA_RETURN.DADOS);\n            that.modalClose();\n            \n\n        });\n\n    };\n    \n    RemessaIntermediaria.prototype.estacaoQuantidade = function(estacao) {\n        \n        var taloes = estacao.TALOES;\n        \n        estacao.QUANTIDADE = 0;\n        estacao.QUANTIDADE_UM = '';\n        \n        for ( var i in taloes ) {\n            var talao = taloes[i];\n            \n            estacao.QUANTIDADE += talao.TALAO_QUANTIDADE;\n            \n            if ( estacao.QUANTIDADE_UM == '' ) {\n                estacao.QUANTIDADE_UM = talao.UM;\n            }\n        }\n\n        return estacao.QUANTIDADE;\n    };\n\n\n         \n    \n    \n    RemessaIntermediaria.prototype.clearData = function() {\n        gScope.Filtro.CODIGO_BARRAS = ''; \n        this.DADOS = []; \n        this.ITENS = [];\n        \n        $('.input-codigo-barras:focusable').first().focus();\n    };     \n    \n    \n\n    RemessaIntermediaria.prototype.keypress = function(item,$event) {\n        \n        if ( $event.key == ' ' ) {\n            \n            $event.preventDefault();\n            \n            this.toggleCheck(item);\n        } else        \n        if ( $event.key == 'Enter' ) {\n            \n            $event.preventDefault();\n            \n            \n            if ( this.ITENS.length > 0) {\n                this.modalOperador.show();\n            }\n        }\n    };     \n\n    RemessaIntermediaria.prototype.modalOperador = {\n        _modal : function () {\n            return $('#modal-autenticar-operador');\n        },\n        show : function(shown,hidden) {\n\n            this._modal()\n                .modal('show')\n            ;                         \n\n            \n            this._modal()\n                .one('shown.bs.modal', function(){\n\n                    $(this).find('input:focusable').first().focus();\n\n                    if ( shown ) {\n                        shown(); \n                    }\n                })\n            ;    \n\n                this._modal()\n                    .one('hidden.bs.modal', function(){\n                        gScope.RemessaIntermediaria.OPERADOR_BARRAS = '';\n                \n                        if ( hidden ) {\n                            hidden();      \n                        }\n                    })\n                ;        \n        },\n        hide : function(hidden) {\n\n            this._modal()\n                .modal('hide')\n            ;\n\n            if ( hidden ) {\n                this._modal()\n                    .one('hidden.bs.modal', function(){\n                        hidden ? hidden() : '';\n                    })\n                ;                      \n            }\n        }\n    };     \n    \n    \n    /**\n     * Return the constructor function\n     */\n    return RemessaIntermediaria;\n};","angular\n    .module('app')\n    .factory('RemessaComponente', RemessaComponente);\n    \n\n\tRemessaComponente.$inject = [\n        '$ajax',\n        '$httpParamSerializer',\n        '$rootScope',\n        '$filter',\n        '$q',\n        '$timeout',\n        'gcCollection',\n        'gScope'\n    ];\n\nfunction RemessaComponente($ajax, $httpParamSerializer, $rootScope, $filter, $q, $timeout, gcCollection, gScope) {\n\n    /**\n     * Constructor, with class name\n     */\n    function RemessaComponente(data) {\n        if (data) {\n            this.setData(data);\n        }\n        \n\t\tgScope.RemessaComponente = this; \n        \n        this.DADOS          = [];\n        this.UPS            = [];\n        this.ESTACOES       = [];\n        this.SKUS           = [];\n        this.ORIGENS        = [];\n        this.TALOES_DETALHE = [];\n        this.SELECTED  = {};\n        this.PENDENTES = [];\n        this.GRUPOS    = [];\n        this.FILTRO    = {};\n\n        this.OPERADOR_BARRAS = '';\n    }\n\n    RemessaComponente.prototype.modalOpen = function(remessa) {\n        \n        var that = this;\n        \n        $('#modal-remessa-componente')\n            .modal('show')\n            .one('shown.bs.modal', function(){\n\n                if ( !that.FILTRO.AUTO_FILTER ) {\n                    $(this).find('#remessa-componente-tipo').first().focus();\n                }\n        \n            })\n            .one('hide.bs.modal', function(){\n                $rootScope.$apply(function(){\n                    \n                });\n            })\n            .one('hidden.bs.modal', function(){\n                \n            })\n        ;           \n\n    };     \n    \n\n    RemessaComponente.prototype.modalClose = function(remessa) {\n        \n        \n        this.FILTRO.REMESSA          = undefined;\n        this.FILTRO.REMESSA_SELECTED = false;\n        \n        this.TALOES = [];\n        this.TALOES_DETALHE = [];\n        \n        this.UPS            = [];\n        this.ESTACOES       = [];\n        \n        \n        $('#modal-remessa-componente').modal('hide');\n\n    };     \n       \n\n    RemessaComponente.prototype.pick = function(item,action) {\n        \n        var that = this;\n\n        if ( item != undefined ) {\n        \n            this.SELECTED = item;\n\n        }\n\n    };     \n       \n       \n       \n\n    RemessaComponente.prototype.consultarOrigemDados = function(remessa) {\n        \n        var that = this;\n\n        return $q(function(resolve,reject){\n\n            var data = {};\n            \n            angular.copy(that.FILTRO,data);\n            \n            $ajax.post('/_22120/api/origem-dados',data,{progress:false})\n                .then(function(response) {\n\n\n                    if ( response.FAMILIAS.length > 0 ) {\n\n                        that.FILTRO.FAMILIAS_ID = arrayToList(response.FAMILIAS,'FAMILIA_ID');\n                        that.FILTRO.REMESSA_ID  = response.FAMILIAS[0].REMESSA_ID;\n                        that.FILTRO.REQUISICAO  = response.FAMILIAS[0].REQUISICAO;\n    //                    that.merge(response);                \n\n                        that.FILTRO.ORIGEM_SELECTED = true;\n\n                        gScope.RcConsultaGp.filtrar();\n                    }\n\n                    \n                    resolve(response);\n                })\n                .catch(function(e) {\n                    reject(e);\n                })\n            ;\n \n        });\n    };     \n\n    RemessaComponente.prototype.consultarTaloesVinculo = function(remessa) {\n        \n        var that = this;\n\n        var data = {};\n        \n        angular.copy(that.FILTRO, data);\n        \n        data.GP_ID      = gScope.RcConsultaGp.GP_ID;\n        data.FAMILIA_ID = gScope.RcConsultaGp.GP_FAMILIA_ID;\n        \n        return $q(function(resolve,reject){\n\n            $ajax.post('/_22120/api/origem-necessidade',data)\n                .then(function(response) {\n\n                    that.dataMerge( response );\n            \n                    resolve(response);\n                })\n                .catch(function(e) {\n                    reject(e);\n                })\n            ;\n \n        });\n    };     \n       \n\n    RemessaComponente.prototype.dataMerge = function(response) {\n        \n        sanitizeJson(response.ESTACOES);\n        sanitizeJson(response.SKUS);\n        sanitizeJson(response.ORIGENS);\n        \n        //////////////////////////////////////////////////////////\n        gcCollection.merge(this.ESTACOES, response.ESTACOES, [\n            'UP_ID', 'ESTACAO'\n        ]);\n        \n        gcCollection.merge(this.SKUS, response.SKUS, [\n            'ID'\n        ]);        \n        \n        if ( response.CONSUMOS != undefined ) {\n\n            gcCollection.merge(this.ORIGENS, response.CONSUMOS, [\n                'ID'\n            ]);    \n        }\n        \n        \n        for ( var i in this.ESTACOES ) {\n            this.ESTACOES[i].TALOES = [];\n        }\n\n        var ups = gcCollection.groupBy(this.ESTACOES, [\n            'UP_ID',\n            'UP_DESCRICAO'\n        ], 'ESTACOES'); \n\n        gcCollection.merge(this.UPS, ups, ['UP_ID']);\n \n        //////////////////////////////////////////////////////////\n        \n        \n        \n        //////////////////////////////////////////////////////////\n\n\n        if ( this.ORIGENS.length > 0 ) {\n            if ( this.SKUS[0].ID == undefined || this.SKUS[0].ID == null ) {\n                \n                gcCollection.bind(this.SKUS, this.ORIGENS, ['MODELO_ID','TAMANHO','COR_ID'], 'ORIGENS');\n            } else {\n                gcCollection.bind(this.SKUS, this.ORIGENS, 'ID', 'ORIGENS');\n            }\n        }\n\n        \n        \n    };     \n\n    RemessaComponente.prototype.processarAuto = function() {\n                \n        var that = this;\n        \n        /**\n         * Insere a estação fake se não existir\n         */\n        if ( !(this.FAKE_IDX > 0) ) {\n\n            var fake_up = {\n                UP_ID : -1000,\n                UP_DESCRICAO : 'A FAKE',\n                ESTACOES : [\n                    {\n                        ESTACAO : -1000,\n                        ESTACAO_DESCRICAO : 'FAKE',\n                        TALOES: []\n                    }\n                ]\n            };\n\n            this.UPS.push(fake_up);\n\n            this.FAKE_IDX = this.UPS.indexOf(fake_up);        \n        }\n        \n        /**\n         * Limpa as estações\n         */\n        for ( var i in that.UPS ) {\n            var up = that.UPS[i];\n            \n            for ( var j in up.ESTACOES ) {\n                var estacao = up.ESTACOES[j];\n                \n                estacao.TALOES = [];\n            }\n        }\n        \n        var taloes = [];\n         \n        /**\n         * Copia os dados originais para serem tratados\n         */\n        angular.copy(that.SKUS,taloes);\n           \n        /**\n         * Função para gerar um id random para o item programado\n         */\n        function makeid() {\n          var text = \"\";\n          var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n          for (var i = 0; i < 5; i++)\n            text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n          return text;\n        }      \n        \n        /**\n         * Identificação da estação fake\n         */\n        var fake_estacao = that.UPS[that.FAKE_IDX].ESTACOES[0].TALOES;\n\n        \n        if ( gScope.RcConsultaGp.GP_HABILITA_QUEBRA_TALAO_SKU == 0 ) {\n            \n            var taloes = gcCollection.groupBy(that.SKUS, [\n                'ACRESCIMO'            ,\n                'DENSIDADE'            ,\n                'ESPESSURA'            ,\n                'FATOR_DIVISAO'        ,\n                'FATOR_DIVISAO_DETALHE',\n                'GRADE_ID'             ,\n                'LOCALIZACAO_ID'       ,\n                'MODELO_DESCRICAO'     ,\n                'MODELO_ID'            ,\n                'PERFIL_SKU'           ,\n                'PERFIL_SKU_DESCRICAO' ,\n                'TAMANHO'              ,\n                'TAMANHO_DESCRICAO'    ,\n                'TIPO'                 ,\n                'UM'                   \n            ], 'SKUS_GROUP',function(modelo,sku){\n                \n                if ( modelo.QUANTIDADE == undefined ) {\n                    modelo.QUANTIDADE = 0;\n                }\n                \n                if ( modelo.ORIGENS == undefined ) {\n                    modelo.ORIGENS = [];\n                }\n                \n                modelo.QUANTIDADE += sku.QUANTIDADE;\n                \n                for ( var i in sku.ORIGENS ) {\n                    var origem = sku.ORIGENS[i];\n                    \n                    modelo.ORIGENS.push(origem);\n                }\n            }); \n            \n        }\n        \n        console.log(taloes);\n        \n//        return false;\n        \n        \n        /**\n         * Passa em todos os itens a serem programados\n         */\n        for ( var i in taloes ) {\n            var talao = taloes[i];\n            \n            \n            /**\n             * Captura o saldo a programar\n             */\n            var saldo = talao.QUANTIDADE_PROGRAMAR || talao.QUANTIDADE;\n            \n\n            var origens = [];\n\n            angular.copy(talao.ORIGENS,origens);\n       \n            \n            /**\n             * Aplica um laço que irá programar toda a quantidade do item \n             * francionando em taloes que atendem a cota acumulada e não particionando a origem em mais de um talão\n             */\n            do {\n//                processarSaldo(talao);\n\n                talao.ORIGENS = [];     \n                var origem_quantidade = 0;\n\n                \n                for (var j = 0; j < origens.length; j++) {\n                    \n                    var origem = origens[j];\n                    \n                    origem_quantidade += parseFloat(origem.QUANTIDADE);\n                    \n                    if ( origem_quantidade > talao.FATOR_DIVISAO ) {\n                        origem_quantidade -= parseFloat(origem.QUANTIDADE);\n                        break;                        \n                    } else {\n                        talao.ORIGENS.push(origem);\n                        \n                        origens.splice(j,1);\n                        j--;\n                    }\n                }\n                \n                if ( origem_quantidade == 0 ) {\n                    saldo = 0;\n                } else {\n                    saldo -= origem_quantidade;\n\n                    var item_programado = {};\n\n                    angular.copy(talao,item_programado);\n\n                    item_programado.ID_REFER = makeid();\n                    item_programado.QUANTIDADE = origem_quantidade;\n\n                    fake_estacao.push(item_programado);\n                }\n                \n                \n               \n            }\n            while ( saldo > 0 );\n        }\n\n\n        taloes = fake_estacao;\n        \n        \n\n        \n        for ( var j in taloes ) {\n            var talao = taloes[j];\n\n\n            var estacao_receiver = null;\n\n            // Busca a estacao com menor quantidade\n            for ( var i in that.UPS ) {\n                var up = that.UPS[i];\n\n                for ( var y in up.ESTACOES ) {\n                    var estacao = up.ESTACOES[y];\n\n                    // Verifica se o perfil da estação é compatível com do talão\n                    if ( estacao.PERFIL_SKU_AUTO != undefined && estacao.PERFIL_SKU_AUTO != null && estacao.PERFIL_SKU_AUTO.indexOf( talao.PERFIL_SKU ) != -1 ) {\n                        if ( estacao_receiver == null ) {\n                            estacao_receiver = estacao;\n                        } \n                        else \n                        if ( estacao.QUANTIDADE < estacao_receiver.QUANTIDADE ) {\n                            estacao_receiver = estacao;\n                        }\n                    }\n                }\n            }\n\n            if ( estacao_receiver != null ) {\n\n\n                talao.PROGRAMADO = true;\n                estacao_receiver.TALOES.push(talao);\n                that.estacaoQuantidade(estacao_receiver);\n            }\n        }\n\n    };\n    \n    \n\n    RemessaComponente.prototype.checkGravar = function(estacao) {\n        \n        var that = this;\n        \n        var ret = true;\n        \n        for ( var i in that.TALOES ) {\n            var talao = that.TALOES[i];\n            \n            if ( talao.PROGRAMADO ) {\n                ret = false;\n                break;\n            }\n        }\n        \n        return ret;\n    };\n    \n\n    RemessaComponente.prototype.gravar = function() {\n        var that = this;\n\n        var data = {};\n        \n        angular.copy(gScope.ConsultaRemessaVinculo, data);\n        \n        data.GP_ID  = gScope.ConsultaGp.GP_ID;\n        data.UPS    = that.UPS;\n        \n        var data = {\n            DADOS : data,\n            FILTRO : { remessa : that.FILTRO.REMESSA }\n        };\n        \n        $ajax.post('/_22120/api/remessa/componente',data).then(function(response){\n\n            gScope.Estrutura.loadData(response.DATA_RETURN.DADOS);\n            that.modalClose();\n            \n\n        });\n\n    };\n    \n    RemessaComponente.prototype.estacaoQuantidade = function(estacao) {\n        \n        var taloes = estacao.TALOES;\n        \n        estacao.QUANTIDADE = 0;\n        estacao.QUANTIDADE_UM = '';\n        \n        for ( var i in taloes ) {\n            var talao = taloes[i];\n            \n            estacao.QUANTIDADE += talao.QUANTIDADE;\n            \n            if ( estacao.QUANTIDADE_UM == '' ) {\n                estacao.QUANTIDADE_UM = talao.UM;\n            }\n        }\n\n        return estacao.QUANTIDADE;\n    };\n\n\n         \n    \n    \n    RemessaComponente.prototype.clearData = function() {\n        gScope.Filtro.CODIGO_BARRAS = ''; \n        this.DADOS = []; \n        this.ITENS = [];\n        \n        $('.input-codigo-barras:focusable').first().focus();\n    };     \n    \n    \n\n    RemessaComponente.prototype.keypress = function(item,$event) {\n        \n        if ( $event.key == ' ' ) {\n            \n            $event.preventDefault();\n            \n            this.toggleCheck(item);\n        } else        \n        if ( $event.key == 'Enter' ) {\n            \n            $event.preventDefault();\n            \n            \n            if ( this.ITENS.length > 0) {\n                this.modalOperador.show();\n            }\n        }\n    };     \n\n    RemessaComponente.prototype.modalOperador = {\n        _modal : function () {\n            return $('#modal-autenticar-operador');\n        },\n        show : function(shown,hidden) {\n\n            this._modal()\n                .modal('show')\n            ;                         \n\n            \n            this._modal()\n                .one('shown.bs.modal', function(){\n\n                    $(this).find('input:focusable').first().focus();\n\n                    if ( shown ) {\n                        shown(); \n                    }\n                })\n            ;    \n\n                this._modal()\n                    .one('hidden.bs.modal', function(){\n                        gScope.RemessaComponente.OPERADOR_BARRAS = '';\n                \n                        if ( hidden ) {\n                            hidden();      \n                        }\n                    })\n                ;        \n        },\n        hide : function(hidden) {\n\n            this._modal()\n                .modal('hide')\n            ;\n\n            if ( hidden ) {\n                this._modal()\n                    .one('hidden.bs.modal', function(){\n                        hidden ? hidden() : '';\n                    })\n                ;                      \n            }\n        }\n    };     \n    \n    \n    /**\n     * Return the constructor function\n     */\n    return RemessaComponente;\n};","angular\n    .module('app')\n    .value('gScope', {})\n    .controller('Ctrl', Ctrl);\n    \n    \n\tCtrl.$inject = [\n        '$scope',\n        '$ajax',\n        '$filter',\n        '$timeout',\n        '$sce',\n        '$consulta',\n        'gcCollection', \n        'Historico',\n        'gScope',\n        'RemessaIntermediaria',\n        'RemessaComponente'\n    ];\n\n\tfunction Ctrl( \n        $scope, \n        $ajax,\n        $filter,\n        $timeout, \n        $sce,\n        $consulta,\n        gcCollection, \n        Historico,\n        gScope,\n        RemessaIntermediaria,\n        RemessaComponente\n    ) {\n\n\t\tvar vm = this;\n        \n\t\tvm.RemessaIntermediaria = new RemessaIntermediaria();\n\t\tvm.RemessaComponente    = new RemessaComponente();\n        vm.Consulta             = new $consulta();\n        \n        \n        vm.ConsultaRemessaVinculo                             = vm.Consulta.getNew(true);\n        vm.ConsultaRemessaVinculo.componente                  = '.consulta-remessa-vinculo';\n        vm.ConsultaRemessaVinculo.model                       = 'vm.ConsultaRemessaVinculo';\n        vm.ConsultaRemessaVinculo.option.label_descricao      = 'Remessa Vinculada:';\n        vm.ConsultaRemessaVinculo.option.obj_consulta         = '/_22120/api/remessas-vinculo';\n//        vm.ConsultaRemessaVinculo.option.tamanho_input        = '';\n//        vm.ConsultaRemessaVinculo.option.tamanho_tabela       = 427;\n        vm.ConsultaRemessaVinculo.option.campos_tabela        = [['REMESSA', 'REMESSA']];\n        vm.ConsultaRemessaVinculo.option.obj_ret              = ['REMESSA'];\n//        vm.ConsultaRemessaVinculo.require                     = vm.Remessa;\n//        vm.ConsultaRemessaVinculo.vincular();\n        vm.ConsultaRemessaVinculo.setDataRequest({REMESSA: [vm.RemessaIntermediaria.FILTRO, 'REMESSA']});\n        vm.ConsultaRemessaVinculo.compile();\n        gScope.ConsultaRemessaVinculo = vm.ConsultaRemessaVinculo;\n\n\n        vm.ConsultaGp                             = vm.Consulta.getNew(true);\n        vm.ConsultaGp.componente                  = '.consulta-gp';\n        vm.ConsultaGp.model                       = 'vm.ConsultaGp';\n        vm.ConsultaGp.option.label_descricao      = 'GP:';\n        vm.ConsultaGp.option.obj_consulta         = '/_22030/api/gp';\n        vm.ConsultaGp.option.tamanho_input        = 'input-maior';\n        vm.ConsultaGp.option.tamanho_tabela       = 427;\n        vm.ConsultaGp.option.campos_tabela        = [['GP_ID', 'ID'],['GP_DESCRICAO','GRUPO DE PRODUÇÃO']];\n        vm.ConsultaGp.option.obj_ret              = ['GP_ID', 'GP_DESCRICAO'];\n        vm.ConsultaGp.require                     = vm.ConsultaRemessaVinculo;\n        vm.ConsultaGp.vincular();\n        vm.ConsultaGp.compile();\n        gScope.ConsultaGp = vm.ConsultaGp;\n        \n\n        vm.RcConsultaGp                             = vm.Consulta.getNew(true);\n        vm.RcConsultaGp.componente                  = '.rc-consulta-gp';\n        vm.RcConsultaGp.model                       = 'vm.RcConsultaGp';\n        vm.RcConsultaGp.option.label_descricao      = 'GP:';\n        vm.RcConsultaGp.option.obj_consulta         = '/_22030/api/gp';\n        vm.RcConsultaGp.option.tamanho_input        = 'input-maior';\n        vm.RcConsultaGp.option.tamanho_tabela       = 427;\n        vm.RcConsultaGp.option.campos_tabela        = [['GP_ID', 'ID'],['GP_DESCRICAO','GRUPO DE PRODUÇÃO']];\n        vm.RcConsultaGp.option.obj_ret              = ['GP_ID', 'GP_DESCRICAO'];\n        vm.RcConsultaGp.setDataRequest({GP_FAMILIAS_ID: [vm.RemessaComponente.FILTRO, 'FAMILIAS_ID']});\n        vm.RcConsultaGp.compile();\n        vm.RcConsultaGp.disable(true);\n        gScope.RcConsultaGp = vm.RcConsultaGp;        \n\n        vm.ConsConsultaProduto                             = vm.Consulta.getNew(true);\n        vm.ConsConsultaProduto.componente                  = '.cons-consulta-produto';\n        vm.ConsConsultaProduto.model                       = 'vm.ConsConsultaProduto';\n        vm.ConsConsultaProduto.option.label_descricao      = 'Produto:';\n        vm.ConsConsultaProduto.option.obj_consulta         = '/_27050/api/produto';\n        vm.ConsConsultaProduto.option.tamanho_input        = 'input-maior';\n        vm.ConsConsultaProduto.option.tamanho_tabela       = 427;\n        vm.ConsConsultaProduto.option.campos_tabela        = [['PRODUTO_ID', 'ID'],['PRODUTO_DESCRICAO','PRODUTO']];\n        vm.ConsConsultaProduto.option.obj_ret              = ['PRODUTO_ID', 'PRODUTO_DESCRICAO'];\n        vm.ConsConsultaProduto.setDataRequest({STATUS: 1,MODELO_ID: '> 0'});\n        vm.ConsConsultaProduto.compile();\n        gScope.ConsConsultaProduto = vm.ConsConsultaProduto;        \n       \n\n        vm.ConsConsultaModeloTamanho                             = vm.Consulta.getNew(true);\n        vm.ConsConsultaModeloTamanho.componente                  = '.cons-consulta-modelo-tamanho';\n        vm.ConsConsultaModeloTamanho.model                       = 'vm.ConsConsultaModeloTamanho';\n        vm.ConsConsultaModeloTamanho.option.label_descricao      = 'Tamanho:';\n        vm.ConsConsultaModeloTamanho.option.obj_consulta         = '/_27020/api/modelo/tamanho';\n        vm.ConsConsultaModeloTamanho.option.tamanho_input        = 'input-menor';\n        vm.ConsConsultaModeloTamanho.option.tamanho_tabela       = 100;\n        vm.ConsConsultaModeloTamanho.option.campos_tabela        = [['TAMANHO_DESCRICAO', 'Tam.']];\n        vm.ConsConsultaModeloTamanho.option.obj_ret              = ['TAMANHO_DESCRICAO'];\n        vm.ConsConsultaModeloTamanho.require                     = vm.ConsConsultaProduto;\n        vm.ConsConsultaModeloTamanho.vincular();\n        vm.ConsConsultaModeloTamanho.setDataRequest({MODELO_ID: [vm.ConsConsultaProduto, 'MODELO_ID']});\n        vm.ConsConsultaModeloTamanho.compile();\n        gScope.ConsConsultaModeloTamanho = vm.ConsConsultaModeloTamanho;        \n       \n        \n\n        $scope.$watch('vm.RemessaComponente.REMESSA_TIPO_AUTO', function (newValue, oldValue, scope) {\n\n            if ( newValue != undefined && newValue.trim() != '' ) {\n                $timeout(function(){\n                    vm.RemessaComponente.modalOpen();\n                    vm.RemessaComponente.FILTRO.REMESSA_TIPO = newValue;\n                });\n            }\n        }, true);\n\n        $scope.$watch('vm.RemessaComponente.REMESSA_ORIGEM_AUTO', function (newValue, oldValue, scope) {\n\n            if ( newValue != undefined && newValue.trim() != '' ) {\n                $timeout(function(){\n                    vm.RemessaComponente.FILTRO.ORIGEM       = newValue;\n                    vm.RemessaComponente.FILTRO.AUTO_FILTER = true;\n                    vm.RemessaComponente.consultarOrigemDados();\n                });\n            }\n        }, true);\n\n        $scope.$watch('vm.RemessaComponente.FILTRO.REMESSA_TIPO', function (newValue, oldValue, scope) {\n\n            vm.RemessaComponente.FILTRO.ORIGEM          = '';\n            vm.RemessaComponente.FILTRO.ORIGEM_SELECTED = false;\n\n            if ( newValue == 3 || newValue == 4 ) {\n                \n                vm.RemessaComponente.consultarOrigemDados();\n            }\n        }, true);\n\n        $scope.$watch('vm.RemessaComponente.FILTRO.ORIGEM_SELECTED', function (newValue, oldValue, scope) {\n\n            vm.RcConsultaGp.apagar();\n            vm.RcConsultaGp.disable(!newValue);\n        }, true);        \n            \n\n        $scope.$watch('vm.RemessaIntermediaria.FILTRO.REMESSA_SELECTED', function (newValue, oldValue, scope) {\n            if ( newValue ) {\n                vm.ConsultaRemessaVinculo.filtrar();\n            } else \n            if ( !newValue ) {\n                vm.ConsultaRemessaVinculo.apagar();\n            } \n        }, true);\n\n        vm.trustedHtml = function (plainText) {\n            return $sce.trustAsHtml(plainText);\n        };\n        \n        \n        \n        \n        var data_table = $.extend({}, table_default);\n            data_table.scrollY = 'calc(100% - 35px)';\n        \n        vm.Historico           = new Historico();\n        vm.Math = window.Math;\n        vm.DADOS    = [];\n        vm.dtOptions           = data_table;\n        vm.remessa             = \"\";\n        vm.TALAO_ORDER_BY      = '';\n        vm.remessas            = [];\n        vm.itens               = [];\n        vm.selected_itens_acao = [];\n        vm.class               = [];\n        vm.filtrar_arvore      = false;\n        vm.familias_consumo    = [];\n        vm.consumo_dados       = [];\n        vm.gerar_consumo_familias = [];\n        vm.gerar_consumo_familia = [];\n        vm.filtro              = {\n            data_1 : moment().subtract(2, \"month\").toDate(),\n            data_2 : moment().add(2, \"month\").toDate()\n        };\n        \n        \n        \n        vm.RemessaKeypress = function(item,tipo,$event) {\n\n            if ( $event.key == ' ' ) {\n\n                $event.preventDefault();\n\n                vm.selectItemAcao(item,tipo,'ID');\n            }\n        };\n\n        vm.remessaAction = {\n            Filtrar: function() {\n                \n                loading($('.table-remessas'));\n                var dados = {\n                    data_1 : moment(vm.filtro.data_1).format('DD.MM.YYYY'),\n                    data_2 : moment(vm.filtro.data_2).format('DD.MM.YYYY')\n                };\n                \n                var remessa = String($filter('uppercase')(vm.filtrar_remessa));\n                \n                if ( remessa != \"undefined\" && String(vm.filtrar_remessa+'').trim() != '' ) {\n                    dados = { remessa : remessa };\n                }\n                \n                $ajax.post('/_22120/remessas',dados)\n                    .then(function(response) {\n                        vm.remessas = response;\n                \n                        $timeout(function(){\n\n                            if ( vm.filtrar_remessa != '' && vm.remessas_filtered.length == 1) {\n                                vm.remessaAction.VisualizarItem(vm.remessas_filtered[0]);\n                            }\n                        },100);\n                        \n                        $('.pesquisa.filtro-obj').select();\n                        loading('hide');\n                    }\n                );\n            },\n            VisualizarItem: function(r) {\n                vm.remessa = r;\n                \n                var link = encodeURI(urlhost + '/_22120?remessa='+vm.remessa.REMESSA);\n                window.history.pushState('Delfa - GC', 'Title', link);\n                vm.estruturaAction.ConsultarRemessa(function(){\n                    vm.filtrar_arvore      = false;\n                    vm.selected_itens_acao = [];\n                    vm.class               = [];\n                });\n            },\n            RepeatFilter: function(row) {\n                \n                var res = false;\n                \n                if ( vm.filtro.status == '' || row.STATUS_PRODUCAO == vm.filtro.status ) {\n                    res = true;\n                }\n                \n                if ( res ) {\n                    if ( vm.filtro.familia == '' || row.FAMILIA_ID == vm.filtro.familia ) {\n                        res = true;\n                    } else {\n                        res = false;\n                    }\n                }\n                \n                return res;\n            }\n        };\n\n        vm.estruturaAction = {\n            ConsultarRemessa: function(callback) {\n                var dados = {\n                    remessa : vm.remessa.REMESSA\n                };\n\n                $ajax.post('/_22120/find',dados)\n                    .then(function(response) {\n                        \n                        callback ? callback() : null;\n                        \n//                        vm.itens = response;\n//                        resizable();\n\n                        vm.estruturaAction.loadData(response);\n                        \n                        if ( $('#modal-remessa').is(\":visible\") ) {\n                            showSuccess('Os dados foram atualizados!');\n                        }\n\n                        $('#modal-remessa').modal();\n                    }\n                );\n            },\n            loadData : function (response) {\n                \n                    gcCollection.merge(vm.itens, response);\n                \n                for ( var i in  vm.itens ) {\n                    var remessa = vm.itens[i];\n                    \n                    gcCollection.bind(remessa.CONSUMOS, remessa.CONSUMO_ALOCACOES, 'ID|CONSUMO_ID', 'ALOCACOES');\n                }\n            \n            }\n        };\n                \n        vm.Acao = function (action,msg,remessa,key,name) {\n            addConfirme('<h4>Confirmação</h4>',\n                msg,\n                [obtn_sim,obtn_nao],\n                [{ret:1,func:function(){\n                    $scope.$apply(function(){\n\n                        var itens = vm.selected_itens_acao[name];\n\n                        var array = [];\n\n                        for ( var i in itens ) {\n                            var item = itens[i];\n\n                            if ( item[key] == remessa[key] ) {\n                                array.push(item);\n                            }\n                        }\n\n                        var dados = {\n                            dados: array,\n                            retorno: true,\n                            param: {\n                                remessa: String($filter('uppercase')(vm.remessa.REMESSA))\n                            }\n                        };\n\n                        $ajax.post('/_22120/'+action+'/'+name,JSON.stringify(dados),{contentType: 'application/json'})\n                            .then(function(response) {\n                                showSuccess(response.success);\n//                                vm.itens = response.dados;\n//                                resizable();\n                                vm.estruturaAction.loadData(response.dados);\n                                \n                                if ( vm.itens.length <= 0 ) {\n                                    \n                                    var idx = vm.remessas.indexOf(vm.remessa);\n\n                                    vm.remessas.splice(idx, 1);\n                                    \n                                    $('#modal-remessa').modal('hide');\n                                }\n                            })\n                        ;    \n                    });\n                }}]     \n            );\n        };\n        \n        vm.winPopUp = function (url,id,params) {\n            var modal = winPopUp(url,id,params);\n            \n            $(modal).unload( function() {\n                vm.estruturaAction.ConsultarRemessa();\n            });\n        };\n        \n        vm.setRemessaHistorico = function (remessa) {\n            $('.historico-corpo').data('id',remessa.REMESSA_ID);\n        };\n        \n        vm.getConsumo = function ()\n        {            \n            var dados = {\n                remessa_id : vm.consumo_dados.remessa_id, \n                familia_id_consumo: vm.consumo_dados.familia_id_consumo\n            };\n            \n            $ajax.post('/_22040/getPdfConsumo',dados)\n                .then(function(response) {  \n                    if (response) {\n                        printPdf(response);\n                    }\n                })\n            ; \n        };\n        \n        vm.Remessa = {\n            SELECTED : null\n        };\n        \n        vm.Consumo = {\n            FAMILIAS : [],\n            FAMILIA_SELECTED : null,\n            Gerar : function () {   \n                \n                addConfirme('<h4>Confirmação</h4>',\n                    'Confirma a geração de consumo para esta remessa?',\n                    [obtn_sim,obtn_nao],\n                    [{ret:1,func:function(){\n                        $scope.$apply(function(){\n\n                            var dados = {\n                                dados: {\n                                    REMESSA_ID : vm.Remessa.SELECTED.REMESSA_ID,\n                                    MP_FAMILIA_ID: vm.Consumo.FAMILIA_SELECTED\n                                },\n                                retorno: true,\n                                param: {\n                                    remessa: String($filter('uppercase')(vm.remessa.REMESSA))\n                                }\n                            };\n\n                            $ajax.post('/_22120/gerar-consumo',JSON.stringify(dados),{contentType: 'application/json'})\n                                .then(function(response) {  \n                                    showSuccess(response.success);\n//                                    vm.itens = response.dados;\n//                                    resizable();\n                                    vm.estruturaAction.loadData(response.dados);\n                                    \n                                    $('#modal-gerar-consumo').modal('hide');\n                                })\n                            ;    \n                        });\n                    }}]     \n                );\n                \n            },\n            ListarFamilias : function(dados) {\n                \n                $ajax.post('/_27010/familia-modelo-alocacao',dados)\n                    .then(function(response) {  \n                        if (response) {\n                            vm.Consumo.FAMILIAS = response;\n                    \n                            if ( vm.Consumo.FAMILIAS.length == 1 ) {\n                                vm.Consumo.FAMILIA_SELECTED = vm.Consumo.FAMILIAS[0].FAMILIA_ID;\n                            } else {\n                                vm.Consumo.FAMILIA_SELECTED = '';\n                            }\n                            \n                            $('#modal-gerar-consumo').modal('show');\n                        }\n                    })\n                ; \n            },\n            alterar : function() {\n                \n                \n    \n                var data = {\n                    DADOS : {\n                        CONSUMOS: vm.selected_itens_acao['CONSUMO'],\n                        PRODUTO_ID : vm.ConsConsultaProduto.PRODUTO_ID,\n                        TAMANHO    : vm.ConsConsultaModeloTamanho.TAMANHO\n                    },\n                    FILTRO : { remessa : String($filter('uppercase')(vm.remessa.REMESSA)) }\n                };                \n  \n                $ajax.post('/_22120/api/consumo/alterar',data)\n                    .then(function(response) {  \n                        vm.ConsConsultaProduto.apagar();\n                        vm.estruturaAction.loadData(response.DATA_RETURN.DADOS);\n                        $('#modal-alterar-consumo').modal('hide');                      \n                    })\n                ; \n            }\n        };\n                \n                \n\n        \n        vm.IndexOfAttr = function(array,attr, value) {\n            for(var i in array) {\n                if(array[i][attr] === value) {\n                    return i;\n                }\n            }\n            return -1;\n        };\n        \n        vm.selectItemAcao = function (item,name,key)\n        {    \n            if ( vm.selected_itens_acao[name] == undefined ) vm.selected_itens_acao[name] = [];\n            var colletion = vm.selected_itens_acao[name];\n            \n            var idx = vm.IndexOfAttr(colletion,key,item[key]);\n            \n            if (idx > -1) colletion.splice(idx, 1);\n            else          colletion.push(item);\n        };\n        \n        vm.selectedItemAcao = function (item,name,key)\n        {    \n            if ( vm.selected_itens_acao[name] == undefined ) vm.selected_itens_acao[name] = [];\n            var colletion = vm.selected_itens_acao[name];\n            \n            return ( vm.IndexOfAttr(colletion,key,item[key]) > -1 ) ? true : false;\n        };        \n        \n        vm.selectTalao = function (item) {\n            vm.class = []; \n            vm.changeClass(item);\n            vm.marcarFilhos(item);\n            vm.marcarPais(item);\n        };\n        \n        vm.changeClass = function(item){\n\n            if (vm.IndexOfAttr(vm.class,item,item.ID) == -1) {\n                vm.class.push(item);\n            }    \n        };\n        \n        vm.marcarMaes = function (item) {\n\n            var item_filtro = '[' + item.GP_PERFIL + '/' + item.REMESSA_TALAO_ID + ']';\n            //var filtro = '[' + talao.REMESSA_ID + '/' + talao.REMESSA_TALAO_ID +']';\n\n            for(var i in vm.itens)\n            {\n                var remessa = vm.itens[i]; \n                for(var j in remessa.TALOES) {\n                    var talao = remessa.TALOES[j];\n                    var talao_filtro = talao.VINCULOS;\n\n                    if ( talao_filtro != undefined && talao_filtro.indexOf(item_filtro) >= 0 ) {\n                        vm.changeClass(talao);\n                        vm.marcarMaes(talao);\n\n                    }\n                }\n            }\n        };\n        \n        vm.marcarPais = function (item) {\n            \n            var item_filtro = '[' + item.GP_PERFIL + '/' + item.REMESSA_TALAO_ID + ']';\n            //var filtro = '[' + talao.REMESSA_ID + '/' + talao.REMESSA_TALAO_ID +']';\n            \n            for(var i in vm.itens)\n            {\n                var remessa = vm.itens[i]; \n                for(var j in remessa.TALOES) {\n                    var talao = remessa.TALOES[j];\n                    var talao_filtro = talao.VINCULOS;\n                    \n                    if ( talao_filtro != undefined && talao_filtro.indexOf(item_filtro) >= 0 ) {\n                        vm.changeClass(talao);\n                        vm.marcarPais(talao);\n                        \n                        if ( vm.marcar_irmaos ) {\n                            vm.marcarIrmaos(talao);\n                        }\n                    }\n                }\n            }\n        };\n       \n        vm.marcarFilhos = function (item) {\n            \n            var item_filtro = item.VINCULOS;\n            \n            for(var i in vm.itens)\n            {\n                var remessa = vm.itens[i]; \n                for(var j in remessa.TALOES)\n                {\n                    var talao = remessa.TALOES[j];\n                    var vinculo = '[' + talao.GP_PERFIL + '/' + talao.REMESSA_TALAO_ID +']';\n                    \n                    if ( item_filtro != undefined && item_filtro.indexOf(vinculo) >= 0 ) {\n                        vm.changeClass(talao);\n                        vm.marcarFilhos(talao);\n                    }\n                }\n            }\n        };\n        \n        vm.marcarIrmaos = function (item) {\n            \n            var item_filtro = item.VINCULOS;// '[' + item.REMESSA_ID + '/' + item.REMESSA_TALAO_ID +']';\n            \n            for(var i in vm.itens)\n            {\n                var remessa = vm.itens[i]; \n                for(var j in remessa.TALOES) {\n                    var talao = remessa.TALOES[j];\n                    var vinculo = '[' + talao.GP_PERFIL + '/' + talao.REMESSA_TALAO_ID +']';\n                    \n                    if ( item_filtro != undefined && item_filtro.indexOf(vinculo) >= 0 ) {\n                        vm.changeClass(talao);\n                       \n                        vm.marcarFilhos(talao);\n   \n                        if ( vm.marcar_irmaos ) {\n                            vm.marcarMaes(talao);\n                        }\n                    }\n                }\n            }\n        };\n          \n        vm.FiltrarArvore = function (row) {\n            var result = true;\n            if ( vm.filtrar_arvore == true ) {\n                vm.filtrar_talao = '';\n                result = false;\n                \n                if ( vm.IndexOfAttr(vm.class,'ID',row.ID) >= 0 ) {\n                    result = true;\n                }\n            }\n            return result;\n        };\n                \n        vm.FiltrarTalaoDetalhe = function(talao) {\n            \n            var itens_selecionados = vm.class;\n            var result = false;\n\n            if ( itens_selecionados.length > 0 ) {\n                \n                for(var i in itens_selecionados) {\n                    if (itens_selecionados[i].REMESSA_ID == talao.REMESSA_ID && itens_selecionados[i].REMESSA_TALAO_ID == talao.REMESSA_TALAO_ID) {\n                        result = true;\n                        break;\n                    }\n                }                \n            }\n            \n            return result;\n        };\n        \n        vm.somaTaloes = function(remessa){\n            var itens = vm.class;\n            var summ     = 0;\n            var summ_alt = 0;\n            \n            for(var i in itens)\n            {\n                if (remessa.REMESSA_ID == itens[i].REMESSA_ID) {\n                    var qtd = (itens[i].QUANTIDADE == undefined) ? 0 : parseFloat(itens[i].QUANTIDADE);\n                    summ += qtd;\n                    \n                    var qtd_alt = (itens[i].QUANTIDADE_ALTERNATIVA == undefined) ? 0 : parseFloat(itens[i].QUANTIDADE_ALTERNATIVA);\n                    summ_alt += qtd_alt;\n                }\n            }\n            \n            remessa.QUANTIDADE_SOMA = summ;\n            remessa.QUANTIDADE_ALTERNATIVA_SOMA = summ_alt;\n        };\n                \n\t\tvm.limparFiltro = function() {\n            if ( vm.filtrar_arvore ) {\n                vm.filtrar_arvore = false;\n            }\n        };\n        \n        vm.FiltrarChange = function() {\n            $timeout(function(){\n                $('.talao .scroll-table').scrollTop(0);\n            }, 10);\n        };\n        \n        vm.Talao = {\n            verificarSobras : function (remessa_id) {\n\n                var dados = {\n                    dados: {\n                        remessa_id : remessa_id\n                    },\n                    retorno: true,\n                    param: {\n                        remessa: String($filter('uppercase')(vm.remessa.REMESSA))\n                    }\n                };\n                $ajax.post('/_22120/post-aproveitamento-sobra',dados)\n                    .then(function(response) {  \n                        vm.estruturaAction.loadData(response.dados);\n                    }\n                );\n            },\n            liberacaoCancelar : function () {\n                \n                addConfirme('<h4>Confirmação</h4>',\n                    'Confirma o cancelamento da liberação dos talões selecionados?',\n                    [obtn_sim,obtn_nao],\n                    [{ret:1,func:function(){\n                        $scope.$apply(function(){\n\n                            var data = {\n                                DADOS : {\n                                    TALOES: vm.selected_itens_acao['TALAO']\n                                },\n                                FILTRO : { remessa : String($filter('uppercase')(vm.remessa.REMESSA)) }\n                            };                \n\n                            $ajax.post('/_22120/api/talao/liberacao/cancelar',data)\n                                .then(function(response) {  \n                                    vm.estruturaAction.loadData(response.DATA_RETURN.DADOS);            \n                                })\n                            ; \n                        });\n                    }}]     \n                );                  \n                \n            }\n        };\n        \n        vm.TaloesExtra = {\n            DADOS : {\n                SKUS : [],\n                TALOES_EXTRA : [],\n                SELECTED : {}\n            },\n            Consultar : function(remessa_id) {\n                var that = this;\n                \n                var dados = {\n                    remessa_id : remessa_id\n                };\n                \n                $ajax.post('/_22120/get-taloes-extras',dados)\n                    .then(function(response) {  \n                        if (response) {\n\n                            \n                            gcCollection.merge(that.DADOS.SKUS        , response.SKUS        );\n                            gcCollection.merge(that.DADOS.TALOES_EXTRA, response.TALOES_EXTRA);\n                            \n                            var taloes = that.DADOS.TALOES_EXTRA;\n                            for ( var i in taloes ) {\n                                var talao_extra = taloes[i];\n                                \n                                var skus = that.DADOS.SKUS;\n                                for ( var y in skus ) {\n                                    var sku = skus[y];\n                                    if ( \n                                        talao_extra.MODELO_ID == sku.MODELO_ID && \n                                        talao_extra.COR_ID == sku.COR_ID && \n                                        talao_extra.TAMANHO == sku.TAMANHO\n                                    ) {\n                                        talao_extra.EXTEND = sku;\n                                    }\n                                }\n                            }\n\n                            $('#modal-taloes-extra').modal('show');\n                        }\n                    })\n                ; \n            },\n            Gravar : function() {\n                var that = this;\n\n                addConfirme('<h4>Confirmação</h4>',\n                    'Confirma a geração dos Talões Extras?',\n                    [obtn_sim,obtn_nao],\n                    [{ret:1,func:function(){\n                        $scope.$apply(function(){\n\n                            var dados = {\n                                dados: that.DADOS.TALOES_EXTRA,\n                                retorno: true,\n                                param: {\n                                    remessa: String($filter('uppercase')(vm.remessa.REMESSA))\n                                }\n                            };\n\n                            $ajax.post('/_22120/post-taloes-extras',JSON.stringify(dados),{contentType: 'application/json'})\n                                .then(function(response) {  \n                                    showSuccess(response.success);\n\n                                    vm.estruturaAction.loadData(response.dados);\n                                    \n                                    $('#modal-taloes-extra').modal('hide');\n                                })\n                            ;    \n                        });\n                    }}]     \n                );                \n                \n                \n            }\n        };\n        \n        vm.fixVsRepeatRemessa = function() {\n            $timeout(function(){\n                $('.table-remessas .scroll-table').scrollTop(0);\n            }, 10);\n        };\n        \n        function resizable() {\n            $timeout(function () {\n                $('.recebe-puxador-talao, .recebe-puxador-comum')\n                    .resizable({\n                        resize  : function( event, ui ) {\n                            $scope.$apply(function(){\n                                $(document).resize();\n                            });\n\n                        },\n                        handles  : 's',\n                        minHeight : 48\n                    })\n                ;\n            }, 500);\n        }\n        \n        $scope.$on('bs-init', function(ngRepeatFinishedEvent) {\n            bootstrapInit();\n        });        \n        \n        $('#modal-remessa')\n            .on('show.bs.modal', function(){\n                resizable();\n            })\n            .on('hide.bs.modal', function () {\n                window.history.pushState('Delfa - GC', 'Title', encodeURI(urlhost + '/_22120'));\n            })\n            .on('hidden.bs.modal', function(){\n                $('.pesquisa.filtro-obj').select();\n            })\n        ;\n        \n        $('#modal-taloes-extra')\n            .on('shown.bs.modal', function(){\n                $.fn.dataTable.tables( {visible: true, api: true} ).columns.adjust();\n//                $(document).resize();\n            })\n        ;\n        \n        \n        \n        gScope.Estrutura = vm.estruturaAction;\n\t}   \n  "]}