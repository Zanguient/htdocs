{"version":3,"sources":["app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"_22130.js","sourcesContent":["/**\n * _22400 - Geracao de Remessas de Bojo\n */\n\n;(function(angular) {\n\n    var Ctrl = function($scope,$ajax,$timeout,$filter,$window,$interval) {\n\n        var vm = this;\n\n        vm.composicao = {Dados:{}, Componente:{}};\n\n        vm.OPERADOR = {\n            operacao_id     :7, //registrar producao\n            valor_ext       :1,\n            barras          : '',\n            abort           :true,\n            verificar_up    :true,\n            LOGADO          :false,\n            OPERADOR_NOME   :'',\n            OPERADOR_ID     :0,\n            OPERADOR_BARRAS : ''\n        };\n\n        vm.TURNO = {\n            TURNO_SELECT : 1,\n            TURNO_ATUAL  : 0\n        };\n\n        vm.FERRAMENTAS = [];\n\n        vm.DADOS = {\n            PARADOS1 : [],\n            PARADOS2 : [],\n            ESTACOES : [{DESCRICAO: 'ESTAÇÕES',TALOES:[]}]\n        };\n\n        vm.PRODUCAO = [];\n\n        vm.TIPO_EFICIENCIA = 0;\n\n        vm.DADOS_TEMP = [];\n        vm.DADOS_TEMP.ESTACOES = [];\n\n        vm.TURNO = {\n            CODIGO      : 0,\n            DESCRICAO   : '',\n        };\n\n        vm.DESC_EFIC = 'EFICÁCIA';\n\n        vm.FILTRO = {\n            DATA_FINAL          : moment().toDate(),\n            DATA_INICIAL        : moment().toDate(),\n            DATA_FINAL2         : moment().toDate(),\n            DATA_INICIAL2       : moment().toDate(),\n            ESTABELECIMENTO     : 0,\n            GP_DESCRICAO        : '',\n            GP_ID               : 0,\n            UP_DESCRICAO        : '',\n            UP_ID               : 0,\n            UPO_ID              : 0,\n            UPO_DESCRICAO       : '',\n            ESTACAO_ID          : 0,\n            ESTACAO_DESCRICAO   : '',\n            FLAG_DATA           : true,\n            FLAG_DATA2          : true,\n            TURNO               : 0,\n            TALAO_ID            : 0,\n            MATRIZ_BARRAS       : '',\n        };\n\n        vm.MODAL         = {};\n        vm.ESTACAO       = {};\n        vm.ESTACAO_MODAL = {};\n        vm.TALAO_MODAL   = {};\n\n        vm.PRODUCAO = [];\n        vm.PRODUCAO_TOTAL = [];\n\n        vm.SETUP = {ESTACAO:0};\n\n        function init(){\n            for(var i in [1,2,3,4,5,6]){\n                vm.DADOS.PARADOS1.push([]);\n                vm.DADOS.PARADOS2.push([]);\n                vm.DADOS.ESTACOES[0].TALOES.push([]);\n            }\n\n            vm.PRODUCAO.push({\n                    DESCRICAO  : '',\n                    ESTACAO    : '',\n                    META         : 0,\n                    META_T       : 0,\n                    META_G       : 0,\n                    PERDA_T      : 0,\n                    PERDA_G      : 0,\n                    PRODUCAO_T   : 0,\n                    PRODUCAO_G   : 0,\n                    EFICIENCIA_T : 0,\n                    EFICIENCIA_G : 0,\n                    PERDAP_T     : 0,\n                    TURNO        : 0\n                });\n        }\n\n        /*\n        $(document).on('change','#turno',function(){\n            var turno = $(this).val();\n            setTimeout(function(){\n                $scope.$apply(function () {\n\n                    var desc  = $('#_turno_cadastrado').val();\n\n                    vm.TURNO.DESC_SELECT = desc;\n\n                    vm.FILTRO.TURNO = parseInt(turno);\n                    montarIndicador();\n                });\n            },300);\n            \n        });\n        */\n\n        function montarIndicador(){\n\n            vm.PRODUCAO = [];\n\n            vm.PRODUCAO_TOTAL = {\n                T_META         : 0,\n                T_META_T       : 0,\n                T_META_G       : 0,\n                T_PERDA_T      : 0,\n                T_PERDA_G      : 0,\n                T_PRODUCAO_T   : 0,\n                T_PRODUCAO_G   : 0,\n                T_EFICIENCIA_T : 0,\n                T_EFICIENCIA_G : 0,\n                T_PERDAP_T     : 0,\n                T_PERDAP_G     : 0,\n                PREVISTO_T     : 0,\n                REALIZADO_T    : 0,\n                TMPEFIC_T      : 0,\n                PREVISTO_G     : 0,\n                REALIZADO_G    : 0,\n                TMPEFIC_G      : 0,\n\n                INFO_T         : [],\n                INFO_G         : [],\n\n                EFICIENCIA_A1  : 0,\n                EFICIENCIA_B1  : 0,\n                PERDA_A1       : 0,\n                PERDA_B1       : 0,\n\n                EFICIENCIA_A2  : 0,\n                EFICIENCIA_B2  : 0,\n                PERDA_A2       : 0,\n                PERDA_B2       : 0,\n            };\n\n\n            angular.forEach(vm.DADOS.ESTACOES, function(estacao, key) {\n\n                if(vm.FILTRO.TURNO > 0){\n                    vm.TURNO.TURNO_SELECT = vm.FILTRO.TURNO;\n                }else{\n                    vm.TURNO.TURNO_SELECT = estacao.TURNO;\n                        \n                    vm.FILTRO.TURNO  = parseInt(estacao.TURNO);\n                }\n\n                vm.TURNO.TURNO_ATUAL  = estacao.TURNO;\n\n                var prod_estacao = [];\n\n                prod_estacao = {\n                    DESCRICAO      : estacao.DESCRICAO,\n                    ESTACAO        : estacao.ESTACAO,\n                    META           : 0,\n                    META_T         : 0,\n                    META_G         : 0,\n                    PERDA_T        : 0,\n                    PERDA_G        : 0,\n                    PRODUCAO_T     : 0,\n                    PRODUCAO_G     : 0,\n                    EFICIENCIA_T   : 0,\n                    EFICIENCIA_G   : 0,\n                    PERDAP_T       : 0,\n                    PERDAP_G       : 0,\n                    COR_EFIC       : 0,\n\n                    EFICIENCIA_A1  : 0,\n                    EFICIENCIA_B1  : 0,\n                    PERDA_A1       : 0,\n                    PERDA_B1       : 0,\n\n                    EFICIENCIA_A2  : 0,\n                    EFICIENCIA_B2  : 0,\n                    PERDA_A2       : 0,\n                    PERDA_B2       : 0,\n                    INFO_T         : [],\n                    INFO_G         : [],\n\n                    TURNO          : vm.TURNO.TURNO_SELECT\n                };\n\n                angular.forEach(vm.DADOS.PRODUCAO.META, function(item, key) {\n                    if(item.ESTACAO == estacao.ESTACAO){\n                        prod_estacao.META  = item.QUANTIDADE;\n                        vm.PRODUCAO_TOTAL.T_META = vm.PRODUCAO_TOTAL.T_META + Number(item.QUANTIDADE);   \n                    }\n                });\n\n                angular.forEach(vm.DADOS.PRODUCAO.META_G, function(item, key) {\n                    if(item.ESTACAO == estacao.ESTACAO){\n                        prod_estacao.META_G  = item.QUANTIDADE;   \n                        vm.PRODUCAO_TOTAL.T_META_G = vm.PRODUCAO_TOTAL.T_META_G + Number(item.QUANTIDADE);\n                    }\n                });\n\n                angular.forEach(vm.DADOS.PRODUCAO.META_T, function(item, key) {\n                    if(item.ESTACAO == estacao.ESTACAO && item.TURNO == vm.TURNO.TURNO_SELECT){\n                        vm.PRODUCAO_TOTAL.META_T   = item.QUANTIDADE;   \n                        vm.PRODUCAO_TOTAL.T_META_T = vm.PRODUCAO_TOTAL.T_META_T + Number(item.QUANTIDADE);\n                    }\n                });\n\n                angular.forEach(vm.DADOS.PRODUCAO.PERDA_G, function(item, key) {\n                    if(item.ESTACAO == estacao.ESTACAO){\n                        prod_estacao.PERDA_G  = item.QUANTIDADE;   \n                        vm.PRODUCAO_TOTAL.T_PERDA_G = vm.PRODUCAO_TOTAL.T_PERDA_G + Number(item.QUANTIDADE);\n                    }\n                });\n\n                angular.forEach(vm.DADOS.PRODUCAO.PERDA_T, function(item, key) {\n                    if(item.ESTACAO == estacao.ESTACAO && item.TURNO == vm.TURNO.TURNO_SELECT){\n                        prod_estacao.PERDA_T  = item.QUANTIDADE;   \n                        vm.PRODUCAO_TOTAL.T_PERDA_T = vm.PRODUCAO_TOTAL.T_PERDA_T + Number(item.QUANTIDADE);\n                    }\n                });\n\n                var a = 0;\n                angular.forEach(vm.DADOS.PRODUCAO.EFICIENCIA_T, function(item, key) {\n                    if(item.ESTACAO == '4'){\n                        console.log(item);\n                    }\n\n                    if(item.ESTACAO == estacao.ESTACAO && item.TURNO == vm.TURNO.TURNO_SELECT){\n                        prod_estacao.EFICIENCIA_T  = item.EFICIENCIA;\n                        prod_estacao.PRODUCAO_T  = item.QUANTIDADE;\n                        vm.PRODUCAO_TOTAL.T_EFICIENCIA_T = vm.PRODUCAO_TOTAL.T_EFICIENCIA_T + Number(item.EFICIENCIA);\n\n                        prod_estacao.PERDA_A2      = item.PERDAS_A;\n                        prod_estacao.PERDA_B2      = item.PERDAS_B;\n\n                        prod_estacao.COR_EFIC_T = item.COR_EFIC;\n\n                        prod_estacao.PRODUCAO_T  = item.QUANTIDADE;\n                        vm.PRODUCAO_TOTAL.T_PRODUCAO_T  = vm.PRODUCAO_TOTAL.T_PRODUCAO_T  + Number(item.QUANTIDADE);\n\n                        vm.PRODUCAO_TOTAL.EFICIENCIA_A1 = vm.PRODUCAO_TOTAL.EFICIENCIA_A1 + (item.EFICIENCIA_A * item.QUANTIDADE);\n                        vm.PRODUCAO_TOTAL.EFICIENCIA_B1 = vm.PRODUCAO_TOTAL.EFICIENCIA_B1 + (item.EFICIENCIA_B * item.QUANTIDADE);\n                        vm.PRODUCAO_TOTAL.PERDA_A1      = vm.PRODUCAO_TOTAL.PERDA_A1      + (item.PERDAS_A * item.QUANTIDADE);\n                        vm.PRODUCAO_TOTAL.PERDA_B1      = vm.PRODUCAO_TOTAL.PERDA_B1      + (item.PERDAS_B * item.QUANTIDADE);  \n\n                        vm.PRODUCAO_TOTAL.PREVISTO_T    = vm.PRODUCAO_TOTAL.PREVISTO_T    + Number(item.TEMPO_PREVISTO_OPERACIONAL);\n                        vm.PRODUCAO_TOTAL.REALIZADO_T   = vm.PRODUCAO_TOTAL.REALIZADO_T   + Number(item.TEMPO_REALIZADO_OPERACIONAL);\n                        vm.PRODUCAO_TOTAL.TMPEFIC_T     = vm.PRODUCAO_TOTAL.TMPEFIC_T     + Number(item.TEMPO_EFIC);\n                    }\n\n                    if(item.ESTACAO == estacao.ESTACAO){\n                        a = a + 1;\n                        prod_estacao.EFICIENCIA_A2 = Number(prod_estacao.EFICIENCIA_A2) + Number(item.EFICIENCIA_A);\n                        prod_estacao.EFICIENCIA_B2 = Number(prod_estacao.EFICIENCIA_B2) + Number(item.EFICIENCIA_B);\n                    }\n\n                });\n\n                if(a < 1){a = 1;}\n                prod_estacao.EFICIENCIA_A2 = Number(prod_estacao.EFICIENCIA_A2)/ a;\n                prod_estacao.EFICIENCIA_B2 = Number(prod_estacao.EFICIENCIA_B2)/ a;\n\n                angular.forEach(vm.DADOS.PRODUCAO.EFICIENCIA_G, function(item, key) {\n                    if(item.ESTACAO == estacao.ESTACAO){\n                        prod_estacao.EFICIENCIA_G  = item.EFICIENCIA;\n                        prod_estacao.PRODUCAO_G  = item.QUANTIDADE;\n\n                        prod_estacao.EFICIENCIA_A1 = item.EFICIENCIA_A;\n                        prod_estacao.EFICIENCIA_B1 = item.EFICIENCIA_B;\n                        prod_estacao.PERDA_A1      = item.PERDAS_A;\n                        prod_estacao.PERDA_B1      = item.PERDAS_B;\n\n                        prod_estacao.COR_EFIC_G = item.COR_EFIC;\n\n                        prod_estacao.PRODUCAO_G  = item.QUANTIDADE;\n                        vm.PRODUCAO_TOTAL.T_PRODUCAO_G  = vm.PRODUCAO_TOTAL.T_PRODUCAO_G  + Number(item.QUANTIDADE);\n\n                        vm.PRODUCAO_TOTAL.EFICIENCIA_A2 = vm.PRODUCAO_TOTAL.EFICIENCIA_A2 + (item.EFICIENCIA_A * item.QUANTIDADE);\n                        vm.PRODUCAO_TOTAL.EFICIENCIA_B2 = vm.PRODUCAO_TOTAL.EFICIENCIA_B2 + (item.EFICIENCIA_B * item.QUANTIDADE);\n\n                        vm.PRODUCAO_TOTAL.PERDA_A2      = vm.PRODUCAO_TOTAL.PERDA_A2 + (item.PERDAS_A * item.QUANTIDADE);\n                        vm.PRODUCAO_TOTAL.PERDA_B2      = vm.PRODUCAO_TOTAL.PERDA_B2 + (item.PERDAS_B * item.QUANTIDADE); \n\n                        vm.PRODUCAO_TOTAL.PREVISTO_G    = vm.PRODUCAO_TOTAL.PREVISTO_G    + Number(item.TEMPO_PREVISTO_OPERACIONAL);\n                        vm.PRODUCAO_TOTAL.REALIZADO_G   = vm.PRODUCAO_TOTAL.REALIZADO_G   + Number(item.TEMPO_REALIZADO_OPERACIONAL);\n                        vm.PRODUCAO_TOTAL.TMPEFIC_G     = vm.PRODUCAO_TOTAL.TMPEFIC_G     + Number(item.TEMPO_EFIC);\n                    }\n                });\n\n                prod_estacao.INFO_T.push(['Meta A',prod_estacao.EFICIENCIA_A1]);\n                prod_estacao.INFO_T.push(['Meta B',prod_estacao.EFICIENCIA_B1]);\n                prod_estacao.INFO_G.push(['Meta A',prod_estacao.EFICIENCIA_A2]);\n                prod_estacao.INFO_G.push(['Meta B',prod_estacao.EFICIENCIA_B2]);\n\n                if(vm.TIPO_EFICIENCIA == 1){\n\n                    var disponivel_t = 0;\n                    var decorrido_t  = 0;\n                    var disponivel_g = 0;\n                    var decorrido_g  = 0;\n\n                    if(vm.TURNO.TURNO_SELECT == 1){\n                        var disponivel_t = vm.DADOS.PRODUCAO.TEMPO_PROD[0].DISPONIVEL_T1;\n                        var decorrido_t  = vm.DADOS.PRODUCAO.TEMPO_PROD[0].CORRIDO_T1;\n                    }else{\n                        var disponivel_t = vm.DADOS.PRODUCAO.TEMPO_PROD[0].DISPONIVEL_T2;\n                        var decorrido_t  = vm.DADOS.PRODUCAO.TEMPO_PROD[0].CORRIDO_T2;\n                    }\n\n                    var disponivel_g = Number(vm.DADOS.PRODUCAO.TEMPO_PROD[0].DISPONIVEL_T1) + Number(vm.DADOS.PRODUCAO.TEMPO_PROD[0].DISPONIVEL_T2);\n                    var decorrido_g  = Number(vm.DADOS.PRODUCAO.TEMPO_PROD[0].CORRIDO_T1)    + Number(vm.DADOS.PRODUCAO.TEMPO_PROD[0].CORRIDO_T2);\n\n                        function tratar(meta,disponivel,decorrido,produzido){\n                            var ret = 0;\n\n                            ret = (produzido * 100) / meta;\n\n                            if( meta       == 0 ){ret = 0;}\n                            if( disponivel == 0 ){ret = 0;}\n                            if( decorrido  == 0 ){ret = 0;}\n                            if( produzido  == 0 ){ret = 0;}\n\n                            return ret;\n                        }\n\n                    var meta_t =  ((prod_estacao.META_G / disponivel_g) *  decorrido_t);\n                    var meta_g =  ((prod_estacao.META_G / disponivel_g) *  decorrido_g);\n\n                    var efic_t  = tratar(meta_t ,disponivel_t, decorrido_t, prod_estacao.PRODUCAO_T);\n                    var efic_g  = tratar(meta_g ,disponivel_g, decorrido_g, prod_estacao.PRODUCAO_G);\n\n                    prod_estacao.EFICIENCIA_T = Number(efic_t);\n                    prod_estacao.EFICIENCIA_G = Number(efic_g);\n\n                    prod_estacao.INFO_T.push(['Temp. Disp.',disponivel_t]);\n                    prod_estacao.INFO_T.push(['Temp. Deco.',decorrido_t] );\n                    prod_estacao.INFO_T.push(['Meta Prod.' ,meta_t]      );  \n\n                    prod_estacao.INFO_G.push(['Temp. Disp.',disponivel_g]);\n                    prod_estacao.INFO_G.push(['Temp. Deco.',decorrido_g] );\n                    prod_estacao.INFO_G.push(['Meta Prod.' ,meta_g]      );              \n\n                    if(Number(efic_t) <  Number(prod_estacao.EFICIENCIA_A1)){prod_estacao.COR_EFIC_T = 1;}\n                    if(Number(efic_t) >= Number(prod_estacao.EFICIENCIA_A1) && efic_t <= Number(prod_estacao.EFICIENCIA_B2)){prod_estacao.COR_EFIC_T = 2;}\n                    if(Number(efic_t) >  Number(prod_estacao.EFICIENCIA_B1)){prod_estacao.COR_EFIC_T = 3;}\n\n                    if(Number(efic_g) <  Number(prod_estacao.EFICIENCIA_A2)){prod_estacao.COR_EFIC_G = 1;}\n                    if(Number(efic_g) >= Number(prod_estacao.EFICIENCIA_A2) && Number(efic_g) <= Number(prod_estacao.EFICIENCIA_B2)){prod_estacao.COR_EFIC_G = 2;}\n                    if(Number(efic_g) >  Number(prod_estacao.EFICIENCIA_B2)){prod_estacao.COR_EFIC_G = 3;}                    \n                }\n\n                if(prod_estacao.PRODUCAO_T > 0){\n                    prod_estacao.PERDAP_T = (prod_estacao.PERDA_T / prod_estacao.PRODUCAO_T) * 100;\n                }else{\n                    if(prod_estacao.PERDA_T  == 0){\n                        prod_estacao.PERDAP_T = 0;\n                    }else{\n                        prod_estacao.PERDAP_T = 100.00;\n                    }\n                }\n\n                if(prod_estacao.PRODUCAO_G > 0){\n                    prod_estacao.PERDAP_G = (prod_estacao.PERDA_G / prod_estacao.PRODUCAO_G) * 100;\n                }else{\n                    if(prod_estacao.PERDA_G  == 0){\n                        prod_estacao.PERDAP_G = 0;\n                    }else{\n                        prod_estacao.PERDAP_G = 100.00;\n                    }\n                }\n\n                \n\n                if(prod_estacao.EFICIENCIA_T >= 100){\n                    prod_estacao.EFICIENCIA_T = 100;\n                }\n\n                if(prod_estacao.EFICIENCIA_G >= 100){\n                    prod_estacao.EFICIENCIA_G = 100;\n                }\n\n                if(prod_estacao.PERDAP_G >= 100){\n                    prod_estacao.PERDAP_G = 100;\n                }\n\n                if(prod_estacao.PERDAP_G >= 100){\n                    prod_estacao.PERDAP_G = 100;\n                }\n\n                vm.PRODUCAO.push(prod_estacao);\n                \n            });\n\n            if(vm.PRODUCAO_TOTAL.TMPEFIC_T > 0){\n                vm.PRODUCAO_TOTAL.T_EFICIENCIA_T = (vm.PRODUCAO_TOTAL.PREVISTO_T / vm.PRODUCAO_TOTAL.TMPEFIC_T) * 100;\n            }else{\n                if(vm.PRODUCAO_TOTAL.PREVISTO_T > 0){\n                    vm.PRODUCAO_TOTAL.T_EFICIENCIA_T = 0;\n                }else{\n                    vm.PRODUCAO_TOTAL.T_EFICIENCIA_T = 100;\n                }\n            }\n\n            if(vm.PRODUCAO_TOTAL.TMPEFIC_G > 0){\n                vm.PRODUCAO_TOTAL.T_EFICIENCIA_G = (vm.PRODUCAO_TOTAL.PREVISTO_G / vm.PRODUCAO_TOTAL.TMPEFIC_G) * 100;\n            }else{\n                if(vm.PRODUCAO_TOTAL.PREVISTO_G > 0){\n                    vm.PRODUCAO_TOTAL.T_EFICIENCIA_G = 0;\n                }else{\n                    vm.PRODUCAO_TOTAL.T_EFICIENCIA_G = 100;\n                }\n            }\n\n            if(vm.PRODUCAO_TOTAL.T_PRODUCAO_T > 0){\n                vm.PRODUCAO_TOTAL.EFICIENCIA_A1 = vm.PRODUCAO_TOTAL.EFICIENCIA_A1 / vm.PRODUCAO_TOTAL.T_PRODUCAO_T;\n                vm.PRODUCAO_TOTAL.EFICIENCIA_B1 = vm.PRODUCAO_TOTAL.EFICIENCIA_B1 / vm.PRODUCAO_TOTAL.T_PRODUCAO_T;\n                vm.PRODUCAO_TOTAL.PERDA_A1      = vm.PRODUCAO_TOTAL.PERDA_A1      / vm.PRODUCAO_TOTAL.T_PRODUCAO_T;\n                vm.PRODUCAO_TOTAL.PERDA_B1      = vm.PRODUCAO_TOTAL.PERDA_B1      / vm.PRODUCAO_TOTAL.T_PRODUCAO_T;\n            }else{\n                vm.PRODUCAO_TOTAL.EFICIENCIA_A1 = 0;\n                vm.PRODUCAO_TOTAL.EFICIENCIA_B1 = 0;\n                vm.PRODUCAO_TOTAL.PERDA_A1      = 0;\n                vm.PRODUCAO_TOTAL.PERDA_B1      = 0;\n            }\n\n            if(vm.PRODUCAO_TOTAL.T_PRODUCAO_G > 0){\n                vm.PRODUCAO_TOTAL.EFICIENCIA_A2 = vm.PRODUCAO_TOTAL.EFICIENCIA_A2 / vm.PRODUCAO_TOTAL.T_PRODUCAO_G;\n                vm.PRODUCAO_TOTAL.EFICIENCIA_B2 = vm.PRODUCAO_TOTAL.EFICIENCIA_B2 / vm.PRODUCAO_TOTAL.T_PRODUCAO_G;\n                vm.PRODUCAO_TOTAL.PERDA_A2      = vm.PRODUCAO_TOTAL.PERDA_A2      / vm.PRODUCAO_TOTAL.T_PRODUCAO_G;\n                vm.PRODUCAO_TOTAL.PERDA_B2      = vm.PRODUCAO_TOTAL.PERDA_B2      / vm.PRODUCAO_TOTAL.T_PRODUCAO_G;\n            }else{\n                vm.PRODUCAO_TOTAL.EFICIENCIA_A2 = 0;\n                vm.PRODUCAO_TOTAL.EFICIENCIA_B2 = 0;\n                vm.PRODUCAO_TOTAL.PERDA_A2      = 0;\n                vm.PRODUCAO_TOTAL.PERDA_B2      = 0;\n            }\n\n            vm.PRODUCAO_TOTAL.INFO_T.push(['Meta A',vm.PRODUCAO_TOTAL.EFICIENCIA_A1]);\n            vm.PRODUCAO_TOTAL.INFO_T.push(['Meta B',vm.PRODUCAO_TOTAL.EFICIENCIA_B1]);\n            vm.PRODUCAO_TOTAL.INFO_G.push(['Meta A',vm.PRODUCAO_TOTAL.EFICIENCIA_A2]);\n            vm.PRODUCAO_TOTAL.INFO_G.push(['Meta B',vm.PRODUCAO_TOTAL.EFICIENCIA_B2]);\n\n            if(vm.TIPO_EFICIENCIA == 1){\n\n                vm.DESC_EFIC = 'EFICIÊNCIA';\n\n                var disponivel_t = 0;\n                var decorrido_t  = 0;\n                var disponivel_g = 0;\n                var decorrido_g  = 0;\n\n                if(vm.TURNO.TURNO_SELECT == 1){\n                    var disponivel_t = vm.DADOS.PRODUCAO.TEMPO_PROD[0].DISPONIVEL_T1;\n                    var decorrido_t  = vm.DADOS.PRODUCAO.TEMPO_PROD[0].CORRIDO_T1;\n                }else{\n                    var disponivel_t = vm.DADOS.PRODUCAO.TEMPO_PROD[0].DISPONIVEL_T2;\n                    var decorrido_t  = vm.DADOS.PRODUCAO.TEMPO_PROD[0].CORRIDO_T2;\n                }\n\n                var disponivel_g = Number(vm.DADOS.PRODUCAO.TEMPO_PROD[0].DISPONIVEL_T1) + Number(vm.DADOS.PRODUCAO.TEMPO_PROD[0].DISPONIVEL_T2);\n                var decorrido_g  = Number(vm.DADOS.PRODUCAO.TEMPO_PROD[0].CORRIDO_T1)    + Number(vm.DADOS.PRODUCAO.TEMPO_PROD[0].CORRIDO_T2);\n\n                    function tratar(meta,disponivel,decorrido,produzido){\n                        var ret = 0;\n\n                        ret = (produzido * 100) / meta;\n\n                        if( meta       == 0 ){ret = 0;}\n                        if( disponivel == 0 ){ret = 0;}\n                        if( decorrido  == 0 ){ret = 0;}\n                        if( produzido  == 0 ){ret = 0;}\n\n                        return ret;\n                    }\n\n                var meta_tt =  ((vm.PRODUCAO_TOTAL.T_META / disponivel_g) *  decorrido_t);\n                var meta_tg =  ((vm.PRODUCAO_TOTAL.T_META / disponivel_g) *  decorrido_g);\n\n                var efic_tt = tratar(meta_tt ,disponivel_t, decorrido_t, vm.PRODUCAO_TOTAL.T_PRODUCAO_T);\n                var efic_tg = tratar(meta_tg ,disponivel_g, decorrido_g, vm.PRODUCAO_TOTAL.T_PRODUCAO_G);\n\n                vm.PRODUCAO_TOTAL.T_EFICIENCIA_T = efic_tt;\n                vm.PRODUCAO_TOTAL.T_EFICIENCIA_G = efic_tg;\n\n                vm.PRODUCAO_TOTAL.INFO_T.push(['Temp. Disp.',disponivel_t]);\n                vm.PRODUCAO_TOTAL.INFO_T.push(['Temp. Deco.',decorrido_t] );\n                vm.PRODUCAO_TOTAL.INFO_T.push(['Meta Prod.' ,meta_tt]     );  \n\n                vm.PRODUCAO_TOTAL.INFO_G.push(['Temp. Disp.',disponivel_g]);\n                vm.PRODUCAO_TOTAL.INFO_G.push(['Temp. Deco.',decorrido_g] );\n                vm.PRODUCAO_TOTAL.INFO_G.push(['Meta Prod.' ,meta_tg]     );\n                \n            }else{\n                vm.DESC_EFIC = 'EFICÁCIA';\n            }\n\n            if(vm.PRODUCAO_TOTAL.T_EFICIENCIA_T > 100){\n                vm.PRODUCAO_TOTAL.T_EFICIENCIA_T = 100;\n            } \n\n            if(vm.PRODUCAO_TOTAL.T_EFICIENCIA_G > 100){\n                vm.PRODUCAO_TOTAL.T_EFICIENCIA_G = 100;\n            }          \n\n            if(vm.PRODUCAO_TOTAL.T_PRODUCAO_T > 0){\n                vm.PRODUCAO_TOTAL.T_PERDAP_T = (vm.PRODUCAO_TOTAL.T_PERDA_T / vm.PRODUCAO_TOTAL.T_PRODUCAO_T) * 100;\n            }else{\n                if(vm.PRODUCAO_TOTAL.T_PERDA_T  == 0){\n                    vm.PRODUCAO_TOTAL.T_PERDAP_T = 0;\n                }else{\n                    vm.PRODUCAO_TOTAL.T_PERDAP_T = 100;\n                }\n            }\n\n            if(vm.PRODUCAO_TOTAL.T_PRODUCAO_G > 0){\n                vm.PRODUCAO_TOTAL.T_PERDAP_G = (vm.PRODUCAO_TOTAL.T_PERDA_G / vm.PRODUCAO_TOTAL.T_PRODUCAO_G) * 100;\n            }else{\n                if(vm.PRODUCAO_TOTAL.T_PERDA_G  == 0){\n                    vm.PRODUCAO_TOTAL.T_PERDAP_G = 0;\n                }else{\n                    vm.PRODUCAO_TOTAL.T_PERDAP_G = 100;\n                }\n            }\n\n        }\n\n        function validarImput(newValue,oldValue,imputValor,classConsulta){\n            if(newValue > 0){\n                $('._consulta_filtro[objcampo='+imputValor+']').val(newValue);\n            }else{\n                $('._consulta_filtro[objcampo='+imputValor+']').val(0);\n            }\n\n            if(newValue > 0 && newValue != oldValue){\n                setTimeout(function(){\n                    $('.'+classConsulta).find('.btn-filtro-consulta').trigger('click');\n                },400);\n            }\n\n            if((newValue == '' || newValue == 0) && newValue != oldValue){\n                setTimeout(function(){\n                    $('.'+classConsulta).find('.btn-apagar-filtro-consulta').trigger('click');\n                },400);\n            }  \n        }\n\n        function iniciarEstacao(estacao){\n\n            vm.ESTACAO_MODAL = estacao;\n\n            var ds = {\n                TABELA_ID       : vm.ESTACAO_MODAL.ESTACAO,\n                TABELA          : 'ESTACAO',\n                STATUS          : 0,\n                VINCULO_ID      : vm.FILTRO.GP_ID,\n                SUBVINCULO_ID   : vm.FILTRO.UP_ID,\n                OPERADOR_ID     : vm.OPERADOR.OPERADOR_ID\n            };\n            \n            $ajax.post('/_22130/pararEstacao',JSON.stringify(ds),{contentType: 'application/json'})\n                .then(function(response) {\n\n                    vm.MODAL = vm.ESTACAO_MODAL.TALOES[0];\n                    vm.MODAL.MAQUINA = vm.ESTACAO_MODAL; \n\n                    if(vm.MODAL.FLAG_REPROGRAMADO == 0 && vm.MODAL.PROGRAMACAO_STATUS == 1){\n                        $('#modal-parar-estacao').modal('hide');\n                        showSuccess('Estação foi iniciada');\n                        showAlert('Iniciando Talão...');\n                        vm.Acoes.validarMatriz();\n                    }else{\n                        $('#modal-parar-estacao').modal('hide');\n                        vm.Acoes.filtrar();\n                        showSuccess('Estação foi iniciada');\n                    }\n                    \n                }\n            );\n        }\n\n        function trocarFerramenta(ferramenta){\n\n            var temp2 = angular.copy(vm.MODAL, temp2);\n            var temp = angular.copy(vm.MODAL, temp);\n            var talao = vm.MODAL;\n\n            temp2.MAQUINA = [];\n\n            var temp1 = {\n                FERRAMENTA  : ferramenta,\n                TALAO       : temp2,\n                FILTRO      : vm.FILTRO\n            }\n\n            $ajax.post('/_22130/trocarFerramenta',JSON.stringify(temp1),{contentType: 'application/json'})\n                .then(function(response) {\n                    \n                    vm.DADOS = [];\n                    vm.MODAL = [];\n\n                    var validar = true;\n\n                    vm.DADOS = response.DADOS;\n\n                    $status  = response.INFO_STATUS;\n                    $mensage = response.INFO_MENSAGE;\n\n                    if($status == 1){showSuccess($mensage); }\n                    if($status == 2){showErro($mensage);    }\n                    if($status == 3){showAlert($mensage);   }\n\n                    angular.forEach(vm.DADOS.ESTACOES, function(estacao, key) {\n                        estacao.LIVRE = true;\n                        estacao.TALAO_EM_PRODUCAO = 0;\n\n                        angular.forEach(estacao.TALOES, function(talao, key) {\n\n                            if(talao.PROGRAMACAO_STATUS == 2){\n                                estacao.LIVRE = false;\n                                estacao.TALAO_EM_PRODUCAO = talao.ID;\n                            }\n\n                            if(temp.ID == talao.ID){\n                                vm.MODAL = talao\n                                vm.MODAL.MAQUINA = estacao;\n                                validar = false;                               \n                            };\n                        });\n\n                    });\n\n                    vm.MODAL = temp;\n\n                    vm.MODAL.INFO_TALAO.MATRIZ.FERRAMENTA_CODIGO = ferramenta.ID;\n                    vm.MODAL.FERRAMENTA_ID = ferramenta.ID;\n\n                    $('#modal-troca-ferramenta').modal('hide');\n                }\n            );\n\n        }\n\n        function acaoTalao(talao,acao){\n\n            var temp = angular.copy(talao, temp);\n\n            var estacao_setup = vm.SETUP.ESTACAO;\n\n            temp.MAQUINA = temp.MAQUINA.ESTACAO;\n\n            temp.DATA_SETUP = moment().format('YYYY-MM-DD HH:m:s');\n\n            var info = JSON.stringify({\n                FILTRO   : vm.FILTRO,\n                TALAO    : temp,\n                ACAO     : acao,\n                OPERADOR : vm.OPERADOR\n            });\n\n            $ajax.post('/_22130/acoesTaloes',info,{contentType: 'application/json'})\n                .then(function(response) {\n\n                    vm.DADOS = [];\n                    vm.MODAL = [];\n\n                    var validar = true;\n\n                    vm.DADOS = null;\n                    vm.DADOS = response.DADOS;\n\n                    vm.TURNO = response.DADOS.TURNO;\n\n                    $status  = response.INFO_STATUS;\n                    $mensage = response.INFO_MENSAGE;\n\n                    if($status == 1){showSuccess($mensage); $('#modal-troca-estacao').modal('hide');}\n                    if($status == 2){showErro($mensage);                                            }\n                    if($status == 3){showAlert($mensage);                                           }\n\n                    angular.forEach(vm.DADOS.ESTACOES, function(estacao, key) {\n\n                        if(estacao_setup == estacao.ESTACAO){\n                           vm.Acoes.fecharSetap();\n                           vm.Acoes.telaSetup(estacao,false);\n                        }\n\n                    });\n                    //*/\n\n                    $('#modal-validar-matriz').modal('hide');\n                    setTimeout(function(){\n                        $('.btn-fechar-modal').trigger('click');\n                    },300);\n\n                },function(erro){\n                    $('.matriz_barra').val('');\n                }\n            );\n        }\n\n        function padLeft(nr, n, str){\n            return Array(n-String(nr).length+1).join(str||'0')+nr;\n        }\n\n        function calcTempo(itens){\n   \n            angular.forEach(itens, function(iten, key) {\n\n                var finalizado      = iten.FINALIZADO;\n                var tempo_decorrido = iten.TEMPO_DECORRIDO;\n                var datahora_inicio = iten.DATAHORA_INICIO;\n                var setup_id        = iten.SETUP_ID;\n\n                datahora_inicio = datahora_inicio + \"\";\n\n                if(datahora_inicio.length > 0){\n\n                    //if(tempo_decorrido == 0){\n                    if(finalizado == 0){\n                        \n                        var date1 = new Date(datahora_inicio);\n                        var date2 = new Date();\n                        var timeDiff = (date2 - date1);\n\n                    }else{\n\n                        var timeDiff = tempo_decorrido;\n\n                    }\n\n                    var segundos = Math.trunc(timeDiff / 1000);\n                    var minutos  = Math.trunc(segundos / 60  );\n                    var horas    = Math.trunc(minutos  / 60  );\n                    var dias     = Math.trunc(horas    / 24  );\n\n                    horas = horas - (dias * 24);\n                    minutos = minutos - (horas * 60) - (dias * 24 * 60);\n                    segundos = segundos - (minutos * 60) - (horas * 60 * 60) - (dias * 24 * 60 * 60);\n\n                    dias = padLeft(dias,2);\n                    horas = padLeft(horas,2);\n                    minutos = padLeft(minutos,2);\n                    segundos = padLeft(segundos,2);\n\n                    if(dias == 'NaN'){dias = '00';}\n                    if(horas == 'NaN'){horas = '00';}\n                    if(minutos == 'NaN'){minutos = '00';}\n                    if(segundos == 'NaN'){segundos = '00';}\n\n                    $('.item-setup_'+setup_id).find('.tempo-setup').html(horas+':'+minutos+':'+segundos);\n                }\n\n            });\n        }\n\n        vm.TIME = null;\n\n        vm.Acoes = {\n\n            detalharProducao:function(estacao,desc){\n\n                vm.PRODUCAO.ESTACAO = desc;\n                var temp = angular.copy(vm.FILTRO, temp);\n                    temp.ESTACAO = estacao;\n\n                var filtro = JSON.stringify(temp);\n                temp = null;\n\n                $ajax.post('/_22130/getProducao',filtro,{contentType: 'application/json'})\n                    .then(function(response) {\n\n                        vm.PRODUCAO.ITENS     = response.PRODUCAO;\n                        vm.PRODUCAO.ESTACOES  = [];\n                        vm.PRODUCAO.ESTACOES2 = [];\n                        vm.PRODUCAO.PARADAS_A = response.PARADAS_A;\n                        vm.PRODUCAO.PARADAS_S = response.PARADAS_S;\n\n                        vm.PRODUCAO.TOTAL = {\n                                PERDAS_PERC                 : 0,\n                                EFICIENCIA                  : 0,\n                                SETUP_PREVISTO              : 0,\n                                SETUP_REALIZADO             : 0,\n                                QUANTIDADE                  : 0,\n                                TROCAS                      : 0,\n                                TEMPO_PREVISTO              : 0,\n                                TEMPO_REALIZADO             : 0,\n                                TEMPO_PREVISTO_OPERACIONAL  : 0,\n                                TEMPO_PREVISTO_FERRAMENTA   : 0,\n                                TEMPO_PREVISTO_AQUECIMENTO  : 0,\n                                TEMPO_PREVISTO_APROVACAO    : 0,\n                                TEMPO_REALIZADO_OPERACIONAL : 0,\n                                TEMPO_REALIZADO_FERRAMENTA  : 0,\n                                TEMPO_REALIZADO_AQUECIMENTO : 0,\n                                TEMPO_REALIZADO_APROVACAO   : 0,\n                                TEMPO_PARADO                : 0,\n                                TEMPO_EXTRA                 : 0,\n                                PERDAS                      : 0,\n                                EFICIENCIA_A                : 0,\n                                EFICIENCIA_B                : 0,\n                                PERDAS_A                    : 0,\n                                PERDAS_B                    : 0,\n                                FERRAMENTA_ID               : 0,\n                                CONTADOR                    : 0,\n                                \n                                REMESSA                     : 0,\n                                REMESSA_TALAO_ID            : 0,\n                                REQUISICAO_ID               : 0,\n                                MODELO_ID                   : 0,\n                                COR_ID                      : 0,\n                                TAMANHO                     : 0,\n\n                                REMESSA_C                   : 0,\n                                REMESSA_TALAO_ID_C          : 0,\n                                REQUISICAO_ID_C             : 0,\n                                MODELO_ID_C                 : 0,\n                                COR_ID_C                    : 0,\n                                TAMANHO_C                   : 0,\n\n                                ESTACAO                     : 0,\n                                ESTACAO2                    : 0,\n                                COR_EFIC                    : 0,\n\n                                PARADAS_A                   : [],\n                                PARADAS_S                   : []\n                            };\n\n                        var cont_setu_troc = 0;\n                        var cont_setu_aque = 0;\n                        var cont_setu_apro = 0;\n\n                        angular.forEach(vm.PRODUCAO.ITENS, function(iten, key) {\n\n                            vm.PRODUCAO.TOTAL.CONTADOR = vm.PRODUCAO.TOTAL.CONTADOR+1;\n\n                            if(vm.PRODUCAO.TOTAL.ESTACAO != iten.ESTACAO){\n                                vm.PRODUCAO.TOTAL.ESTACAO = iten.ESTACAO;\n\n                                vm.PRODUCAO.ESTACOES.push({\n                                    ID: iten.ESTACAO,\n                                    DESCRICAO: iten.ESTACAO_DESCRICAO\n                                });\n                            }                            \n\n                            if(vm.PRODUCAO.TOTAL.FERRAMENTA_ID == 0){vm.PRODUCAO.TOTAL.FERRAMENTA_ID = iten.FERRAMENTA_ID;}\n                            if(vm.PRODUCAO.TOTAL.FERRAMENTA_ID != iten.FERRAMENTA_ID){vm.PRODUCAO.TOTAL.FERRAMENTA_ID = iten.FERRAMENTA_ID; vm.PRODUCAO.TOTAL.TROCAS = vm.PRODUCAO.TOTAL.TROCAS + 1;}\n\n                            if(vm.PRODUCAO.TOTAL.REMESSA == 0){vm.PRODUCAO.TOTAL.REMESSA = iten.REMESSA;}\n                            if(vm.PRODUCAO.TOTAL.REMESSA != iten.REMESSA){vm.PRODUCAO.TOTAL.REMESSA = iten.REMESSA; vm.PRODUCAO.TOTAL.REMESSA_C = vm.PRODUCAO.TOTAL.REMESSA_C + 1;}\n\n                            if(vm.PRODUCAO.TOTAL.REMESSA_TALAO_ID == 0){vm.PRODUCAO.TOTAL.REMESSA_TALAO_ID = iten.REMESSA_TALAO_ID;}\n                            if(vm.PRODUCAO.TOTAL.REMESSA_TALAO_ID != iten.REMESSA_TALAO_ID){vm.PRODUCAO.TOTAL.REMESSA_TALAO_ID = iten.REMESSA_TALAO_ID; vm.PRODUCAO.TOTAL.REMESSA_TALAO_ID_C = vm.PRODUCAO.TOTAL.REMESSA_TALAO_ID_C + 1;}\n\n                            if(vm.PRODUCAO.TOTAL.REQUISICAO_ID == 0){vm.PRODUCAO.TOTAL.REQUISICAO_ID = iten.REQUISICAO_ID;}\n                            if(vm.PRODUCAO.TOTAL.REQUISICAO_ID != iten.FERRAMENTA_ID){vm.PRODUCAO.TOTAL.REQUISICAO_ID = iten.REQUISICAO_ID; vm.PRODUCAO.TOTAL.REQUISICAO_ID_C = vm.PRODUCAO.TOTAL.REQUISICAO_ID_C + 1;}\n\n                            if(vm.PRODUCAO.TOTAL.MODELO_ID == 0){vm.PRODUCAO.TOTAL.MODELO_ID = iten.MODELO_ID;}\n                            if(vm.PRODUCAO.TOTAL.MODELO_ID != iten.MODELO_ID){vm.PRODUCAO.TOTAL.MODELO_ID = iten.MODELO_ID; vm.PRODUCAO.TOTAL.MODELO_ID_C = vm.PRODUCAO.TOTAL.MODELO_ID_C + 1;}\n\n                            if(vm.PRODUCAO.TOTAL.COR_ID == 0){vm.PRODUCAO.TOTAL.COR_ID = iten.COR_ID;}\n                            if(vm.PRODUCAO.TOTAL.COR_ID != iten.FERRAMENTA_ID){vm.PRODUCAO.TOTAL.COR_ID = iten.COR_ID; vm.PRODUCAO.TOTAL.COR_ID_C = vm.PRODUCAO.TOTAL.COR_ID_C + 1;}\n\n                            if(vm.PRODUCAO.TOTAL.TAMANHO == 0){vm.PRODUCAO.TOTAL.TAMANHO = iten.TAMANHO;}\n                            if(vm.PRODUCAO.TOTAL.TAMANHO != iten.TAMANHO){vm.PRODUCAO.TOTAL.TAMANHO = iten.TAMANHO; vm.PRODUCAO.TOTAL.TAMANHO_C = vm.PRODUCAO.TOTAL.TAMANHO_C + 1;}\n\n                            iten.PERDAS_PERC = Number(iten.PERDAS_PERC);\n\n                            if(Number(iten.TEMPO_REALIZADO_FERRAMENTA) > 0){\n                                cont_setu_troc = cont_setu_troc + 1;\n                            }\n\n                            if(Number(iten.TEMPO_REALIZADO_AQUECIMENTO) > 0){\n                                cont_setu_aque = cont_setu_aque + 1;\n                            }\n\n                            if(Number(iten.TEMPO_REALIZADO_APROVACAO) > 0){\n                                cont_setu_apro = cont_setu_apro + 1;\n                            }\n\n                            vm.PRODUCAO.TOTAL.PERDAS_PERC                 =  Number(vm.PRODUCAO.TOTAL.PERDAS_PERC                ) + Number(iten.PERDAS_PERC                );\n                            vm.PRODUCAO.TOTAL.EFICIENCIA                  =  Number(vm.PRODUCAO.TOTAL.EFICIENCIA                 ) + Number(iten.EFICIENCIA                 );\n                            vm.PRODUCAO.TOTAL.SETUP_PREVISTO              =  Number(vm.PRODUCAO.TOTAL.SETUP_PREVISTO             ) + Number(iten.SETUP_PREVISTO             );\n                            vm.PRODUCAO.TOTAL.SETUP_REALIZADO             =  Number(vm.PRODUCAO.TOTAL.SETUP_REALIZADO            ) + Number(iten.SETUP_REALIZADO            );\n                            vm.PRODUCAO.TOTAL.QUANTIDADE                  =  Number(vm.PRODUCAO.TOTAL.QUANTIDADE                 ) + Number(iten.QUANTIDADE                 );\n                            vm.PRODUCAO.TOTAL.TEMPO_PREVISTO              =  Number(vm.PRODUCAO.TOTAL.TEMPO_PREVISTO             ) + Number(iten.TEMPO_PREVISTO             );\n                            vm.PRODUCAO.TOTAL.TEMPO_REALIZADO             =  Number(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO            ) + Number(iten.TEMPO_REALIZADO            );\n                            vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_OPERACIONAL  =  Number(vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_OPERACIONAL ) + Number(iten.TEMPO_PREVISTO_OPERACIONAL );\n                            vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_FERRAMENTA   =  Number(vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_FERRAMENTA  ) + Number(iten.TEMPO_PREVISTO_FERRAMENTA  );\n                            vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_AQUECIMENTO  =  Number(vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_AQUECIMENTO ) + Number(iten.TEMPO_PREVISTO_AQUECIMENTO );\n                            vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_APROVACAO    =  Number(vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_APROVACAO   ) + Number(iten.TEMPO_PREVISTO_APROVACAO   );\n                            vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_OPERACIONAL =  Number(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_OPERACIONAL) + Number(iten.TEMPO_REALIZADO_OPERACIONAL);\n                            vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_FERRAMENTA  =  Number(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_FERRAMENTA ) + Number(iten.TEMPO_REALIZADO_FERRAMENTA );\n                            vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_AQUECIMENTO =  Number(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_AQUECIMENTO) + Number(iten.TEMPO_REALIZADO_AQUECIMENTO);\n                            vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_APROVACAO   =  Number(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_APROVACAO  ) + Number(iten.TEMPO_REALIZADO_APROVACAO  );\n                            vm.PRODUCAO.TOTAL.TEMPO_PARADO                =  Number(vm.PRODUCAO.TOTAL.TEMPO_PARADO               ) + Number(iten.TEMPO_PARADO               );\n                            vm.PRODUCAO.TOTAL.TEMPO_EXTRA                 =  Number(vm.PRODUCAO.TOTAL.TEMPO_EXTRA                ) + Number(iten.TEMPO_EXTRA                );\n                            vm.PRODUCAO.TOTAL.PERDAS                      =  Number(vm.PRODUCAO.TOTAL.PERDAS                     ) + Number(iten.PERDAS                     );\n                            vm.PRODUCAO.TOTAL.EFICIENCIA_A                =  Number(vm.PRODUCAO.TOTAL.EFICIENCIA_A               ) + Number(iten.EFICIENCIA_A               );\n                            vm.PRODUCAO.TOTAL.EFICIENCIA_B                =  Number(vm.PRODUCAO.TOTAL.EFICIENCIA_B               ) + Number(iten.EFICIENCIA_B               );\n                            vm.PRODUCAO.TOTAL.PERDAS_A                    =  Number(vm.PRODUCAO.TOTAL.PERDAS_A                   ) + Number(iten.PERDAS_A                   );\n                            vm.PRODUCAO.TOTAL.PERDAS_B                    =  Number(vm.PRODUCAO.TOTAL.PERDAS_B                   ) + Number(iten.PERDAS_B                   );\n                            \n                        });\n\n                        if(cont_setu_troc == 0){cont_setu_troc=1;}\n                        if(cont_setu_aque == 0){cont_setu_aque=1;}\n                        if(cont_setu_apro == 0){cont_setu_apro=1;}\n\n                        vm.PRODUCAO.TOTAL.MEDIA_REALIZADO_FERRAMENTA  =  Number(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_FERRAMENTA ) / cont_setu_troc;\n                        vm.PRODUCAO.TOTAL.MEDIA_REALIZADO_AQUECIMENTO =  Number(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_AQUECIMENTO) / cont_setu_aque;\n                        vm.PRODUCAO.TOTAL.MEDIA_REALIZADO_APROVACAO   =  Number(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_APROVACAO  ) / cont_setu_apro;\n\n                        vm.PRODUCAO.TOTAL.QUANT_REALIZADO_FERRAMENTA  =  cont_setu_troc;\n                        vm.PRODUCAO.TOTAL.QUANT_REALIZADO_AQUECIMENTO =  cont_setu_aque;\n                        vm.PRODUCAO.TOTAL.QUANT_REALIZADO_APROVACAO   =  cont_setu_apro;\n\n                        var temp_perdas  = vm.PRODUCAO.TOTAL.PERDAS;\n                        if(vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_OPERACIONAL < 1){vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_OPERACIONAL = 1;}\n                        if(vm.PRODUCAO.TOTAL.CONTADOR < 1){vm.PRODUCAO.TOTAL.CONTADOR = 1;}\n                        if(vm.PRODUCAO.TOTAL.PERDAS < 1){vm.PRODUCAO.TOTAL.PERDAS = 1;}\n\n                        vm.PRODUCAO.TOTAL.EFICIENCIA_A   =  Number(vm.PRODUCAO.TOTAL.EFICIENCIA_A ) / vm.PRODUCAO.TOTAL.CONTADOR;\n                        vm.PRODUCAO.TOTAL.EFICIENCIA_B   =  Number(vm.PRODUCAO.TOTAL.EFICIENCIA_B ) / vm.PRODUCAO.TOTAL.CONTADOR;\n                        vm.PRODUCAO.TOTAL.PERDAS_A       =  Number(vm.PRODUCAO.TOTAL.PERDAS_A     ) / vm.PRODUCAO.TOTAL.CONTADOR;\n                        vm.PRODUCAO.TOTAL.PERDAS_B       =  Number(vm.PRODUCAO.TOTAL.PERDAS_B     ) / vm.PRODUCAO.TOTAL.CONTADOR;\n                        \n                        var tempo_cal = vm.PRODUCAO.TOTAL.TEMPO_PARADO + vm.PRODUCAO.TOTAL.TEMPO_EXTRA + vm.PRODUCAO.TOTAL.TEMPO_REALIZADO_OPERACIONAL;\n                        if(tempo_cal < 1){tempo_cal = 1}\n                            \n                        vm.PRODUCAO.TOTAL.PERDAS_PERC    =  Number((vm.PRODUCAO.TOTAL.PERDAS / vm.PRODUCAO.TOTAL.QUANTIDADE) * 100);\n                        vm.PRODUCAO.TOTAL.EFICIENCIA     =  (vm.PRODUCAO.TOTAL.TEMPO_PREVISTO_OPERACIONAL / tempo_cal) * 100;\n\n                        if(vm.PRODUCAO.TOTAL.PERDAS_PERC > 100){vm.PRODUCAO.TOTAL.PERDAS_PERC = 100;}\n                        if(vm.PRODUCAO.TOTAL.EFICIENCIA  > 100){vm.PRODUCAO.TOTAL.EFICIENCIA  = 100;}\n\n                        vm.PRODUCAO.TOTAL.PERDAS = temp_perdas;\n\n                        if(response.PRODUCAO.length > 0){\n                            $('#modal-detalhar-producao').modal();\n                        }else{\n                            showSuccess('Sem registros para listar');\n                        }\n\n                        var cont_paradas = 0;\n                        angular.forEach(vm.PRODUCAO.PARADAS_A, function(iten, key) {\n\n                            cont_paradas++;\n\n                            if(vm.PRODUCAO.TOTAL.ESTACAO2 != iten.ESTACAO){\n                                vm.PRODUCAO.TOTAL.ESTACAO2 = iten.ESTACAO;\n\n                                vm.PRODUCAO.ESTACOES2.push({\n                                    ID: iten.ESTACAO,\n                                    DESCRICAO: iten.ESTACAO_DESCRICAO\n                                });\n                            }\n\n                            if(iten.TIPO == 1){\n                                vm.PRODUCAO.TOTAL.PARADAS_A = Number(vm.PRODUCAO.TOTAL.PARADAS_A) + Number(iten.TEMPO_PARADO);\n                            }\n\n                        });\n\n                        vm.PRODUCAO.TOTAL.MOTIVOS = [];\n                        var i = 0;\n\n                        angular.forEach(vm.PRODUCAO.PARADAS_S, function(iten, key) {\n                            i = 0;\n                            angular.forEach(vm.PRODUCAO.TOTAL.MOTIVOS, function(iten2, key) {\n                                if(iten2.DESCRICAO == iten.MOTIVO_PARADA){\n                                    i = 1;\n                                }\n                            });\n\n                            if(i == 0){\n\n                                var obj = {\n                                    SOMA: 0,\n                                    DESCRICAO: iten.MOTIVO_PARADA,\n                                    MARCAR: iten.MARCAR\n                                };\n\n                                vm.PRODUCAO.TOTAL.MOTIVOS.push(obj);  \n                            }\n\n                            angular.forEach(vm.PRODUCAO.TOTAL.MOTIVOS, function(iten2, key) {\n                                if(iten2.DESCRICAO == iten.MOTIVO_PARADA){\n                                        iten2.SOMA = Number(iten2.SOMA) + Number(iten.TEMPO_PARADO);\n                                }\n                            });\n\n                            if(iten.TIPO == 1){\n                                vm.PRODUCAO.TOTAL.PARADAS_S = Number(vm.PRODUCAO.TOTAL.PARADAS_S) + Number(iten.TEMPO_PARADO);\n                            }\n\n                        });\n\n                        if(cont_paradas == 0){\n                            vm.PRODUCAO.ESTACOES2.push({\n                                ID: 0,\n                                DESCRICAO: \"SEM REGISTROS\"\n                            });\n\n                            var obj = {\n                                SOMA: 0,\n                                DESCRICAO: \"SEM REGISTROS\"\n                            };\n\n                            vm.PRODUCAO.TOTAL.MOTIVOS.push(obj); \n                        }\n\n                    },function(erro){\n                            \n                    }\n                );\n            },\n\n            modalProdTalao:function(item){\n\n                var temp = angular.copy(vm.FILTRO, temp);\n                    temp.ITEM = item;\n                    temp.ESTACAO  = item.ESTACAO;\n                    temp.TALAO_ID = item.TALAO_ID;\n                    temp.FILTRAR_TALAO = 999;\n\n                var filtro = JSON.stringify(temp);\n                temp = null;\n\n                $ajax.post('/_22130/getProducaoTalao',filtro,{contentType: 'application/json'})\n                    .then(function(response) {\n\n                        vm.MODAL = [];\n\n                        angular.forEach(response.ESTACOES, function(estacao, key) {\n                            if(estacao.ESTACAO == item.ESTACAO){\n                                vm.MODAL = estacao.TALOES[0];\n                                vm.MODAL.MAQUINA = [];\n                                vm.MODAL.ITEM_PRODUCAO = item;\n                            }\n                        });\n\n                        if(vm.MODAL.ID > 0){\n                            $ajax.post('/_22130/getInfoTalao',JSON.stringify(vm.MODAL),{contentType: 'application/json'})\n                            .then(function(response) {\n\n                                vm.MODAL.INFO_TALAO = [];\n                                vm.MODAL.INFO_TALAO = response;\n                            });\n\n                            $('#modal-producao-talao').modal();\n                        }\n\n                    },function(erro){\n                            \n                    }\n                );\n            },\n\n            confirmeJornada:function(estacao){\n\n                var info = JSON.stringify({\n                    ESTACAO : estacao,\n                    UP      : vm.FILTRO.UP_ID\n                });\n\n                $ajax.post('/_22130/jornadaIntervalo',info,{contentType: 'application/json'})\n                    .then(function(response) {\n\n                        addConfirme('Alterar jornada de trabalho',\n                                '<span style=\"font-size: 1.5vw;\">Utilizar <input type=\"number\" max=\"\" min=\"1\" style=\" font-size: 1.5vw;width: 6vw;display: inline-flex;\" class=\"form-control minutos_trabalhar\" value=\"0\">'+\n                                ' minutos do próximo intervalo disponível como minutos produtivos</span>'+\n                                '<br>'+\n                                '<br>'+\n                                '<span style=\"font-size: 1.5vw;\">Intervalo:<span class=\"tempo-intervalo1\"></span> a <span class=\"tempo-intervalo2\"></span></span>'\n                                ,[obtn_ok,obtn_cancelar],\n                            [\n                            {ret:1,func:function(e){\n\n                                var info = JSON.stringify({\n                                    ESTACAO : estacao,\n                                    UP      : vm.FILTRO.UP_ID,\n                                    MINUTOS : $('.minutos_trabalhar').val()\n                                });\n\n                                $ajax.post('/_22130/jornadaGravar',info,{contentType: 'application/json'})\n                                    .then(function(response) {\n\n                                    },function(erro){\n                                            \n                                    }\n                                );\n\n                            }},\n                            {ret:2,func:function(e){\n\n\n                            }},\n                            ]  \n                        );\n\n                        setTimeout(function(){\n\n                            $('.tempo-intervalo1').html(response[0].DATAHORA_INICIO);\n                            $('.tempo-intervalo2').html(response[0].DATAHORA_FIM);\n\n                            $('.minutos_trabalhar').val(response[0].MINUTOS_DESCANSO);\n                            $('.minutos_trabalhar').attr('max',response[0].MINUTOS_DESCANSO);\n                            $('.minutos_trabalhar').val(response[0].MINUTOS_DESCANSO);\n                            $('.minutos_trabalhar').focus(); \n\n                        }, 100);\n\n                    },function(erro){\n                            \n                    }\n                );\n\n            },\n\n            fecharSetap:function(){\n                clearInterval(vm.TIME);\n            },\n\n            telaSetup:function(estacao,show){\n                clearInterval(vm.TIME);\n\n                vm.SETUP = estacao.TALOES[0];\n\n                if(show){\n                    $('.item-setup_1').find('.tempo-setup').html('00:00:00');\n                    $('.item-setup_2').find('.tempo-setup').html('00:00:00');\n                    $('.item-setup_3').find('.tempo-setup').html('00:00:00');\n\n                    $('#modal-setup').modal('show');\n                }\n\n                vm.TIME = setInterval(function(){\n                    calcTempo(vm.SETUP.SETUP);\n                },1000);\n\n            },\n\n            iniciarSetup:function(setup_id,ultimo,talao){\n\n                var temp = angular.copy(talao, temp);\n\n                temp.MAQUINA = null;\n\n                temp.SETUP_ID     = setup_id;\n                temp.SETUP_ULTIMO = ultimo;\n                temp.DATA_SETUP   = moment().format('YYYY-MM-DD HH:m:s');\n\n                var estacao = talao.ESTACAO;\n\n                $ajax.post('/_22130/iniciarSetup',JSON.stringify(temp),{contentType: 'application/json'})\n                    .then(function(response) {\n                        vm.Acoes.filtrar();\n                    }\n                );\n\n            },\n\n            filtrar:function(){\n\n                vm.FILTRO.TALAO_ID = 0;\n\n                var estacao_setup = vm.SETUP.ESTACAO;\n\n                $ajax.post('/_22130/filtarTaloes',JSON.stringify(vm.FILTRO),{contentType: 'application/json'})\n                    .then(function(response) {\n\n                        var link = encodeURI(urlhost + '/_22130/'+vm.FILTRO.ESTABELECIMENTO+'/'+vm.FILTRO.GP_ID+'/'+vm.FILTRO.GP_DESCRICAO+'/'+vm.FILTRO.UP_ID+'/'+vm.FILTRO.UP_DESCRICAO+'/'+vm.FILTRO.ESTACAO_ID+'/'+vm.FILTRO.ESTACAO_DESCRICAO);\n                        window.history.replaceState('Delfa - GC', 'Title', link);\n\n                        var togle = $('.btn-toggle-filter').hasClass('collapsed');\n\n                        if(!togle){\n                            $('.btn-toggle-filter').trigger('click');\n                        }\n\n                        vm.DADOS = null;\n                        vm.DADOS = response;\n\n                        vm.TURNO = response.TURNO;\n                        \n                        angular.forEach(vm.DADOS.ESTACOES, function(estacao, key) {\n\n                            if(estacao_setup == estacao.ESTACAO){\n                               vm.Acoes.fecharSetap();\n                               vm.Acoes.telaSetup(estacao,false);\n                            }\n\n                        });\n\n                       montarIndicador();\n                    }\n                );\n            },\n\n            ferramentasLivres:function(){\n\n                var temp = {\n                    FERRAMENTA  : vm.MODAL.FERRAMENTA_ID,\n                    ESTACAO     : vm.MODAL.ESTACAO,\n                    UP          : vm.FILTRO.UP_ID,\n                    DATA_INICIO : vm.MODAL.DATAHORA_INICIO,\n                    DATA_FIM    : vm.MODAL.DATAHORA_FIM\n                }\n\n                vm.FERRAMENTAS = [];\n\n                $('#modal-troca-ferramenta').modal();\n                \n\n                $ajax.post('/_22130/ferramentasLivres',JSON.stringify(temp),{contentType: 'application/json'})\n                    .then(function(response) {\n                        vm.FERRAMENTAS = response;\n                    }\n                );\n\n            },\n\n            trocaFerramenta:function(ferramenta){\n                trocarFerramenta(ferramenta);\n            },\n\n            paradaEstacao:function(justificativa,descricao){\n\n                var ds = {\n                    TABELA_ID       : vm.ESTACAO_MODAL.ESTACAO,\n                    TABELA          : 'ESTACAO',\n                    STATUS          : justificativa,\n                    VINCULO_ID      : vm.FILTRO.GP_ID,\n                    SUBVINCULO_ID   : vm.FILTRO.UP_ID,\n                    OPERADOR_ID     : vm.OPERADOR.OPERADOR_ID\n                };\n                \n                $ajax.post('/_22130/pararEstacao',JSON.stringify(ds),{contentType: 'application/json'})\n                    .then(function(response) {\n                    \n                        $('#modal-parar-estacao').modal('hide');\n\n                        vm.Acoes.filtrar();\n\n                        showSuccess('Estação foi parada');\n                    }\n                );\n            },\n\n            justIneficiencia:function(justificativa,descricao){\n\n                if(true){\n                    addConfirme('Justificativa',\n                            'Observação para o registro <b>' + descricao + '<b>:'+\n                            '<p>'+\n                            '<input type=\"search\" class=\"form-control input-medio justificativa_ineficiencia_reg\" maxlength=\"90\" autocomplete=\"off\">'+\n                            ''\n\n                            ,[obtn_ok,obtn_cancelar],\n                        [\n                        {ret:1,func:function(e){\n\n                            var ds = {\n                                    TABELA_ID       : vm.TALAO_MODAL.PROGRAMACAO_ID,\n                                    TABELA          : 'INEFICIENCIA',\n                                    STATUS          : justificativa,\n                                    VINCULO_ID      : vm.FILTRO.GP_ID,\n                                    SUBVINCULO_ID   : vm.FILTRO.UP_ID,\n                                    OPERADOR_ID     : vm.OPERADOR.OPERADOR_ID,\n                                    OBSERVACAO      : $('.justificativa_ineficiencia_reg').val()\n                                };\n\n                            $ajax.post('/_22130/justIneficiencia',JSON.stringify(ds),{contentType: 'application/json'})\n                                .then(function(response) {\n                                    \n                                    if(response.length > 0){\n                                        vm.MODAL.JUSTIFICATIVA_INEFIC = response[0].DESC;\n                                    }\n\n                                    $('#modal-just-inefic').modal('hide');\n\n                                    showSuccess('Talão Justificado!');\n                                }\n                            );\n\n                        }},\n                        {ret:2,func:function(e){\n\n\n                        }},\n                        ]  \n                    );\n\n                    setTimeout(function(){$('.justificativa_ineficiencia_reg').focus();},300);\n\n                }else{\n                    var ds = {\n                            TABELA_ID       : vm.TALAO_MODAL.PROGRAMACAO_ID,\n                            TABELA          : 'INEFICIENCIA',\n                            STATUS          : justificativa,\n                            VINCULO_ID      : vm.FILTRO.GP_ID,\n                            SUBVINCULO_ID   : vm.FILTRO.UP_ID,\n                            OPERADOR_ID     : vm.OPERADOR.OPERADOR_ID,\n                            OBSERVACAO      : \"\"\n                        };\n\n                    $ajax.post('/_22130/justIneficiencia',JSON.stringify(ds),{contentType: 'application/json'})\n                        .then(function(response) {\n                            \n                            if(response.length > 0){\n                                vm.MODAL.JUSTIFICATIVA_INEFIC = response[0].DESC;\n                            }\n\n                            $('#modal-just-inefic').modal('hide');                          \n\n                            showSuccess('Talão Justificado!');\n                        }\n                    );   \n                }\n            },\n\n            paradaTalao:function(justificativa,descricao){\n\n                var ds = {\n                    TABELA_ID       : vm.TALAO_MODAL.ID,\n                    TABELA          : 'TALAO_ACUMULADO',\n                    STATUS          : justificativa,\n                    VINCULO_ID      : vm.FILTRO.GP_ID,\n                    SUBVINCULO_ID   : vm.FILTRO.UP_ID,\n                };\n\n                vm.TALAO_MODAL.STATUS_PARADA = justificativa;\n\n                $('#modal-parar-talao').modal('hide');\n\n                acaoTalao(vm.MODAL,'PAUSAR'); \n               \n            },\n\n            initModal:function(talao,estacao){\n                if(Object.keys(talao).length > 0){\n\n                    vm.MODAL = [];\n                    vm.MODAL = talao;\n\n                    vm.MODAL.MAQUINA = [];\n\n                    if(vm.MODAL.ID > 0){\n                        $ajax.post('/_22130/getInfoTalao',JSON.stringify(vm.MODAL),{contentType: 'application/json'})\n                        .then(function(response) {\n\n                            vm.MODAL.INFO_TALAO = [];\n                            vm.MODAL.INFO_TALAO = response;\n                        });\n\n                        angular.forEach(vm.DADOS.ESTACOES, function(estacao, key) {\n                            if(estacao.ESTACAO == vm.MODAL.ESTACAO){\n                                vm.MODAL.MAQUINA   = estacao;\n                            }\n                        });\n\n                        var data = vm.MODAL.DATA_PRODUCAO + '';\n                        vm.MODAL.DATA_PRODUCAO  = data.substr(0, 10).split('-').reverse().join('/');\n                        $('#modal-detalhar-talao').modal();\n                    }\n\n                }\n            },\n\n            modalTrocaEstacao:function(){\n\n                $('#modal-troca-estacao').modal();\n\n                var temp = angular.copy(vm.DADOS.ESTACOES, temp);\n                vm.DADOS_TEMP.ESTACOES = null;\n\n                setTimeout(function() {\n                    $scope.$apply(function () {  \n                        vm.DADOS_TEMP.ESTACOES = temp;\n                    });\n                },500);\n\n                setTimeout(function(){\n\n                    $( \".sortable\" ).sortable({\n                        revert: true,\n                        cancel      : '.itens_nao_troca',   //Quais itens não podem ser selecionados\n                        items       : '.sortable_itens',    //Quais os itens que podem ser selecionados\n                        appendTo    : \".sortable\",          //Por onde os itens selecionados podem percorrer\n                        cursor      : 'move',               //Cursor enquanto arrasta itens\n                        tolerance   : 'pointer',            //Em que ponto poderá ser soltados os itens\n                        delay       : 150,                  //Tempo em milisegundos que demora para começar a arrastar os itens\n                        distance    : 1,    \n                        revert      : false,                //Ativa o efeito ao soltar suavisado\n                        tolerance   : \"pointer\",\n                        placeholder : {\n                            element: function(currentItem) {\n                                return $('<div class=\"scoll-talao\"><div class=\"table-cell\"><div></div><div class=\"grup-valores\"><div class=\"div-info-1\"><div></div><div></div></div><div class=\"div-info-2\"><div class=\"remessa\"></div>    <div></div>    <div class=\"remessa\"></div></div></div><div class=\"grup-legenda\">    <div>    <div></div>    <div></div>    <div></div>    </div></div></div></div>')[0];\n                            },\n                            update: function(container, p) {\n                                return;\n                            }\n                        },\n                        stop: function(e, ui){\n\n                            //*\n                            var est = $(ui.item).prev('.scoll-talao').attr('estacao');\n                            var hor = '2000-01-01 00:00:00';\n\n                            vm.ESTACAO = est;\n                            vm.MODAL.ESTACAO = est;\n\n                            var item = $(ui.item).prev('.scoll-talao');\n                            var encontrado = 0;\n\n                            for(var k = 0; k < 6; k++){\n\n                                var t = $(item).attr('horafim');\n\n                                item = $(item).prev('.scoll-talao');\n\n                                if(typeof t != 'undefined' && encontrado == 0){\n                                    hor = t;\n                                    encontrado = 1;\n                                }\n                                \n                            }\n\n                            $scope.$apply(function () {\n                                vm.MODAL.ABILITAR_TROCA = 1;\n                                vm.MODAL.HORA_TALAO_ANTERIOR = hor;\n                            });\n                            \n\n                        }\n                    });\n\n                    $( \".sortable_itens\" ).find('div').disableSelection();\n\n                },500);\n            },\n\n            pararEstacao:function(estacao){\n                vm.ESTACAO_MODAL = estacao;\n                $('#modal-parar-estacao').modal();\n            },\n\n            justInefic:function(talao){\n                vm.TALAO_MODAL = talao;\n                $('#modal-just-inefic').modal();\n            },\n\n            pararTalao:function(talao){\n                vm.TALAO_MODAL = talao;\n                $('#modal-parar-talao').modal();\n            },\n\n            trocarEstacao:function(estacao_id){\n                acaoTalao(vm.MODAL,'TROCAR');\n            },\n\n            validarMatriz:function(){\n\n                vm.FILTRO.MATRIZ_BARRAS ='';\n\n                if(vm.MODAL.TROCA_MATRIZ.trim() == 'M' && vm.MODAL.TALAO_ENCERRADO == 0 && ((vm.MODAL.FLAG_REPROGRAMADO == 1 && vm.MODAL.PROGRAMACAO_STATUS == 1) || (vm.MODAL.PROGRAMACAO_STATUS == 0))){\n                    $('#modal-validar-matriz').modal();\n\n                    setTimeout(function(){\n                        $('.matriz_barra').focus();\n                    },500);\n\n                }else{\n                    acaoTalao(vm.MODAL,'INICIAR');\n                }\n\n            },\n\n            modalLogin:function(){\n                $('#modal-autenticar').modal();\n                $('.usuario_barra').val('');\n\n                setTimeout(function(){\n                    $('.usuario_barra').focus();\n                },700);\n            },\n\n            modalLogin2:function(estacao){\n\n                vm.ESTACAO_MODAL = estacao;\n\n                if(vm.OPERADOR.OPERADOR_ID > 0){\n                    iniciarEstacao(estacao);    \n                }else{\n                    $('#modal-autenticar2').modal();\n                    $('.usuario_barra2').val('');\n\n                    setTimeout(function(){\n                        $('.usuario_barra2').focus();\n                    },500);\n                }\n            },\n\n            logarUser:function(){\n                $ajax.post('/_22050/autenticacao',JSON.stringify(vm.OPERADOR),{contentType: 'application/json'})\n                    .then(function(response) {\n\n                        vm.OPERADOR = response[0];\n                        vm.OPERADOR.LOGADO = true;\n                        $('#modal-autenticar').modal('hide'); \n\n                    },function(erro){\n\n                        $('.usuario_barra').val('');\n\n                    }\n                );\n            },\n\n            logarUser2:function(estacao){\n                $ajax.post('/_22050/autenticacao',JSON.stringify(vm.OPERADOR),{contentType: 'application/json'})\n                    .then(function(response) {\n                        vm.OPERADOR = response[0];\n                        vm.OPERADOR.LOGADO = true;\n                        $('#modal-autenticar2').modal('hide'); \n\n                        iniciarEstacao(estacao);\n                    }\n                );\n            },\n\n            LogOff:function(){\n                vm.OPERADOR = null;\n                vm.OPERADOR = {\n                    operacao_id     :7, //registrar producao\n                    valor_ext       :1,\n                    barras          : '',\n                    abort           :true,\n                    verificar_up    :true,\n                    LOGADO          :false,\n                    OPERADOR_NOME   :'',\n                    OPERADOR_ID     :'',\n                    OPERADOR_BARRAS : ''\n                };\n            },\n\n            iniciarTalao:function(){\n                acaoTalao(vm.MODAL,'INICIAR');\n            },\n\n            pausarTalao:function(){\n                acaoTalao(vm.MODAL,'PAUSAR');\n            },\n\n            finalizarTalao:function(){\n                acaoTalao(vm.MODAL,'FINALIZAR');\n            },\n\n            consultarMatriz:function(){\n\n                var MTZ = {\n                    MATRIZ_BARRAS : vm.FILTRO.MATRIZ_BARRAS,\n                    FERRAMENTA_ID : vm.MODAL.FERRAMENTA_ID\n                };\n\n                $ajax.post('/_22130/consultarMatriz',JSON.stringify(MTZ),{contentType: 'application/json'})\n                    .then(function(response) {\n\n                        var validacao = response['VALIDACAO'];\n                        var mensagem  = response['MENSAGEM'];\n\n                        if(validacao){\n                            acaoTalao(vm.MODAL,'INICIAR');\n                        }else{\n                            addBalao(mensagem,'danger');\n                        }\n\n                    },function(response) {\n\n                    }\n                );\n            },\n\n            infoComponentes: function(Componente){\n                console.log(Componente);\n                $ajax.post('/_22130/getComposicao',Componente)\n                    .then(function(response) {\n                        vm.composicao = {Dados:response, Componente: Componente};\n                    },function(response) {\n\n                    }\n                );\n                $('#modal-detalhar-componentes').modal('show');\n            }\n\n        };\n\n        $scope.$watch('vm.FILTRO.ESTABELECIMENTO', function (newValue, oldValue, scope) {\n            if(newValue > 0 && newValue != oldValue && (vm.FILTRO.GP_ID < 1 || vm.FILTRO.GP_ID == '') ){\n                setTimeout(function(){\n\n                    if($('._auto_filtro').val() > 0){\n                        setTimeout(function(){\n\n                            if($('._auto_filtro').val() > 0){\n                                ///*\n                                var GP_ID             = $('._auto_gp_id').val();\n                                var UP_ID             = $('._auto_up_id').val();\n                                var ESTACAO_ID        = $('._auto_estacao_id').val();\n                                var GP_DESCRICAO      = $('._auto_gp_descricao').val();\n                                var UP_DESCRICAO      = $('._auto_up_descricao').val();\n                                var ESTACAO_DESCRICAO = $('._auto_estacao_descricao').val();\n\n                                $('._gp_id').val(GP_ID);\n                                $('._up_id').val(UP_ID);\n                                $('._estacao_id').val(ESTACAO_ID);\n                                $('._gp_descricao').val(GP_DESCRICAO);\n                                $('._up_descricao').val(UP_DESCRICAO);\n                                $('._estacao_descricao').val(ESTACAO_DESCRICAO);\n\n                                $scope.$apply(function () {\n                                    vm.FILTRO.GP_ID             = GP_ID;\n                                    vm.FILTRO.UP_ID             = UP_ID;\n                                    vm.FILTRO.ESTACAO_ID        = ESTACAO_ID;\n                                    vm.FILTRO.GP_DESCRICAO      = GP_DESCRICAO;\n                                    vm.FILTRO.UP_DESCRICAO      = UP_DESCRICAO;\n                                    vm.FILTRO.ESTACAO_DESCRICAO = ESTACAO_DESCRICAO;\n                                });\n                                //*/\n\n                                $('.btn-filtrar').trigger('click');\n                            }  \n\n                        },200);\n\n                    }else{\n\n                        if(!($('._gp_id').val() > 0)){\n                            $('.consulta_gp_grup').find('.btn-filtro-consulta').trigger('click');\n                        }\n\n                    }\n                },400);\n            }\n        }, true);\n\n        $scope.$on('bs-init', function(ngRepeatFinishedEvent) {\n            bootstrapInit();\n        });\n\n        $scope.$watch('vm.FILTRO.GP_ID', function (newValue, oldValue, scope) {\n            if(!($('._up_id').val() > 0)){\n                validarImput(newValue,oldValue,'GP','consulta_up_group');\n            }\n        }, true);\n\n        $scope.$watch('vm.FILTRO.UP_ID', function (newValue, oldValue, scope) {\n            if(!($('._estacao_id').val() !== '')){\n                validarImput(newValue,oldValue,'UP','consulta_estacao_group');\n            } \n        }, true);\n\n        $scope.$watch('vm.TIPO_EFICIENCIA', function (newValue, oldValue, scope) {\n            if(newValue != oldValue){\n                montarIndicador();\n            } \n        }, true);\n\n        $scope.$watch('vm.FILTRO.TURNO', function (newValue, oldValue, scope) {\n            if(newValue != oldValue){\n                montarIndicador();\n            } \n        }, true);\n\n        init();\n        \n    };\n\n    Ctrl.$inject = ['$scope','$ajax','$timeout','$filter','$window','$interval'];\n\n    var bsInit = function() {\n        return function(scope, element, attrs) {         \n            bootstrapInit();\n        };\n    };\n    \n    var parseData = function() {\n        return function(input) {\n            if ( input ) return new Date(input);\n        };\n    };\n        \n    angular\n    .module    ('app'           , ['angular.filter','vs-repeat','gc-ajax','gc-form','gc-utils','gc-find','gc-transform','ngSanitize'])\n    .filter    ('parseDate'     , parseData)\n    .controller('Ctrl'          , Ctrl     );\n        \n})(angular);\n\n ;(function($){\n\n    $(document).on( \"click\", \".btn-atualizat-tela\", function() {\n        $('.btn-filtrar').trigger('click');\n    });\n\n    $(document).on( \"click\", \"#fechar-resumo\", function() {\n        $('#resumo-producao').collapse('hide');\n    });\n\n    $(document).on( \"click\", \"#abrir-resumo\", function() {\n        $('#resumo-producao').collapse('show');\n    });\n\n    function padLeft(nr, n, str){\n        return Array(n-String(nr).length+1).join(str||'0')+nr;\n    }\n\n    function calcTempo2(){\n        $('.itens_tempo').each(function(i, el){\n\n            var data   = $(el).data('data');\n            var server = $('#_hora-servidor').val();\n\n            var date1 = new Date(data);\n            var date2 = new Date(server);\n            var timeDiff = date2 - date1;\n\n            var segundos = Math.trunc(timeDiff / 1000);\n            var minutos  = Math.trunc(segundos / 60  );\n            var horas    = Math.trunc(minutos  / 60  );\n            var dias     = Math.trunc(horas    / 24  );\n\n            horas = horas - (dias * 24);\n            minutos = minutos - (horas * 60) - (dias * 24 * 60);\n            segundos = segundos - (minutos * 60) - (horas * 60 * 60) - (dias * 24 * 60 * 60);\n\n            dias = padLeft(dias,2);\n            horas = padLeft(horas,2);\n            minutos = padLeft(minutos,2);\n            segundos = padLeft(segundos,2);\n\n            var corrido = $(el).find('.tempo-corrido');\n\n            if(dias > 0){\n                $(corrido).html(dias+'dias e '+horas+':'+minutos+':'+segundos);\n            }else{\n                $(corrido).html(horas+':'+minutos+':'+segundos);    \n            }\n\n        });\n    }\n\n    var atualiza_tempo = null;\n    var atualizar = null;\n    var abrir_auto = true;\n    var exibir_por_tempo = true;\n\n    setInterval(function(){\n        calcTempo2();    \n    },1000);\n\n\n//    function exibir(){\n//\n//        $('#resumo-producao').collapse('hide');\n//\n//        clearTimeout(atualizar);\n//        clearInterval(atualiza_tempo);\n//\n//        if(abrir_auto){\n//\n//            atualizar = setTimeout(function(){\n//\n//                clearTimeout(atualizar);\n//\n//                if(abrir_auto){\n//                    $('#resumo-producao').collapse('show');\n//\n//                    atualiza_tempo = setInterval(function(){\n//                        calcTempo2();\n//                        console.log('CalcTempo2');    \n//                    },1000);\n//                }\n//\n//            },30000);        \n//        }\n//    };\n\n\n//    $(document)\n//            .on('mousemove', function() {\n//                exibir();\n//           })\n//            .on('keydown', function() {\n//                exibir();\n//            })\n//            .on('click', '#status-producao', function() {\n//                exibir_por_tempo = $(this).hasClass('collapsed') ? true : false;\n//            })\n//            .on('switchChange.bootstrapSwitch', '.chk-switch', function(event, state) {\n//                abrir_auto = state ? true : false;\n//                console.log(abrir_auto);\n//            })\n//        ;\n\n    \n\n})(jQuery);"]}